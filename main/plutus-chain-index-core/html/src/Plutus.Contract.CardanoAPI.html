<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE GADTs              #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase         #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings  #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards    #-}</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-comment">{-|

Interface to the transaction types from 'cardano-api'

-}</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Plutus.Contract.CardanoAPI</span><span class="hs-special">(</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Plutus.Contract.CardanoAPI.html#fromCardanoBlock"><span class="hs-identifier">fromCardanoBlock</span></a></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.CardanoAPI.html#fromCardanoTx"><span class="hs-identifier">fromCardanoTx</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.CardanoAPI.html#setValidity"><span class="hs-identifier">setValidity</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.CardanoAPI.html#fromCardanoTxOut"><span class="hs-identifier">fromCardanoTxOut</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.CardanoAPI.html#fromCardanoTxOutRefScript"><span class="hs-identifier">fromCardanoTxOutRefScript</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><span class="hs-identifier">Export</span></span><span>
</span><span id="line-19"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Api</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Api.Shelley</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">fromRight</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">sort</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Tx.CardanoAPI</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Export</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html"><span class="hs-identifier">Plutus.ChainIndex.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.Types.html#ChainIndexTx"><span class="hs-identifier">ChainIndexTx</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#ChainIndexTxOut"><span class="hs-identifier">ChainIndexTxOut</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#ChainIndexTxOutputs"><span class="hs-identifier">ChainIndexTxOutputs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#ReferenceScript"><span class="hs-identifier">ReferenceScript</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="annot"><a href="Plutus.Contract.CardanoAPI.html#fromCardanoBlock"><span class="hs-identifier hs-type">fromCardanoBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.BlockInMode</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.CardanoMode</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Plutus.ChainIndex.Types.html#ChainIndexTx"><span class="hs-identifier hs-type">ChainIndexTx</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-29"></span><span id="fromCardanoBlock"><span class="annot"><span class="annottext">fromCardanoBlock :: BlockInMode CardanoMode -&gt; [ChainIndexTx]
</span><a href="Plutus.Contract.CardanoAPI.html#fromCardanoBlock"><span class="hs-identifier hs-var hs-var">fromCardanoBlock</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.BlockInMode</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.Block</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.BlockHeader</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span id="local-6989586621679681872"><span class="annot"><span class="annottext">[Tx era]
</span><a href="#local-6989586621679681872"><span class="hs-identifier hs-var">txs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679681871"><span class="annot"><span class="annottext">EraInMode era CardanoMode
</span><a href="#local-6989586621679681871"><span class="hs-identifier hs-var">eraInMode</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><span class="annottext">(Tx era -&gt; ChainIndexTx) -&gt; [Tx era] -&gt; [ChainIndexTx]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraInMode era CardanoMode -&gt; Tx era -&gt; ChainIndexTx
forall era.
IsCardanoEra era =&gt;
EraInMode era CardanoMode -&gt; Tx era -&gt; ChainIndexTx
</span><a href="Plutus.Contract.CardanoAPI.html#fromCardanoTx"><span class="hs-identifier hs-var">fromCardanoTx</span></a></span><span> </span><span class="annot"><span class="annottext">EraInMode era CardanoMode
</span><a href="#local-6989586621679681871"><span class="hs-identifier hs-var">eraInMode</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Tx era]
</span><a href="#local-6989586621679681872"><span class="hs-identifier hs-var">txs</span></a></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-comment">-- | Convert a Cardano API tx of any given era to a Plutus chain index tx.</span><span>
</span><span id="line-33"></span><span id="local-6989586621679682019"><span class="annot"><a href="Plutus.Contract.CardanoAPI.html#fromCardanoTx"><span class="hs-identifier hs-type">fromCardanoTx</span></a></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.IsCardanoEra</span></span><span> </span><span class="annot"><a href="#local-6989586621679682019"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.EraInMode</span></span><span> </span><span class="annot"><a href="#local-6989586621679682019"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.CardanoMode</span></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Tx</span></span><span> </span><span class="annot"><a href="#local-6989586621679682019"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#ChainIndexTx"><span class="hs-identifier hs-type">ChainIndexTx</span></a></span></span><span>
</span><span id="line-38"></span><span id="fromCardanoTx"><span class="annot"><span class="annottext">fromCardanoTx :: EraInMode era CardanoMode -&gt; Tx era -&gt; ChainIndexTx
</span><a href="Plutus.Contract.CardanoAPI.html#fromCardanoTx"><span class="hs-identifier hs-var hs-var">fromCardanoTx</span></a></span></span><span> </span><span id="local-6989586621679681870"><span class="annot"><span class="annottext">EraInMode era CardanoMode
</span><a href="#local-6989586621679681870"><span class="hs-identifier hs-var">eraInMode</span></a></span></span><span> </span><span id="local-6989586621679681869"><span class="annot"><span class="annottext">tx :: Tx era
</span><a href="#local-6989586621679681869"><span class="hs-identifier hs-var">tx</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.Tx</span></span><span> </span><span id="local-6989586621679681867"><span class="annot"><span class="annottext">txBody :: TxBody era
</span><a href="#local-6989586621679681867"><span class="hs-identifier hs-var">txBody</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.TxBody</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.TxBodyContent</span></span><span class="hs-special">{</span><span id="local-6989586621679681848"><span id="local-6989586621679681849"><span id="local-6989586621679681850"><span id="local-6989586621679681851"><span id="local-6989586621679681852"><span id="local-6989586621679681853"><span id="local-6989586621679681854"><span id="local-6989586621679681855"><span id="local-6989586621679681856"><span id="local-6989586621679681857"><span id="local-6989586621679681858"><span id="local-6989586621679681859"><span id="local-6989586621679681860"><span id="local-6989586621679681861"><span id="local-6989586621679681862"><span id="local-6989586621679681863"><span id="local-6989586621679681864"><span class="annot"><span class="annottext">TxIns ViewTx era
[TxOut CtxTx era]
(TxValidityLowerBound era, TxValidityUpperBound era)
BuildTxWith ViewTx (Maybe ProtocolParameters)
TxAuxScripts era
TxCertificates ViewTx era
TxExtraKeyWitnesses era
TxFee era
TxInsCollateral era
TxInsReference ViewTx era
TxMetadataInEra era
TxMintValue ViewTx era
TxReturnCollateral CtxTx era
TxScriptValidity era
TxTotalCollateral era
TxUpdateProposal era
TxWithdrawals ViewTx era
txWithdrawals :: forall build era.
TxBodyContent build era -&gt; TxWithdrawals build era
txValidityRange :: forall build era.
TxBodyContent build era
-&gt; (TxValidityLowerBound era, TxValidityUpperBound era)
txUpdateProposal :: forall build era. TxBodyContent build era -&gt; TxUpdateProposal era
txTotalCollateral :: forall build era. TxBodyContent build era -&gt; TxTotalCollateral era
txScriptValidity :: forall build era. TxBodyContent build era -&gt; TxScriptValidity era
txReturnCollateral :: forall build era.
TxBodyContent build era -&gt; TxReturnCollateral CtxTx era
txProtocolParams :: forall build era.
TxBodyContent build era
-&gt; BuildTxWith build (Maybe ProtocolParameters)
txOuts :: forall build era. TxBodyContent build era -&gt; [TxOut CtxTx era]
txMintValue :: forall build era. TxBodyContent build era -&gt; TxMintValue build era
txMetadata :: forall build era. TxBodyContent build era -&gt; TxMetadataInEra era
txInsReference :: forall build era.
TxBodyContent build era -&gt; TxInsReference build era
txInsCollateral :: forall build era. TxBodyContent build era -&gt; TxInsCollateral era
txIns :: forall build era. TxBodyContent build era -&gt; TxIns build era
txFee :: forall build era. TxBodyContent build era -&gt; TxFee era
txExtraKeyWits :: forall build era.
TxBodyContent build era -&gt; TxExtraKeyWitnesses era
txCertificates :: forall build era.
TxBodyContent build era -&gt; TxCertificates build era
txAuxScripts :: forall build era. TxBodyContent build era -&gt; TxAuxScripts era
txScriptValidity :: TxScriptValidity era
txMintValue :: TxMintValue ViewTx era
txUpdateProposal :: TxUpdateProposal era
txCertificates :: TxCertificates ViewTx era
txWithdrawals :: TxWithdrawals ViewTx era
txProtocolParams :: BuildTxWith ViewTx (Maybe ProtocolParameters)
txExtraKeyWits :: TxExtraKeyWitnesses era
txAuxScripts :: TxAuxScripts era
txMetadata :: TxMetadataInEra era
txValidityRange :: (TxValidityLowerBound era, TxValidityUpperBound era)
txFee :: TxFee era
txReturnCollateral :: TxReturnCollateral CtxTx era
txTotalCollateral :: TxTotalCollateral era
txOuts :: [TxOut CtxTx era]
txInsReference :: TxInsReference ViewTx era
txInsCollateral :: TxInsCollateral era
txIns :: TxIns ViewTx era
</span><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[KeyWitness era]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679681830"><span class="annot"><span class="annottext">txOutputs :: [ChainIndexTxOut]
</span><a href="#local-6989586621679681830"><span class="hs-identifier hs-var hs-var">txOutputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TxOut CtxTx era -&gt; ChainIndexTxOut)
-&gt; [TxOut CtxTx era] -&gt; [ChainIndexTxOut]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut CtxTx era -&gt; ChainIndexTxOut
forall era. IsCardanoEra era =&gt; TxOut CtxTx era -&gt; ChainIndexTxOut
</span><a href="Plutus.Contract.CardanoAPI.html#fromCardanoTxOut"><span class="hs-identifier hs-var">fromCardanoTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut CtxTx era]
</span><a href="#local-6989586621679681861"><span class="hs-identifier hs-var">txOuts</span></a></span><span>
</span><span id="line-40"></span><span>        </span><span id="local-6989586621679681829"><span class="annot"><span class="annottext">scriptMap :: Map ScriptHash (Versioned Script)
</span><a href="#local-6989586621679681829"><span class="hs-identifier hs-var hs-var">scriptMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxBody era -&gt; Map ScriptHash (Versioned Script)
forall era. TxBody era -&gt; Map ScriptHash (Versioned Script)
</span><span class="hs-identifier hs-var">plutusScriptsFromTxBody</span></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679681867"><span class="hs-identifier hs-var">txBody</span></a></span><span>
</span><span id="line-41"></span><span>        </span><span id="local-6989586621679681827"><span class="annot"><span class="annottext">isTxScriptValid :: Bool
</span><a href="#local-6989586621679681827"><span class="hs-identifier hs-var hs-var">isTxScriptValid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxScriptValidity era -&gt; Bool
forall era. TxScriptValidity era -&gt; Bool
</span><span class="hs-identifier hs-var">fromTxScriptValidity</span></span><span> </span><span class="annot"><span class="annottext">TxScriptValidity era
</span><a href="#local-6989586621679681848"><span class="hs-identifier hs-var">txScriptValidity</span></a></span><span>
</span><span id="line-42"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679681825"><span class="annot"><span class="annottext">Map DatumHash Datum
</span><a href="#local-6989586621679681825"><span class="hs-identifier hs-var">datums</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679681824"><span class="annot"><span class="annottext">Redeemers
</span><a href="#local-6989586621679681824"><span class="hs-identifier hs-var">redeemers</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxBody era -&gt; (Map DatumHash Datum, Redeemers)
forall era. TxBody era -&gt; (Map DatumHash Datum, Redeemers)
</span><span class="hs-identifier hs-var">scriptDataFromCardanoTxBody</span></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679681867"><span class="hs-identifier hs-var">txBody</span></a></span><span>
</span><span id="line-43"></span><span>        </span><span class="hs-comment">-- We need to sort the inputs as the order is important</span><span>
</span><span id="line-44"></span><span>        </span><span class="hs-comment">-- to find the corresponding redeemers</span><span>
</span><span id="line-45"></span><span>        </span><span id="local-6989586621679681822"><span class="annot"><span class="annottext">inputs :: [TxIn]
</span><a href="#local-6989586621679681822"><span class="hs-identifier hs-var hs-var">inputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TxIn] -&gt; [TxIn]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">sort</span></a></span><span> </span><span class="annot"><span class="annottext">([TxIn] -&gt; [TxIn]) -&gt; [TxIn] -&gt; [TxIn]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-46"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679681827"><span class="hs-identifier hs-var">isTxScriptValid</span></a></span><span>
</span><span id="line-47"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(TxIn, BuildTxWith ViewTx (Witness WitCtxTxIn era)) -&gt; TxIn
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((TxIn, BuildTxWith ViewTx (Witness WitCtxTxIn era)) -&gt; TxIn)
-&gt; TxIns ViewTx era -&gt; [TxIn]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TxIns ViewTx era
</span><a href="#local-6989586621679681864"><span class="hs-identifier hs-var">txIns</span></a></span><span>
</span><span id="line-48"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxInsCollateral era
</span><a href="#local-6989586621679681863"><span class="hs-identifier hs-var">txInsCollateral</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-49"></span><span>                   </span><span class="annot"><span class="annottext">TxInsCollateral era
</span><span class="hs-identifier hs-var">C.TxInsCollateralNone</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-50"></span><span>                   </span><span class="annot"><span class="hs-identifier hs-type">C.TxInsCollateral</span></span><span> </span><span class="annot"><span class="annottext">CollateralSupportedInEra era
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679681818"><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621679681818"><span class="hs-identifier hs-var">txins</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621679681818"><span class="hs-identifier hs-var">txins</span></a></span><span>
</span><span id="line-51"></span><span>        </span><span id="local-6989586621679681817"><span class="annot"><span class="annottext">collateralOut :: Maybe ChainIndexTxOut
</span><a href="#local-6989586621679681817"><span class="hs-identifier hs-var hs-var">collateralOut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxReturnCollateral CtxTx era
</span><a href="#local-6989586621679681859"><span class="hs-identifier hs-var">txReturnCollateral</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-52"></span><span>          </span><span class="annot"><span class="annottext">TxReturnCollateral CtxTx era
</span><span class="hs-identifier hs-var">C.TxReturnCollateralNone</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ChainIndexTxOut
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-53"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">C.TxReturnCollateral</span></span><span> </span><span class="annot"><span class="annottext">TxTotalAndReturnCollateralSupportedInEra era
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679681814"><span class="annot"><span class="annottext">TxOut CtxTx era
</span><a href="#local-6989586621679681814"><span class="hs-identifier hs-var">txOut</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ChainIndexTxOut -&gt; Maybe ChainIndexTxOut
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexTxOut -&gt; Maybe ChainIndexTxOut)
-&gt; ChainIndexTxOut -&gt; Maybe ChainIndexTxOut
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut CtxTx era -&gt; ChainIndexTxOut
forall era. IsCardanoEra era =&gt; TxOut CtxTx era -&gt; ChainIndexTxOut
</span><a href="Plutus.Contract.CardanoAPI.html#fromCardanoTxOut"><span class="hs-identifier hs-var">fromCardanoTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut CtxTx era
</span><a href="#local-6989586621679681814"><span class="hs-identifier hs-var">txOut</span></a></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ChainIndexTx :: TxId
-&gt; [TxOutRef]
-&gt; ChainIndexTxOutputs
-&gt; SlotRange
-&gt; Map DatumHash Datum
-&gt; Redeemers
-&gt; Map ScriptHash (Versioned Script)
-&gt; Maybe CardanoTx
-&gt; ChainIndexTx
</span><a href="Plutus.ChainIndex.Types.html#ChainIndexTx"><span class="hs-identifier hs-type">ChainIndexTx</span></a></span><span>
</span><span id="line-56"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_citxTxId :: TxId
</span><a href="Plutus.ChainIndex.Types.html#_citxTxId"><span class="hs-identifier hs-var">_citxTxId</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxId -&gt; TxId
</span><span class="hs-identifier hs-var">fromCardanoTxId</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxBody era -&gt; TxId
forall era. TxBody era -&gt; TxId
</span><span class="hs-identifier hs-var">C.getTxId</span></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679681867"><span class="hs-identifier hs-var">txBody</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_citxValidRange :: SlotRange
</span><a href="Plutus.ChainIndex.Types.html#_citxValidRange"><span class="hs-identifier hs-var">_citxValidRange</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TxValidityLowerBound era, TxValidityUpperBound era) -&gt; SlotRange
forall era.
(TxValidityLowerBound era, TxValidityUpperBound era) -&gt; SlotRange
</span><span class="hs-identifier hs-var">fromCardanoValidityRange</span></span><span> </span><span class="annot"><span class="annottext">(TxValidityLowerBound era, TxValidityUpperBound era)
</span><a href="#local-6989586621679681857"><span class="hs-identifier hs-var">txValidityRange</span></a></span><span>
</span><span id="line-58"></span><span>            </span><span class="hs-comment">-- If the transaction is invalid, we use collateral inputs</span><span>
</span><span id="line-59"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_citxInputs :: [TxOutRef]
</span><a href="Plutus.ChainIndex.Types.html#_citxInputs"><span class="hs-identifier hs-var">_citxInputs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TxIn -&gt; TxOutRef) -&gt; [TxIn] -&gt; [TxOutRef]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">TxIn -&gt; TxOutRef
</span><span class="hs-identifier hs-var">fromCardanoTxIn</span></span><span> </span><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621679681822"><span class="hs-identifier hs-var">inputs</span></a></span><span>
</span><span id="line-60"></span><span>            </span><span class="hs-comment">-- No outputs if the one of scripts failed</span><span>
</span><span id="line-61"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_citxOutputs :: ChainIndexTxOutputs
</span><a href="Plutus.ChainIndex.Types.html#_citxOutputs"><span class="hs-identifier hs-var">_citxOutputs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679681827"><span class="hs-identifier hs-var">isTxScriptValid</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[ChainIndexTxOut] -&gt; ChainIndexTxOutputs
</span><a href="Plutus.ChainIndex.Types.html#ValidTx"><span class="hs-identifier hs-var">ValidTx</span></a></span><span> </span><span class="annot"><span class="annottext">[ChainIndexTxOut]
</span><a href="#local-6989586621679681830"><span class="hs-identifier hs-var">txOutputs</span></a></span><span>
</span><span id="line-62"></span><span>                                                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe ChainIndexTxOut -&gt; ChainIndexTxOutputs
</span><a href="Plutus.ChainIndex.Types.html#InvalidTx"><span class="hs-identifier hs-var">InvalidTx</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ChainIndexTxOut
</span><a href="#local-6989586621679681817"><span class="hs-identifier hs-var">collateralOut</span></a></span><span>
</span><span id="line-63"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_citxData :: Map DatumHash Datum
</span><a href="Plutus.ChainIndex.Types.html#_citxData"><span class="hs-identifier hs-var">_citxData</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map DatumHash Datum
</span><a href="#local-6989586621679681825"><span class="hs-identifier hs-var">datums</span></a></span><span>
</span><span id="line-64"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_citxRedeemers :: Redeemers
</span><a href="Plutus.ChainIndex.Types.html#_citxRedeemers"><span class="hs-identifier hs-var">_citxRedeemers</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Redeemers
</span><a href="#local-6989586621679681824"><span class="hs-identifier hs-var">redeemers</span></a></span><span>
</span><span id="line-65"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_citxScripts :: Map ScriptHash (Versioned Script)
</span><a href="Plutus.ChainIndex.Types.html#_citxScripts"><span class="hs-identifier hs-var">_citxScripts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map ScriptHash (Versioned Script)
</span><a href="#local-6989586621679681829"><span class="hs-identifier hs-var">scriptMap</span></a></span><span>
</span><span id="line-66"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_citxCardanoTx :: Maybe CardanoTx
</span><a href="Plutus.ChainIndex.Types.html#_citxCardanoTx"><span class="hs-identifier hs-var">_citxCardanoTx</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CardanoTx -&gt; Maybe CardanoTx
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(CardanoTx -&gt; Maybe CardanoTx) -&gt; CardanoTx -&gt; Maybe CardanoTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Tx era -&gt; EraInMode era CardanoMode -&gt; CardanoTx
forall era.
IsCardanoEra era =&gt;
Tx era -&gt; EraInMode era CardanoMode -&gt; CardanoTx
</span><span class="hs-identifier hs-var">CardanoTx</span></span><span> </span><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621679681869"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">EraInMode era CardanoMode
</span><a href="#local-6989586621679681870"><span class="hs-identifier hs-var">eraInMode</span></a></span><span>
</span><span id="line-67"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span id="local-6989586621679681957"><span class="annot"><a href="Plutus.Contract.CardanoAPI.html#fromCardanoTxOut"><span class="hs-identifier hs-type">fromCardanoTxOut</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.IsCardanoEra</span></span><span> </span><span class="annot"><a href="#local-6989586621679681957"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.TxOut</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.CtxTx</span></span><span> </span><span class="annot"><a href="#local-6989586621679681957"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#ChainIndexTxOut"><span class="hs-identifier hs-type">ChainIndexTxOut</span></a></span></span><span>
</span><span id="line-70"></span><span id="fromCardanoTxOut"><span class="annot"><span class="annottext">fromCardanoTxOut :: TxOut CtxTx era -&gt; ChainIndexTxOut
</span><a href="Plutus.Contract.CardanoAPI.html#fromCardanoTxOut"><span class="hs-identifier hs-var hs-var">fromCardanoTxOut</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.TxOut</span></span><span> </span><span id="local-6989586621679681796"><span class="annot"><span class="annottext">AddressInEra era
</span><a href="#local-6989586621679681796"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621679681795"><span class="annot"><span class="annottext">TxOutValue era
</span><a href="#local-6989586621679681795"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621679681794"><span class="annot"><span class="annottext">TxOutDatum CtxTx era
</span><a href="#local-6989586621679681794"><span class="hs-identifier hs-var">datum</span></a></span></span><span> </span><span id="local-6989586621679681793"><span class="annot"><span class="annottext">ReferenceScript era
</span><a href="#local-6989586621679681793"><span class="hs-identifier hs-var">refScript</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><span class="annottext">CardanoAddress
-&gt; Value -&gt; OutputDatum -&gt; ReferenceScript -&gt; ChainIndexTxOut
</span><a href="Plutus.ChainIndex.Types.html#ChainIndexTxOut"><span class="hs-identifier hs-var">ChainIndexTxOut</span></a></span><span>
</span><span id="line-72"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardanoAddress
-&gt; Either EraCastError CardanoAddress -&gt; CardanoAddress
forall b a. b -&gt; Either a b -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; CardanoAddress
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;BabbageEra should be the latest era&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either EraCastError CardanoAddress -&gt; CardanoAddress)
-&gt; Either EraCastError CardanoAddress -&gt; CardanoAddress
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoEra BabbageEra
-&gt; AddressInEra era -&gt; Either EraCastError CardanoAddress
forall (f :: * -&gt; *) fromEra toEra.
(EraCast f, IsCardanoEra fromEra, IsCardanoEra toEra) =&gt;
CardanoEra toEra -&gt; f fromEra -&gt; Either EraCastError (f toEra)
</span><span class="hs-identifier hs-var">C.eraCast</span></span><span> </span><span class="annot"><span class="annottext">CardanoEra BabbageEra
</span><span class="hs-identifier hs-var">C.BabbageEra</span></span><span> </span><span class="annot"><span class="annottext">AddressInEra era
</span><a href="#local-6989586621679681796"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOutValue era -&gt; Value
forall era. TxOutValue era -&gt; Value
</span><span class="hs-identifier hs-var">C.txOutValueToValue</span></span><span> </span><span class="annot"><span class="annottext">TxOutValue era
</span><a href="#local-6989586621679681795"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOutDatum CtxTx era -&gt; OutputDatum
forall era. TxOutDatum CtxTx era -&gt; OutputDatum
</span><span class="hs-identifier hs-var">fromCardanoTxOutDatum</span></span><span> </span><span class="annot"><span class="annottext">TxOutDatum CtxTx era
</span><a href="#local-6989586621679681794"><span class="hs-identifier hs-var">datum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReferenceScript era -&gt; ReferenceScript
forall era. ReferenceScript era -&gt; ReferenceScript
</span><a href="Plutus.Contract.CardanoAPI.html#fromCardanoTxOutRefScript"><span class="hs-identifier hs-var">fromCardanoTxOutRefScript</span></a></span><span> </span><span class="annot"><span class="annottext">ReferenceScript era
</span><a href="#local-6989586621679681793"><span class="hs-identifier hs-var">refScript</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span id="local-6989586621679681786"><span class="annot"><a href="Plutus.Contract.CardanoAPI.html#setValidity"><span class="hs-identifier hs-type">setValidity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Tx</span></span><span> </span><span class="annot"><a href="#local-6989586621679681786"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Tx</span></span><span> </span><span class="annot"><a href="#local-6989586621679681786"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-78"></span><span id="setValidity"><span class="annot"><span class="annottext">setValidity :: Bool -&gt; Tx era -&gt; Tx era
</span><a href="Plutus.Contract.CardanoAPI.html#setValidity"><span class="hs-identifier hs-var hs-var">setValidity</span></a></span></span><span> </span><span id="local-6989586621679681785"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679681785"><span class="hs-identifier hs-var">validity</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.Tx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.ShelleyTxBody</span></span><span> </span><span id="local-6989586621679681783"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679681783"><span class="hs-identifier hs-var">shelleyBasedEra</span></a></span></span><span> </span><span id="local-6989586621679681782"><span class="annot"><span class="annottext">TxBody (ShelleyLedgerEra era)
</span><a href="#local-6989586621679681782"><span class="hs-identifier hs-var">txBody</span></a></span></span><span> </span><span id="local-6989586621679681781"><span class="annot"><span class="annottext">[Script (ShelleyLedgerEra era)]
</span><a href="#local-6989586621679681781"><span class="hs-identifier hs-var">scripts</span></a></span></span><span> </span><span id="local-6989586621679681780"><span class="annot"><span class="annottext">TxBodyScriptData era
</span><a href="#local-6989586621679681780"><span class="hs-identifier hs-var">dat</span></a></span></span><span> </span><span id="local-6989586621679681779"><span class="annot"><span class="annottext">Maybe (AuxiliaryData (ShelleyLedgerEra era))
</span><a href="#local-6989586621679681779"><span class="hs-identifier hs-var">aux</span></a></span></span><span> </span><span class="annot"><span class="annottext">TxScriptValidity era
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679681778"><span class="annot"><span class="annottext">[KeyWitness era]
</span><a href="#local-6989586621679681778"><span class="hs-identifier hs-var">era</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><span class="annottext">TxBody era -&gt; [KeyWitness era] -&gt; Tx era
forall era. TxBody era -&gt; [KeyWitness era] -&gt; Tx era
</span><span class="hs-identifier hs-var">C.Tx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShelleyBasedEra era
-&gt; TxBody (ShelleyLedgerEra era)
-&gt; [Script (ShelleyLedgerEra era)]
-&gt; TxBodyScriptData era
-&gt; Maybe (AuxiliaryData (ShelleyLedgerEra era))
-&gt; TxScriptValidity era
-&gt; TxBody era
forall era.
ShelleyBasedEra era
-&gt; TxBody (ShelleyLedgerEra era)
-&gt; [Script (ShelleyLedgerEra era)]
-&gt; TxBodyScriptData era
-&gt; Maybe (AuxiliaryData (ShelleyLedgerEra era))
-&gt; TxScriptValidity era
-&gt; TxBody era
</span><span class="hs-identifier hs-var">C.ShelleyTxBody</span></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679681783"><span class="hs-identifier hs-var">shelleyBasedEra</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody (ShelleyLedgerEra era)
</span><a href="#local-6989586621679681782"><span class="hs-identifier hs-var">txBody</span></a></span><span> </span><span class="annot"><span class="annottext">[Script (ShelleyLedgerEra era)]
</span><a href="#local-6989586621679681781"><span class="hs-identifier hs-var">scripts</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyScriptData era
</span><a href="#local-6989586621679681780"><span class="hs-identifier hs-var">dat</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (AuxiliaryData (ShelleyLedgerEra era))
</span><a href="#local-6989586621679681779"><span class="hs-identifier hs-var">aux</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShelleyBasedEra era -&gt; Bool -&gt; TxScriptValidity era
forall era. ShelleyBasedEra era -&gt; Bool -&gt; TxScriptValidity era
</span><span class="hs-identifier hs-var">toTxScriptValidity</span></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679681783"><span class="hs-identifier hs-var">shelleyBasedEra</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679681785"><span class="hs-identifier hs-var">validity</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[KeyWitness era]
</span><a href="#local-6989586621679681778"><span class="hs-identifier hs-var">era</span></a></span><span>
</span><span id="line-80"></span><span class="annot"><a href="Plutus.Contract.CardanoAPI.html#setValidity"><span class="hs-identifier hs-var">setValidity</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679681776"><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621679681776"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621679681776"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="hs-comment">-- @setValidity@ only applies in Alonzo era (and newer)</span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span id="local-6989586621679681896"><span class="annot"><a href="Plutus.Contract.CardanoAPI.html#fromCardanoTxOutRefScript"><span class="hs-identifier hs-type">fromCardanoTxOutRefScript</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.ReferenceScript</span></span><span> </span><span class="annot"><a href="#local-6989586621679681896"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#ReferenceScript"><span class="hs-identifier hs-type">ReferenceScript</span></a></span></span><span>
</span><span id="line-83"></span><span id="fromCardanoTxOutRefScript"><span class="annot"><span class="annottext">fromCardanoTxOutRefScript :: ReferenceScript era -&gt; ReferenceScript
</span><a href="Plutus.Contract.CardanoAPI.html#fromCardanoTxOutRefScript"><span class="hs-identifier hs-var hs-var">fromCardanoTxOutRefScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-84"></span><span>    </span><span class="annot"><span class="annottext">ReferenceScript era
</span><span class="hs-identifier hs-var">C.ReferenceScriptNone</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ReferenceScript
</span><a href="Plutus.ChainIndex.Types.html#ReferenceScriptNone"><span class="hs-identifier hs-var">ReferenceScriptNone</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">C.ReferenceScript</span></span><span> </span><span class="annot"><span class="annottext">ReferenceTxInsScriptsInlineDatumsSupportedInEra era
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679681772"><span class="annot"><span class="annottext">ScriptInAnyLang
</span><a href="#local-6989586621679681772"><span class="hs-identifier hs-var">script</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ScriptInAnyLang -&gt; ReferenceScript
</span><a href="Plutus.ChainIndex.Types.html#ReferenceScriptInAnyLang"><span class="hs-identifier hs-var">ReferenceScriptInAnyLang</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptInAnyLang
</span><a href="#local-6989586621679681772"><span class="hs-identifier hs-var">script</span></a></span><span>
</span><span id="line-86"></span></pre></body></html>