<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleInstances  #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE GADTs              #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE NumericUnderscores #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings  #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-unused-matches -Wno-name-shadowing #-}</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- | The threat modelling framework allows you to write down and test properties of modifications of</span><span>
</span><span id="line-7"></span><span class="hs-comment">--   valid transactions.</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">--   A threat model is represented by a value in the `ThreatModel` monad, and is evaluated in the</span><span>
</span><span id="line-10"></span><span class="hs-comment">--   context of a single valid transaction and the chain state at the point it validated (a</span><span>
</span><span id="line-11"></span><span class="hs-comment">--   `ThreatModelEnv`). Transactions and chain states can most easily be obtained using a</span><span>
</span><span id="line-12"></span><span class="hs-comment">--   `ContractModelResult` from `runContractModel`, but they can in principle come from anywhere.</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">--   As an example, here is a `ThreatModel` that checks that any interaction with @myScript@</span><span>
</span><span id="line-15"></span><span class="hs-comment">--   requires @theToken@ to be present:</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-18"></span><span class="hs-comment">--     tokenThreatModel :: 'ThreatModel' ()</span><span>
</span><span id="line-19"></span><span class="hs-comment">--     tokenThreatModel = do</span><span>
</span><span id="line-20"></span><span class="hs-comment">--       'ensureHasInputAt' myScript</span><span>
</span><span id="line-21"></span><span class="hs-comment">--</span><span>
</span><span id="line-22"></span><span class="hs-comment">--       let hasToken out = theToken ``leqValue`` 'valueOf' out</span><span>
</span><span id="line-23"></span><span class="hs-comment">--       i &lt;- 'anyInputSuchThat'  hasToken</span><span>
</span><span id="line-24"></span><span class="hs-comment">--       o &lt;- 'anyOutputSuchThat' hasToken</span><span>
</span><span id="line-25"></span><span class="hs-comment">--</span><span>
</span><span id="line-26"></span><span class="hs-comment">--       'shouldNotValidate' $ 'changeValueOf' i ('valueOf' i &lt;&gt; negateValue theToken)</span><span>
</span><span id="line-27"></span><span class="hs-comment">--                        &lt;&gt; 'changeValueOf' o ('valueOf' o &lt;&gt; negateValue theToken)</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-29"></span><span class="hs-comment">--</span><span>
</span><span id="line-30"></span><span class="hs-comment">--   For a more complex example see &quot;Test.QuickCheck.ContractModel.ThreatModel.DoubleSatisfaction&quot;.</span><span>
</span><span id="line-31"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Test.QuickCheck.ContractModel.ThreatModel</span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Transaction modifiers</span></span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Types</span></span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#TxModifier"><span class="hs-identifier">TxModifier</span></a></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#Input"><span class="hs-identifier">Input</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#Output"><span class="hs-identifier">Output</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#Datum"><span class="hs-identifier">Datum</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#Redeemer"><span class="hs-identifier">Redeemer</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Modifiers</span></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#IsInputOrOutput"><span class="hs-identifier">IsInputOrOutput</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#addOutput"><span class="hs-identifier">addOutput</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#removeOutput"><span class="hs-identifier">removeOutput</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#addKeyInput"><span class="hs-identifier">addKeyInput</span></a></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#addPlutusScriptInput"><span class="hs-identifier">addPlutusScriptInput</span></a></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#addSimpleScriptInput"><span class="hs-identifier">addSimpleScriptInput</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#removeInput"><span class="hs-identifier">removeInput</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#changeRedeemerOf"><span class="hs-identifier">changeRedeemerOf</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#changeValidityRange"><span class="hs-identifier">changeValidityRange</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#changeValidityLowerBound"><span class="hs-identifier">changeValidityLowerBound</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#changeValidityUpperBound"><span class="hs-identifier">changeValidityUpperBound</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#replaceTx"><span class="hs-identifier">replaceTx</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Threat models</span></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier">ThreatModel</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModelEnv"><span class="hs-identifier">ThreatModelEnv</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#runThreatModel"><span class="hs-identifier">runThreatModel</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#assertThreatModel"><span class="hs-identifier">assertThreatModel</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Preconditions</span></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#threatPrecondition"><span class="hs-identifier">threatPrecondition</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#inPrecondition"><span class="hs-identifier">inPrecondition</span></a></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ensure"><span class="hs-identifier">ensure</span></a></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ensureHasInputAt"><span class="hs-identifier">ensureHasInputAt</span></a></span><span>
</span><span id="line-62"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Validation</span></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#shouldValidate"><span class="hs-identifier">shouldValidate</span></a></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#shouldNotValidate"><span class="hs-identifier">shouldNotValidate</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#ValidityReport"><span class="hs-identifier">ValidityReport</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#validate"><span class="hs-identifier">validate</span></a></span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Querying the environment</span></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#getThreatModelEnv"><span class="hs-identifier">getThreatModelEnv</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#originalTx"><span class="hs-identifier">originalTx</span></a></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#getTxInputs"><span class="hs-identifier">getTxInputs</span></a></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#getTxOutputs"><span class="hs-identifier">getTxOutputs</span></a></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#getRedeemer"><span class="hs-identifier">getRedeemer</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Random generation</span></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#forAllTM"><span class="hs-identifier">forAllTM</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#pickAny"><span class="hs-identifier">pickAny</span></a></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#anySigner"><span class="hs-identifier">anySigner</span></a></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#anyInputSuchThat"><span class="hs-identifier">anyInputSuchThat</span></a></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#anyOutputSuchThat"><span class="hs-identifier">anyOutputSuchThat</span></a></span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Monitoring</span></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#counterexampleTM"><span class="hs-identifier">counterexampleTM</span></a></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#tabulateTM"><span class="hs-identifier">tabulateTM</span></a></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#collectTM"><span class="hs-identifier">collectTM</span></a></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#classifyTM"><span class="hs-identifier">classifyTM</span></a></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#monitorThreatModel"><span class="hs-identifier">monitorThreatModel</span></a></span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#monitorLocalThreatModel"><span class="hs-identifier">monitorLocalThreatModel</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Cardano API helpers</span></span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-comment">-- $cardanoHelpers</span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-comment">-- ** Value</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#projectAda"><span class="hs-identifier">projectAda</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#leqValue"><span class="hs-identifier">leqValue</span></a></span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Addresses</span></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#keyAddressAny"><span class="hs-identifier">keyAddressAny</span></a></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#scriptAddressAny"><span class="hs-identifier">scriptAddressAny</span></a></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#isKeyAddressAny"><span class="hs-identifier">isKeyAddressAny</span></a></span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Datums</span></span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#txOutDatum"><span class="hs-identifier">txOutDatum</span></a></span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#toScriptData"><span class="hs-identifier">toScriptData</span></a></span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#datumOfTxOut"><span class="hs-identifier">datumOfTxOut</span></a></span><span>
</span><span id="line-99"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Pretty printing</span></span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><span class="hs-comment">-- $prettyPrinting</span></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Pretty.html#paragraph"><span class="hs-identifier">paragraph</span></a></span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Pretty.html#prettyAddress"><span class="hs-identifier">prettyAddress</span></a></span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Pretty.html#prettyValue"><span class="hs-identifier">prettyValue</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Pretty.html#prettyDatum"><span class="hs-identifier">prettyDatum</span></a></span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Pretty.html#prettyInput"><span class="hs-identifier">prettyInput</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Pretty.html#prettyOutput"><span class="hs-identifier">prettyOutput</span></a></span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Api</span></span><span>
</span><span id="line-110"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Api.Shelley</span></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.html"><span class="hs-identifier">Test.QuickCheck.ContractModel.Internal</span></a></span><span>
</span><span id="line-117"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.ChainIndex.html"><span class="hs-identifier">Test.QuickCheck.ContractModel.Internal.ChainIndex</span></a></span><span>
</span><span id="line-118"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html"><span class="hs-identifier">Test.QuickCheck.ContractModel.Internal.Common</span></a></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.QuickCheck</span></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/pretty-1.1.3.6/src"><span class="hs-identifier">Text.PrettyPrint</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/pretty-1.1.3.6/src"><span class="hs-operator">(&lt;&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Text.Printf</span></a></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html"><span class="hs-identifier">Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api</span></a></span><span>
</span><span id="line-126"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Pretty.html"><span class="hs-identifier">Test.QuickCheck.ContractModel.ThreatModel.Pretty</span></a></span><span>
</span><span id="line-127"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html"><span class="hs-identifier">Test.QuickCheck.ContractModel.ThreatModel.TxModifier</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">-- $cardanoHelpers</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- Some convenience functions making it easier to work with Cardano API.</span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="hs-comment">-- $prettyPrinting</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- The framework already prints the original transaction and the results of validating modified</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- transactions in counterexamples. To include more information you can use `counterexampleTM` with</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- the functions below.</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">-- | The context in which a `ThreatModel` is executed. Contains a transaction, its UTxO set and the</span><span>
</span><span id="line-138"></span><span class="hs-comment">--   protocol parameters. See `getThreatModelEnv` and `originalTx` to access this information in a</span><span>
</span><span id="line-139"></span><span class="hs-comment">--   threat model.</span><span>
</span><span id="line-140"></span><span class="hs-keyword">data</span><span> </span><span id="ThreatModelEnv"><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModelEnv"><span class="hs-identifier hs-var">ThreatModelEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ThreatModelEnv"><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModelEnv"><span class="hs-identifier hs-var">ThreatModelEnv</span></a></span></span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="currentTx"><span class="annot"><span class="annottext">ThreatModelEnv -&gt; Tx Era
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#currentTx"><span class="hs-identifier hs-var hs-var">currentTx</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="currentUTxOs"><span class="annot"><span class="annottext">ThreatModelEnv -&gt; UTxO Era
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#currentUTxOs"><span class="hs-identifier hs-var hs-var">currentUTxOs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="pparams"><span class="annot"><span class="annottext">ThreatModelEnv -&gt; ProtocolParameters
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#pparams"><span class="hs-identifier hs-var hs-var">pparams</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ProtocolParameters</span></span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679451450"><span id="local-6989586621679451452"><span id="local-6989586621679451454"><span class="annot"><span class="annottext">Int -&gt; ThreatModelEnv -&gt; ShowS
[ThreatModelEnv] -&gt; ShowS
ThreatModelEnv -&gt; String
(Int -&gt; ThreatModelEnv -&gt; ShowS)
-&gt; (ThreatModelEnv -&gt; String)
-&gt; ([ThreatModelEnv] -&gt; ShowS)
-&gt; Show ThreatModelEnv
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ThreatModelEnv] -&gt; ShowS
$cshowList :: [ThreatModelEnv] -&gt; ShowS
show :: ThreatModelEnv -&gt; String
$cshow :: ThreatModelEnv -&gt; String
showsPrec :: Int -&gt; ThreatModelEnv -&gt; ShowS
$cshowsPrec :: Int -&gt; ThreatModelEnv -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">-- | The threat model monad is how you construct threat models. It works in the context of a given</span><span>
</span><span id="line-147"></span><span class="hs-comment">--   transaction and the UTxO set at the point where the transaction was validated (see</span><span>
</span><span id="line-148"></span><span class="hs-comment">--   `ThreatModelEnv`) and lets you construct properties about the validatity of modifications of</span><span>
</span><span id="line-149"></span><span class="hs-comment">--   the original transaction.</span><span>
</span><span id="line-150"></span><span class="hs-keyword">data</span><span> </span><span id="ThreatModel"><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-var">ThreatModel</span></a></span></span><span> </span><span id="local-6989586621679451448"><span class="annot"><a href="#local-6989586621679451448"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-151"></span><span>  </span><span id="local-6989586621679451611"><span id="Validate"><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Validate"><span class="hs-identifier hs-var">Validate</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#TxModifier"><span class="hs-identifier hs-type">TxModifier</span></a></span><span>
</span><span id="line-152"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#ValidityReport"><span class="hs-identifier hs-type">ValidityReport</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451611"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451611"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span>  </span><span id="local-6989586621679451446"><span id="local-6989586621679451600"><span id="Generate"><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Generate"><span class="hs-identifier hs-var">Generate</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451446"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-156"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><a href="#local-6989586621679451446"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-157"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679451446"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679451446"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679451446"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451600"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451600"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span>  </span><span id="local-6989586621679451599"><span id="GetCtx"><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#GetCtx"><span class="hs-identifier hs-var">GetCtx</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModelEnv"><span class="hs-identifier hs-type">ThreatModelEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451599"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451599"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span>  </span><span id="local-6989586621679451606"><span id="Skip"><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Skip"><span class="hs-identifier hs-var">Skip</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451606"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span>  </span><span id="local-6989586621679451605"><span id="InPrecondition"><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#InPrecondition"><span class="hs-identifier hs-var">InPrecondition</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451605"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451605"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span>  </span><span id="local-6989586621679451604"><span id="Fail"><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-169"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451604"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span>  </span><span id="local-6989586621679451597"><span id="Monitor"><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Monitor"><span class="hs-identifier hs-var">Monitor</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451597"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-173"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451597"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span>  </span><span id="local-6989586621679451439"><span id="MonitorLocal"><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#MonitorLocal"><span class="hs-identifier hs-var">MonitorLocal</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451439"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-178"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451439"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span>  </span><span id="local-6989586621679451437"><span id="Done"><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Done"><span class="hs-identifier hs-var">Done</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679451437"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-181"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451437"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679451433"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-184"></span><span>  </span><span id="local-6989586621679451431"><span class="annot"><span class="annottext">fmap :: (a -&gt; b) -&gt; ThreatModel a -&gt; ThreatModel b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; ThreatModel a -&gt; ThreatModel b
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftM</span></a></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679451421"><span id="local-6989586621679451423"><span id="local-6989586621679451425"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Applicative</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-187"></span><span>  </span><span id="local-6989586621679451419"><span class="annot"><span class="annottext">pure :: a -&gt; ThreatModel a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">pure</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; ThreatModel a
forall a. a -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Done"><span class="hs-identifier hs-var">Done</span></a></span><span>
</span><span id="line-188"></span><span>  </span><span id="local-6989586621679451418"><span class="annot"><span class="annottext">&lt;*&gt; :: ThreatModel (a -&gt; b) -&gt; ThreatModel a -&gt; ThreatModel b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;*&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ThreatModel (a -&gt; b) -&gt; ThreatModel a -&gt; ThreatModel b
forall (m :: * -&gt; *) a b. Monad m =&gt; m (a -&gt; b) -&gt; m a -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">ap</span></a></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679451411"><span id="local-6989586621679451413"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-191"></span><span>  </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Validate"><span class="hs-identifier hs-type">Validate</span></a></span><span> </span><span id="local-6989586621679451409"><span class="annot"><span class="annottext">TxModifier
</span><a href="#local-6989586621679451409"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span id="local-6989586621679451408"><span class="annot"><span class="annottext">ValidityReport -&gt; ThreatModel a
</span><a href="#local-6989586621679451408"><span class="hs-identifier hs-var">cont</span></a></span></span><span>      </span><span id="local-6989586621679451407"><span class="annot"><span class="annottext">&gt;&gt;= :: ThreatModel a -&gt; (a -&gt; ThreatModel b) -&gt; ThreatModel b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">&gt;&gt;=</span></a></span></span><span> </span><span id="local-6989586621679451406"><span class="annot"><span class="annottext">a -&gt; ThreatModel b
</span><a href="#local-6989586621679451406"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxModifier -&gt; (ValidityReport -&gt; ThreatModel b) -&gt; ThreatModel b
forall a.
TxModifier -&gt; (ValidityReport -&gt; ThreatModel a) -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Validate"><span class="hs-identifier hs-var">Validate</span></a></span><span> </span><span class="annot"><span class="annottext">TxModifier
</span><a href="#local-6989586621679451409"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ValidityReport -&gt; ThreatModel a
</span><a href="#local-6989586621679451408"><span class="hs-identifier hs-var">cont</span></a></span><span> </span><span class="annot"><span class="annottext">(ValidityReport -&gt; ThreatModel a)
-&gt; (a -&gt; ThreatModel b) -&gt; ValidityReport -&gt; ThreatModel b
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; ThreatModel b
</span><a href="#local-6989586621679451406"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>  </span><span class="annot"><span class="annottext">ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Skip"><span class="hs-identifier hs-var">Skip</span></a></span><span>                  </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; ThreatModel b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ThreatModel b
forall a. ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Skip"><span class="hs-identifier hs-var">Skip</span></a></span><span>
</span><span id="line-193"></span><span>  </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#InPrecondition"><span class="hs-identifier hs-type">InPrecondition</span></a></span><span> </span><span id="local-6989586621679451404"><span class="annot"><span class="annottext">Bool -&gt; ThreatModel a
</span><a href="#local-6989586621679451404"><span class="hs-identifier hs-var">cont</span></a></span></span><span>   </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span id="local-6989586621679451403"><span class="annot"><span class="annottext">a -&gt; ThreatModel b
</span><a href="#local-6989586621679451403"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; ThreatModel b) -&gt; ThreatModel b
forall a. (Bool -&gt; ThreatModel a) -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#InPrecondition"><span class="hs-identifier hs-var">InPrecondition</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; ThreatModel a
</span><a href="#local-6989586621679451404"><span class="hs-identifier hs-var">cont</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; ThreatModel a)
-&gt; (a -&gt; ThreatModel b) -&gt; Bool -&gt; ThreatModel b
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; ThreatModel b
</span><a href="#local-6989586621679451403"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>  </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Fail"><span class="hs-identifier hs-type">Fail</span></a></span><span> </span><span id="local-6989586621679451402"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679451402"><span class="hs-identifier hs-var">err</span></a></span></span><span>              </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; ThreatModel b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ThreatModel b
forall a. String -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679451402"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-195"></span><span>  </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Generate"><span class="hs-identifier hs-type">Generate</span></a></span><span> </span><span id="local-6989586621679451401"><span class="annot"><span class="annottext">Gen a
</span><a href="#local-6989586621679451401"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span id="local-6989586621679451400"><span class="annot"><span class="annottext">a -&gt; [a]
</span><a href="#local-6989586621679451400"><span class="hs-identifier hs-var">shr</span></a></span></span><span> </span><span id="local-6989586621679451399"><span class="annot"><span class="annottext">a -&gt; ThreatModel a
</span><a href="#local-6989586621679451399"><span class="hs-identifier hs-var">cont</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span id="local-6989586621679451398"><span class="annot"><span class="annottext">a -&gt; ThreatModel b
</span><a href="#local-6989586621679451398"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; ThreatModel b) -&gt; ThreatModel b
forall a b.
Show a =&gt;
Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; ThreatModel b) -&gt; ThreatModel b
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Generate"><span class="hs-identifier hs-var">Generate</span></a></span><span> </span><span class="annot"><span class="annottext">Gen a
</span><a href="#local-6989586621679451401"><span class="hs-identifier hs-var">gen</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a]
</span><a href="#local-6989586621679451400"><span class="hs-identifier hs-var">shr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; ThreatModel a
</span><a href="#local-6989586621679451399"><span class="hs-identifier hs-var">cont</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; ThreatModel a) -&gt; (a -&gt; ThreatModel b) -&gt; a -&gt; ThreatModel b
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; ThreatModel b
</span><a href="#local-6989586621679451398"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>  </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#GetCtx"><span class="hs-identifier hs-type">GetCtx</span></a></span><span> </span><span id="local-6989586621679451397"><span class="annot"><span class="annottext">ThreatModelEnv -&gt; ThreatModel a
</span><a href="#local-6989586621679451397"><span class="hs-identifier hs-var">cont</span></a></span></span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span id="local-6989586621679451396"><span class="annot"><span class="annottext">a -&gt; ThreatModel b
</span><a href="#local-6989586621679451396"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ThreatModelEnv -&gt; ThreatModel b) -&gt; ThreatModel b
forall a. (ThreatModelEnv -&gt; ThreatModel a) -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#GetCtx"><span class="hs-identifier hs-var">GetCtx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ThreatModelEnv -&gt; ThreatModel a
</span><a href="#local-6989586621679451397"><span class="hs-identifier hs-var">cont</span></a></span><span> </span><span class="annot"><span class="annottext">(ThreatModelEnv -&gt; ThreatModel a)
-&gt; (a -&gt; ThreatModel b) -&gt; ThreatModelEnv -&gt; ThreatModel b
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; ThreatModel b
</span><a href="#local-6989586621679451396"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>  </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Monitor"><span class="hs-identifier hs-type">Monitor</span></a></span><span> </span><span id="local-6989586621679451395"><span class="annot"><span class="annottext">Property -&gt; Property
</span><a href="#local-6989586621679451395"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679451394"><span class="annot"><span class="annottext">ThreatModel a
</span><a href="#local-6989586621679451394"><span class="hs-identifier hs-var">cont</span></a></span></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span id="local-6989586621679451393"><span class="annot"><span class="annottext">a -&gt; ThreatModel b
</span><a href="#local-6989586621679451393"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; ThreatModel b -&gt; ThreatModel b
forall a. (Property -&gt; Property) -&gt; ThreatModel a -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Monitor"><span class="hs-identifier hs-var">Monitor</span></a></span><span> </span><span class="annot"><span class="annottext">Property -&gt; Property
</span><a href="#local-6989586621679451395"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ThreatModel a
</span><a href="#local-6989586621679451394"><span class="hs-identifier hs-var">cont</span></a></span><span> </span><span class="annot"><span class="annottext">ThreatModel a -&gt; (a -&gt; ThreatModel b) -&gt; ThreatModel b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; ThreatModel b
</span><a href="#local-6989586621679451393"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>  </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#MonitorLocal"><span class="hs-identifier hs-type">MonitorLocal</span></a></span><span> </span><span id="local-6989586621679451392"><span class="annot"><span class="annottext">Property -&gt; Property
</span><a href="#local-6989586621679451392"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679451391"><span class="annot"><span class="annottext">ThreatModel a
</span><a href="#local-6989586621679451391"><span class="hs-identifier hs-var">cont</span></a></span></span><span>   </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span id="local-6989586621679451390"><span class="annot"><span class="annottext">a -&gt; ThreatModel b
</span><a href="#local-6989586621679451390"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; ThreatModel b -&gt; ThreatModel b
forall a. (Property -&gt; Property) -&gt; ThreatModel a -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#MonitorLocal"><span class="hs-identifier hs-var">MonitorLocal</span></a></span><span> </span><span class="annot"><span class="annottext">Property -&gt; Property
</span><a href="#local-6989586621679451392"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ThreatModel a
</span><a href="#local-6989586621679451391"><span class="hs-identifier hs-var">cont</span></a></span><span> </span><span class="annot"><span class="annottext">ThreatModel a -&gt; (a -&gt; ThreatModel b) -&gt; ThreatModel b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; ThreatModel b
</span><a href="#local-6989586621679451390"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>  </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Done"><span class="hs-identifier hs-type">Done</span></a></span><span> </span><span id="local-6989586621679451389"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679451389"><span class="hs-identifier hs-var">a</span></a></span></span><span>                </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span id="local-6989586621679451388"><span class="annot"><span class="annottext">a -&gt; ThreatModel b
</span><a href="#local-6989586621679451388"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; ThreatModel b
</span><a href="#local-6989586621679451388"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679451389"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadFail</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-202"></span><span>  </span><span id="local-6989586621679451384"><span class="annot"><span class="annottext">fail :: String -&gt; ThreatModel a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">fail</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ThreatModel a
forall a. String -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-comment">-- | Evaluate a `ThreatModel` on a list of transactions with their context. Fails the property if</span><span>
</span><span id="line-205"></span><span class="hs-comment">--   the threat model fails on any of the transactions.</span><span>
</span><span id="line-206"></span><span id="local-6989586621679451571"><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#runThreatModel"><span class="hs-identifier hs-type">runThreatModel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451571"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModelEnv"><span class="hs-identifier hs-type">ThreatModelEnv</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span></span><span>
</span><span id="line-207"></span><span id="runThreatModel"><span class="annot"><span class="annottext">runThreatModel :: ThreatModel a -&gt; [ThreatModelEnv] -&gt; Property
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#runThreatModel"><span class="hs-identifier hs-var hs-var">runThreatModel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ThreatModel a -&gt; [ThreatModelEnv] -&gt; Property
forall a. Bool -&gt; ThreatModel a -&gt; [ThreatModelEnv] -&gt; Property
</span><a href="#local-6989586621679451383"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679451383"><span class="annot"><span class="annottext">go :: Bool -&gt; ThreatModel a -&gt; [ThreatModelEnv] -&gt; Property
</span><a href="#local-6989586621679451383"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679451382"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679451382"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679451381"><span class="annot"><span class="annottext">ThreatModel a
</span><a href="#local-6989586621679451381"><span class="hs-identifier hs-var">model</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679451382"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Property -&gt; Property
forall prop. Testable prop =&gt; Bool -&gt; prop -&gt; Property
</span><span class="hs-operator hs-var">==&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">property</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-209"></span><span>        </span><span class="annot"><a href="#local-6989586621679451383"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679451378"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679451378"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679451377"><span class="annot"><span class="annottext">ThreatModel a
</span><a href="#local-6989586621679451377"><span class="hs-identifier hs-var">model</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679451376"><span class="annot"><span class="annottext">ThreatModelEnv
</span><a href="#local-6989586621679451376"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679451375"><span class="annot"><span class="annottext">[ThreatModelEnv]
</span><a href="#local-6989586621679451375"><span class="hs-identifier hs-var">envs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; ThreatModel a -&gt; Property
</span><a href="#local-6989586621679451374"><span class="hs-identifier hs-var">interp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Property -&gt; Property
forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Property -&gt; Property) -&gt; String -&gt; Property -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679451371"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ThreatModel a
</span><a href="#local-6989586621679451377"><span class="hs-identifier hs-var">model</span></a></span><span>
</span><span id="line-210"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-211"></span><span>            </span><span id="local-6989586621679451371"><span class="annot"><span class="annottext">info :: Doc
</span><a href="#local-6989586621679451371"><span class="hs-identifier hs-var hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-212"></span><span>              </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><a href="../../../../ghc/html/libraries/pretty-1.1.3.6/src"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-213"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; [Doc] -&gt; Doc
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Pretty.html#block"><span class="hs-identifier hs-var">block</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;Original UTxO set&quot;</span></span><span>
</span><span id="line-214"></span><span>                           </span><span class="hs-special">[</span><span class="annot"><span class="annottext">UTxO Era -&gt; Doc
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Pretty.html#prettyUTxO"><span class="hs-identifier hs-var">prettyUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">(UTxO Era -&gt; Doc) -&gt; UTxO Era -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Tx Era -&gt; UTxO Era -&gt; UTxO Era
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#restrictUTxO"><span class="hs-identifier hs-var">restrictUTxO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ThreatModelEnv -&gt; Tx Era
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#currentTx"><span class="hs-identifier hs-var hs-var">currentTx</span></a></span><span> </span><span class="annot"><span class="annottext">ThreatModelEnv
</span><a href="#local-6989586621679451376"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>                                       </span><span class="annot"><span class="annottext">(UTxO Era -&gt; UTxO Era) -&gt; UTxO Era -&gt; UTxO Era
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ThreatModelEnv -&gt; UTxO Era
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#currentUTxOs"><span class="hs-identifier hs-var hs-var">currentUTxOs</span></a></span><span> </span><span class="annot"><span class="annottext">ThreatModelEnv
</span><a href="#local-6989586621679451376"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-216"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-217"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; [Doc] -&gt; Doc
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Pretty.html#block"><span class="hs-identifier hs-var">block</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;Original transaction&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tx Era -&gt; Doc
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Pretty.html#prettyTx"><span class="hs-identifier hs-var">prettyTx</span></a></span><span> </span><span class="annot"><span class="annottext">(Tx Era -&gt; Doc) -&gt; Tx Era -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ThreatModelEnv -&gt; Tx Era
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#currentTx"><span class="hs-identifier hs-var hs-var">currentTx</span></a></span><span> </span><span class="annot"><span class="annottext">ThreatModelEnv
</span><a href="#local-6989586621679451376"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-218"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-219"></span><span>                   </span><span class="hs-special">]</span><span>
</span><span id="line-220"></span><span>            </span><span id="local-6989586621679451374"><span class="annot"><span class="annottext">interp :: (Property -&gt; Property) -&gt; ThreatModel a -&gt; Property
</span><a href="#local-6989586621679451374"><span class="hs-identifier hs-var hs-var">interp</span></a></span></span><span> </span><span id="local-6989586621679451365"><span class="annot"><span class="annottext">Property -&gt; Property
</span><a href="#local-6989586621679451365"><span class="hs-identifier hs-var">mon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">case</span><span>
</span><span id="line-221"></span><span>              </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Validate"><span class="hs-identifier hs-type">Validate</span></a></span><span> </span><span id="local-6989586621679451364"><span class="annot"><span class="annottext">TxModifier
</span><a href="#local-6989586621679451364"><span class="hs-identifier hs-var">mods</span></a></span></span><span> </span><span id="local-6989586621679451363"><span class="annot"><span class="annottext">ValidityReport -&gt; ThreatModel a
</span><a href="#local-6989586621679451363"><span class="hs-identifier hs-var">k</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; ThreatModel a -&gt; Property
</span><a href="#local-6989586621679451374"><span class="hs-identifier hs-var">interp</span></a></span><span> </span><span class="annot"><span class="annottext">Property -&gt; Property
</span><a href="#local-6989586621679451365"><span class="hs-identifier hs-var">mon</span></a></span><span>
</span><span id="line-222"></span><span>                                  </span><span class="annot"><span class="annottext">(ThreatModel a -&gt; Property) -&gt; ThreatModel a -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ValidityReport -&gt; ThreatModel a
</span><a href="#local-6989586621679451363"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-223"></span><span>                                  </span><span class="annot"><span class="annottext">(ValidityReport -&gt; ThreatModel a)
-&gt; ValidityReport -&gt; ThreatModel a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Tx Era -&gt; UTxO Era -&gt; ValidityReport)
-&gt; (Tx Era, UTxO Era) -&gt; ValidityReport
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProtocolParameters -&gt; Tx Era -&gt; UTxO Era -&gt; ValidityReport
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#validateTx"><span class="hs-identifier hs-var">validateTx</span></a></span><span> </span><span class="annot"><span class="annottext">(ProtocolParameters -&gt; Tx Era -&gt; UTxO Era -&gt; ValidityReport)
-&gt; ProtocolParameters -&gt; Tx Era -&gt; UTxO Era -&gt; ValidityReport
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ThreatModelEnv -&gt; ProtocolParameters
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#pparams"><span class="hs-identifier hs-var hs-var">pparams</span></a></span><span> </span><span class="annot"><span class="annottext">ThreatModelEnv
</span><a href="#local-6989586621679451376"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>                                  </span><span class="annot"><span class="annottext">((Tx Era, UTxO Era) -&gt; ValidityReport)
-&gt; (Tx Era, UTxO Era) -&gt; ValidityReport
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Tx Era -&gt; UTxO Era -&gt; TxModifier -&gt; (Tx Era, UTxO Era)
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#applyTxModifier"><span class="hs-identifier hs-var">applyTxModifier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ThreatModelEnv -&gt; Tx Era
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#currentTx"><span class="hs-identifier hs-var hs-var">currentTx</span></a></span><span> </span><span class="annot"><span class="annottext">ThreatModelEnv
</span><a href="#local-6989586621679451376"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ThreatModelEnv -&gt; UTxO Era
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#currentUTxOs"><span class="hs-identifier hs-var hs-var">currentUTxOs</span></a></span><span> </span><span class="annot"><span class="annottext">ThreatModelEnv
</span><a href="#local-6989586621679451376"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxModifier
</span><a href="#local-6989586621679451364"><span class="hs-identifier hs-var">mods</span></a></span><span>
</span><span id="line-225"></span><span>              </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Generate"><span class="hs-identifier hs-type">Generate</span></a></span><span> </span><span id="local-6989586621679451359"><span class="annot"><span class="annottext">Gen a
</span><a href="#local-6989586621679451359"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span id="local-6989586621679451358"><span class="annot"><span class="annottext">a -&gt; [a]
</span><a href="#local-6989586621679451358"><span class="hs-identifier hs-var">shr</span></a></span></span><span> </span><span id="local-6989586621679451357"><span class="annot"><span class="annottext">a -&gt; ThreatModel a
</span><a href="#local-6989586621679451357"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; Property) -&gt; Property
forall prop a.
Testable prop =&gt;
Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; prop) -&gt; Property
</span><span class="hs-identifier hs-var">forAllShrinkBlind</span></span><span> </span><span class="annot"><span class="annottext">Gen a
</span><a href="#local-6989586621679451359"><span class="hs-identifier hs-var">gen</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a]
</span><a href="#local-6989586621679451358"><span class="hs-identifier hs-var">shr</span></a></span><span>
</span><span id="line-226"></span><span>                                  </span><span class="annot"><span class="annottext">((a -&gt; Property) -&gt; Property) -&gt; (a -&gt; Property) -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; ThreatModel a -&gt; Property
</span><a href="#local-6989586621679451374"><span class="hs-identifier hs-var">interp</span></a></span><span> </span><span class="annot"><span class="annottext">Property -&gt; Property
</span><a href="#local-6989586621679451365"><span class="hs-identifier hs-var">mon</span></a></span><span> </span><span class="annot"><span class="annottext">(ThreatModel a -&gt; Property)
-&gt; (a -&gt; ThreatModel a) -&gt; a -&gt; Property
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; ThreatModel a
</span><a href="#local-6989586621679451357"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-227"></span><span>              </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#GetCtx"><span class="hs-identifier hs-type">GetCtx</span></a></span><span> </span><span id="local-6989586621679451354"><span class="annot"><span class="annottext">ThreatModelEnv -&gt; ThreatModel a
</span><a href="#local-6989586621679451354"><span class="hs-identifier hs-var">k</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; ThreatModel a -&gt; Property
</span><a href="#local-6989586621679451374"><span class="hs-identifier hs-var">interp</span></a></span><span> </span><span class="annot"><span class="annottext">Property -&gt; Property
</span><a href="#local-6989586621679451365"><span class="hs-identifier hs-var">mon</span></a></span><span>
</span><span id="line-228"></span><span>                                  </span><span class="annot"><span class="annottext">(ThreatModel a -&gt; Property) -&gt; ThreatModel a -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ThreatModelEnv -&gt; ThreatModel a
</span><a href="#local-6989586621679451354"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">ThreatModelEnv
</span><a href="#local-6989586621679451376"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-229"></span><span>              </span><span class="annot"><span class="annottext">ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Skip"><span class="hs-identifier hs-var">Skip</span></a></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ThreatModel a -&gt; [ThreatModelEnv] -&gt; Property
</span><a href="#local-6989586621679451383"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679451378"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">ThreatModel a
</span><a href="#local-6989586621679451377"><span class="hs-identifier hs-var">model</span></a></span><span> </span><span class="annot"><span class="annottext">[ThreatModelEnv]
</span><a href="#local-6989586621679451375"><span class="hs-identifier hs-var">envs</span></a></span><span>
</span><span id="line-230"></span><span>              </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#InPrecondition"><span class="hs-identifier hs-type">InPrecondition</span></a></span><span> </span><span id="local-6989586621679451353"><span class="annot"><span class="annottext">Bool -&gt; ThreatModel a
</span><a href="#local-6989586621679451353"><span class="hs-identifier hs-var">k</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; ThreatModel a -&gt; Property
</span><a href="#local-6989586621679451374"><span class="hs-identifier hs-var">interp</span></a></span><span> </span><span class="annot"><span class="annottext">Property -&gt; Property
</span><a href="#local-6989586621679451365"><span class="hs-identifier hs-var">mon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; ThreatModel a
</span><a href="#local-6989586621679451353"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>              </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Fail"><span class="hs-identifier hs-type">Fail</span></a></span><span> </span><span id="local-6989586621679451352"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679451352"><span class="hs-identifier hs-var">err</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Property -&gt; Property
</span><a href="#local-6989586621679451365"><span class="hs-identifier hs-var">mon</span></a></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; Property -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool -&gt; Property
forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679451352"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-232"></span><span>              </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Monitor"><span class="hs-identifier hs-type">Monitor</span></a></span><span> </span><span id="local-6989586621679451351"><span class="annot"><span class="annottext">Property -&gt; Property
</span><a href="#local-6989586621679451351"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679451350"><span class="annot"><span class="annottext">ThreatModel a
</span><a href="#local-6989586621679451350"><span class="hs-identifier hs-var">k</span></a></span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Property -&gt; Property
</span><a href="#local-6989586621679451351"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; Property -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; ThreatModel a -&gt; Property
</span><a href="#local-6989586621679451374"><span class="hs-identifier hs-var">interp</span></a></span><span> </span><span class="annot"><span class="annottext">Property -&gt; Property
</span><a href="#local-6989586621679451365"><span class="hs-identifier hs-var">mon</span></a></span><span> </span><span class="annot"><span class="annottext">ThreatModel a
</span><a href="#local-6989586621679451350"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-233"></span><span>              </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#MonitorLocal"><span class="hs-identifier hs-type">MonitorLocal</span></a></span><span> </span><span id="local-6989586621679451349"><span class="annot"><span class="annottext">Property -&gt; Property
</span><a href="#local-6989586621679451349"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679451348"><span class="annot"><span class="annottext">ThreatModel a
</span><a href="#local-6989586621679451348"><span class="hs-identifier hs-var">k</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; ThreatModel a -&gt; Property
</span><a href="#local-6989586621679451374"><span class="hs-identifier hs-var">interp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Property -&gt; Property
</span><a href="#local-6989586621679451365"><span class="hs-identifier hs-var">mon</span></a></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property)
-&gt; (Property -&gt; Property) -&gt; Property -&gt; Property
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Property -&gt; Property
</span><a href="#local-6989586621679451349"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ThreatModel a
</span><a href="#local-6989586621679451348"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-234"></span><span>              </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Done"><span class="hs-identifier hs-type">Done</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ThreatModel a -&gt; [ThreatModelEnv] -&gt; Property
</span><a href="#local-6989586621679451383"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">ThreatModel a
</span><a href="#local-6989586621679451377"><span class="hs-identifier hs-var">model</span></a></span><span> </span><span class="annot"><span class="annottext">[ThreatModelEnv]
</span><a href="#local-6989586621679451375"><span class="hs-identifier hs-var">envs</span></a></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="hs-comment">-- | Evaluate a `ThreatModel` on the result of running a t`Test.QuickCheck.ContractModel.ContractModel` test (see</span><span>
</span><span id="line-237"></span><span class="hs-comment">--   `runContractModel`). Checks the threat model on all transactions produced by the test.</span><span>
</span><span id="line-238"></span><span id="local-6989586621679451346"><span id="local-6989586621679451347"><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#assertThreatModel"><span class="hs-identifier hs-type">assertThreatModel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451347"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-239"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ProtocolParameters</span></span><span>
</span><span id="line-240"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.html#ContractModelResult"><span class="hs-identifier hs-type">ContractModelResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451346"><span class="hs-identifier hs-type">state</span></a></span><span>
</span><span id="line-241"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span></span></span><span>
</span><span id="line-242"></span><span id="assertThreatModel"><span class="annot"><span class="annottext">assertThreatModel :: ThreatModel a
-&gt; ProtocolParameters -&gt; ContractModelResult state -&gt; Property
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#assertThreatModel"><span class="hs-identifier hs-var hs-var">assertThreatModel</span></a></span></span><span> </span><span id="local-6989586621679451345"><span class="annot"><span class="annottext">ThreatModel a
</span><a href="#local-6989586621679451345"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679451344"><span class="annot"><span class="annottext">ProtocolParameters
</span><a href="#local-6989586621679451344"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679451343"><span class="annot"><span class="annottext">ContractModelResult state
</span><a href="#local-6989586621679451343"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ThreatModel a -&gt; [ThreatModelEnv] -&gt; Property
forall a. ThreatModel a -&gt; [ThreatModelEnv] -&gt; Property
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#runThreatModel"><span class="hs-identifier hs-var">runThreatModel</span></a></span><span> </span><span class="annot"><span class="annottext">ThreatModel a
</span><a href="#local-6989586621679451345"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">[ThreatModelEnv]
</span><a href="#local-6989586621679451342"><span class="hs-identifier hs-var">envs</span></a></span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-244"></span><span>    </span><span id="local-6989586621679451342"><span class="annot"><span class="annottext">envs :: [ThreatModelEnv]
</span><a href="#local-6989586621679451342"><span class="hs-identifier hs-var hs-var">envs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Tx Era -&gt; UTxO Era -&gt; ProtocolParameters -&gt; ThreatModelEnv
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModelEnv"><span class="hs-identifier hs-var">ThreatModelEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxInState -&gt; Tx Era
</span><a href="Test.QuickCheck.ContractModel.Internal.ChainIndex.html#tx"><span class="hs-identifier hs-var hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">TxInState
</span><a href="#local-6989586621679451340"><span class="hs-identifier hs-var">txInState</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainState -&gt; UTxO Era
</span><a href="Test.QuickCheck.ContractModel.Internal.ChainIndex.html#utxo"><span class="hs-identifier hs-var hs-var">utxo</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainState -&gt; UTxO Era) -&gt; ChainState -&gt; UTxO Era
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxInState -&gt; ChainState
</span><a href="Test.QuickCheck.ContractModel.Internal.ChainIndex.html#chainState"><span class="hs-identifier hs-var hs-var">chainState</span></a></span><span> </span><span class="annot"><span class="annottext">TxInState
</span><a href="#local-6989586621679451340"><span class="hs-identifier hs-var">txInState</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ProtocolParameters
</span><a href="#local-6989586621679451344"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-245"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679451340"><span class="annot"><span class="annottext">TxInState
</span><a href="#local-6989586621679451340"><span class="hs-identifier hs-var">txInState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ChainIndex -&gt; [TxInState]
</span><a href="Test.QuickCheck.ContractModel.Internal.ChainIndex.html#transactions"><span class="hs-identifier hs-var hs-var">transactions</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndex -&gt; [TxInState]) -&gt; ChainIndex -&gt; [TxInState]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ContractModelResult state -&gt; ChainIndex
forall state. ContractModelResult state -&gt; ChainIndex
</span><a href="Test.QuickCheck.ContractModel.Internal.html#finalChainIndex"><span class="hs-identifier hs-var hs-var">finalChainIndex</span></a></span><span> </span><span class="annot"><span class="annottext">ContractModelResult state
</span><a href="#local-6989586621679451343"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="hs-comment">-- | Check a precondition. If the argument threat model fails, the evaluation of the current</span><span>
</span><span id="line-248"></span><span class="hs-comment">--   transaction is skipped. If all transactions in an evaluation of `runThreatModel` are skipped</span><span>
</span><span id="line-249"></span><span class="hs-comment">--   it is considered a /discarded/ test for QuickCheck.</span><span>
</span><span id="line-250"></span><span class="hs-comment">--</span><span>
</span><span id="line-251"></span><span class="hs-comment">--   Having the argument to `threatPrecondition` be a threat model computation instead of a plain</span><span>
</span><span id="line-252"></span><span class="hs-comment">--   boolean allows you do express preconditions talking about the validation of modified</span><span>
</span><span id="line-253"></span><span class="hs-comment">--   transactions (using `shouldValidate` and `shouldNotValidate`). See `ensure` for the boolean</span><span>
</span><span id="line-254"></span><span class="hs-comment">--   version.</span><span>
</span><span id="line-255"></span><span id="local-6989586621679451564"><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#threatPrecondition"><span class="hs-identifier hs-type">threatPrecondition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451564"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451564"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-256"></span><span id="threatPrecondition"><span class="annot"><span class="annottext">threatPrecondition :: ThreatModel a -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#threatPrecondition"><span class="hs-identifier hs-var hs-var">threatPrecondition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">case</span><span>
</span><span id="line-257"></span><span>  </span><span class="annot"><span class="annottext">ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Skip"><span class="hs-identifier hs-var">Skip</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ThreatModel a
forall a. ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Skip"><span class="hs-identifier hs-var">Skip</span></a></span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#InPrecondition"><span class="hs-identifier hs-type">InPrecondition</span></a></span><span> </span><span id="local-6989586621679451335"><span class="annot"><span class="annottext">Bool -&gt; ThreatModel a
</span><a href="#local-6989586621679451335"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ThreatModel a
</span><a href="#local-6989586621679451335"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-259"></span><span>  </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Fail"><span class="hs-identifier hs-type">Fail</span></a></span><span> </span><span id="local-6989586621679451334"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679451334"><span class="hs-identifier hs-var">reason</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; ThreatModel a -&gt; ThreatModel a
forall a. (Property -&gt; Property) -&gt; ThreatModel a -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Monitor"><span class="hs-identifier hs-var">Monitor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; Property -&gt; Property
forall prop.
Testable prop =&gt;
String -&gt; [String] -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">tabulate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Precondition failed with reason&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679451334"><span class="hs-identifier hs-var">reason</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ThreatModel a
forall a. ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Skip"><span class="hs-identifier hs-var">Skip</span></a></span><span>
</span><span id="line-260"></span><span>  </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Validate"><span class="hs-identifier hs-type">Validate</span></a></span><span> </span><span id="local-6989586621679451332"><span class="annot"><span class="annottext">TxModifier
</span><a href="#local-6989586621679451332"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span id="local-6989586621679451331"><span class="annot"><span class="annottext">ValidityReport -&gt; ThreatModel a
</span><a href="#local-6989586621679451331"><span class="hs-identifier hs-var">k</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxModifier -&gt; (ValidityReport -&gt; ThreatModel a) -&gt; ThreatModel a
forall a.
TxModifier -&gt; (ValidityReport -&gt; ThreatModel a) -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Validate"><span class="hs-identifier hs-var">Validate</span></a></span><span> </span><span class="annot"><span class="annottext">TxModifier
</span><a href="#local-6989586621679451332"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ThreatModel a -&gt; ThreatModel a
forall a. ThreatModel a -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#threatPrecondition"><span class="hs-identifier hs-var">threatPrecondition</span></a></span><span> </span><span class="annot"><span class="annottext">(ThreatModel a -&gt; ThreatModel a)
-&gt; (ValidityReport -&gt; ThreatModel a)
-&gt; ValidityReport
-&gt; ThreatModel a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ValidityReport -&gt; ThreatModel a
</span><a href="#local-6989586621679451331"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>  </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Generate"><span class="hs-identifier hs-type">Generate</span></a></span><span> </span><span id="local-6989586621679451330"><span class="annot"><span class="annottext">Gen a
</span><a href="#local-6989586621679451330"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679451329"><span class="annot"><span class="annottext">a -&gt; [a]
</span><a href="#local-6989586621679451329"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679451328"><span class="annot"><span class="annottext">a -&gt; ThreatModel a
</span><a href="#local-6989586621679451328"><span class="hs-identifier hs-var">k</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; ThreatModel a) -&gt; ThreatModel a
forall a b.
Show a =&gt;
Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; ThreatModel b) -&gt; ThreatModel b
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Generate"><span class="hs-identifier hs-var">Generate</span></a></span><span> </span><span class="annot"><span class="annottext">Gen a
</span><a href="#local-6989586621679451330"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a]
</span><a href="#local-6989586621679451329"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ThreatModel a -&gt; ThreatModel a
forall a. ThreatModel a -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#threatPrecondition"><span class="hs-identifier hs-var">threatPrecondition</span></a></span><span> </span><span class="annot"><span class="annottext">(ThreatModel a -&gt; ThreatModel a)
-&gt; (a -&gt; ThreatModel a) -&gt; a -&gt; ThreatModel a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; ThreatModel a
</span><a href="#local-6989586621679451328"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>  </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#GetCtx"><span class="hs-identifier hs-type">GetCtx</span></a></span><span> </span><span id="local-6989586621679451327"><span class="annot"><span class="annottext">ThreatModelEnv -&gt; ThreatModel a
</span><a href="#local-6989586621679451327"><span class="hs-identifier hs-var">k</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(ThreatModelEnv -&gt; ThreatModel a) -&gt; ThreatModel a
forall a. (ThreatModelEnv -&gt; ThreatModel a) -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#GetCtx"><span class="hs-identifier hs-var">GetCtx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ThreatModel a -&gt; ThreatModel a
forall a. ThreatModel a -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#threatPrecondition"><span class="hs-identifier hs-var">threatPrecondition</span></a></span><span> </span><span class="annot"><span class="annottext">(ThreatModel a -&gt; ThreatModel a)
-&gt; (ThreatModelEnv -&gt; ThreatModel a)
-&gt; ThreatModelEnv
-&gt; ThreatModel a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ThreatModelEnv -&gt; ThreatModel a
</span><a href="#local-6989586621679451327"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>  </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Monitor"><span class="hs-identifier hs-type">Monitor</span></a></span><span> </span><span id="local-6989586621679451326"><span class="annot"><span class="annottext">Property -&gt; Property
</span><a href="#local-6989586621679451326"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679451325"><span class="annot"><span class="annottext">ThreatModel a
</span><a href="#local-6989586621679451325"><span class="hs-identifier hs-var">k</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; ThreatModel a -&gt; ThreatModel a
forall a. (Property -&gt; Property) -&gt; ThreatModel a -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Monitor"><span class="hs-identifier hs-var">Monitor</span></a></span><span> </span><span class="annot"><span class="annottext">Property -&gt; Property
</span><a href="#local-6989586621679451326"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ThreatModel a -&gt; ThreatModel a
forall a. ThreatModel a -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#threatPrecondition"><span class="hs-identifier hs-var">threatPrecondition</span></a></span><span> </span><span class="annot"><span class="annottext">ThreatModel a
</span><a href="#local-6989586621679451325"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>  </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#MonitorLocal"><span class="hs-identifier hs-type">MonitorLocal</span></a></span><span> </span><span id="local-6989586621679451324"><span class="annot"><span class="annottext">Property -&gt; Property
</span><a href="#local-6989586621679451324"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679451323"><span class="annot"><span class="annottext">ThreatModel a
</span><a href="#local-6989586621679451323"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; ThreatModel a -&gt; ThreatModel a
forall a. (Property -&gt; Property) -&gt; ThreatModel a -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#MonitorLocal"><span class="hs-identifier hs-var">MonitorLocal</span></a></span><span> </span><span class="annot"><span class="annottext">Property -&gt; Property
</span><a href="#local-6989586621679451324"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ThreatModel a -&gt; ThreatModel a
forall a. ThreatModel a -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#threatPrecondition"><span class="hs-identifier hs-var">threatPrecondition</span></a></span><span> </span><span class="annot"><span class="annottext">ThreatModel a
</span><a href="#local-6989586621679451323"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>  </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Done"><span class="hs-identifier hs-type">Done</span></a></span><span> </span><span id="local-6989586621679451322"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679451322"><span class="hs-identifier hs-var">a</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; ThreatModel a
forall a. a -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Done"><span class="hs-identifier hs-var">Done</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679451322"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-comment">-- | Same as `threatPrecondition` but takes a boolean and skips the test if the argument is @False@.</span><span>
</span><span id="line-268"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ensure"><span class="hs-identifier hs-type">ensure</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span id="ensure"><span class="annot"><span class="annottext">ensure :: Bool -&gt; ThreatModel ()
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ensure"><span class="hs-identifier hs-var hs-var">ensure</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ThreatModel ()
forall a. ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Skip"><span class="hs-identifier hs-var">Skip</span></a></span><span>
</span><span id="line-270"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ensure"><span class="hs-identifier hs-var">ensure</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; ThreatModel ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="hs-comment">-- | Precondition that check that the original transaction has an input at a given address. Useful,</span><span>
</span><span id="line-273"></span><span class="hs-comment">--   for example, to ensure that you only consider transactions that trie to spend a script output</span><span>
</span><span id="line-274"></span><span class="hs-comment">--   from the script under test.</span><span>
</span><span id="line-275"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ensureHasInputAt"><span class="hs-identifier hs-type">ensureHasInputAt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AddressAny</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span id="ensureHasInputAt"><span class="annot"><span class="annottext">ensureHasInputAt :: AddressAny -&gt; ThreatModel ()
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ensureHasInputAt"><span class="hs-identifier hs-var hs-var">ensureHasInputAt</span></a></span></span><span> </span><span id="local-6989586621679451321"><span class="annot"><span class="annottext">AddressAny
</span><a href="#local-6989586621679451321"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-277"></span><span>  </span><span id="local-6989586621679451320"><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679451320"><span class="hs-identifier hs-var">inputs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ThreatModel [Input]
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#getTxInputs"><span class="hs-identifier hs-var">getTxInputs</span></a></span><span>
</span><span id="line-278"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; ThreatModel ()
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ensure"><span class="hs-identifier hs-var">ensure</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; ThreatModel ()) -&gt; Bool -&gt; ThreatModel ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Input -&gt; Bool) -&gt; [Input] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">any</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddressAny
</span><a href="#local-6989586621679451321"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">AddressAny -&gt; AddressAny -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(AddressAny -&gt; Bool) -&gt; (Input -&gt; AddressAny) -&gt; Input -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Input -&gt; AddressAny
forall t. IsInputOrOutput t =&gt; t -&gt; AddressAny
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#addressOf"><span class="hs-identifier hs-var">addressOf</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Input]
</span><a href="#local-6989586621679451320"><span class="hs-identifier hs-var">inputs</span></a></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="hs-comment">-- | Returns @True@ if evaluated under a `threatPrecondition` and @False@ otherwise.</span><span>
</span><span id="line-281"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#inPrecondition"><span class="hs-identifier hs-type">inPrecondition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-282"></span><span id="inPrecondition"><span class="annot"><span class="annottext">inPrecondition :: ThreatModel Bool
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#inPrecondition"><span class="hs-identifier hs-var hs-var">inPrecondition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; ThreatModel Bool) -&gt; ThreatModel Bool
forall a. (Bool -&gt; ThreatModel a) -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#InPrecondition"><span class="hs-identifier hs-var">InPrecondition</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ThreatModel Bool
forall a. a -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Done"><span class="hs-identifier hs-var">Done</span></a></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="hs-comment">-- | The most low-level way to validate a modified transaction. In most cases `shouldValidate` and</span><span>
</span><span id="line-285"></span><span class="hs-comment">--   `shouldNotValidate` are preferred.</span><span>
</span><span id="line-286"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#validate"><span class="hs-identifier hs-type">validate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#TxModifier"><span class="hs-identifier hs-type">TxModifier</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#ValidityReport"><span class="hs-identifier hs-type">ValidityReport</span></a></span><span>
</span><span id="line-287"></span><span id="validate"><span class="annot"><span class="annottext">validate :: TxModifier -&gt; ThreatModel ValidityReport
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#validate"><span class="hs-identifier hs-var hs-var">validate</span></a></span></span><span> </span><span id="local-6989586621679451317"><span class="annot"><span class="annottext">TxModifier
</span><a href="#local-6989586621679451317"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxModifier
-&gt; (ValidityReport -&gt; ThreatModel ValidityReport)
-&gt; ThreatModel ValidityReport
forall a.
TxModifier -&gt; (ValidityReport -&gt; ThreatModel a) -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Validate"><span class="hs-identifier hs-var">Validate</span></a></span><span> </span><span class="annot"><span class="annottext">TxModifier
</span><a href="#local-6989586621679451317"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">ValidityReport -&gt; ThreatModel ValidityReport
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="hs-comment">-- | Check that a given modification of the original transaction validates. The modified transaction</span><span>
</span><span id="line-290"></span><span class="hs-comment">--   is printed in counterexample when this fails, or if it succeeds in a precondition and the test</span><span>
</span><span id="line-291"></span><span class="hs-comment">--   fails later.</span><span>
</span><span id="line-292"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#shouldValidate"><span class="hs-identifier hs-type">shouldValidate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#TxModifier"><span class="hs-identifier hs-type">TxModifier</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span id="shouldValidate"><span class="annot"><span class="annottext">shouldValidate :: TxModifier -&gt; ThreatModel ()
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#shouldValidate"><span class="hs-identifier hs-var hs-var">shouldValidate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TxModifier -&gt; ThreatModel ()
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#shouldValidateOrNot"><span class="hs-identifier hs-var">shouldValidateOrNot</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="hs-comment">-- | Check that a given modification of the original transaction does not validate. The modified</span><span>
</span><span id="line-296"></span><span class="hs-comment">--   transaction is printed in counterexample when it does validate, or if it doesn't in a satisfied</span><span>
</span><span id="line-297"></span><span class="hs-comment">--   precondition and the test fails later.</span><span>
</span><span id="line-298"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#shouldNotValidate"><span class="hs-identifier hs-type">shouldNotValidate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#TxModifier"><span class="hs-identifier hs-type">TxModifier</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span id="shouldNotValidate"><span class="annot"><span class="annottext">shouldNotValidate :: TxModifier -&gt; ThreatModel ()
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#shouldNotValidate"><span class="hs-identifier hs-var hs-var">shouldNotValidate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TxModifier -&gt; ThreatModel ()
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#shouldValidateOrNot"><span class="hs-identifier hs-var">shouldValidateOrNot</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#shouldValidateOrNot"><span class="hs-identifier hs-type">shouldValidateOrNot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#TxModifier"><span class="hs-identifier hs-type">TxModifier</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span id="shouldValidateOrNot"><span class="annot"><span class="annottext">shouldValidateOrNot :: Bool -&gt; TxModifier -&gt; ThreatModel ()
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#shouldValidateOrNot"><span class="hs-identifier hs-var hs-var">shouldValidateOrNot</span></a></span></span><span> </span><span id="local-6989586621679451315"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679451315"><span class="hs-identifier hs-var">should</span></a></span></span><span> </span><span id="local-6989586621679451314"><span class="annot"><span class="annottext">TxModifier
</span><a href="#local-6989586621679451314"><span class="hs-identifier hs-var">txMod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-303"></span><span>  </span><span id="local-6989586621679451313"><span class="annot"><span class="annottext">ValidityReport
</span><a href="#local-6989586621679451313"><span class="hs-identifier hs-var">validReport</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxModifier -&gt; ThreatModel ValidityReport
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#validate"><span class="hs-identifier hs-var">validate</span></a></span><span> </span><span class="annot"><span class="annottext">TxModifier
</span><a href="#local-6989586621679451314"><span class="hs-identifier hs-var">txMod</span></a></span><span>
</span><span id="line-304"></span><span>  </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModelEnv"><span class="hs-identifier hs-type">ThreatModelEnv</span></a></span><span> </span><span id="local-6989586621679451312"><span class="annot"><span class="annottext">Tx Era
</span><a href="#local-6989586621679451312"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span id="local-6989586621679451311"><span class="annot"><span class="annottext">UTxO Era
</span><a href="#local-6989586621679451311"><span class="hs-identifier hs-var">utxos</span></a></span></span><span> </span><span class="annot"><span class="annottext">ProtocolParameters
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ThreatModel ThreatModelEnv
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#getThreatModelEnv"><span class="hs-identifier hs-var">getThreatModelEnv</span></a></span><span>
</span><span id="line-305"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679451310"><span class="annot"><span class="annottext">newTx :: Tx Era
</span><a href="#local-6989586621679451310"><span class="hs-identifier hs-var hs-var">newTx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Tx Era, UTxO Era) -&gt; Tx Era
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((Tx Era, UTxO Era) -&gt; Tx Era) -&gt; (Tx Era, UTxO Era) -&gt; Tx Era
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Tx Era -&gt; UTxO Era -&gt; TxModifier -&gt; (Tx Era, UTxO Era)
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#applyTxModifier"><span class="hs-identifier hs-var">applyTxModifier</span></a></span><span> </span><span class="annot"><span class="annottext">Tx Era
</span><a href="#local-6989586621679451312"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO Era
</span><a href="#local-6989586621679451311"><span class="hs-identifier hs-var">utxos</span></a></span><span> </span><span class="annot"><span class="annottext">TxModifier
</span><a href="#local-6989586621679451314"><span class="hs-identifier hs-var">txMod</span></a></span><span>
</span><span id="line-306"></span><span>      </span><span id="local-6989586621679451309"><span class="annot"><span class="annottext">info :: String -&gt; Doc
</span><a href="#local-6989586621679451309"><span class="hs-identifier hs-var hs-var">info</span></a></span></span><span> </span><span id="local-6989586621679451308"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679451308"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-307"></span><span>        </span><span class="annot"><span class="annottext">Doc -&gt; [Doc] -&gt; Doc
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Pretty.html#block"><span class="hs-identifier hs-var">block</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="../../../../ghc/html/libraries/pretty-1.1.3.6/src"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679451308"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; [Doc] -&gt; Doc
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Pretty.html#block"><span class="hs-identifier hs-var">block</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;Modifications to original transaction&quot;</span></span><span>
</span><span id="line-309"></span><span>                  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TxModifier -&gt; Doc
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Pretty.html#prettyTxModifier"><span class="hs-identifier hs-var">prettyTxModifier</span></a></span><span> </span><span class="annot"><span class="annottext">TxModifier
</span><a href="#local-6989586621679451314"><span class="hs-identifier hs-var">txMod</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-310"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; [Doc] -&gt; Doc
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Pretty.html#block"><span class="hs-identifier hs-var">block</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;Resulting transaction&quot;</span></span><span>
</span><span id="line-311"></span><span>                  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tx Era -&gt; Doc
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Pretty.html#prettyTx"><span class="hs-identifier hs-var">prettyTx</span></a></span><span> </span><span class="annot"><span class="annottext">Tx Era
</span><a href="#local-6989586621679451310"><span class="hs-identifier hs-var">newTx</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-312"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="../../../../ghc/html/libraries/pretty-1.1.3.6/src"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-313"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-314"></span><span>      </span><span id="local-6989586621679451305"><span class="annot"><span class="annottext">n't :: String
</span><a href="#local-6989586621679451305"><span class="hs-identifier hs-var hs-var">n't</span></a></span></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679451315"><span class="hs-identifier hs-var">should</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;n't&quot;</span></span><span>
</span><span id="line-315"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-316"></span><span>      </span><span id="local-6989586621679451304"><span class="annot"><span class="annottext">notN't :: String
</span><a href="#local-6989586621679451304"><span class="hs-identifier hs-var hs-var">notN't</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679451315"><span class="hs-identifier hs-var">should</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-317"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;n't&quot;</span></span><span>
</span><span id="line-318"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; ThreatModel () -&gt; ThreatModel ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679451315"><span class="hs-identifier hs-var">should</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">ValidityReport -&gt; Bool
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#valid"><span class="hs-identifier hs-var hs-var">valid</span></a></span><span> </span><span class="annot"><span class="annottext">ValidityReport
</span><a href="#local-6989586621679451313"><span class="hs-identifier hs-var">validReport</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ThreatModel () -&gt; ThreatModel ())
-&gt; ThreatModel () -&gt; ThreatModel ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-319"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ThreatModel ()
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ThreatModel ()) -&gt; String -&gt; ThreatModel ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; String) -&gt; Doc -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="#local-6989586621679451309"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc) -&gt; String -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall r. PrintfType r =&gt; String -&gt; r
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">printf</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Test failure: the following transaction did%s validate&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679451305"><span class="hs-identifier hs-var">n't</span></a></span><span>
</span><span id="line-320"></span><span>  </span><span id="local-6989586621679451299"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679451299"><span class="hs-identifier hs-var">pre</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ThreatModel Bool
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#inPrecondition"><span class="hs-identifier hs-var">inPrecondition</span></a></span><span>
</span><span id="line-321"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; ThreatModel () -&gt; ThreatModel ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679451299"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">(ThreatModel () -&gt; ThreatModel ())
-&gt; ThreatModel () -&gt; ThreatModel ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ThreatModel ()
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#counterexampleTM"><span class="hs-identifier hs-var">counterexampleTM</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ThreatModel ()) -&gt; String -&gt; ThreatModel ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; String) -&gt; Doc -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-323"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="#local-6989586621679451309"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc) -&gt; String -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall r. PrintfType r =&gt; String -&gt; r
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">printf</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Satisfied precondition: the following transaction did%s validate&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679451304"><span class="hs-identifier hs-var">notN't</span></a></span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span class="hs-comment">-- | Get the current context.</span><span>
</span><span id="line-326"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#getThreatModelEnv"><span class="hs-identifier hs-type">getThreatModelEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModelEnv"><span class="hs-identifier hs-type">ThreatModelEnv</span></a></span><span>
</span><span id="line-327"></span><span id="getThreatModelEnv"><span class="annot"><span class="annottext">getThreatModelEnv :: ThreatModel ThreatModelEnv
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#getThreatModelEnv"><span class="hs-identifier hs-var hs-var">getThreatModelEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ThreatModelEnv -&gt; ThreatModel ThreatModelEnv)
-&gt; ThreatModel ThreatModelEnv
forall a. (ThreatModelEnv -&gt; ThreatModel a) -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#GetCtx"><span class="hs-identifier hs-var">GetCtx</span></a></span><span> </span><span class="annot"><span class="annottext">ThreatModelEnv -&gt; ThreatModel ThreatModelEnv
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="hs-comment">-- | Get the original transaction from the context.</span><span>
</span><span id="line-330"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#originalTx"><span class="hs-identifier hs-type">originalTx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span id="originalTx"><span class="annot"><span class="annottext">originalTx :: ThreatModel (Tx Era)
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#originalTx"><span class="hs-identifier hs-var hs-var">originalTx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ThreatModelEnv -&gt; Tx Era
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#currentTx"><span class="hs-identifier hs-var hs-var">currentTx</span></a></span><span> </span><span class="annot"><span class="annottext">(ThreatModelEnv -&gt; Tx Era)
-&gt; ThreatModel ThreatModelEnv -&gt; ThreatModel (Tx Era)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ThreatModel ThreatModelEnv
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#getThreatModelEnv"><span class="hs-identifier hs-var">getThreatModelEnv</span></a></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="hs-comment">-- | Get the outputs from the original transaction.</span><span>
</span><span id="line-334"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#getTxOutputs"><span class="hs-identifier hs-type">getTxOutputs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#Output"><span class="hs-identifier hs-type">Output</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-335"></span><span id="getTxOutputs"><span class="annot"><span class="annottext">getTxOutputs :: ThreatModel [Output]
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#getTxOutputs"><span class="hs-identifier hs-var hs-var">getTxOutputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word -&gt; TxOut CtxTx Era -&gt; Output)
-&gt; [Word] -&gt; [TxOut CtxTx Era] -&gt; [Output]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">zipWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxOut CtxTx Era -&gt; TxIx -&gt; Output)
-&gt; TxIx -&gt; TxOut CtxTx Era -&gt; Output
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut CtxTx Era -&gt; TxIx -&gt; Output
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#Output"><span class="hs-identifier hs-var">Output</span></a></span><span> </span><span class="annot"><span class="annottext">(TxIx -&gt; TxOut CtxTx Era -&gt; Output)
-&gt; (Word -&gt; TxIx) -&gt; Word -&gt; TxOut CtxTx Era -&gt; Output
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; TxIx
</span><span class="hs-identifier hs-var">TxIx</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">([TxOut CtxTx Era] -&gt; [Output])
-&gt; (Tx Era -&gt; [TxOut CtxTx Era]) -&gt; Tx Era -&gt; [Output]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Tx Era -&gt; [TxOut CtxTx Era]
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#txOutputs"><span class="hs-identifier hs-var">txOutputs</span></a></span><span> </span><span class="annot"><span class="annottext">(Tx Era -&gt; [Output])
-&gt; ThreatModel (Tx Era) -&gt; ThreatModel [Output]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ThreatModel (Tx Era)
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#originalTx"><span class="hs-identifier hs-var">originalTx</span></a></span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span class="hs-comment">-- | Get the inputs from the original transaction.</span><span>
</span><span id="line-338"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#getTxInputs"><span class="hs-identifier hs-type">getTxInputs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#Input"><span class="hs-identifier hs-type">Input</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-339"></span><span id="getTxInputs"><span class="annot"><span class="annottext">getTxInputs :: ThreatModel [Input]
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#getTxInputs"><span class="hs-identifier hs-var hs-var">getTxInputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-340"></span><span>  </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModelEnv"><span class="hs-identifier hs-type">ThreatModelEnv</span></a></span><span> </span><span id="local-6989586621679451292"><span class="annot"><span class="annottext">Tx Era
</span><a href="#local-6989586621679451292"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span id="local-6989586621679451290"><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO Era)
</span><a href="#local-6989586621679451290"><span class="hs-identifier hs-var">utxos</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ProtocolParameters
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ThreatModel ThreatModelEnv
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#getThreatModelEnv"><span class="hs-identifier hs-var">getThreatModelEnv</span></a></span><span>
</span><span id="line-341"></span><span>  </span><span class="annot"><span class="annottext">[Input] -&gt; ThreatModel [Input]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO Era -&gt; TxIn -&gt; Input
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#Input"><span class="hs-identifier hs-var">Input</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO Era
</span><a href="#local-6989586621679451288"><span class="hs-identifier hs-var">txout</span></a></span><span> </span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679451287"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-342"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679451287"><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679451287"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Tx Era -&gt; [TxIn]
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#txInputs"><span class="hs-identifier hs-var">txInputs</span></a></span><span> </span><span class="annot"><span class="annottext">Tx Era
</span><a href="#local-6989586621679451292"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-343"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679451288"><span class="annot"><span class="annottext">TxOut CtxUTxO Era
</span><a href="#local-6989586621679451288"><span class="hs-identifier hs-var">txout</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TxIn -&gt; Map TxIn (TxOut CtxUTxO Era) -&gt; Maybe (TxOut CtxUTxO Era)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679451287"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO Era)
</span><a href="#local-6989586621679451290"><span class="hs-identifier hs-var">utxos</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-344"></span><span>       </span><span class="hs-special">]</span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span class="hs-comment">-- | Get the redeemer (if any) for an input of the original transaction.</span><span>
</span><span id="line-347"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#getRedeemer"><span class="hs-identifier hs-type">getRedeemer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#Input"><span class="hs-identifier hs-type">Input</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#Redeemer"><span class="hs-identifier hs-type">Redeemer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span id="getRedeemer"><span class="annot"><span class="annottext">getRedeemer :: Input -&gt; ThreatModel (Maybe Redeemer)
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#getRedeemer"><span class="hs-identifier hs-var hs-var">getRedeemer</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#Input"><span class="hs-identifier hs-type">Input</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO Era
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679451284"><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679451284"><span class="hs-identifier hs-var">txIn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-349"></span><span>  </span><span id="local-6989586621679451283"><span class="annot"><span class="annottext">Tx Era
</span><a href="#local-6989586621679451283"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ThreatModel (Tx Era)
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#originalTx"><span class="hs-identifier hs-var">originalTx</span></a></span><span>
</span><span id="line-350"></span><span>  </span><span class="annot"><span class="annottext">Maybe Redeemer -&gt; ThreatModel (Maybe Redeemer)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Redeemer -&gt; ThreatModel (Maybe Redeemer))
-&gt; Maybe Redeemer -&gt; ThreatModel (Maybe Redeemer)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Tx Era -&gt; TxIn -&gt; Maybe Redeemer
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#redeemerOfTxIn"><span class="hs-identifier hs-var">redeemerOfTxIn</span></a></span><span> </span><span class="annot"><span class="annottext">Tx Era
</span><a href="#local-6989586621679451283"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679451284"><span class="hs-identifier hs-var">txIn</span></a></span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span class="hs-comment">-- | Generate a random value. Takes a QuickCheck generator and a `shrink` function.</span><span>
</span><span id="line-353"></span><span id="local-6989586621679451520"><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#forAllTM"><span class="hs-identifier hs-type">forAllTM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451520"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><a href="#local-6989586621679451520"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679451520"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679451520"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451520"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-354"></span><span id="forAllTM"><span class="annot"><span class="annottext">forAllTM :: Gen a -&gt; (a -&gt; [a]) -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#forAllTM"><span class="hs-identifier hs-var hs-var">forAllTM</span></a></span></span><span> </span><span id="local-6989586621679451281"><span class="annot"><span class="annottext">Gen a
</span><a href="#local-6989586621679451281"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679451280"><span class="annot"><span class="annottext">a -&gt; [a]
</span><a href="#local-6989586621679451280"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; ThreatModel a) -&gt; ThreatModel a
forall a b.
Show a =&gt;
Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; ThreatModel b) -&gt; ThreatModel b
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Generate"><span class="hs-identifier hs-var">Generate</span></a></span><span> </span><span class="annot"><span class="annottext">Gen a
</span><a href="#local-6989586621679451281"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a]
</span><a href="#local-6989586621679451280"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; ThreatModel a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span class="hs-comment">-- | Pick a random input satisfying the given predicate.</span><span>
</span><span id="line-357"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#anyInputSuchThat"><span class="hs-identifier hs-type">anyInputSuchThat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#Input"><span class="hs-identifier hs-type">Input</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#Input"><span class="hs-identifier hs-type">Input</span></a></span><span>
</span><span id="line-358"></span><span id="anyInputSuchThat"><span class="annot"><span class="annottext">anyInputSuchThat :: (Input -&gt; Bool) -&gt; ThreatModel Input
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#anyInputSuchThat"><span class="hs-identifier hs-var hs-var">anyInputSuchThat</span></a></span></span><span> </span><span id="local-6989586621679451279"><span class="annot"><span class="annottext">Input -&gt; Bool
</span><a href="#local-6989586621679451279"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Input] -&gt; ThreatModel Input
forall a. Show a =&gt; [a] -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#pickAny"><span class="hs-identifier hs-var">pickAny</span></a></span><span> </span><span class="annot"><span class="annottext">([Input] -&gt; ThreatModel Input)
-&gt; ([Input] -&gt; [Input]) -&gt; [Input] -&gt; ThreatModel Input
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Input -&gt; Bool) -&gt; [Input] -&gt; [Input]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="annot"><span class="annottext">Input -&gt; Bool
</span><a href="#local-6989586621679451279"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">([Input] -&gt; ThreatModel Input)
-&gt; ThreatModel [Input] -&gt; ThreatModel Input
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">ThreatModel [Input]
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#getTxInputs"><span class="hs-identifier hs-var">getTxInputs</span></a></span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="hs-comment">-- | Pick a random output satisfying the given predicate.</span><span>
</span><span id="line-361"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#anyOutputSuchThat"><span class="hs-identifier hs-type">anyOutputSuchThat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#Output"><span class="hs-identifier hs-type">Output</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.TxModifier.html#Output"><span class="hs-identifier hs-type">Output</span></a></span><span>
</span><span id="line-362"></span><span id="anyOutputSuchThat"><span class="annot"><span class="annottext">anyOutputSuchThat :: (Output -&gt; Bool) -&gt; ThreatModel Output
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#anyOutputSuchThat"><span class="hs-identifier hs-var hs-var">anyOutputSuchThat</span></a></span></span><span> </span><span id="local-6989586621679451277"><span class="annot"><span class="annottext">Output -&gt; Bool
</span><a href="#local-6989586621679451277"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Output] -&gt; ThreatModel Output
forall a. Show a =&gt; [a] -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#pickAny"><span class="hs-identifier hs-var">pickAny</span></a></span><span> </span><span class="annot"><span class="annottext">([Output] -&gt; ThreatModel Output)
-&gt; ([Output] -&gt; [Output]) -&gt; [Output] -&gt; ThreatModel Output
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Output -&gt; Bool) -&gt; [Output] -&gt; [Output]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="annot"><span class="annottext">Output -&gt; Bool
</span><a href="#local-6989586621679451277"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">([Output] -&gt; ThreatModel Output)
-&gt; ThreatModel [Output] -&gt; ThreatModel Output
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">ThreatModel [Output]
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#getTxOutputs"><span class="hs-identifier hs-var">getTxOutputs</span></a></span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span class="hs-comment">-- | Pick a random value from a list. Skips the test if the list is empty.</span><span>
</span><span id="line-365"></span><span id="local-6989586621679451530"><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#pickAny"><span class="hs-identifier hs-type">pickAny</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451530"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679451530"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451530"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-366"></span><span id="pickAny"><span class="annot"><span class="annottext">pickAny :: [a] -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#pickAny"><span class="hs-identifier hs-var hs-var">pickAny</span></a></span></span><span> </span><span id="local-6989586621679451276"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679451276"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-367"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; ThreatModel ()
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ensure"><span class="hs-identifier hs-var">ensure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679451276"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679451273"><span class="annot"><span class="annottext">xs' :: [(a, Int)]
</span><a href="#local-6989586621679451273"><span class="hs-identifier hs-var hs-var">xs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [Int] -&gt; [(a, Int)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679451276"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-369"></span><span>  </span><span class="annot"><span class="annottext">(a, Int) -&gt; a
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((a, Int) -&gt; a) -&gt; ThreatModel (a, Int) -&gt; ThreatModel a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Gen (a, Int) -&gt; ((a, Int) -&gt; [(a, Int)]) -&gt; ThreatModel (a, Int)
forall a. Show a =&gt; Gen a -&gt; (a -&gt; [a]) -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#forAllTM"><span class="hs-identifier hs-var">forAllTM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(a, Int)] -&gt; Gen (a, Int)
forall a. [a] -&gt; Gen a
</span><span class="hs-identifier hs-var">elements</span></span><span> </span><span class="annot"><span class="annottext">[(a, Int)]
</span><a href="#local-6989586621679451273"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451271"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679451271"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [(a, Int)] -&gt; [(a, Int)]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679451271"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, Int)]
</span><a href="#local-6989586621679451273"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="hs-comment">-- | Pick a random signer of the original transaction.</span><span>
</span><span id="line-372"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#anySigner"><span class="hs-identifier hs-type">anySigner</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Hash</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PaymentKey</span></span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span id="anySigner"><span class="annot"><span class="annottext">anySigner :: ThreatModel (Hash PaymentKey)
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#anySigner"><span class="hs-identifier hs-var hs-var">anySigner</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Hash PaymentKey] -&gt; ThreatModel (Hash PaymentKey)
forall a. Show a =&gt; [a] -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#pickAny"><span class="hs-identifier hs-var">pickAny</span></a></span><span> </span><span class="annot"><span class="annottext">([Hash PaymentKey] -&gt; ThreatModel (Hash PaymentKey))
-&gt; (Tx Era -&gt; [Hash PaymentKey])
-&gt; Tx Era
-&gt; ThreatModel (Hash PaymentKey)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Tx Era -&gt; [Hash PaymentKey]
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#txSigners"><span class="hs-identifier hs-var">txSigners</span></a></span><span> </span><span class="annot"><span class="annottext">(Tx Era -&gt; ThreatModel (Hash PaymentKey))
-&gt; ThreatModel (Tx Era) -&gt; ThreatModel (Hash PaymentKey)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">ThreatModel (Tx Era)
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#originalTx"><span class="hs-identifier hs-var">originalTx</span></a></span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span class="hs-comment">-- | Monitoring that's shared between all transactions evaulated. Avoid this in favour of</span><span>
</span><span id="line-376"></span><span class="hs-comment">--   `tabulateTM`, `collectTM` and `classifyTM` when possible.</span><span>
</span><span id="line-377"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#monitorThreatModel"><span class="hs-identifier hs-type">monitorThreatModel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span id="monitorThreatModel"><span class="annot"><span class="annottext">monitorThreatModel :: (Property -&gt; Property) -&gt; ThreatModel ()
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#monitorThreatModel"><span class="hs-identifier hs-var hs-var">monitorThreatModel</span></a></span></span><span> </span><span id="local-6989586621679451268"><span class="annot"><span class="annottext">Property -&gt; Property
</span><a href="#local-6989586621679451268"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; ThreatModel () -&gt; ThreatModel ()
forall a. (Property -&gt; Property) -&gt; ThreatModel a -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#Monitor"><span class="hs-identifier hs-var">Monitor</span></a></span><span> </span><span class="annot"><span class="annottext">Property -&gt; Property
</span><a href="#local-6989586621679451268"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; ThreatModel ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span class="hs-comment">-- | Monitoring that's local to the current transaction. Use `counterexampleTM` when possible.</span><span>
</span><span id="line-381"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#monitorLocalThreatModel"><span class="hs-identifier hs-type">monitorLocalThreatModel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span id="monitorLocalThreatModel"><span class="annot"><span class="annottext">monitorLocalThreatModel :: (Property -&gt; Property) -&gt; ThreatModel ()
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#monitorLocalThreatModel"><span class="hs-identifier hs-var hs-var">monitorLocalThreatModel</span></a></span></span><span> </span><span id="local-6989586621679451267"><span class="annot"><span class="annottext">Property -&gt; Property
</span><a href="#local-6989586621679451267"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; ThreatModel () -&gt; ThreatModel ()
forall a. (Property -&gt; Property) -&gt; ThreatModel a -&gt; ThreatModel a
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#MonitorLocal"><span class="hs-identifier hs-var">MonitorLocal</span></a></span><span> </span><span class="annot"><span class="annottext">Property -&gt; Property
</span><a href="#local-6989586621679451267"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; ThreatModel ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span class="hs-comment">-- | Print the given string in case this threat model fails. Threat model counterpart of</span><span>
</span><span id="line-385"></span><span class="hs-comment">--   the QuickCheck `Test.QuickCheck.counterexample` function.</span><span>
</span><span id="line-386"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#counterexampleTM"><span class="hs-identifier hs-type">counterexampleTM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-387"></span><span id="counterexampleTM"><span class="annot"><span class="annottext">counterexampleTM :: String -&gt; ThreatModel ()
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#counterexampleTM"><span class="hs-identifier hs-var hs-var">counterexampleTM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; ThreatModel ()
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#monitorLocalThreatModel"><span class="hs-identifier hs-var">monitorLocalThreatModel</span></a></span><span> </span><span class="annot"><span class="annottext">((Property -&gt; Property) -&gt; ThreatModel ())
-&gt; (String -&gt; Property -&gt; Property) -&gt; String -&gt; ThreatModel ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Property -&gt; Property
forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span class="hs-comment">-- | Threat model counterpart of QuickCheck's `Test.QuickCheck.tabulate` function.</span><span>
</span><span id="line-390"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#tabulateTM"><span class="hs-identifier hs-type">tabulateTM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span id="tabulateTM"><span class="annot"><span class="annottext">tabulateTM :: String -&gt; [String] -&gt; ThreatModel ()
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#tabulateTM"><span class="hs-identifier hs-var hs-var">tabulateTM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; ThreatModel ()
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#monitorThreatModel"><span class="hs-identifier hs-var">monitorThreatModel</span></a></span><span> </span><span class="annot"><span class="annottext">((Property -&gt; Property) -&gt; ThreatModel ())
-&gt; ([String] -&gt; Property -&gt; Property) -&gt; [String] -&gt; ThreatModel ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([String] -&gt; Property -&gt; Property) -&gt; [String] -&gt; ThreatModel ())
-&gt; (String -&gt; [String] -&gt; Property -&gt; Property)
-&gt; String
-&gt; [String]
-&gt; ThreatModel ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; Property -&gt; Property
forall prop.
Testable prop =&gt;
String -&gt; [String] -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">tabulate</span></span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="hs-comment">-- | Threat model counterpart of QuickCheck's `Test.QuickCheck.collect` function.</span><span>
</span><span id="line-394"></span><span id="local-6989586621679451266"><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#collectTM"><span class="hs-identifier hs-type">collectTM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451266"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679451266"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-395"></span><span id="collectTM"><span class="annot"><span class="annottext">collectTM :: a -&gt; ThreatModel ()
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#collectTM"><span class="hs-identifier hs-var hs-var">collectTM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; ThreatModel ()
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#monitorThreatModel"><span class="hs-identifier hs-var">monitorThreatModel</span></a></span><span> </span><span class="annot"><span class="annottext">((Property -&gt; Property) -&gt; ThreatModel ())
-&gt; (a -&gt; Property -&gt; Property) -&gt; a -&gt; ThreatModel ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Property -&gt; Property
forall a prop. (Show a, Testable prop) =&gt; a -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">collect</span></span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="hs-comment">-- | Threat model counterpart of QuickCheck's `Test.QuickCheck.classify` function.</span><span>
</span><span id="line-398"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#classifyTM"><span class="hs-identifier hs-type">classifyTM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.html#ThreatModel"><span class="hs-identifier hs-type">ThreatModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span id="classifyTM"><span class="annot"><span class="annottext">classifyTM :: Bool -&gt; String -&gt; ThreatModel ()
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#classifyTM"><span class="hs-identifier hs-var hs-var">classifyTM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; ThreatModel ()
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.html#monitorThreatModel"><span class="hs-identifier hs-var">monitorThreatModel</span></a></span><span> </span><span class="annot"><span class="annottext">((Property -&gt; Property) -&gt; ThreatModel ())
-&gt; (String -&gt; Property -&gt; Property) -&gt; String -&gt; ThreatModel ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((String -&gt; Property -&gt; Property) -&gt; String -&gt; ThreatModel ())
-&gt; (Bool -&gt; String -&gt; Property -&gt; Property)
-&gt; Bool
-&gt; String
-&gt; ThreatModel ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; Property -&gt; Property
forall prop. Testable prop =&gt; Bool -&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">classify</span></span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span></pre></body></html>