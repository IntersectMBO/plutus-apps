<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Api</span></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Api.Byron</span></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Api.Shelley</span></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Alonzo.Tx</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Data</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">hashData</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">indexOf</span></span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Alonzo.TxWitness</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Babbage.TxBody</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Crypto</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">StandardCrypto</span></span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Keys</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">coerceKeyRole</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">hashKey</span></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Shelley.TxBody</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Wdrl</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">WitVKey</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.ShelleyMA.Timelocks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ValidityInterval</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.TxIn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">txid</span></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Slotting.Slot</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">EpochSize</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">EpochSize</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Slotting.Time</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SlotLength</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mkSlotLength</span></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Cardano.Block</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CardanoEras</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.HardFork.History</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Util.Counting</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmptyOne</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PlutusTx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ToData</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">toData</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Alonzo.Scripts</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Either</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe.Strict</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence.Strict</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Seq</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Time.Clock.POSIX</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">posixSecondsToUTCTime</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Word</span></a></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html"><span class="hs-identifier">Test.QuickCheck.ContractModel.Internal.Common</span></a></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span id="local-6989586621679449726"><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#addressOfTxOut"><span class="hs-identifier hs-type">addressOfTxOut</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span class="annot"><a href="#local-6989586621679449726"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AddressAny</span></span></span><span>
</span><span id="line-33"></span><span id="addressOfTxOut"><span class="annot"><span class="annottext">addressOfTxOut :: TxOut ctx Era -&gt; AddressAny
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#addressOfTxOut"><span class="hs-identifier hs-var hs-var">addressOfTxOut</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AddressInEra</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ShelleyAddressInEra</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span id="local-6989586621679449721"><span class="annot"><span class="annottext">Address addrtype
</span><a href="#local-6989586621679449721"><span class="hs-identifier hs-var">addr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxOutValue Era
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TxOutDatum ctx Era
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ReferenceScript Era
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Address ShelleyAddr -&gt; AddressAny
</span><span class="hs-identifier hs-var">AddressShelley</span></span><span> </span><span class="annot"><span class="annottext">Address addrtype
Address ShelleyAddr
</span><a href="#local-6989586621679449721"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-34"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#addressOfTxOut"><span class="hs-identifier hs-var">addressOfTxOut</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AddressInEra</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByronAddressInAnyEra</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span id="local-6989586621679449718"><span class="annot"><span class="annottext">Address addrtype
</span><a href="#local-6989586621679449718"><span class="hs-identifier hs-var">addr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxOutValue Era
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TxOutDatum ctx Era
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ReferenceScript Era
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Address ByronAddr -&gt; AddressAny
</span><span class="hs-identifier hs-var">AddressByron</span></span><span>   </span><span class="annot"><span class="annottext">Address addrtype
Address ByronAddr
</span><a href="#local-6989586621679449718"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span id="local-6989586621679449716"><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#valueOfTxOut"><span class="hs-identifier hs-type">valueOfTxOut</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span class="annot"><a href="#local-6989586621679449716"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span></span><span>
</span><span id="line-37"></span><span id="valueOfTxOut"><span class="annot"><span class="annottext">valueOfTxOut :: TxOut ctx Era -&gt; Value
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#valueOfTxOut"><span class="hs-identifier hs-var hs-var">valueOfTxOut</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span class="annot"><span class="annottext">AddressInEra Era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxOutAdaOnly</span></span><span> </span><span class="annot"><span class="annottext">OnlyAdaSupportedInEra Era
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679449713"><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679449713"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxOutDatum ctx Era
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ReferenceScript Era
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Value
</span><span class="hs-identifier hs-var">lovelaceToValue</span></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679449713"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-38"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#valueOfTxOut"><span class="hs-identifier hs-var">valueOfTxOut</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span class="annot"><span class="annottext">AddressInEra Era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxOutValue</span></span><span> </span><span class="annot"><span class="annottext">MultiAssetSupportedInEra Era
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679449710"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679449710"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxOutDatum ctx Era
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ReferenceScript Era
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679449710"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-comment">-- | Get the datum from a transaction output.</span><span>
</span><span id="line-41"></span><span id="local-6989586621679449709"><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#datumOfTxOut"><span class="hs-identifier hs-type">datumOfTxOut</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span class="annot"><a href="#local-6989586621679449709"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutDatum</span></span><span> </span><span class="annot"><a href="#local-6989586621679449709"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span></span><span>
</span><span id="line-42"></span><span id="datumOfTxOut"><span class="annot"><span class="annottext">datumOfTxOut :: TxOut ctx Era -&gt; TxOutDatum ctx Era
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#datumOfTxOut"><span class="hs-identifier hs-var hs-var">datumOfTxOut</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span class="annot"><span class="annottext">AddressInEra Era
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TxOutValue Era
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679449707"><span class="annot"><span class="annottext">TxOutDatum ctx Era
</span><a href="#local-6989586621679449707"><span class="hs-identifier hs-var">datum</span></a></span></span><span> </span><span class="annot"><span class="annottext">ReferenceScript Era
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOutDatum ctx Era
</span><a href="#local-6989586621679449707"><span class="hs-identifier hs-var">datum</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#redeemerOfTxIn"><span class="hs-identifier hs-type">redeemerOfTxIn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxIn</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScriptData</span></span><span>
</span><span id="line-45"></span><span id="redeemerOfTxIn"><span class="annot"><span class="annottext">redeemerOfTxIn :: Tx Era -&gt; TxIn -&gt; Maybe ScriptData
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#redeemerOfTxIn"><span class="hs-identifier hs-var hs-var">redeemerOfTxIn</span></a></span></span><span> </span><span id="local-6989586621679449705"><span class="annot"><span class="annottext">Tx Era
</span><a href="#local-6989586621679449705"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span id="local-6989586621679449704"><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679449704"><span class="hs-identifier hs-var">txIn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ScriptData
</span><a href="#local-6989586621679449703"><span class="hs-identifier hs-var">redeemer</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ShelleyTxBody</span></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra Era
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.TxBody</span></span><span class="hs-special">{</span><span class="annot"><span class="hs-identifier hs-var">Ledger.inputs</span></span><span class="hs-glyph">=</span><span id="local-6989586621679449698"><span class="annot"><a href="#local-6989586621679449698"><span class="hs-identifier hs-var">inputs</span></a></span></span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">[Script (ShelleyLedgerEra Era)]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679449697"><span class="annot"><span class="annottext">TxBodyScriptData Era
</span><a href="#local-6989586621679449697"><span class="hs-identifier hs-var">scriptData</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (AuxiliaryData (ShelleyLedgerEra Era))
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TxScriptValidity Era
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[KeyWitness Era]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tx Era
</span><a href="#local-6989586621679449705"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span>    </span><span id="local-6989586621679449703"><span class="annot"><span class="annottext">redeemer :: Maybe ScriptData
</span><a href="#local-6989586621679449703"><span class="hs-identifier hs-var hs-var">redeemer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxBodyScriptData Era
</span><a href="#local-6989586621679449697"><span class="hs-identifier hs-var">scriptData</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-50"></span><span>      </span><span class="annot"><span class="annottext">TxBodyScriptData Era
</span><span class="hs-identifier hs-var">TxBodyNoScriptData</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ScriptData
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-51"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">TxBodyScriptData</span></span><span> </span><span class="annot"><span class="annottext">ScriptDataSupportedInEra Era
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TxDats (ShelleyLedgerEra Era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.Redeemers</span></span><span> </span><span id="local-6989586621679449693"><span class="annot"><a href="#local-6989586621679449693"><span class="hs-identifier hs-var">rdmrs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-52"></span><span>        </span><span class="annot"><span class="annottext">Data StandardBabbage -&gt; ScriptData
forall ledgerera. Data ledgerera -&gt; ScriptData
</span><span class="hs-identifier hs-var">fromAlonzoData</span></span><span> </span><span class="annot"><span class="annottext">(Data StandardBabbage -&gt; ScriptData)
-&gt; ((Data StandardBabbage, ExUnits) -&gt; Data StandardBabbage)
-&gt; (Data StandardBabbage, ExUnits)
-&gt; ScriptData
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Data StandardBabbage, ExUnits) -&gt; Data StandardBabbage
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((Data StandardBabbage, ExUnits) -&gt; ScriptData)
-&gt; Maybe (Data StandardBabbage, ExUnits) -&gt; Maybe ScriptData
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">RdmrPtr
-&gt; Map RdmrPtr (Data StandardBabbage, ExUnits)
-&gt; Maybe (Data StandardBabbage, ExUnits)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tag -&gt; Word64 -&gt; RdmrPtr
</span><span class="hs-identifier hs-var">Ledger.RdmrPtr</span></span><span> </span><span class="annot"><span class="annottext">Tag
</span><span class="hs-identifier hs-var">Ledger.Spend</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679449686"><span class="hs-identifier hs-var">idx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map RdmrPtr (Data StandardBabbage, ExUnits)
</span><a href="#local-6989586621679449693"><span class="hs-identifier hs-var">rdmrs</span></a></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span>    </span><span id="local-6989586621679449686"><span class="annot"><span class="annottext">idx :: Word64
</span><a href="#local-6989586621679449686"><span class="hs-identifier hs-var hs-var">idx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxIn StandardCrypto
-&gt; Set (TxIn StandardCrypto) -&gt; StrictMaybe Word64
forall elem container.
Indexable elem container =&gt;
elem -&gt; container -&gt; StrictMaybe Word64
</span><span class="hs-identifier hs-var">Ledger.indexOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn -&gt; TxIn StandardCrypto
</span><span class="hs-identifier hs-var">toShelleyTxIn</span></span><span> </span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679449704"><span class="hs-identifier hs-var">txIn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set (TxIn StandardCrypto)
Set (TxIn (Crypto StandardBabbage))
</span><a href="#local-6989586621679449698"><span class="hs-identifier hs-var">inputs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-55"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">SJust</span></span><span> </span><span id="local-6989586621679449683"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679449683"><span class="hs-identifier hs-var">idx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679449683"><span class="hs-identifier hs-var">idx</span></a></span><span>
</span><span id="line-56"></span><span>      </span><span class="annot"><span class="annottext">StrictMaybe Word64
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Word64
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;The impossible happened!&quot;</span></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#paymentCredentialToAddressAny"><span class="hs-identifier hs-type">paymentCredentialToAddressAny</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PaymentCredential</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AddressAny</span></span><span>
</span><span id="line-59"></span><span id="paymentCredentialToAddressAny"><span class="annot"><span class="annottext">paymentCredentialToAddressAny :: PaymentCredential -&gt; AddressAny
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#paymentCredentialToAddressAny"><span class="hs-identifier hs-var hs-var">paymentCredentialToAddressAny</span></a></span></span><span> </span><span id="local-6989586621679449680"><span class="annot"><span class="annottext">PaymentCredential
</span><a href="#local-6989586621679449680"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-60"></span><span>  </span><span class="annot"><span class="annottext">Address ShelleyAddr -&gt; AddressAny
</span><span class="hs-identifier hs-var">AddressShelley</span></span><span> </span><span class="annot"><span class="annottext">(Address ShelleyAddr -&gt; AddressAny)
-&gt; Address ShelleyAddr -&gt; AddressAny
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
-&gt; PaymentCredential
-&gt; StakeAddressReference
-&gt; Address ShelleyAddr
</span><span class="hs-identifier hs-var">makeShelleyAddress</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NetworkMagic -&gt; NetworkId
</span><span class="hs-identifier hs-var">Testnet</span></span><span> </span><span class="annot"><span class="annottext">(NetworkMagic -&gt; NetworkId) -&gt; NetworkMagic -&gt; NetworkId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; NetworkMagic
</span><span class="hs-identifier hs-var">NetworkMagic</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PaymentCredential
</span><a href="#local-6989586621679449680"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">StakeAddressReference
</span><span class="hs-identifier hs-var">NoStakeAddress</span></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-comment">-- | Construct a script address.</span><span>
</span><span id="line-63"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#scriptAddressAny"><span class="hs-identifier hs-type">scriptAddressAny</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScriptHash</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AddressAny</span></span><span>
</span><span id="line-64"></span><span id="scriptAddressAny"><span class="annot"><span class="annottext">scriptAddressAny :: ScriptHash -&gt; AddressAny
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#scriptAddressAny"><span class="hs-identifier hs-var hs-var">scriptAddressAny</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PaymentCredential -&gt; AddressAny
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#paymentCredentialToAddressAny"><span class="hs-identifier hs-var">paymentCredentialToAddressAny</span></a></span><span> </span><span class="annot"><span class="annottext">(PaymentCredential -&gt; AddressAny)
-&gt; (ScriptHash -&gt; PaymentCredential) -&gt; ScriptHash -&gt; AddressAny
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptHash -&gt; PaymentCredential
</span><span class="hs-identifier hs-var">PaymentCredentialByScript</span></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-comment">-- | Construct a public key address.</span><span>
</span><span id="line-67"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#keyAddressAny"><span class="hs-identifier hs-type">keyAddressAny</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Hash</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PaymentKey</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AddressAny</span></span><span>
</span><span id="line-68"></span><span id="keyAddressAny"><span class="annot"><span class="annottext">keyAddressAny :: Hash PaymentKey -&gt; AddressAny
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#keyAddressAny"><span class="hs-identifier hs-var hs-var">keyAddressAny</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PaymentCredential -&gt; AddressAny
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#paymentCredentialToAddressAny"><span class="hs-identifier hs-var">paymentCredentialToAddressAny</span></a></span><span> </span><span class="annot"><span class="annottext">(PaymentCredential -&gt; AddressAny)
-&gt; (Hash PaymentKey -&gt; PaymentCredential)
-&gt; Hash PaymentKey
-&gt; AddressAny
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Hash PaymentKey -&gt; PaymentCredential
</span><span class="hs-identifier hs-var">PaymentCredentialByKey</span></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-comment">-- | Check if an address is a public key address.</span><span>
</span><span id="line-71"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#isKeyAddressAny"><span class="hs-identifier hs-type">isKeyAddressAny</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AddressAny</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-72"></span><span id="isKeyAddressAny"><span class="annot"><span class="annottext">isKeyAddressAny :: AddressAny -&gt; Bool
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#isKeyAddressAny"><span class="hs-identifier hs-var hs-var">isKeyAddressAny</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddressInEra Era -&gt; Bool
forall era. AddressInEra era -&gt; Bool
</span><span class="hs-identifier hs-var">isKeyAddress</span></span><span> </span><span class="annot"><span class="annottext">(AddressInEra Era -&gt; Bool)
-&gt; (AddressAny -&gt; AddressInEra Era) -&gt; AddressAny -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsShelleyBasedEra Era =&gt; AddressAny -&gt; AddressInEra Era
forall era. IsShelleyBasedEra era =&gt; AddressAny -&gt; AddressInEra era
</span><span class="hs-identifier hs-var">anyAddressInShelleyBasedEra</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#recomputeScriptData"><span class="hs-identifier hs-type">recomputeScriptData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-comment">-- Index to remove</span><span>
</span><span id="line-75"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxBodyScriptData</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span>
</span><span id="line-77"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxBodyScriptData</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span>
</span><span id="line-78"></span><span id="recomputeScriptData"><span class="annot"><span class="annottext">recomputeScriptData :: Maybe Word64
-&gt; (Word64 -&gt; Word64)
-&gt; TxBodyScriptData Era
-&gt; TxBodyScriptData Era
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#recomputeScriptData"><span class="hs-identifier hs-var hs-var">recomputeScriptData</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Word64
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TxBodyScriptData Era
</span><span class="hs-identifier hs-var">TxBodyNoScriptData</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxBodyScriptData Era
forall era. TxBodyScriptData era
</span><span class="hs-identifier hs-var">TxBodyNoScriptData</span></span><span>
</span><span id="line-79"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#recomputeScriptData"><span class="hs-identifier hs-var">recomputeScriptData</span></a></span><span> </span><span id="local-6989586621679449667"><span class="annot"><span class="annottext">Maybe Word64
</span><a href="#local-6989586621679449667"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679449666"><span class="annot"><span class="annottext">Word64 -&gt; Word64
</span><a href="#local-6989586621679449666"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxBodyScriptData</span></span><span> </span><span id="local-6989586621679449665"><span class="annot"><span class="annottext">ScriptDataSupportedInEra Era
</span><a href="#local-6989586621679449665"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span id="local-6989586621679449664"><span class="annot"><span class="annottext">TxDats (ShelleyLedgerEra Era)
</span><a href="#local-6989586621679449664"><span class="hs-identifier hs-var">dats</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.Redeemers</span></span><span> </span><span id="local-6989586621679449663"><span class="annot"><a href="#local-6989586621679449663"><span class="hs-identifier hs-var">rdmrs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-80"></span><span>  </span><span class="annot"><span class="annottext">ScriptDataSupportedInEra Era
-&gt; TxDats (ShelleyLedgerEra Era)
-&gt; Redeemers (ShelleyLedgerEra Era)
-&gt; TxBodyScriptData Era
forall era.
ScriptDataSupportedInEra era
-&gt; TxDats (ShelleyLedgerEra era)
-&gt; Redeemers (ShelleyLedgerEra era)
-&gt; TxBodyScriptData era
</span><span class="hs-identifier hs-var">TxBodyScriptData</span></span><span> </span><span class="annot"><span class="annottext">ScriptDataSupportedInEra Era
</span><a href="#local-6989586621679449665"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="annot"><span class="annottext">TxDats (ShelleyLedgerEra Era)
</span><a href="#local-6989586621679449664"><span class="hs-identifier hs-var">dats</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map RdmrPtr (Data StandardBabbage, ExUnits)
-&gt; Redeemers StandardBabbage
forall era.
Era era =&gt;
Map RdmrPtr (Data era, ExUnits) -&gt; Redeemers era
</span><span class="hs-identifier hs-var">Ledger.Redeemers</span></span><span> </span><span class="annot"><span class="annottext">(Map RdmrPtr (Data StandardBabbage, ExUnits)
 -&gt; Redeemers StandardBabbage)
-&gt; Map RdmrPtr (Data StandardBabbage, ExUnits)
-&gt; Redeemers StandardBabbage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(RdmrPtr -&gt; RdmrPtr)
-&gt; Map RdmrPtr (Data StandardBabbage, ExUnits)
-&gt; Map RdmrPtr (Data StandardBabbage, ExUnits)
forall k2 k1 a. Ord k2 =&gt; (k1 -&gt; k2) -&gt; Map k1 a -&gt; Map k2 a
</span><span class="hs-identifier hs-var">Map.mapKeys</span></span><span> </span><span class="annot"><span class="annottext">RdmrPtr -&gt; RdmrPtr
</span><a href="#local-6989586621679449661"><span class="hs-identifier hs-var">updatePtr</span></a></span><span> </span><span class="annot"><span class="annottext">(Map RdmrPtr (Data StandardBabbage, ExUnits)
 -&gt; Map RdmrPtr (Data StandardBabbage, ExUnits))
-&gt; Map RdmrPtr (Data StandardBabbage, ExUnits)
-&gt; Map RdmrPtr (Data StandardBabbage, ExUnits)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(RdmrPtr -&gt; (Data StandardBabbage, ExUnits) -&gt; Bool)
-&gt; Map RdmrPtr (Data StandardBabbage, ExUnits)
-&gt; Map RdmrPtr (Data StandardBabbage, ExUnits)
forall k a. (k -&gt; a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.filterWithKey</span></span><span> </span><span class="annot"><span class="annottext">RdmrPtr -&gt; (Data StandardBabbage, ExUnits) -&gt; Bool
</span><a href="#local-6989586621679449659"><span class="hs-identifier hs-var">idxFilter</span></a></span><span> </span><span class="annot"><span class="annottext">Map RdmrPtr (Data StandardBabbage, ExUnits)
</span><a href="#local-6989586621679449663"><span class="hs-identifier hs-var">rdmrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679449661"><span class="annot"><span class="annottext">updatePtr :: RdmrPtr -&gt; RdmrPtr
</span><a href="#local-6989586621679449661"><span class="hs-identifier hs-var hs-var">updatePtr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.RdmrPtr</span></span><span> </span><span id="local-6989586621679449658"><span class="annot"><span class="annottext">Tag
</span><a href="#local-6989586621679449658"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621679449657"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679449657"><span class="hs-identifier hs-var">idx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tag -&gt; Word64 -&gt; RdmrPtr
</span><span class="hs-identifier hs-var">Ledger.RdmrPtr</span></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="#local-6989586621679449658"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Word64
</span><a href="#local-6989586621679449666"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679449657"><span class="hs-identifier hs-var">idx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>        </span><span id="local-6989586621679449659"><span class="annot"><span class="annottext">idxFilter :: RdmrPtr -&gt; (Data StandardBabbage, ExUnits) -&gt; Bool
</span><a href="#local-6989586621679449659"><span class="hs-identifier hs-var hs-var">idxFilter</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.RdmrPtr</span></span><span> </span><span class="annot"><span class="annottext">Tag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679449656"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679449656"><span class="hs-identifier hs-var">idx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Data StandardBabbage, ExUnits)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Maybe Word64
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679449656"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Word64 -&gt; Maybe Word64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Word64
</span><a href="#local-6989586621679449667"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#emptyTxBodyScriptData"><span class="hs-identifier hs-type">emptyTxBodyScriptData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxBodyScriptData</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span>
</span><span id="line-86"></span><span id="emptyTxBodyScriptData"><span class="annot"><span class="annottext">emptyTxBodyScriptData :: TxBodyScriptData Era
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#emptyTxBodyScriptData"><span class="hs-identifier hs-var hs-var">emptyTxBodyScriptData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScriptDataSupportedInEra Era
-&gt; TxDats (ShelleyLedgerEra Era)
-&gt; Redeemers (ShelleyLedgerEra Era)
-&gt; TxBodyScriptData Era
forall era.
ScriptDataSupportedInEra era
-&gt; TxDats (ShelleyLedgerEra era)
-&gt; Redeemers (ShelleyLedgerEra era)
-&gt; TxBodyScriptData era
</span><span class="hs-identifier hs-var">TxBodyScriptData</span></span><span> </span><span class="annot"><span class="annottext">ScriptDataSupportedInEra Era
</span><span class="hs-identifier hs-var">ScriptDataInBabbageEra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (DataHash (Crypto StandardBabbage)) (Data StandardBabbage)
-&gt; TxDats StandardBabbage
forall era.
Typeable era =&gt;
Map (DataHash (Crypto era)) (Data era) -&gt; TxDats era
</span><span class="hs-identifier hs-var">Ledger.TxDats</span></span><span> </span><span class="annot"><span class="annottext">Map (DataHash (Crypto StandardBabbage)) (Data StandardBabbage)
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map RdmrPtr (Data StandardBabbage, ExUnits)
-&gt; Redeemers StandardBabbage
forall era.
Era era =&gt;
Map RdmrPtr (Data era, ExUnits) -&gt; Redeemers era
</span><span class="hs-identifier hs-var">Ledger.Redeemers</span></span><span> </span><span class="annot"><span class="annottext">Map RdmrPtr (Data StandardBabbage, ExUnits)
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#addScriptData"><span class="hs-identifier hs-type">addScriptData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-89"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Data</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ShelleyLedgerEra</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.Data</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ShelleyLedgerEra</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.ExUnits</span></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxBodyScriptData</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span>
</span><span id="line-92"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxBodyScriptData</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span>
</span><span id="line-93"></span><span id="addScriptData"><span class="annot"><span class="annottext">addScriptData :: Word64
-&gt; Data (ShelleyLedgerEra Era)
-&gt; (Data (ShelleyLedgerEra Era), ExUnits)
-&gt; TxBodyScriptData Era
-&gt; TxBodyScriptData Era
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#addScriptData"><span class="hs-identifier hs-var hs-var">addScriptData</span></a></span></span><span> </span><span id="local-6989586621679449650"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679449650"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span id="local-6989586621679449649"><span class="annot"><span class="annottext">Data (ShelleyLedgerEra Era)
</span><a href="#local-6989586621679449649"><span class="hs-identifier hs-var">dat</span></a></span></span><span> </span><span id="local-6989586621679449648"><span class="annot"><span class="annottext">(Data (ShelleyLedgerEra Era), ExUnits)
</span><a href="#local-6989586621679449648"><span class="hs-identifier hs-var">rdmr</span></a></span></span><span> </span><span class="annot"><span class="annottext">TxBodyScriptData Era
</span><span class="hs-identifier hs-var">TxBodyNoScriptData</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
-&gt; Data (ShelleyLedgerEra Era)
-&gt; (Data (ShelleyLedgerEra Era), ExUnits)
-&gt; TxBodyScriptData Era
-&gt; TxBodyScriptData Era
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#addScriptData"><span class="hs-identifier hs-var">addScriptData</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679449650"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="annot"><span class="annottext">Data (ShelleyLedgerEra Era)
</span><a href="#local-6989586621679449649"><span class="hs-identifier hs-var">dat</span></a></span><span> </span><span class="annot"><span class="annottext">(Data (ShelleyLedgerEra Era), ExUnits)
</span><a href="#local-6989586621679449648"><span class="hs-identifier hs-var">rdmr</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyScriptData Era
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#emptyTxBodyScriptData"><span class="hs-identifier hs-var">emptyTxBodyScriptData</span></a></span><span>
</span><span id="line-94"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#addScriptData"><span class="hs-identifier hs-var">addScriptData</span></a></span><span> </span><span id="local-6989586621679449647"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679449647"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span id="local-6989586621679449646"><span class="annot"><span class="annottext">Data (ShelleyLedgerEra Era)
</span><a href="#local-6989586621679449646"><span class="hs-identifier hs-var">dat</span></a></span></span><span> </span><span id="local-6989586621679449645"><span class="annot"><span class="annottext">(Data (ShelleyLedgerEra Era), ExUnits)
</span><a href="#local-6989586621679449645"><span class="hs-identifier hs-var">rdmr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxBodyScriptData</span></span><span> </span><span id="local-6989586621679449644"><span class="annot"><span class="annottext">ScriptDataSupportedInEra Era
</span><a href="#local-6989586621679449644"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.TxDats</span></span><span> </span><span id="local-6989586621679449643"><span class="annot"><a href="#local-6989586621679449643"><span class="hs-identifier hs-var">dats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.Redeemers</span></span><span> </span><span id="local-6989586621679449642"><span class="annot"><a href="#local-6989586621679449642"><span class="hs-identifier hs-var">rdmrs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-95"></span><span>  </span><span class="annot"><span class="annottext">ScriptDataSupportedInEra Era
-&gt; TxDats (ShelleyLedgerEra Era)
-&gt; Redeemers (ShelleyLedgerEra Era)
-&gt; TxBodyScriptData Era
forall era.
ScriptDataSupportedInEra era
-&gt; TxDats (ShelleyLedgerEra era)
-&gt; Redeemers (ShelleyLedgerEra era)
-&gt; TxBodyScriptData era
</span><span class="hs-identifier hs-var">TxBodyScriptData</span></span><span> </span><span class="annot"><span class="annottext">ScriptDataSupportedInEra Era
</span><a href="#local-6989586621679449644"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (DataHash (Crypto StandardBabbage)) (Data StandardBabbage)
-&gt; TxDats StandardBabbage
forall era.
Typeable era =&gt;
Map (DataHash (Crypto era)) (Data era) -&gt; TxDats era
</span><span class="hs-identifier hs-var">Ledger.TxDats</span></span><span> </span><span class="annot"><span class="annottext">(Map (DataHash (Crypto StandardBabbage)) (Data StandardBabbage)
 -&gt; TxDats StandardBabbage)
-&gt; Map (DataHash (Crypto StandardBabbage)) (Data StandardBabbage)
-&gt; TxDats StandardBabbage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DataHash StandardCrypto
-&gt; Data StandardBabbage
-&gt; Map (DataHash StandardCrypto) (Data StandardBabbage)
-&gt; Map (DataHash StandardCrypto) (Data StandardBabbage)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Data StandardBabbage -&gt; DataHash (Crypto StandardBabbage)
forall era. Era era =&gt; Data era -&gt; DataHash (Crypto era)
</span><span class="hs-identifier hs-var">Ledger.hashData</span></span><span> </span><span class="annot"><span class="annottext">Data (ShelleyLedgerEra Era)
Data StandardBabbage
</span><a href="#local-6989586621679449646"><span class="hs-identifier hs-var">dat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Data (ShelleyLedgerEra Era)
Data StandardBabbage
</span><a href="#local-6989586621679449646"><span class="hs-identifier hs-var">dat</span></a></span><span> </span><span class="annot"><span class="annottext">Map (DataHash StandardCrypto) (Data StandardBabbage)
Map (DataHash (Crypto StandardBabbage)) (Data StandardBabbage)
</span><a href="#local-6989586621679449643"><span class="hs-identifier hs-var">dats</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map RdmrPtr (Data StandardBabbage, ExUnits)
-&gt; Redeemers StandardBabbage
forall era.
Era era =&gt;
Map RdmrPtr (Data era, ExUnits) -&gt; Redeemers era
</span><span class="hs-identifier hs-var">Ledger.Redeemers</span></span><span> </span><span class="annot"><span class="annottext">(Map RdmrPtr (Data StandardBabbage, ExUnits)
 -&gt; Redeemers StandardBabbage)
-&gt; Map RdmrPtr (Data StandardBabbage, ExUnits)
-&gt; Redeemers StandardBabbage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RdmrPtr
-&gt; (Data StandardBabbage, ExUnits)
-&gt; Map RdmrPtr (Data StandardBabbage, ExUnits)
-&gt; Map RdmrPtr (Data StandardBabbage, ExUnits)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tag -&gt; Word64 -&gt; RdmrPtr
</span><span class="hs-identifier hs-var">Ledger.RdmrPtr</span></span><span> </span><span class="annot"><span class="annottext">Tag
</span><span class="hs-identifier hs-var">Ledger.Spend</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679449647"><span class="hs-identifier hs-var">ix</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Data (ShelleyLedgerEra Era), ExUnits)
(Data StandardBabbage, ExUnits)
</span><a href="#local-6989586621679449645"><span class="hs-identifier hs-var">rdmr</span></a></span><span> </span><span class="annot"><span class="annottext">Map RdmrPtr (Data StandardBabbage, ExUnits)
</span><a href="#local-6989586621679449642"><span class="hs-identifier hs-var">rdmrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#addDatum"><span class="hs-identifier hs-type">addDatum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Data</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ShelleyLedgerEra</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxBodyScriptData</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span>
</span><span id="line-100"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxBodyScriptData</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span>
</span><span id="line-101"></span><span id="addDatum"><span class="annot"><span class="annottext">addDatum :: Data (ShelleyLedgerEra Era)
-&gt; TxBodyScriptData Era -&gt; TxBodyScriptData Era
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#addDatum"><span class="hs-identifier hs-var hs-var">addDatum</span></a></span></span><span> </span><span id="local-6989586621679449639"><span class="annot"><span class="annottext">Data (ShelleyLedgerEra Era)
</span><a href="#local-6989586621679449639"><span class="hs-identifier hs-var">dat</span></a></span></span><span> </span><span class="annot"><span class="annottext">TxBodyScriptData Era
</span><span class="hs-identifier hs-var">TxBodyNoScriptData</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Data (ShelleyLedgerEra Era)
-&gt; TxBodyScriptData Era -&gt; TxBodyScriptData Era
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#addDatum"><span class="hs-identifier hs-var">addDatum</span></a></span><span> </span><span class="annot"><span class="annottext">Data (ShelleyLedgerEra Era)
</span><a href="#local-6989586621679449639"><span class="hs-identifier hs-var">dat</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyScriptData Era
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#emptyTxBodyScriptData"><span class="hs-identifier hs-var">emptyTxBodyScriptData</span></a></span><span>
</span><span id="line-102"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#addDatum"><span class="hs-identifier hs-var">addDatum</span></a></span><span> </span><span id="local-6989586621679449638"><span class="annot"><span class="annottext">Data (ShelleyLedgerEra Era)
</span><a href="#local-6989586621679449638"><span class="hs-identifier hs-var">dat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxBodyScriptData</span></span><span> </span><span id="local-6989586621679449637"><span class="annot"><span class="annottext">ScriptDataSupportedInEra Era
</span><a href="#local-6989586621679449637"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.TxDats</span></span><span> </span><span id="local-6989586621679449636"><span class="annot"><a href="#local-6989586621679449636"><span class="hs-identifier hs-var">dats</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679449635"><span class="annot"><span class="annottext">Redeemers (ShelleyLedgerEra Era)
</span><a href="#local-6989586621679449635"><span class="hs-identifier hs-var">rdmrs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><span class="annottext">ScriptDataSupportedInEra Era
-&gt; TxDats (ShelleyLedgerEra Era)
-&gt; Redeemers (ShelleyLedgerEra Era)
-&gt; TxBodyScriptData Era
forall era.
ScriptDataSupportedInEra era
-&gt; TxDats (ShelleyLedgerEra era)
-&gt; Redeemers (ShelleyLedgerEra era)
-&gt; TxBodyScriptData era
</span><span class="hs-identifier hs-var">TxBodyScriptData</span></span><span> </span><span class="annot"><span class="annottext">ScriptDataSupportedInEra Era
</span><a href="#local-6989586621679449637"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (DataHash (Crypto StandardBabbage)) (Data StandardBabbage)
-&gt; TxDats StandardBabbage
forall era.
Typeable era =&gt;
Map (DataHash (Crypto era)) (Data era) -&gt; TxDats era
</span><span class="hs-identifier hs-var">Ledger.TxDats</span></span><span> </span><span class="annot"><span class="annottext">(Map (DataHash (Crypto StandardBabbage)) (Data StandardBabbage)
 -&gt; TxDats StandardBabbage)
-&gt; Map (DataHash (Crypto StandardBabbage)) (Data StandardBabbage)
-&gt; TxDats StandardBabbage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DataHash StandardCrypto
-&gt; Data StandardBabbage
-&gt; Map (DataHash StandardCrypto) (Data StandardBabbage)
-&gt; Map (DataHash StandardCrypto) (Data StandardBabbage)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Data StandardBabbage -&gt; DataHash (Crypto StandardBabbage)
forall era. Era era =&gt; Data era -&gt; DataHash (Crypto era)
</span><span class="hs-identifier hs-var">Ledger.hashData</span></span><span> </span><span class="annot"><span class="annottext">Data (ShelleyLedgerEra Era)
Data StandardBabbage
</span><a href="#local-6989586621679449638"><span class="hs-identifier hs-var">dat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Data (ShelleyLedgerEra Era)
Data StandardBabbage
</span><a href="#local-6989586621679449638"><span class="hs-identifier hs-var">dat</span></a></span><span> </span><span class="annot"><span class="annottext">Map (DataHash StandardCrypto) (Data StandardBabbage)
Map (DataHash (Crypto StandardBabbage)) (Data StandardBabbage)
</span><a href="#local-6989586621679449636"><span class="hs-identifier hs-var">dats</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>                       </span><span class="annot"><span class="annottext">Redeemers (ShelleyLedgerEra Era)
</span><a href="#local-6989586621679449635"><span class="hs-identifier hs-var">rdmrs</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#toCtxUTxODatum"><span class="hs-identifier hs-type">toCtxUTxODatum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutDatum</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CtxTx</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutDatum</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CtxUTxO</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span>
</span><span id="line-107"></span><span id="toCtxUTxODatum"><span class="annot"><span class="annottext">toCtxUTxODatum :: TxOutDatum CtxTx Era -&gt; TxOutDatum CtxUTxO Era
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#toCtxUTxODatum"><span class="hs-identifier hs-var hs-var">toCtxUTxODatum</span></a></span></span><span> </span><span id="local-6989586621679449633"><span class="annot"><span class="annottext">TxOutDatum CtxTx Era
</span><a href="#local-6989586621679449633"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxOutDatum CtxTx Era
</span><a href="#local-6989586621679449633"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><span class="annottext">TxOutDatum CtxTx Era
</span><span class="hs-identifier hs-var">TxOutDatumNone</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxOutDatum CtxUTxO Era
forall ctx era. TxOutDatum ctx era
</span><span class="hs-identifier hs-var">TxOutDatumNone</span></span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">TxOutDatumHash</span></span><span> </span><span id="local-6989586621679449630"><span class="annot"><span class="annottext">ScriptDataSupportedInEra Era
</span><a href="#local-6989586621679449630"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679449629"><span class="annot"><span class="annottext">Hash ScriptData
</span><a href="#local-6989586621679449629"><span class="hs-identifier hs-var">h</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ScriptDataSupportedInEra Era
-&gt; Hash ScriptData -&gt; TxOutDatum CtxUTxO Era
forall era ctx.
ScriptDataSupportedInEra era
-&gt; Hash ScriptData -&gt; TxOutDatum ctx era
</span><span class="hs-identifier hs-var">TxOutDatumHash</span></span><span> </span><span class="annot"><span class="annottext">ScriptDataSupportedInEra Era
</span><a href="#local-6989586621679449630"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Hash ScriptData
</span><a href="#local-6989586621679449629"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">TxOutDatumInTx</span></span><span> </span><span id="local-6989586621679449627"><span class="annot"><span class="annottext">ScriptDataSupportedInEra Era
</span><a href="#local-6989586621679449627"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679449626"><span class="annot"><span class="annottext">ScriptData
</span><a href="#local-6989586621679449626"><span class="hs-identifier hs-var">d</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ScriptDataSupportedInEra Era
-&gt; Hash ScriptData -&gt; TxOutDatum CtxUTxO Era
forall era ctx.
ScriptDataSupportedInEra era
-&gt; Hash ScriptData -&gt; TxOutDatum ctx era
</span><span class="hs-identifier hs-var">TxOutDatumHash</span></span><span> </span><span class="annot"><span class="annottext">ScriptDataSupportedInEra Era
</span><a href="#local-6989586621679449627"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScriptData -&gt; Hash ScriptData
</span><span class="hs-identifier hs-var">hashScriptData</span></span><span> </span><span class="annot"><span class="annottext">ScriptData
</span><a href="#local-6989586621679449626"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">TxOutDatumInline</span></span><span> </span><span id="local-6989586621679449623"><span class="annot"><span class="annottext">ReferenceTxInsScriptsInlineDatumsSupportedInEra Era
</span><a href="#local-6989586621679449623"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679449622"><span class="annot"><span class="annottext">ScriptData
</span><a href="#local-6989586621679449622"><span class="hs-identifier hs-var">sd</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ReferenceTxInsScriptsInlineDatumsSupportedInEra Era
-&gt; ScriptData -&gt; TxOutDatum CtxUTxO Era
forall era ctx.
ReferenceTxInsScriptsInlineDatumsSupportedInEra era
-&gt; ScriptData -&gt; TxOutDatum ctx era
</span><span class="hs-identifier hs-var">TxOutDatumInline</span></span><span> </span><span class="annot"><span class="annottext">ReferenceTxInsScriptsInlineDatumsSupportedInEra Era
</span><a href="#local-6989586621679449623"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptData
</span><a href="#local-6989586621679449622"><span class="hs-identifier hs-var">sd</span></a></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">-- | Convert ScriptData to a `Test.QuickCheck.ContractModel.ThreatModel.Datum`.</span><span>
</span><span id="line-114"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#txOutDatum"><span class="hs-identifier hs-type">txOutDatum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScriptData</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutDatum</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CtxTx</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span>
</span><span id="line-115"></span><span id="txOutDatum"><span class="annot"><span class="annottext">txOutDatum :: ScriptData -&gt; TxOutDatum CtxTx Era
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#txOutDatum"><span class="hs-identifier hs-var hs-var">txOutDatum</span></a></span></span><span> </span><span id="local-6989586621679449620"><span class="annot"><span class="annottext">ScriptData
</span><a href="#local-6989586621679449620"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScriptDataSupportedInEra Era -&gt; ScriptData -&gt; TxOutDatum CtxTx Era
forall era.
ScriptDataSupportedInEra era -&gt; ScriptData -&gt; TxOutDatum CtxTx era
</span><span class="hs-identifier hs-var">TxOutDatumInTx</span></span><span> </span><span class="annot"><span class="annottext">ScriptDataSupportedInEra Era
</span><span class="hs-identifier hs-var">ScriptDataInBabbageEra</span></span><span> </span><span class="annot"><span class="annottext">ScriptData
</span><a href="#local-6989586621679449620"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-comment">-- | Convert a Haskell value to ScriptData for use as a</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- `Test.QuickCheck.ContractModel.ThreatModel.Redeemer` or convert to a</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- `Test.QuickCheck.ContractModel.ThreatModel.Datum` with `txOutDatum`.</span><span>
</span><span id="line-120"></span><span id="local-6989586621679449619"><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#toScriptData"><span class="hs-identifier hs-type">toScriptData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToData</span></span><span> </span><span class="annot"><a href="#local-6989586621679449619"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679449619"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScriptData</span></span></span><span>
</span><span id="line-121"></span><span id="toScriptData"><span class="annot"><span class="annottext">toScriptData :: a -&gt; ScriptData
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#toScriptData"><span class="hs-identifier hs-var hs-var">toScriptData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Data -&gt; ScriptData
</span><span class="hs-identifier hs-var">fromPlutusData</span></span><span> </span><span class="annot"><span class="annottext">(Data -&gt; ScriptData) -&gt; (a -&gt; Data) -&gt; a -&gt; ScriptData
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Data
forall a. ToData a =&gt; a -&gt; Data
</span><span class="hs-identifier hs-var">toData</span></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="hs-comment">-- | Used for new inputs.</span><span>
</span><span id="line-124"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#dummyTxId"><span class="hs-identifier hs-type">dummyTxId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxId</span></span><span>
</span><span id="line-125"></span><span id="dummyTxId"><span class="annot"><span class="annottext">dummyTxId :: TxId
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#dummyTxId"><span class="hs-identifier hs-var hs-var">dummyTxId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-126"></span><span>  </span><span class="annot"><span class="annottext">TxId StandardCrypto -&gt; TxId
</span><span class="hs-identifier hs-var">fromShelleyTxId</span></span><span>
</span><span id="line-127"></span><span>  </span><span class="annot"><span class="annottext">(TxId StandardCrypto -&gt; TxId) -&gt; TxId StandardCrypto -&gt; TxId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall c.
(HashAlgorithm (HASH c),
 HashAnnotated
   (TxBody (ShelleyLedgerEra Era)) EraIndependentTxBody c) =&gt;
TxBody (ShelleyLedgerEra Era) -&gt; TxId c
forall era c.
(HashAlgorithm (HASH c),
 HashAnnotated (TxBody era) EraIndependentTxBody c) =&gt;
TxBody era -&gt; TxId c
</span><span class="hs-identifier hs-var">txid</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#LedgerEra"><span class="hs-identifier hs-type">LedgerEra</span></a></span><span>
</span><span id="line-128"></span><span>  </span><span class="annot"><span class="annottext">(TxBody (ShelleyLedgerEra Era) -&gt; TxId StandardCrypto)
-&gt; TxBody (ShelleyLedgerEra Era) -&gt; TxId StandardCrypto
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Set (TxIn (Crypto (ShelleyLedgerEra Era)))
-&gt; Set (TxIn (Crypto (ShelleyLedgerEra Era)))
-&gt; Set (TxIn (Crypto (ShelleyLedgerEra Era)))
-&gt; StrictSeq (Sized (TxOut (ShelleyLedgerEra Era)))
-&gt; StrictMaybe (Sized (TxOut (ShelleyLedgerEra Era)))
-&gt; StrictMaybe Coin
-&gt; StrictSeq (DCert (Crypto (ShelleyLedgerEra Era)))
-&gt; Wdrl (Crypto (ShelleyLedgerEra Era))
-&gt; Coin
-&gt; ValidityInterval
-&gt; StrictMaybe (Update (ShelleyLedgerEra Era))
-&gt; Set (KeyHash 'Witness (Crypto (ShelleyLedgerEra Era)))
-&gt; Value (Crypto (ShelleyLedgerEra Era))
-&gt; StrictMaybe
     (ScriptIntegrityHash (Crypto (ShelleyLedgerEra Era)))
-&gt; StrictMaybe (AuxiliaryDataHash (Crypto (ShelleyLedgerEra Era)))
-&gt; StrictMaybe Network
-&gt; TxBody (ShelleyLedgerEra Era)
forall era.
BabbageBody era =&gt;
Set (TxIn (Crypto era))
-&gt; Set (TxIn (Crypto era))
-&gt; Set (TxIn (Crypto era))
-&gt; StrictSeq (Sized (TxOut era))
-&gt; StrictMaybe (Sized (TxOut era))
-&gt; StrictMaybe Coin
-&gt; StrictSeq (DCert (Crypto era))
-&gt; Wdrl (Crypto era)
-&gt; Coin
-&gt; ValidityInterval
-&gt; StrictMaybe (Update era)
-&gt; Set (KeyHash 'Witness (Crypto era))
-&gt; Value (Crypto era)
-&gt; StrictMaybe (ScriptIntegrityHash (Crypto era))
-&gt; StrictMaybe (AuxiliaryDataHash (Crypto era))
-&gt; StrictMaybe Network
-&gt; TxBody era
</span><span class="hs-identifier hs-var">Ledger.TxBody</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#LedgerEra"><span class="hs-identifier hs-type">LedgerEra</span></a></span><span>
</span><span id="line-129"></span><span>      </span><span class="annot"><span class="annottext">Set (TxIn (Crypto (ShelleyLedgerEra Era)))
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-130"></span><span>      </span><span class="annot"><span class="annottext">Set (TxIn (Crypto (ShelleyLedgerEra Era)))
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-131"></span><span>      </span><span class="annot"><span class="annottext">Set (TxIn (Crypto (ShelleyLedgerEra Era)))
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-132"></span><span>      </span><span class="annot"><span class="annottext">StrictSeq (Sized (TxOut (ShelleyLedgerEra Era)))
forall a. StrictSeq a
</span><span class="hs-identifier hs-var">Seq.empty</span></span><span>
</span><span id="line-133"></span><span>      </span><span class="annot"><span class="annottext">StrictMaybe (Sized (TxOut (ShelleyLedgerEra Era)))
forall a. StrictMaybe a
</span><span class="hs-identifier hs-var">SNothing</span></span><span>
</span><span id="line-134"></span><span>      </span><span class="annot"><span class="annottext">StrictMaybe Coin
forall a. StrictMaybe a
</span><span class="hs-identifier hs-var">SNothing</span></span><span>
</span><span id="line-135"></span><span>      </span><span class="annot"><span class="annottext">StrictSeq (DCert (Crypto (ShelleyLedgerEra Era)))
forall a. StrictSeq a
</span><span class="hs-identifier hs-var">Seq.empty</span></span><span>
</span><span id="line-136"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (RewardAcnt StandardCrypto) Coin -&gt; Wdrl StandardCrypto
forall crypto. Map (RewardAcnt crypto) Coin -&gt; Wdrl crypto
</span><span class="hs-identifier hs-var">Wdrl</span></span><span> </span><span class="annot"><span class="annottext">Map (RewardAcnt StandardCrypto) Coin
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>      </span><span class="annot"><span class="annottext">Coin
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-138"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StrictMaybe SlotNo -&gt; StrictMaybe SlotNo -&gt; ValidityInterval
</span><span class="hs-identifier hs-var">ValidityInterval</span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe SlotNo
forall a. StrictMaybe a
</span><span class="hs-identifier hs-var">SNothing</span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe SlotNo
forall a. StrictMaybe a
</span><span class="hs-identifier hs-var">SNothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>      </span><span class="annot"><span class="annottext">StrictMaybe (Update (ShelleyLedgerEra Era))
forall a. StrictMaybe a
</span><span class="hs-identifier hs-var">SNothing</span></span><span>
</span><span id="line-140"></span><span>      </span><span class="annot"><span class="annottext">Set (KeyHash 'Witness (Crypto (ShelleyLedgerEra Era)))
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-141"></span><span>      </span><span class="annot"><span class="annottext">Value (Crypto (ShelleyLedgerEra Era))
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-142"></span><span>      </span><span class="annot"><span class="annottext">StrictMaybe (ScriptIntegrityHash (Crypto (ShelleyLedgerEra Era)))
forall a. StrictMaybe a
</span><span class="hs-identifier hs-var">SNothing</span></span><span>
</span><span id="line-143"></span><span>      </span><span class="annot"><span class="annottext">StrictMaybe (AuxiliaryDataHash (Crypto (ShelleyLedgerEra Era)))
forall a. StrictMaybe a
</span><span class="hs-identifier hs-var">SNothing</span></span><span>
</span><span id="line-144"></span><span>      </span><span class="annot"><span class="annottext">StrictMaybe Network
forall a. StrictMaybe a
</span><span class="hs-identifier hs-var">SNothing</span></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#makeTxOut"><span class="hs-identifier hs-type">makeTxOut</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AddressAny</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutDatum</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CtxTx</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReferenceScript</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CtxUTxO</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span>
</span><span id="line-147"></span><span id="makeTxOut"><span class="annot"><span class="annottext">makeTxOut :: AddressAny
-&gt; Value
-&gt; TxOutDatum CtxTx Era
-&gt; ReferenceScript Era
-&gt; TxOut CtxUTxO Era
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#makeTxOut"><span class="hs-identifier hs-var hs-var">makeTxOut</span></a></span></span><span> </span><span id="local-6989586621679449608"><span class="annot"><span class="annottext">AddressAny
</span><a href="#local-6989586621679449608"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621679449607"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679449607"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span id="local-6989586621679449606"><span class="annot"><span class="annottext">TxOutDatum CtxTx Era
</span><a href="#local-6989586621679449606"><span class="hs-identifier hs-var">datum</span></a></span></span><span> </span><span id="local-6989586621679449605"><span class="annot"><span class="annottext">ReferenceScript Era
</span><a href="#local-6989586621679449605"><span class="hs-identifier hs-var">refScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-148"></span><span>  </span><span class="annot"><span class="annottext">TxOut CtxTx Era -&gt; TxOut CtxUTxO Era
forall era. TxOut CtxTx era -&gt; TxOut CtxUTxO era
</span><span class="hs-identifier hs-var">toCtxUTxOTxOut</span></span><span> </span><span class="annot"><span class="annottext">(TxOut CtxTx Era -&gt; TxOut CtxUTxO Era)
-&gt; TxOut CtxTx Era -&gt; TxOut CtxUTxO Era
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AddressInEra Era
-&gt; TxOutValue Era
-&gt; TxOutDatum CtxTx Era
-&gt; ReferenceScript Era
-&gt; TxOut CtxTx Era
forall ctx era.
AddressInEra era
-&gt; TxOutValue era
-&gt; TxOutDatum ctx era
-&gt; ReferenceScript era
-&gt; TxOut ctx era
</span><span class="hs-identifier hs-var">TxOut</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddressAny -&gt; AddressInEra Era
forall era. IsShelleyBasedEra era =&gt; AddressAny -&gt; AddressInEra era
</span><span class="hs-identifier hs-var">anyAddressInShelleyBasedEra</span></span><span> </span><span class="annot"><span class="annottext">AddressAny
</span><a href="#local-6989586621679449608"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MultiAssetSupportedInEra Era -&gt; Value -&gt; TxOutValue Era
forall era. MultiAssetSupportedInEra era -&gt; Value -&gt; TxOutValue era
</span><span class="hs-identifier hs-var">TxOutValue</span></span><span> </span><span class="annot"><span class="annottext">MultiAssetSupportedInEra Era
</span><span class="hs-identifier hs-var">MultiAssetInBabbageEra</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679449607"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>                         </span><span class="annot"><span class="annottext">TxOutDatum CtxTx Era
</span><a href="#local-6989586621679449606"><span class="hs-identifier hs-var">datum</span></a></span><span>
</span><span id="line-151"></span><span>                         </span><span class="annot"><span class="annottext">ReferenceScript Era
</span><a href="#local-6989586621679449605"><span class="hs-identifier hs-var">refScript</span></a></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#txSigners"><span class="hs-identifier hs-type">txSigners</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Hash</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PaymentKey</span></span><span class="hs-special">]</span><span>
</span><span id="line-154"></span><span id="txSigners"><span class="annot"><span class="annottext">txSigners :: Tx Era -&gt; [Hash PaymentKey]
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#txSigners"><span class="hs-identifier hs-var hs-var">txSigners</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><span class="annottext">TxBody Era
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679449601"><span class="annot"><span class="annottext">[KeyWitness Era]
</span><a href="#local-6989586621679449601"><span class="hs-identifier hs-var">wits</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">VKey 'Witness StandardCrypto -&gt; Hash PaymentKey
forall (r :: KeyRole). VKey r StandardCrypto -&gt; Hash PaymentKey
</span><a href="#local-6989586621679449600"><span class="hs-identifier hs-var">toHash</span></a></span><span> </span><span class="annot"><span class="annottext">VKey 'Witness StandardCrypto
</span><a href="#local-6989586621679449599"><span class="hs-identifier hs-var">wit</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ShelleyKeyWitness</span></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra Era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WitVKey</span></span><span> </span><span id="local-6989586621679449599"><span class="annot"><span class="annottext">VKey 'Witness StandardCrypto
</span><a href="#local-6989586621679449599"><span class="hs-identifier hs-var">wit</span></a></span></span><span> </span><span class="annot"><span class="annottext">SignedDSIGN
  StandardCrypto (Hash StandardCrypto EraIndependentTxBody)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[KeyWitness Era]
</span><a href="#local-6989586621679449601"><span class="hs-identifier hs-var">wits</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-156"></span><span>    </span><span id="local-6989586621679449600"><span class="annot"><span class="annottext">toHash :: VKey r StandardCrypto -&gt; Hash PaymentKey
</span><a href="#local-6989586621679449600"><span class="hs-identifier hs-var hs-var">toHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyHash 'Payment StandardCrypto -&gt; Hash PaymentKey
</span><span class="hs-identifier hs-var">PaymentKeyHash</span></span><span>
</span><span id="line-157"></span><span>           </span><span class="annot"><span class="annottext">(KeyHash 'Payment StandardCrypto -&gt; Hash PaymentKey)
-&gt; (VKey r StandardCrypto -&gt; KeyHash 'Payment StandardCrypto)
-&gt; VKey r StandardCrypto
-&gt; Hash PaymentKey
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">VKey 'Payment StandardCrypto -&gt; KeyHash 'Payment StandardCrypto
forall crypto (kd :: KeyRole).
Crypto crypto =&gt;
VKey kd crypto -&gt; KeyHash kd crypto
</span><span class="hs-identifier hs-var">hashKey</span></span><span>
</span><span id="line-158"></span><span>           </span><span class="annot"><span class="annottext">(VKey 'Payment StandardCrypto -&gt; KeyHash 'Payment StandardCrypto)
-&gt; (VKey r StandardCrypto -&gt; VKey 'Payment StandardCrypto)
-&gt; VKey r StandardCrypto
-&gt; KeyHash 'Payment StandardCrypto
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">VKey r StandardCrypto -&gt; VKey 'Payment StandardCrypto
forall (a :: KeyRole -&gt; * -&gt; *) (r :: KeyRole) crypto
       (r' :: KeyRole).
HasKeyRole a =&gt;
a r crypto -&gt; a r' crypto
</span><span class="hs-identifier hs-var">coerceKeyRole</span></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#txInputs"><span class="hs-identifier hs-type">txInputs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TxIn</span></span><span class="hs-special">]</span><span>
</span><span id="line-161"></span><span id="txInputs"><span class="annot"><span class="annottext">txInputs :: Tx Era -&gt; [TxIn]
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#txInputs"><span class="hs-identifier hs-var hs-var">txInputs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxBody</span></span><span> </span><span id="local-6989586621679449593"><span class="annot"><span class="annottext">TxBodyContent ViewTx Era
</span><a href="#local-6989586621679449593"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[KeyWitness Era]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((TxIn, BuildTxWith ViewTx (Witness WitCtxTxIn Era)) -&gt; TxIn)
-&gt; [(TxIn, BuildTxWith ViewTx (Witness WitCtxTxIn Era))] -&gt; [TxIn]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(TxIn, BuildTxWith ViewTx (Witness WitCtxTxIn Era)) -&gt; TxIn
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">([(TxIn, BuildTxWith ViewTx (Witness WitCtxTxIn Era))] -&gt; [TxIn])
-&gt; [(TxIn, BuildTxWith ViewTx (Witness WitCtxTxIn Era))] -&gt; [TxIn]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyContent ViewTx Era
-&gt; [(TxIn, BuildTxWith ViewTx (Witness WitCtxTxIn Era))]
forall build era. TxBodyContent build era -&gt; TxIns build era
</span><span class="hs-identifier hs-var hs-var">txIns</span></span><span> </span><span class="annot"><span class="annottext">TxBodyContent ViewTx Era
</span><a href="#local-6989586621679449593"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#txOutputs"><span class="hs-identifier hs-type">txOutputs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CtxTx</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-164"></span><span id="txOutputs"><span class="annot"><span class="annottext">txOutputs :: Tx Era -&gt; [TxOut CtxTx Era]
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#txOutputs"><span class="hs-identifier hs-var hs-var">txOutputs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxBody</span></span><span> </span><span id="local-6989586621679449590"><span class="annot"><span class="annottext">TxBodyContent ViewTx Era
</span><a href="#local-6989586621679449590"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[KeyWitness Era]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxBodyContent ViewTx Era -&gt; [TxOut CtxTx Era]
forall build era. TxBodyContent build era -&gt; [TxOut CtxTx era]
</span><span class="hs-identifier hs-var hs-var">txOuts</span></span><span> </span><span class="annot"><span class="annottext">TxBodyContent ViewTx Era
</span><a href="#local-6989586621679449590"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-comment">-- | Check if a value is less or equal than another value.</span><span>
</span><span id="line-167"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#leqValue"><span class="hs-identifier hs-type">leqValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-168"></span><span id="leqValue"><span class="annot"><span class="annottext">leqValue :: Value -&gt; Value -&gt; Bool
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#leqValue"><span class="hs-identifier hs-var hs-var">leqValue</span></a></span></span><span> </span><span id="local-6989586621679449587"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679449587"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679449586"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679449586"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((AssetId, Quantity) -&gt; Bool) -&gt; [(AssetId, Quantity)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Quantity -&gt; Quantity -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Quantity
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Quantity -&gt; Bool)
-&gt; ((AssetId, Quantity) -&gt; Quantity) -&gt; (AssetId, Quantity) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(AssetId, Quantity) -&gt; Quantity
forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; [(AssetId, Quantity)]
</span><span class="hs-identifier hs-var">valueToList</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; [(AssetId, Quantity)]) -&gt; Value -&gt; [(AssetId, Quantity)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679449587"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; Value
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value
</span><span class="hs-identifier hs-var">negateValue</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679449586"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-comment">-- | Keep only the Ada part of a value.</span><span>
</span><span id="line-171"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#projectAda"><span class="hs-identifier hs-type">projectAda</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span>
</span><span id="line-172"></span><span id="projectAda"><span class="annot"><span class="annottext">projectAda :: Value -&gt; Value
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#projectAda"><span class="hs-identifier hs-var hs-var">projectAda</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Value
</span><span class="hs-identifier hs-var">lovelaceToValue</span></span><span> </span><span class="annot"><span class="annottext">(Lovelace -&gt; Value) -&gt; (Value -&gt; Lovelace) -&gt; Value -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Lovelace
</span><span class="hs-identifier hs-var">selectLovelace</span></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-comment">-- TODO: transactions can fail for different reasons. Sometimes they fail with</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- a &quot;translation error&quot;. Translation errors should probably be treated as test</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- failures not as validation failing - it's after all not validation failing!</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-comment">-- | The result of validating a transaction. In case of failure, it includes a list</span><span>
</span><span id="line-179"></span><span class="hs-comment">--   of reasons.</span><span>
</span><span id="line-180"></span><span class="hs-keyword">data</span><span> </span><span id="ValidityReport"><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#ValidityReport"><span class="hs-identifier hs-var">ValidityReport</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ValidityReport"><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#ValidityReport"><span class="hs-identifier hs-var">ValidityReport</span></a></span></span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="valid"><span class="annot"><span class="annottext">ValidityReport -&gt; Bool
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#valid"><span class="hs-identifier hs-var hs-var">valid</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="errors"><span class="annot"><span class="annottext">ValidityReport -&gt; [[Char]]
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#errors"><span class="hs-identifier hs-var hs-var">errors</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679449561"><span id="local-6989586621679449563"><span id="local-6989586621679449565"><span id="local-6989586621679449567"><span id="local-6989586621679449569"><span id="local-6989586621679449571"><span id="local-6989586621679449573"><span class="annot"><span class="annottext">Eq ValidityReport
Eq ValidityReport
-&gt; (ValidityReport -&gt; ValidityReport -&gt; Ordering)
-&gt; (ValidityReport -&gt; ValidityReport -&gt; Bool)
-&gt; (ValidityReport -&gt; ValidityReport -&gt; Bool)
-&gt; (ValidityReport -&gt; ValidityReport -&gt; Bool)
-&gt; (ValidityReport -&gt; ValidityReport -&gt; Bool)
-&gt; (ValidityReport -&gt; ValidityReport -&gt; ValidityReport)
-&gt; (ValidityReport -&gt; ValidityReport -&gt; ValidityReport)
-&gt; Ord ValidityReport
ValidityReport -&gt; ValidityReport -&gt; Bool
ValidityReport -&gt; ValidityReport -&gt; Ordering
ValidityReport -&gt; ValidityReport -&gt; ValidityReport
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: ValidityReport -&gt; ValidityReport -&gt; ValidityReport
$cmin :: ValidityReport -&gt; ValidityReport -&gt; ValidityReport
max :: ValidityReport -&gt; ValidityReport -&gt; ValidityReport
$cmax :: ValidityReport -&gt; ValidityReport -&gt; ValidityReport
&gt;= :: ValidityReport -&gt; ValidityReport -&gt; Bool
$c&gt;= :: ValidityReport -&gt; ValidityReport -&gt; Bool
&gt; :: ValidityReport -&gt; ValidityReport -&gt; Bool
$c&gt; :: ValidityReport -&gt; ValidityReport -&gt; Bool
&lt;= :: ValidityReport -&gt; ValidityReport -&gt; Bool
$c&lt;= :: ValidityReport -&gt; ValidityReport -&gt; Bool
&lt; :: ValidityReport -&gt; ValidityReport -&gt; Bool
$c&lt; :: ValidityReport -&gt; ValidityReport -&gt; Bool
compare :: ValidityReport -&gt; ValidityReport -&gt; Ordering
$ccompare :: ValidityReport -&gt; ValidityReport -&gt; Ordering
$cp1Ord :: Eq ValidityReport
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679449556"><span id="local-6989586621679449558"><span class="annot"><span class="annottext">ValidityReport -&gt; ValidityReport -&gt; Bool
(ValidityReport -&gt; ValidityReport -&gt; Bool)
-&gt; (ValidityReport -&gt; ValidityReport -&gt; Bool) -&gt; Eq ValidityReport
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ValidityReport -&gt; ValidityReport -&gt; Bool
$c/= :: ValidityReport -&gt; ValidityReport -&gt; Bool
== :: ValidityReport -&gt; ValidityReport -&gt; Bool
$c== :: ValidityReport -&gt; ValidityReport -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679449549"><span id="local-6989586621679449551"><span id="local-6989586621679449553"><span class="annot"><span class="annottext">Int -&gt; ValidityReport -&gt; ShowS
[ValidityReport] -&gt; ShowS
ValidityReport -&gt; [Char]
(Int -&gt; ValidityReport -&gt; ShowS)
-&gt; (ValidityReport -&gt; [Char])
-&gt; ([ValidityReport] -&gt; ShowS)
-&gt; Show ValidityReport
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ValidityReport] -&gt; ShowS
$cshowList :: [ValidityReport] -&gt; ShowS
show :: ValidityReport -&gt; [Char]
$cshow :: ValidityReport -&gt; [Char]
showsPrec :: Int -&gt; ValidityReport -&gt; ShowS
$cshowsPrec :: Int -&gt; ValidityReport -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-comment">-- NOTE: this function ignores the execution units associated with</span><span>
</span><span id="line-186"></span><span class="hs-comment">-- the scripts in the Tx. That way we don't have to care about computing</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- the right values in the threat model (as this is not our main concern here).</span><span>
</span><span id="line-188"></span><span class="hs-comment">--</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- This also means that if we were to want to deal with execution units in the threat</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- modelling framework we would need to be a bit careful and figure out some abstractions</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- that make it make sense (and check the budgets here).</span><span>
</span><span id="line-192"></span><span class="hs-comment">--</span><span>
</span><span id="line-193"></span><span class="hs-comment">-- Stolen from Hydra</span><span>
</span><span id="line-194"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#validateTx"><span class="hs-identifier hs-type">validateTx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ProtocolParameters</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#ValidityReport"><span class="hs-identifier hs-type">ValidityReport</span></a></span><span>
</span><span id="line-195"></span><span id="validateTx"><span class="annot"><span class="annottext">validateTx :: ProtocolParameters -&gt; Tx Era -&gt; UTxO Era -&gt; ValidityReport
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#validateTx"><span class="hs-identifier hs-var hs-var">validateTx</span></a></span></span><span> </span><span id="local-6989586621679449546"><span class="annot"><span class="annottext">ProtocolParameters
</span><a href="#local-6989586621679449546"><span class="hs-identifier hs-var">pparams</span></a></span></span><span> </span><span id="local-6989586621679449545"><span class="annot"><span class="annottext">Tx Era
</span><a href="#local-6989586621679449545"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span id="local-6989586621679449544"><span class="annot"><span class="annottext">UTxO Era
</span><a href="#local-6989586621679449544"><span class="hs-identifier hs-var">utxos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either
  TransactionValidityError
  (Map
     ScriptWitnessIndex (Either ScriptExecutionError ExecutionUnits))
</span><a href="#local-6989586621679449543"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-196"></span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679449542"><span class="annot"><span class="annottext">TransactionValidityError
</span><a href="#local-6989586621679449542"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [[Char]] -&gt; ValidityReport
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#ValidityReport"><span class="hs-identifier hs-var">ValidityReport</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TransactionValidityError -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">TransactionValidityError
</span><a href="#local-6989586621679449542"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-197"></span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679449540"><span class="annot"><span class="annottext">Map ScriptWitnessIndex (Either ScriptExecutionError ExecutionUnits)
</span><a href="#local-6989586621679449540"><span class="hs-identifier hs-var">report</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [[Char]] -&gt; ValidityReport
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#ValidityReport"><span class="hs-identifier hs-var">ValidityReport</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Either ScriptExecutionError ExecutionUnits -&gt; Bool)
-&gt; [Either ScriptExecutionError ExecutionUnits] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="annot"><span class="annottext">Either ScriptExecutionError ExecutionUnits -&gt; Bool
forall a b. Either a b -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">isRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map ScriptWitnessIndex (Either ScriptExecutionError ExecutionUnits)
-&gt; [Either ScriptExecutionError ExecutionUnits]
forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">Map.elems</span></span><span> </span><span class="annot"><span class="annottext">Map ScriptWitnessIndex (Either ScriptExecutionError ExecutionUnits)
</span><a href="#local-6989586621679449540"><span class="hs-identifier hs-var">report</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>                                 </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ScriptExecutionError -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptExecutionError
</span><a href="#local-6989586621679449537"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679449537"><span class="annot"><span class="annottext">ScriptExecutionError
</span><a href="#local-6989586621679449537"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map ScriptWitnessIndex (Either ScriptExecutionError ExecutionUnits)
-&gt; [Either ScriptExecutionError ExecutionUnits]
forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">Map.elems</span></span><span> </span><span class="annot"><span class="annottext">Map ScriptWitnessIndex (Either ScriptExecutionError ExecutionUnits)
</span><a href="#local-6989586621679449540"><span class="hs-identifier hs-var">report</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-200"></span><span>    </span><span id="local-6989586621679449543"><span class="annot"><span class="annottext">result :: Either
  TransactionValidityError
  (Map
     ScriptWitnessIndex (Either ScriptExecutionError ExecutionUnits))
</span><a href="#local-6989586621679449543"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EraInMode Era CardanoMode
-&gt; SystemStart
-&gt; EraHistory CardanoMode
-&gt; ProtocolParameters
-&gt; UTxO Era
-&gt; TxBody Era
-&gt; Either
     TransactionValidityError
     (Map
        ScriptWitnessIndex (Either ScriptExecutionError ExecutionUnits))
forall era mode.
EraInMode era mode
-&gt; SystemStart
-&gt; EraHistory mode
-&gt; ProtocolParameters
-&gt; UTxO era
-&gt; TxBody era
-&gt; Either
     TransactionValidityError
     (Map
        ScriptWitnessIndex (Either ScriptExecutionError ExecutionUnits))
</span><span class="hs-identifier hs-var">evaluateTransactionExecutionUnits</span></span><span>
</span><span id="line-201"></span><span>                </span><span class="annot"><span class="annottext">EraInMode Era CardanoMode
</span><span class="hs-identifier hs-var">BabbageEraInCardanoMode</span></span><span>
</span><span id="line-202"></span><span>                </span><span class="annot"><span class="annottext">SystemStart
</span><a href="#local-6989586621679449534"><span class="hs-identifier hs-var">systemStart</span></a></span><span>
</span><span id="line-203"></span><span>                </span><span class="annot"><span class="annottext">EraHistory CardanoMode
</span><a href="#local-6989586621679449533"><span class="hs-identifier hs-var">eraHistory</span></a></span><span>
</span><span id="line-204"></span><span>                </span><span class="annot"><span class="annottext">ProtocolParameters
</span><a href="#local-6989586621679449546"><span class="hs-identifier hs-var">pparams</span></a></span><span>
</span><span id="line-205"></span><span>                </span><span class="annot"><span class="annottext">UTxO Era
</span><a href="#local-6989586621679449544"><span class="hs-identifier hs-var">utxos</span></a></span><span>
</span><span id="line-206"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tx Era -&gt; TxBody Era
forall era. Tx era -&gt; TxBody era
</span><span class="hs-identifier hs-var">getTxBody</span></span><span> </span><span class="annot"><span class="annottext">Tx Era
</span><a href="#local-6989586621679449545"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><a href="#local-6989586621679449533"><span class="hs-identifier hs-type">eraHistory</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EraHistory</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoMode</span></span><span>
</span><span id="line-208"></span><span>    </span><span id="local-6989586621679449533"><span class="annot"><span class="annottext">eraHistory :: EraHistory CardanoMode
</span><a href="#local-6989586621679449533"><span class="hs-identifier hs-var hs-var">eraHistory</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConsensusMode CardanoMode
-&gt; Interpreter (CardanoEras StandardCrypto)
-&gt; EraHistory CardanoMode
forall mode (xs :: [*]).
(ConsensusBlockForMode mode ~ HardForkBlock xs) =&gt;
ConsensusMode mode -&gt; Interpreter xs -&gt; EraHistory mode
</span><span class="hs-identifier hs-var">EraHistory</span></span><span> </span><span class="annot"><span class="annottext">ConsensusMode CardanoMode
</span><span class="hs-identifier hs-var">CardanoMode</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Summary (CardanoEras StandardCrypto)
-&gt; Interpreter (CardanoEras StandardCrypto)
forall (xs :: [*]). Summary xs -&gt; Interpreter xs
</span><span class="hs-identifier hs-var">mkInterpreter</span></span><span> </span><span class="annot"><span class="annottext">Summary (CardanoEras StandardCrypto)
</span><a href="#local-6989586621679449528"><span class="hs-identifier hs-var">summary</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span>    </span><span class="annot"><a href="#local-6989586621679449528"><span class="hs-identifier hs-type">summary</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Summary</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CardanoEras</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>    </span><span id="local-6989586621679449528"><span class="annot"><span class="annottext">summary :: Summary (CardanoEras StandardCrypto)
</span><a href="#local-6989586621679449528"><span class="hs-identifier hs-var hs-var">summary</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-212"></span><span>      </span><span class="annot"><span class="annottext">NonEmpty (CardanoEras StandardCrypto) EraSummary
-&gt; Summary (CardanoEras StandardCrypto)
forall (xs :: [*]). NonEmpty xs EraSummary -&gt; Summary xs
</span><span class="hs-identifier hs-var">Summary</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (CardanoEras StandardCrypto) EraSummary
 -&gt; Summary (CardanoEras StandardCrypto))
-&gt; (EraSummary -&gt; NonEmpty (CardanoEras StandardCrypto) EraSummary)
-&gt; EraSummary
-&gt; Summary (CardanoEras StandardCrypto)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">EraSummary -&gt; NonEmpty (CardanoEras StandardCrypto) EraSummary
forall b x (xs :: [*]). b -&gt; NonEmpty (x : xs) b
</span><span class="hs-identifier hs-var">NonEmptyOne</span></span><span> </span><span class="annot"><span class="annottext">(EraSummary -&gt; Summary (CardanoEras StandardCrypto))
-&gt; EraSummary -&gt; Summary (CardanoEras StandardCrypto)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-213"></span><span>        </span><span class="annot"><span class="annottext">EraSummary :: Bound -&gt; EraEnd -&gt; EraParams -&gt; EraSummary
</span><span class="hs-identifier hs-type">EraSummary</span></span><span>
</span><span id="line-214"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">eraStart :: Bound
</span><span class="hs-identifier hs-var">eraStart</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bound
</span><span class="hs-identifier hs-var">initBound</span></span><span>
</span><span id="line-215"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">eraEnd :: EraEnd
</span><span class="hs-identifier hs-var">eraEnd</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EraEnd
</span><span class="hs-identifier hs-var">EraUnbounded</span></span><span>
</span><span id="line-216"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">eraParams :: EraParams
</span><span class="hs-identifier hs-var">eraParams</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-217"></span><span>              </span><span class="annot"><span class="annottext">EraParams :: EpochSize -&gt; SlotLength -&gt; SafeZone -&gt; EraParams
</span><span class="hs-identifier hs-type">EraParams</span></span><span>
</span><span id="line-218"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">eraEpochSize :: EpochSize
</span><span class="hs-identifier hs-var">eraEpochSize</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EpochSize
</span><a href="#local-6989586621679449518"><span class="hs-identifier hs-var">epochSize</span></a></span><span>
</span><span id="line-219"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">eraSlotLength :: SlotLength
</span><span class="hs-identifier hs-var">eraSlotLength</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SlotLength
</span><a href="#local-6989586621679449516"><span class="hs-identifier hs-var">slotLength</span></a></span><span>
</span><span id="line-220"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">eraSafeZone :: SafeZone
</span><span class="hs-identifier hs-var">eraSafeZone</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SafeZone
</span><span class="hs-identifier hs-var">UnsafeIndefiniteSafeZone</span></span><span>
</span><span id="line-221"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-222"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span>    </span><span class="annot"><a href="#local-6989586621679449518"><span class="hs-identifier hs-type">epochSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EpochSize</span></span><span>
</span><span id="line-225"></span><span>    </span><span id="local-6989586621679449518"><span class="annot"><span class="annottext">epochSize :: EpochSize
</span><a href="#local-6989586621679449518"><span class="hs-identifier hs-var hs-var">epochSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; EpochSize
</span><span class="hs-identifier hs-var">EpochSize</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">100</span></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><a href="#local-6989586621679449516"><span class="hs-identifier hs-type">slotLength</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotLength</span></span><span>
</span><span id="line-228"></span><span>    </span><span id="local-6989586621679449516"><span class="annot"><span class="annottext">slotLength :: SlotLength
</span><a href="#local-6989586621679449516"><span class="hs-identifier hs-var hs-var">slotLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; SlotLength
</span><span class="hs-identifier hs-var">mkSlotLength</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><span class="hs-number">1</span></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span>    </span><span class="annot"><a href="#local-6989586621679449534"><span class="hs-identifier hs-type">systemStart</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SystemStart</span></span><span>
</span><span id="line-231"></span><span>    </span><span id="local-6989586621679449534"><span class="annot"><span class="annottext">systemStart :: SystemStart
</span><a href="#local-6989586621679449534"><span class="hs-identifier hs-var hs-var">systemStart</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; SystemStart
</span><span class="hs-identifier hs-var">SystemStart</span></span><span> </span><span class="annot"><span class="annottext">(UTCTime -&gt; SystemStart) -&gt; UTCTime -&gt; SystemStart
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; UTCTime
</span><span class="hs-identifier hs-var">posixSecondsToUTCTime</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><span class="hs-number">0</span></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="hs-comment">-- | Keep only UTxOs mentioned in the given transaction.</span><span>
</span><span id="line-234"></span><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#restrictUTxO"><span class="hs-identifier hs-type">restrictUTxO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.ContractModel.Internal.Common.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span>
</span><span id="line-235"></span><span id="restrictUTxO"><span class="annot"><span class="annottext">restrictUTxO :: Tx Era -&gt; UTxO Era -&gt; UTxO Era
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#restrictUTxO"><span class="hs-identifier hs-var hs-var">restrictUTxO</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxBody</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxBodyContent</span></span><span class="hs-special">{</span><span id="local-6989586621679449494"><span id="local-6989586621679449495"><span id="local-6989586621679449496"><span id="local-6989586621679449497"><span id="local-6989586621679449498"><span id="local-6989586621679449499"><span id="local-6989586621679449500"><span id="local-6989586621679449501"><span id="local-6989586621679449502"><span id="local-6989586621679449503"><span id="local-6989586621679449504"><span id="local-6989586621679449505"><span id="local-6989586621679449506"><span id="local-6989586621679449507"><span id="local-6989586621679449508"><span id="local-6989586621679449509"><span id="local-6989586621679449510"><span class="annot"><span class="annottext">[(TxIn, BuildTxWith ViewTx (Witness WitCtxTxIn Era))]
[TxOut CtxTx Era]
(TxValidityLowerBound Era, TxValidityUpperBound Era)
BuildTxWith ViewTx (Maybe ProtocolParameters)
TxAuxScripts Era
TxCertificates ViewTx Era
TxExtraKeyWitnesses Era
TxFee Era
TxInsCollateral Era
TxInsReference ViewTx Era
TxMetadataInEra Era
TxMintValue ViewTx Era
TxReturnCollateral CtxTx Era
TxScriptValidity Era
TxTotalCollateral Era
TxUpdateProposal Era
TxWithdrawals ViewTx Era
txWithdrawals :: forall build era.
TxBodyContent build era -&gt; TxWithdrawals build era
txValidityRange :: forall build era.
TxBodyContent build era
-&gt; (TxValidityLowerBound era, TxValidityUpperBound era)
txUpdateProposal :: forall build era. TxBodyContent build era -&gt; TxUpdateProposal era
txTotalCollateral :: forall build era. TxBodyContent build era -&gt; TxTotalCollateral era
txScriptValidity :: forall build era. TxBodyContent build era -&gt; TxScriptValidity era
txReturnCollateral :: forall build era.
TxBodyContent build era -&gt; TxReturnCollateral CtxTx era
txProtocolParams :: forall build era.
TxBodyContent build era
-&gt; BuildTxWith build (Maybe ProtocolParameters)
txMintValue :: forall build era. TxBodyContent build era -&gt; TxMintValue build era
txMetadata :: forall build era. TxBodyContent build era -&gt; TxMetadataInEra era
txInsReference :: forall build era.
TxBodyContent build era -&gt; TxInsReference build era
txInsCollateral :: forall build era. TxBodyContent build era -&gt; TxInsCollateral era
txFee :: forall build era. TxBodyContent build era -&gt; TxFee era
txExtraKeyWits :: forall build era.
TxBodyContent build era -&gt; TxExtraKeyWitnesses era
txCertificates :: forall build era.
TxBodyContent build era -&gt; TxCertificates build era
txAuxScripts :: forall build era. TxBodyContent build era -&gt; TxAuxScripts era
txScriptValidity :: TxScriptValidity Era
txMintValue :: TxMintValue ViewTx Era
txUpdateProposal :: TxUpdateProposal Era
txCertificates :: TxCertificates ViewTx Era
txWithdrawals :: TxWithdrawals ViewTx Era
txProtocolParams :: BuildTxWith ViewTx (Maybe ProtocolParameters)
txExtraKeyWits :: TxExtraKeyWitnesses Era
txAuxScripts :: TxAuxScripts Era
txMetadata :: TxMetadataInEra Era
txValidityRange :: (TxValidityLowerBound Era, TxValidityUpperBound Era)
txFee :: TxFee Era
txReturnCollateral :: TxReturnCollateral CtxTx Era
txTotalCollateral :: TxTotalCollateral Era
txOuts :: [TxOut CtxTx Era]
txInsReference :: TxInsReference ViewTx Era
txInsCollateral :: TxInsCollateral Era
txIns :: [(TxIn, BuildTxWith ViewTx (Witness WitCtxTxIn Era))]
txOuts :: forall build era. TxBodyContent build era -&gt; [TxOut CtxTx era]
txIns :: forall build era. TxBodyContent build era -&gt; TxIns build era
</span><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[KeyWitness Era]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span id="local-6989586621679449477"><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO Era)
</span><a href="#local-6989586621679449477"><span class="hs-identifier hs-var">utxo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-236"></span><span>  </span><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO Era) -&gt; UTxO Era
forall era. Map TxIn (TxOut CtxUTxO era) -&gt; UTxO era
</span><span class="hs-identifier hs-var">UTxO</span></span><span> </span><span class="annot"><span class="annottext">(Map TxIn (TxOut CtxUTxO Era) -&gt; UTxO Era)
-&gt; Map TxIn (TxOut CtxUTxO Era) -&gt; UTxO Era
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(TxIn -&gt; TxOut CtxUTxO Era -&gt; Bool)
-&gt; Map TxIn (TxOut CtxUTxO Era) -&gt; Map TxIn (TxOut CtxUTxO Era)
forall k a. (k -&gt; a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.filterWithKey</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679449476"><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679449476"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO Era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679449476"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">TxIn -&gt; [TxIn] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">`elem`</span></a></span><span> </span><span class="annot"><span class="annottext">((TxIn, BuildTxWith ViewTx (Witness WitCtxTxIn Era)) -&gt; TxIn)
-&gt; [(TxIn, BuildTxWith ViewTx (Witness WitCtxTxIn Era))] -&gt; [TxIn]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(TxIn, BuildTxWith ViewTx (Witness WitCtxTxIn Era)) -&gt; TxIn
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[(TxIn, BuildTxWith ViewTx (Witness WitCtxTxIn Era))]
</span><a href="#local-6989586621679449510"><span class="hs-identifier hs-var">txIns</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO Era)
</span><a href="#local-6989586621679449477"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span id="local-6989586621679449474"><span class="annot"><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#convValidityInterval"><span class="hs-identifier hs-type">convValidityInterval</span></a></span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxValidityLowerBound</span></span><span> </span><span class="annot"><a href="#local-6989586621679449474"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxValidityUpperBound</span></span><span> </span><span class="annot"><a href="#local-6989586621679449474"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ValidityInterval</span></span></span><span>
</span><span id="line-241"></span><span id="convValidityInterval"><span class="annot"><span class="annottext">convValidityInterval :: (TxValidityLowerBound era, TxValidityUpperBound era)
-&gt; ValidityInterval
</span><a href="Test.QuickCheck.ContractModel.ThreatModel.Cardano.Api.html#convValidityInterval"><span class="hs-identifier hs-var hs-var">convValidityInterval</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679449472"><span class="annot"><span class="annottext">TxValidityLowerBound era
</span><a href="#local-6989586621679449472"><span class="hs-identifier hs-var">lowerBound</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679449471"><span class="annot"><span class="annottext">TxValidityUpperBound era
</span><a href="#local-6989586621679449471"><span class="hs-identifier hs-var">upperBound</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-242"></span><span>  </span><span class="annot"><span class="annottext">ValidityInterval :: StrictMaybe SlotNo -&gt; StrictMaybe SlotNo -&gt; ValidityInterval
</span><span class="hs-identifier hs-type">ValidityInterval</span></span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">invalidBefore :: StrictMaybe SlotNo
</span><span class="hs-identifier hs-var">invalidBefore</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxValidityLowerBound era
</span><a href="#local-6989586621679449472"><span class="hs-identifier hs-var">lowerBound</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-244"></span><span>                        </span><span class="annot"><span class="annottext">TxValidityLowerBound era
</span><span class="hs-identifier hs-var">TxValidityNoLowerBound</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StrictMaybe SlotNo
forall a. StrictMaybe a
</span><span class="hs-identifier hs-var">SNothing</span></span><span>
</span><span id="line-245"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">TxValidityLowerBound</span></span><span> </span><span class="annot"><span class="annottext">ValidityLowerBoundSupportedInEra era
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679449467"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679449467"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; StrictMaybe SlotNo
forall a. a -&gt; StrictMaybe a
</span><span class="hs-identifier hs-var">SJust</span></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679449467"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-246"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">invalidHereafter :: StrictMaybe SlotNo
</span><span class="hs-identifier hs-var">invalidHereafter</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxValidityUpperBound era
</span><a href="#local-6989586621679449471"><span class="hs-identifier hs-var">upperBound</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-247"></span><span>                           </span><span class="annot"><span class="hs-identifier hs-type">TxValidityNoUpperBound</span></span><span> </span><span class="annot"><span class="annottext">ValidityNoUpperBoundSupportedInEra era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StrictMaybe SlotNo
forall a. StrictMaybe a
</span><span class="hs-identifier hs-var">SNothing</span></span><span>
</span><span id="line-248"></span><span>                           </span><span class="annot"><span class="hs-identifier hs-type">TxValidityUpperBound</span></span><span> </span><span class="annot"><span class="annottext">ValidityUpperBoundSupportedInEra era
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679449463"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679449463"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; StrictMaybe SlotNo
forall a. a -&gt; StrictMaybe a
</span><span class="hs-identifier hs-var">SJust</span></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679449463"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span></pre></body></html>