<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Test.QuickCheck.ContractModel.DL</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">quickcheck-contractmodel-0.1.4.1</span><ul class="links" id="page-menu"><li><a href="src/Test.QuickCheck.ContractModel.DL.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Test.QuickCheck.ContractModel.DL</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#section.orphans">Orphan instances</a></li></ul></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">type</span> <a href="#t:DL">DL</a> state = DL (<a href="Test-QuickCheck-ContractModel-Internal-Spec.html#t:ModelState" title="Test.QuickCheck.ContractModel.Internal.Spec">ModelState</a> state)</li><li class="src short"><span class="keyword">class</span> <a href="#t:ActionLike">ActionLike</a> state a | a -&gt; state <span class="keyword">where</span><ul class="subs"><li><a href="#v:action">action</a> :: a -&gt; <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state ()</li></ul></li><li class="src short"><a href="#v:observe">observe</a> :: <a href="Test-QuickCheck-ContractModel-Internal-Model.html#t:ContractModel" title="Test.QuickCheck.ContractModel.Internal.Model">ContractModel</a> state =&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; ((<span class="keyword">forall</span> t. <a href="Test-QuickCheck-ContractModel-Internal-Symbolics.html#t:HasSymbolicRep" title="Test.QuickCheck.ContractModel.Internal.Symbolics">HasSymbolicRep</a> t =&gt; <a href="Test-QuickCheck-ContractModel-Internal-Symbolics.html#t:Symbolic" title="Test.QuickCheck.ContractModel.Internal.Symbolics">Symbolic</a> t -&gt; t) -&gt; <a href="Test-QuickCheck-ContractModel-Internal-ChainIndex.html#t:ChainState" title="Test.QuickCheck.ContractModel.Internal.ChainIndex">ChainState</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state ()</li><li class="src short"><a href="#v:waitUntilDL">waitUntilDL</a> :: <span class="keyword">forall</span> state. <a href="Test-QuickCheck-ContractModel-Internal-Model.html#t:ContractModel" title="Test.QuickCheck.ContractModel.Internal.Model">ContractModel</a> state =&gt; SlotNo -&gt; <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state ()</li><li class="src short"><a href="#v:anyAction">anyAction</a> :: <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state ()</li><li class="src short"><a href="#v:anyActions">anyActions</a> :: <a href="../../ghc/html/libraries/base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state ()</li><li class="src short"><a href="#v:anyActions_">anyActions_</a> :: <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state ()</li><li class="src short"><a href="#v:stopping">stopping</a> :: <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state ()</li><li class="src short"><a href="#v:weight">weight</a> :: <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state ()</li><li class="src short"><a href="#v:getSize">getSize</a> :: <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state <a href="../../ghc/html/libraries/base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a></li><li class="src short"><a href="#v:monitor">monitor</a> :: (Property -&gt; Property) -&gt; <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state ()</li><li class="src short"><a href="#v:assertModel">assertModel</a> :: <a href="../../ghc/html/libraries/base-4.14.3.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; (<a href="Test-QuickCheck-ContractModel-Internal-Spec.html#t:ModelState" title="Test.QuickCheck.ContractModel.Internal.Spec">ModelState</a> state -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state ()</li><li class="src short"><a href="#v:forAllDL">forAllDL</a> :: (<a href="Test-QuickCheck-ContractModel-Internal-Model.html#t:ContractModel" title="Test.QuickCheck.ContractModel.Internal.Model">ContractModel</a> state, Testable p) =&gt; <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state () -&gt; (<a href="Test-QuickCheck-ContractModel-Internal-Model.html#t:Actions" title="Test.QuickCheck.ContractModel.Internal.Model">Actions</a> state -&gt; p) -&gt; Property</li><li class="src short"><a href="#v:forAllUniqueDL">forAllUniqueDL</a> :: <span class="keyword">forall</span> state p. (<a href="Test-QuickCheck-ContractModel-Internal-Model.html#t:ContractModel" title="Test.QuickCheck.ContractModel.Internal.Model">ContractModel</a> state, Testable p) =&gt; Annotated (<a href="Test-QuickCheck-ContractModel-Internal-Spec.html#t:ModelState" title="Test.QuickCheck.ContractModel.Internal.Spec">ModelState</a> state) -&gt; <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state () -&gt; (<a href="Test-QuickCheck-ContractModel-Internal-Model.html#t:Actions" title="Test.QuickCheck.ContractModel.Internal.Model">Actions</a> state -&gt; p) -&gt; Property</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="doc"><p>Test scenarios are described in the <code><a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a></code> monad (based on dynamic logic) which lets you freely mix
 random sequences of actions (<code><a href="Test-QuickCheck-ContractModel-DL.html#v:anyAction" title="Test.QuickCheck.ContractModel.DL">anyAction</a></code>, <code><a href="Test-QuickCheck-ContractModel-DL.html#v:anyActions_" title="Test.QuickCheck.ContractModel.DL">anyActions_</a></code>, <code><a href="Test-QuickCheck-ContractModel-DL.html#v:anyActions" title="Test.QuickCheck.ContractModel.DL">anyActions</a></code>) with specific
 actions (<code><a href="Test-QuickCheck-ContractModel-DL.html#v:action" title="Test.QuickCheck.ContractModel.DL">action</a></code>). It also supports checking properties of the model state (<code>assert</code>,
 <code><a href="Test-QuickCheck-ContractModel-DL.html#v:assertModel" title="Test.QuickCheck.ContractModel.DL">assertModel</a></code>), and random generation (<code>forAllQ</code>).</p><p>For instance, a unit test for a simple auction contract might look something like this:</p><pre> unitTest :: <code><a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a></code> AuctionState ()
 unitTest = do
     <code><a href="Test-QuickCheck-ContractModel-DL.html#v:action" title="Test.QuickCheck.ContractModel.DL">action</a></code> $ Bid w1 100
     <code><a href="Test-QuickCheck-ContractModel-DL.html#v:action" title="Test.QuickCheck.ContractModel.DL">action</a></code> $ Bid w2 150
     <code><a href="Test-QuickCheck-ContractModel-DL.html#v:action" title="Test.QuickCheck.ContractModel.DL">action</a></code> $ Wait endSlot
     <code><a href="Test-QuickCheck-ContractModel-DL.html#v:action" title="Test.QuickCheck.ContractModel.DL">action</a></code> $ Collect
</pre><p>and could easily be extended with some randomly generated values</p><pre> unitTest :: <code><a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a></code> AuctionState ()
 unitTest = do
     bid &lt;- <code>forAllQ</code> $ <code>chooseQ</code> (1, 100)
     <code><a href="Test-QuickCheck-ContractModel-DL.html#v:action" title="Test.QuickCheck.ContractModel.DL">action</a></code> $ Bid w1 bid
     <code><a href="Test-QuickCheck-ContractModel-DL.html#v:action" title="Test.QuickCheck.ContractModel.DL">action</a></code> $ Bid w2 (bid + 50)
     <code><a href="Test-QuickCheck-ContractModel-DL.html#v:action" title="Test.QuickCheck.ContractModel.DL">action</a></code> $ Wait endSlot
     <code><a href="Test-QuickCheck-ContractModel-DL.html#v:action" title="Test.QuickCheck.ContractModel.DL">action</a></code> $ Collect
</pre><p>More interesting scenarios can be constructed by mixing random and fixed sequences. The following
 checks that you can always finish an auction after which point there are no funds locked by the
 contract:</p><pre>finishAuction :: <code><a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a></code> AuctionState ()
finishAuction = do
  <code><a href="Test-QuickCheck-ContractModel-DL.html#v:anyActions_" title="Test.QuickCheck.ContractModel.DL">anyActions_</a></code>
  <code><a href="Test-QuickCheck-ContractModel-DL.html#v:action" title="Test.QuickCheck.ContractModel.DL">action</a></code> $ Wait endSlot
  <code><a href="Test-QuickCheck-ContractModel-DL.html#v:action" title="Test.QuickCheck.ContractModel.DL">action</a></code> $ Collect
  <code><a href="Test-QuickCheck-ContractModel-DL.html#v:assertModel" title="Test.QuickCheck.ContractModel.DL">assertModel</a></code> &quot;Funds are locked!&quot; (<code><a href="Ledger-Value.html#v:isZero" title="Ledger.Value">isZero</a></code> . <code><a href="Test-QuickCheck-ContractModel-Internal-Spec.html#v:lockedValue" title="Test.QuickCheck.ContractModel.Internal.Spec">lockedValue</a></code>)
</pre><p><code><a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a></code> scenarios are turned into QuickCheck properties using <code><a href="Test-QuickCheck-ContractModel-DL.html#v:forAllDL" title="Test.QuickCheck.ContractModel.DL">forAllDL</a></code>.</p></div><div class="doc"><p>In addition to failing the check that the emulator run matches the model, there are a few other
 ways that test scenarios can fail:</p><ul><li>an explicit <code><a href="Test-QuickCheck-ContractModel-DL.html#v:action" title="Test.QuickCheck.ContractModel.DL">action</a></code> does not satisfy its <code><a href="Test-QuickCheck-ContractModel-Internal-Model.html#v:precondition" title="Test.QuickCheck.ContractModel.Internal.Model">precondition</a></code></li><li>a failed <code>assert</code> or <code><a href="Test-QuickCheck-ContractModel-DL.html#v:assertModel" title="Test.QuickCheck.ContractModel.DL">assertModel</a></code>, or a monad <code><a href="../../ghc/html/libraries/base-4.14.3.0/Control-Monad-Fail.html#v:fail" title="Control.Monad.Fail">fail</a></code></li><li>an <code><a href="../../ghc/html/libraries/base-4.14.3.0/Control-Applicative.html#v:empty" title="Control.Applicative">empty</a></code> set of <code><a href="../../ghc/html/libraries/base-4.14.3.0/Control-Applicative.html#v:Alternative" title="Control.Applicative">Alternative</a></code>s</li><li>the scenario fails to terminate (see <code><a href="Test-QuickCheck-ContractModel-DL.html#v:stopping" title="Test.QuickCheck.ContractModel.DL">stopping</a></code>)</li></ul><p>All of these occur at test case generation time, and thus do not directly say anything about the
 contract implementation. However, together with the check that the model agrees with the emulator
 they indirectly imply properties of the implementation. An advantage of this is that <code><a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a></code> test
 scenarios can be checked without running the contract through the emulator, which is much much
 faster. For instance,</p><pre>prop_FinishModel = <code><a href="Test-QuickCheck-ContractModel-DL.html#v:forAllDL" title="Test.QuickCheck.ContractModel.DL">forAllDL</a></code> finishAuction $ const True
</pre><p>would check that the model does not think there will be any locked funds after the auction is
 finished. Once this property passes, one can run the slower property that also checks that the
 emulator agrees.</p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:DL" class="def">DL</a> state = DL (<a href="Test-QuickCheck-ContractModel-Internal-Spec.html#t:ModelState" title="Test.QuickCheck.ContractModel.Internal.Spec">ModelState</a> state) <a href="src/Test.QuickCheck.ContractModel.DL.html#DL" class="link">Source</a> <a href="#t:DL" class="selflink">#</a></p><div class="doc"><p>The monad for writing test scenarios. It supports non-deterministic choice through
   <code><a href="../../ghc/html/libraries/base-4.14.3.0/Control-Applicative.html#v:Alternative" title="Control.Applicative">Alternative</a></code>, failure with <code><a href="../../ghc/html/libraries/base-4.14.3.0/Control-Monad-Fail.html#t:MonadFail" title="Control.Monad.Fail">MonadFail</a></code>, and access to the model state
   through <code><a href="Test-QuickCheck-ContractModel-Internal-Spec.html#t:GetModelState" title="Test.QuickCheck.ContractModel.Internal.Spec">GetModelState</a></code>. It is lazy, so scenarios can be potentially infinite, although the
   probability of termination needs to be high enough that concrete test cases are always finite.
   See <code><a href="Test-QuickCheck-ContractModel-DL.html#v:stopping" title="Test.QuickCheck.ContractModel.DL">stopping</a></code> for more information on termination.</p></div></div><div class="top"><p class="src"><span class="keyword">class</span> <a id="t:ActionLike" class="def">ActionLike</a> state a | a -&gt; state <span class="keyword">where</span> <a href="src/Test.QuickCheck.ContractModel.DL.html#ActionLike" class="link">Source</a> <a href="#t:ActionLike" class="selflink">#</a></p><div class="subs methods"><p class="caption">Methods</p><p class="src"><a id="v:action" class="def">action</a> :: a -&gt; <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state () <a href="src/Test.QuickCheck.ContractModel.DL.html#action" class="link">Source</a> <a href="#v:action" class="selflink">#</a></p><div class="doc"><p>Generate a specific action. Fails if the action's <code><a href="Test-QuickCheck-ContractModel-Internal-Model.html#v:precondition" title="Test.QuickCheck.ContractModel.Internal.Model">precondition</a></code> is not satisfied.</p></div></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:ActionLike">Instances</h4><details id="i:ActionLike" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:ic:ActionLike:ActionLike:1"></span> <a href="Test-QuickCheck-ContractModel-Internal-Model.html#t:ContractModel" title="Test.QuickCheck.ContractModel.Internal.Model">ContractModel</a> state =&gt; <a href="Test-QuickCheck-ContractModel-DL.html#t:ActionLike" title="Test.QuickCheck.ContractModel.DL">ActionLike</a> state (<a href="Test-QuickCheck-ContractModel-Internal-Model.html#t:Action" title="Test.QuickCheck.ContractModel.Internal.Model">Action</a> state)</span> <a href="src/Test.QuickCheck.ContractModel.DL.html#line-108" class="link">Source</a> <a href="#t:ActionLike" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:ic:ActionLike:ActionLike:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Test-QuickCheck-ContractModel-DL.html">Test.QuickCheck.ContractModel.DL</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:action">action</a> :: <a href="Test-QuickCheck-ContractModel-Internal-Model.html#t:Action" title="Test.QuickCheck.ContractModel.Internal.Model">Action</a> state -&gt; <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state () <a href="src/Test.QuickCheck.ContractModel.DL.html#action" class="link">Source</a> <a href="#v:action" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:ic:ActionLike:ActionLike:2"></span> (<a href="Test-QuickCheck-ContractModel-Internal-Model.html#t:ContractModel" title="Test.QuickCheck.ContractModel.Internal.Model">ContractModel</a> state, <a href="../../ghc/html/libraries/base-4.14.3.0/Type-Reflection.html#t:Typeable" title="Type.Reflection">Typeable</a> a) =&gt; <a href="Test-QuickCheck-ContractModel-DL.html#t:ActionLike" title="Test.QuickCheck.ContractModel.DL">ActionLike</a> state (Action (<a href="Test-QuickCheck-ContractModel-Internal-Spec.html#t:ModelState" title="Test.QuickCheck.ContractModel.Internal.Spec">ModelState</a> state) a)</span> <a href="src/Test.QuickCheck.ContractModel.DL.html#line-113" class="link">Source</a> <a href="#t:ActionLike" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:ic:ActionLike:ActionLike:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Test-QuickCheck-ContractModel-DL.html">Test.QuickCheck.ContractModel.DL</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:action">action</a> :: Action (<a href="Test-QuickCheck-ContractModel-Internal-Spec.html#t:ModelState" title="Test.QuickCheck.ContractModel.Internal.Spec">ModelState</a> state) a -&gt; <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state () <a href="src/Test.QuickCheck.ContractModel.DL.html#action" class="link">Source</a> <a href="#v:action" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:observe" class="def">observe</a> :: <a href="Test-QuickCheck-ContractModel-Internal-Model.html#t:ContractModel" title="Test.QuickCheck.ContractModel.Internal.Model">ContractModel</a> state =&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; ((<span class="keyword">forall</span> t. <a href="Test-QuickCheck-ContractModel-Internal-Symbolics.html#t:HasSymbolicRep" title="Test.QuickCheck.ContractModel.Internal.Symbolics">HasSymbolicRep</a> t =&gt; <a href="Test-QuickCheck-ContractModel-Internal-Symbolics.html#t:Symbolic" title="Test.QuickCheck.ContractModel.Internal.Symbolics">Symbolic</a> t -&gt; t) -&gt; <a href="Test-QuickCheck-ContractModel-Internal-ChainIndex.html#t:ChainState" title="Test.QuickCheck.ContractModel.Internal.ChainIndex">ChainState</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state () <a href="src/Test.QuickCheck.ContractModel.DL.html#observe" class="link">Source</a> <a href="#v:observe" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:waitUntilDL" class="def">waitUntilDL</a> :: <span class="keyword">forall</span> state. <a href="Test-QuickCheck-ContractModel-Internal-Model.html#t:ContractModel" title="Test.QuickCheck.ContractModel.Internal.Model">ContractModel</a> state =&gt; SlotNo -&gt; <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state () <a href="src/Test.QuickCheck.ContractModel.DL.html#waitUntilDL" class="link">Source</a> <a href="#v:waitUntilDL" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:anyAction" class="def">anyAction</a> :: <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state () <a href="src/Test.QuickCheck.ContractModel.DL.html#anyAction" class="link">Source</a> <a href="#v:anyAction" class="selflink">#</a></p><div class="doc"><p>Generate a random action using <code><a href="Test-QuickCheck-ContractModel-Internal-Model.html#v:arbitraryAction" title="Test.QuickCheck.ContractModel.Internal.Model">arbitraryAction</a></code>. The generated action is guaranteed to satisfy
   its <code><a href="Test-QuickCheck-ContractModel-Internal-Model.html#v:precondition" title="Test.QuickCheck.ContractModel.Internal.Model">precondition</a></code>. Fails with <code>Stuck</code> if no action satisfying the precondition can be found
   after 100 attempts.</p></div></div><div class="top"><p class="src"><a id="v:anyActions" class="def">anyActions</a> :: <a href="../../ghc/html/libraries/base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state () <a href="src/Test.QuickCheck.ContractModel.DL.html#anyActions" class="link">Source</a> <a href="#v:anyActions" class="selflink">#</a></p><div class="doc"><p>Generate a sequence of random actions using <code><a href="Test-QuickCheck-ContractModel-Internal-Model.html#v:arbitraryAction" title="Test.QuickCheck.ContractModel.Internal.Model">arbitraryAction</a></code>. All actions satisfy their
   <code><a href="Test-QuickCheck-ContractModel-Internal-Model.html#v:precondition" title="Test.QuickCheck.ContractModel.Internal.Model">precondition</a></code>s. The argument is the expected number of actions in the sequence chosen from a
   geometric distribution, unless in the <code><a href="Test-QuickCheck-ContractModel-DL.html#v:stopping" title="Test.QuickCheck.ContractModel.DL">stopping</a></code> stage, in which case as few actions as
   possible are generated.</p></div></div><div class="top"><p class="src"><a id="v:anyActions_" class="def">anyActions_</a> :: <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state () <a href="src/Test.QuickCheck.ContractModel.DL.html#anyActions_" class="link">Source</a> <a href="#v:anyActions_" class="selflink">#</a></p><div class="doc"><p>Generate a sequence of random actions using <code><a href="Test-QuickCheck-ContractModel-Internal-Model.html#v:arbitraryAction" title="Test.QuickCheck.ContractModel.Internal.Model">arbitraryAction</a></code>. All actions satisfy their
   <code><a href="Test-QuickCheck-ContractModel-Internal-Model.html#v:precondition" title="Test.QuickCheck.ContractModel.Internal.Model">precondition</a></code>s. Actions may be generated until the <code><a href="Test-QuickCheck-ContractModel-DL.html#v:stopping" title="Test.QuickCheck.ContractModel.DL">stopping</a></code> stage is reached; the expected length is size/2.</p></div></div><div class="top"><p class="src"><a id="v:stopping" class="def">stopping</a> :: <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state () <a href="src/Test.QuickCheck.ContractModel.DL.html#stopping" class="link">Source</a> <a href="#v:stopping" class="selflink">#</a></p><div class="doc"><p>Test case generation from <code><a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a></code> scenarios have a target length of the action sequence to be
   generated that is based on the QuickCheck size parameter (see <code>sized</code>). However, given that
   scenarios can contain explicit <code><a href="Test-QuickCheck-ContractModel-DL.html#v:action" title="Test.QuickCheck.ContractModel.DL">action</a></code>s it might not be possible to stop the scenario once the
   target length has been reached.</p><p>Instead, once the target number of actions have been reached, generation goes into the
   <em>stopping</em> phase. In this phase branches starting with <code><a href="Test-QuickCheck-ContractModel-DL.html#v:stopping" title="Test.QuickCheck.ContractModel.DL">stopping</a></code> are preferred, if possible.
   Conversely, before the stopping phase, branches starting with <code><a href="Test-QuickCheck-ContractModel-DL.html#v:stopping" title="Test.QuickCheck.ContractModel.DL">stopping</a></code>
   are avoided unless there are no other possible choices.</p><p>For example, here is the definition of <code><a href="Test-QuickCheck-ContractModel-DL.html#v:anyActions" title="Test.QuickCheck.ContractModel.DL">anyActions</a></code>:</p><pre><code><a href="Test-QuickCheck-ContractModel-DL.html#v:anyActions" title="Test.QuickCheck.ContractModel.DL">anyActions</a></code> n = <code><a href="Test-QuickCheck-ContractModel-DL.html#v:stopping" title="Test.QuickCheck.ContractModel.DL">stopping</a></code> <code><a href="../../ghc/html/libraries/base-4.14.3.0/Control-Applicative.html#v:-60--124--62-" title="Control.Applicative">&lt;|&gt;</a></code> pure ()
                       <code><a href="../../ghc/html/libraries/base-4.14.3.0/Control-Applicative.html#v:-60--124--62-" title="Control.Applicative">&lt;|&gt;</a></code> (<code><a href="Test-QuickCheck-ContractModel-DL.html#v:weight" title="Test.QuickCheck.ContractModel.DL">weight</a></code> (fromIntegral n) &gt;&gt; <code><a href="Test-QuickCheck-ContractModel-DL.html#v:anyAction" title="Test.QuickCheck.ContractModel.DL">anyAction</a></code> &gt;&gt; <code><a href="Test-QuickCheck-ContractModel-DL.html#v:anyActions" title="Test.QuickCheck.ContractModel.DL">anyActions</a></code> n)
</pre><p>The effect of this definition is that the second or third branch will be taken until the desired number
   of actions have been generated, at which point the <code><a href="Test-QuickCheck-ContractModel-DL.html#v:stopping" title="Test.QuickCheck.ContractModel.DL">stopping</a></code> branch will be taken and
   generation stops (or continues with whatever comes after the <code><a href="Test-QuickCheck-ContractModel-DL.html#v:anyActions" title="Test.QuickCheck.ContractModel.DL">anyActions</a></code> call).</p><p>Now, it might not be possible, or too hard, to find a way to terminate a scenario. For
   instance, this scenario has no finite test cases:</p><pre>looping = <code><a href="Test-QuickCheck-ContractModel-DL.html#v:anyAction" title="Test.QuickCheck.ContractModel.DL">anyAction</a></code> &gt;&gt; looping
</pre><p>To prevent test case generation from looping, if a scenario has not terminated after generating
   <code>2 * n + 20</code> actions, where <code>n</code> is when the stopping phase kicks in, generation fails with a
   <code>Looping</code> error.</p></div></div><div class="top"><p class="src"><a id="v:weight" class="def">weight</a> :: <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state () <a href="src/Test.QuickCheck.ContractModel.DL.html#weight" class="link">Source</a> <a href="#v:weight" class="selflink">#</a></p><div class="doc"><p>By default, <code><a href="../../ghc/html/libraries/base-4.14.3.0/Control-Applicative.html#v:Alternative" title="Control.Applicative">Alternative</a></code> choice (<code><a href="../../ghc/html/libraries/base-4.14.3.0/Control-Applicative.html#v:-60--124--62-" title="Control.Applicative">&lt;|&gt;</a></code>) picks among
   the next actions with equal probability. So, for instance, this code chooses between the actions
   <code>a</code>, <code>b</code> and <code>c</code>, with a probability <code>1/3</code> of choosing each:</p><pre>unbiasedChoice a b c = <code><a href="Test-QuickCheck-ContractModel-DL.html#v:action" title="Test.QuickCheck.ContractModel.DL">action</a></code> a <code><a href="../../ghc/html/libraries/base-4.14.3.0/Control-Applicative.html#v:-60--124--62-" title="Control.Applicative">&lt;|&gt;</a></code> <code><a href="Test-QuickCheck-ContractModel-DL.html#v:action" title="Test.QuickCheck.ContractModel.DL">action</a></code> b <code><a href="../../ghc/html/libraries/base-4.14.3.0/Control-Applicative.html#v:-60--124--62-" title="Control.Applicative">&lt;|&gt;</a></code> <code><a href="Test-QuickCheck-ContractModel-DL.html#v:action" title="Test.QuickCheck.ContractModel.DL">action</a></code> c
</pre><p>To change this you can use <code><a href="Test-QuickCheck-ContractModel-DL.html#v:weight" title="Test.QuickCheck.ContractModel.DL">weight</a></code>, which multiplies the
   relative probability of picking a branch by the given number.</p><p>For instance, the following scenario picks the action <code>a</code> with probability <code>2/3</code> and the action
   <code>b</code> with probability <code>1/3</code>:</p><pre>biasedChoice a b = <code><a href="Test-QuickCheck-ContractModel-DL.html#v:weight" title="Test.QuickCheck.ContractModel.DL">weight</a></code> 2 (<code><a href="Test-QuickCheck-ContractModel-DL.html#v:action" title="Test.QuickCheck.ContractModel.DL">action</a></code> a) <code><a href="../../ghc/html/libraries/base-4.14.3.0/Control-Applicative.html#v:-60--124--62-" title="Control.Applicative">&lt;|&gt;</a></code> <code><a href="Test-QuickCheck-ContractModel-DL.html#v:weight" title="Test.QuickCheck.ContractModel.DL">weight</a></code> (<code><a href="Test-QuickCheck-ContractModel-DL.html#v:action" title="Test.QuickCheck.ContractModel.DL">action</a></code> b)
</pre><p>Calls to <code><a href="Test-QuickCheck-ContractModel-DL.html#v:weight" title="Test.QuickCheck.ContractModel.DL">weight</a></code> need to appear at the top-level after a choice, preceding any actions
   (<code><a href="Test-QuickCheck-ContractModel-DL.html#v:action" title="Test.QuickCheck.ContractModel.DL">action</a></code>/<code><a href="Test-QuickCheck-ContractModel-DL.html#v:anyAction" title="Test.QuickCheck.ContractModel.DL">anyAction</a></code>) or random generation (<code>forAllQ</code>), or they will have no effect.</p></div></div><div class="top"><p class="src"><a id="v:getSize" class="def">getSize</a> :: <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state <a href="../../ghc/html/libraries/base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a> <a href="src/Test.QuickCheck.ContractModel.DL.html#getSize" class="link">Source</a> <a href="#v:getSize" class="selflink">#</a></p><div class="doc"><p>Sometimes test case generation should depend on QuickCheck's size
   parameter. This can be accessed using <code>getSize</code>. For example, <code>anyActions_</code> is defined by</p><pre>anyActions_ = do n &lt;- getSize
                 anyActions (n <code><a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#v:div" title="Prelude">div</a></code> 2 + 1)
</pre><p>so that we generate a random number of actions, but on average half the size (which is about the same as
 the average random positive integer, or length of a list).</p></div></div><div class="top"><p class="src"><a id="v:monitor" class="def">monitor</a> :: (Property -&gt; Property) -&gt; <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state () <a href="src/Test.QuickCheck.ContractModel.DL.html#monitor" class="link">Source</a> <a href="#v:monitor" class="selflink">#</a></p><div class="doc"><p>The <code><a href="Test-QuickCheck-ContractModel-DL.html#v:monitor" title="Test.QuickCheck.ContractModel.DL">monitor</a></code> function allows you to collect statistics of your testing using QuickCheck
   functions like <code>label</code>, <code>collect</code>, <code>classify</code>,
   and <code>tabulate</code>. See also the <code>monitoring</code> method of <code><a href="Test-QuickCheck-ContractModel-Internal-Model.html#t:ContractModel" title="Test.QuickCheck.ContractModel.Internal.Model">ContractModel</a></code> which is
   called for all actions in a test case (regardless of whether they are generated by an explicit
   <code><a href="Test-QuickCheck-ContractModel-DL.html#v:action" title="Test.QuickCheck.ContractModel.DL">action</a></code> or an <code><a href="Test-QuickCheck-ContractModel-DL.html#v:anyAction" title="Test.QuickCheck.ContractModel.DL">anyAction</a></code>).</p></div></div><div class="top"><p class="src"><a id="v:assertModel" class="def">assertModel</a> :: <a href="../../ghc/html/libraries/base-4.14.3.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; (<a href="Test-QuickCheck-ContractModel-Internal-Spec.html#t:ModelState" title="Test.QuickCheck.ContractModel.Internal.Spec">ModelState</a> state -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state () <a href="src/Test.QuickCheck.ContractModel.DL.html#assertModel" class="link">Source</a> <a href="#v:assertModel" class="selflink">#</a></p><div class="doc"><p>Fail unless the given predicate holds of the model state.</p><p>Equivalent to</p><pre>assertModel msg p = do
  s &lt;- <code><a href="Test-QuickCheck-ContractModel-Internal-Spec.html#v:getModelState" title="Test.QuickCheck.ContractModel.Internal.Spec">getModelState</a></code>
  <code>assert</code> msg (p s)
</pre></div></div><div class="top"><p class="src"><a id="v:forAllDL" class="def">forAllDL</a> :: (<a href="Test-QuickCheck-ContractModel-Internal-Model.html#t:ContractModel" title="Test.QuickCheck.ContractModel.Internal.Model">ContractModel</a> state, Testable p) =&gt; <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state () -&gt; (<a href="Test-QuickCheck-ContractModel-Internal-Model.html#t:Actions" title="Test.QuickCheck.ContractModel.Internal.Model">Actions</a> state -&gt; p) -&gt; Property <a href="src/Test.QuickCheck.ContractModel.DL.html#forAllDL" class="link">Source</a> <a href="#v:forAllDL" class="selflink">#</a></p><div class="doc"><p>Turn a <code><a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a></code> scenario into a QuickCheck property. Generates a random <code><a href="Test-QuickCheck-ContractModel-Internal-Model.html#t:Actions" title="Test.QuickCheck.ContractModel.Internal.Model">Actions</a></code> matching the
   scenario and feeds it to the given property. The property can be a full property running the
   emulator and checking the results, defined using <code>propRunActions_</code>, <code>propRunActions</code>, or
   <code>propRunActionsWithOptions</code>. Assuming a model for an auction contract and <code><a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a></code> scenario that
   checks that you can always complete the auction, you can write:</p><pre>finishAuction :: <code><a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a></code> AuctionState ()
prop_Auction  = <code>propRunActions_</code> handles
  where handles = ...
prop_Finish = <code><a href="Test-QuickCheck-ContractModel-DL.html#v:forAllDL" title="Test.QuickCheck.ContractModel.DL">forAllDL</a></code> finishAuction prop_Auction
</pre><p>However, there is also value in a property that does not run the emulator at all:</p><pre>prop_FinishModel = <code><a href="Test-QuickCheck-ContractModel-DL.html#v:forAllDL" title="Test.QuickCheck.ContractModel.DL">forAllDL</a></code> finishAuction $ const True
</pre><p>This will check all the assertions and other failure conditions of the <code><a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a></code> scenario very
   quickly. Once this property passes a large number of tests, you can run the full property
   checking that the model agrees with reality.</p></div></div><div class="top"><p class="src"><a id="v:forAllUniqueDL" class="def">forAllUniqueDL</a> :: <span class="keyword">forall</span> state p. (<a href="Test-QuickCheck-ContractModel-Internal-Model.html#t:ContractModel" title="Test.QuickCheck.ContractModel.Internal.Model">ContractModel</a> state, Testable p) =&gt; Annotated (<a href="Test-QuickCheck-ContractModel-Internal-Spec.html#t:ModelState" title="Test.QuickCheck.ContractModel.Internal.Spec">ModelState</a> state) -&gt; <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state () -&gt; (<a href="Test-QuickCheck-ContractModel-Internal-Model.html#t:Actions" title="Test.QuickCheck.ContractModel.Internal.Model">Actions</a> state -&gt; p) -&gt; Property <a href="src/Test.QuickCheck.ContractModel.DL.html#forAllUniqueDL" class="link">Source</a> <a href="#v:forAllUniqueDL" class="selflink">#</a></p></div><h1>Orphan instances</h1><div id="section.orphans"><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:o:ic:GetModelState:GetModelState:1"></span> <a href="Test-QuickCheck-ContractModel-Internal-Spec.html#t:GetModelState" title="Test.QuickCheck.ContractModel.Internal.Spec">GetModelState</a> (<a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state)</span> <a href="src/Test.QuickCheck.ContractModel.DL.html#line-271" class="link">Source</a> <a href="#v:-36-fGetModelStateDL" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:o:ic:GetModelState:GetModelState:1"><summary class="hide-when-js-enabled">Instance details</summary><p></p> <div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="Test-QuickCheck-ContractModel-Internal-Spec.html#t:StateType" title="Test.QuickCheck.ContractModel.Internal.Spec">StateType</a> (<a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state) <a href="src/Test.QuickCheck.ContractModel.Internal.Spec.html#StateType" class="link">Source</a> <a href="#t:StateType" class="selflink">#</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:getModelState">getModelState</a> :: <a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state (<a href="Test-QuickCheck-ContractModel-Internal-Spec.html#t:ModelState" title="Test.QuickCheck.ContractModel.Internal.Spec">ModelState</a> (<a href="Test-QuickCheck-ContractModel-Internal-Spec.html#t:StateType" title="Test.QuickCheck.ContractModel.Internal.Spec">StateType</a> (<a href="Test-QuickCheck-ContractModel-DL.html#t:DL" title="Test.QuickCheck.ContractModel.DL">DL</a> state))) <a href="src/Test.QuickCheck.ContractModel.Internal.Spec.html#getModelState" class="link">Source</a> <a href="#v:getModelState" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:o:ic:DynLogicModel:DynLogicModel:2"></span> <a href="Test-QuickCheck-ContractModel-Internal-Model.html#t:ContractModel" title="Test.QuickCheck.ContractModel.Internal.Model">ContractModel</a> s =&gt; DynLogicModel (<a href="Test-QuickCheck-ContractModel-Internal-Spec.html#t:ModelState" title="Test.QuickCheck.ContractModel.Internal.Spec">ModelState</a> s)</span> <a href="src/Test.QuickCheck.ContractModel.DL.html#line-266" class="link">Source</a> <a href="#v:-36-fDynLogicModelModelState" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:o:ic:DynLogicModel:DynLogicModel:2"><summary class="hide-when-js-enabled">Instance details</summary><p></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:restricted">restricted</a> :: Action (<a href="Test-QuickCheck-ContractModel-Internal-Spec.html#t:ModelState" title="Test.QuickCheck.ContractModel.Internal.Spec">ModelState</a> s) a -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></p></div></details></td></tr></table></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.2</p></div></body></html>