<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes   #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds             #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies    #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts      #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances     #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE GADTs                 #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE KindSignatures        #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns        #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings     #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes            #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables   #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TupleSections         #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications      #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators         #-}</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Plutus.PAB.Webserver.Handler</span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Handler.html#apiHandler"><span class="hs-identifier">apiHandler</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Handler.html#swagger"><span class="hs-identifier">swagger</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Reports</span></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Handler.html#getFullReport"><span class="hs-identifier">getFullReport</span></a></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Handler.html#contractSchema"><span class="hs-identifier">contractSchema</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.LocalClient.ExportTx.html"><span class="hs-identifier">Cardano.Wallet.LocalClient.ExportTx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.LocalClient.ExportTx.html#ExportTx"><span class="hs-identifier">ExportTx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">preview</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">join</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">unless</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Freer.Error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">throwError</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">JSON</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">traverse_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">fromMaybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">mapMaybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.OpenApi.Schema</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ToSchema</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Proxy</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Contract.Effects</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PABReq</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_ExposeEndpointReq</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html"><span class="hs-identifier">Plutus.PAB.Core</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier">PABAction</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html"><span class="hs-identifier">Plutus.PAB.Core</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Core</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html"><span class="hs-identifier">Plutus.PAB.Effects.Contract</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Contract</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Events.ContractInstanceState.html"><span class="hs-identifier">Plutus.PAB.Events.ContractInstanceState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Events.ContractInstanceState.html#PartiallyDecodedResponse"><span class="hs-identifier">PartiallyDecodedResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Events.ContractInstanceState.html#hooks"><span class="hs-identifier">hooks</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Events.ContractInstanceState.html#fromResp"><span class="hs-identifier">fromResp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html"><span class="hs-identifier">Plutus.PAB.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Types.html#PABError"><span class="hs-identifier">PABError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Types.html#ContractInstanceNotFound"><span class="hs-identifier">ContractInstanceNotFound</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html#EndpointCallError"><span class="hs-identifier">EndpointCallError</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.API.html"><span class="hs-identifier">Plutus.PAB.Webserver.API</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Webserver.API.html#API"><span class="hs-identifier">API</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html"><span class="hs-identifier">Plutus.PAB.Webserver.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractActivationArgs"><span class="hs-identifier">ContractActivationArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractActivationArgs"><span class="hs-identifier">ContractActivationArgs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#caID"><span class="hs-identifier">caID</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#caWallet"><span class="hs-identifier">caWallet</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>                                   </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractInstanceClientState"><span class="hs-identifier">ContractInstanceClientState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractInstanceClientState"><span class="hs-identifier">ContractInstanceClientState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#cicContract"><span class="hs-identifier">cicContract</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#cicCurrentState"><span class="hs-identifier">cicCurrentState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#cicDefinition"><span class="hs-identifier">cicDefinition</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#cicStatus"><span class="hs-identifier">cicStatus</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#cicWallet"><span class="hs-identifier">cicWallet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#cicYieldedExportTxs"><span class="hs-identifier">cicYieldedExportTxs</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>                                   </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractReport"><span class="hs-identifier">ContractReport</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractReport"><span class="hs-identifier">ContractReport</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#crActiveContractStates"><span class="hs-identifier">crActiveContractStates</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#crAvailableContracts"><span class="hs-identifier">crAvailableContracts</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>                                   </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractSignatureResponse"><span class="hs-identifier">ContractSignatureResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractSignatureResponse"><span class="hs-identifier">ContractSignatureResponse</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>                                   </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#FullReport"><span class="hs-identifier">FullReport</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#FullReport"><span class="hs-identifier">FullReport</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#chainReport"><span class="hs-identifier">chainReport</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#contractReport"><span class="hs-identifier">contractReport</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#emptyChainReport"><span class="hs-identifier">emptyChainReport</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Servant</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(:&lt;|&gt;)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(:&lt;|&gt;)</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Servant.OpenApi</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toOpenApi</span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Servant.Server</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Servant</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Servant.Swagger.UI</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SwaggerSchemaUI'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">swaggerSchemaUIServer</span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Wallet.Emulator.Wallet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Wallet</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">WalletId</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getWalletId</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">knownWallet</span></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Wallet.Types</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ContractActivityStatus</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Active</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ContractInstanceId</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">parseContractActivityStatus</span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="annot"><a href="Plutus.PAB.Webserver.Handler.html#healthcheck"><span class="hs-identifier hs-type">healthcheck</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680277067"><span class="annot"><a href="#local-6989586621680277067"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680277066"><span class="annot"><a href="#local-6989586621680277066"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277067"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277066"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span id="healthcheck"><span class="annot"><span class="annottext">healthcheck :: PABAction t env ()
</span><a href="Plutus.PAB.Webserver.Handler.html#healthcheck"><span class="hs-identifier hs-var hs-var">healthcheck</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; PABAction t env ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="annot"><a href="Plutus.PAB.Webserver.Handler.html#getContractReport"><span class="hs-identifier hs-type">getContractReport</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680277087"><span class="annot"><a href="#local-6989586621680277087"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680277088"><span class="annot"><a href="#local-6989586621680277088"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#PABContract"><span class="hs-identifier hs-type">Contract.PABContract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277087"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277087"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277088"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractReport"><span class="hs-identifier hs-type">ContractReport</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">Contract.ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277087"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span id="getContractReport"><span class="annot"><span class="annottext">getContractReport :: PABAction t env (ContractReport (ContractDef t))
</span><a href="Plutus.PAB.Webserver.Handler.html#getContractReport"><span class="hs-identifier hs-var hs-var">getContractReport</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-60"></span><span>    </span><span id="local-6989586621680276922"><span class="annot"><span class="annottext">[ContractDef t]
</span><a href="#local-6989586621680276922"><span class="hs-identifier hs-var">contracts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (ContractDefinition t) effs =&gt;
Eff effs [ContractDef t]
forall t (effs :: [* -&gt; *]).
Member (ContractDefinition t) effs =&gt;
Eff effs [ContractDef t]
</span><a href="Plutus.PAB.Effects.Contract.html#getDefinitions"><span class="hs-identifier hs-var">Contract.getDefinitions</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680277087"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span id="local-6989586621680276920"><span class="annot"><span class="annottext">[ContractInstanceId]
</span><a href="#local-6989586621680276920"><span class="hs-identifier hs-var">activeContractIDs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((ContractInstanceId, ContractActivationArgs (ContractDef t))
 -&gt; ContractInstanceId)
-&gt; [(ContractInstanceId, ContractActivationArgs (ContractDef t))]
-&gt; [ContractInstanceId]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">(ContractInstanceId, ContractActivationArgs (ContractDef t))
-&gt; ContractInstanceId
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">([(ContractInstanceId, ContractActivationArgs (ContractDef t))]
 -&gt; [ContractInstanceId])
-&gt; (Map ContractInstanceId (ContractActivationArgs (ContractDef t))
    -&gt; [(ContractInstanceId, ContractActivationArgs (ContractDef t))])
-&gt; Map ContractInstanceId (ContractActivationArgs (ContractDef t))
-&gt; [ContractInstanceId]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Map ContractInstanceId (ContractActivationArgs (ContractDef t))
-&gt; [(ContractInstanceId, ContractActivationArgs (ContractDef t))]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">(Map ContractInstanceId (ContractActivationArgs (ContractDef t))
 -&gt; [ContractInstanceId])
-&gt; Eff
     (PABEffects t env)
     (Map ContractInstanceId (ContractActivationArgs (ContractDef t)))
-&gt; Eff (PABEffects t env) [ContractInstanceId]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (ContractStore t) effs =&gt;
Eff
  effs
  (Map ContractInstanceId (ContractActivationArgs (ContractDef t)))
forall t (effs :: [* -&gt; *]).
Member (ContractStore t) effs =&gt;
Eff
  effs
  (Map ContractInstanceId (ContractActivationArgs (ContractDef t)))
</span><a href="Plutus.PAB.Effects.Contract.html#getActiveContracts"><span class="hs-identifier hs-var">Contract.getActiveContracts</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680277087"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span id="local-6989586621680276915"><span class="annot"><span class="annottext">[ContractSignatureResponse (ContractDef t)]
</span><a href="#local-6989586621680276915"><span class="hs-identifier hs-var">crAvailableContracts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ContractSignatureResponse (ContractDef t)]
-&gt; Eff
     (PABEffects t env) [ContractSignatureResponse (ContractDef t)]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">([ContractSignatureResponse (ContractDef t)]
 -&gt; Eff
      (PABEffects t env) [ContractSignatureResponse (ContractDef t)])
-&gt; [ContractSignatureResponse (ContractDef t)]
-&gt; Eff
     (PABEffects t env) [ContractSignatureResponse (ContractDef t)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(ContractDef t -&gt; ContractSignatureResponse (ContractDef t))
-&gt; [ContractDef t] -&gt; [ContractSignatureResponse (ContractDef t)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">ContractDef t -&gt; ContractSignatureResponse (ContractDef t)
forall t. t -&gt; ContractSignatureResponse t
</span><a href="Plutus.PAB.Webserver.Types.html#ContractSignatureResponse"><span class="hs-identifier hs-var">ContractSignatureResponse</span></a></span><span> </span><span class="annot"><span class="annottext">[ContractDef t]
</span><a href="#local-6989586621680276922"><span class="hs-identifier hs-var">contracts</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span id="local-6989586621680276914"><span class="annot"><span class="annottext">[(ContractInstanceId, PartiallyDecodedResponse PABReq)]
</span><a href="#local-6989586621680276914"><span class="hs-identifier hs-var">crActiveContractStates</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ContractInstanceId
 -&gt; Eff
      (PABEffects t env)
      (ContractInstanceId, PartiallyDecodedResponse PABReq))
-&gt; [ContractInstanceId]
-&gt; Eff
     (PABEffects t env)
     [(ContractInstanceId, PartiallyDecodedResponse PABReq)]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680276912"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276912"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; Eff (PABEffects t env) (State t)
forall t (effs :: [* -&gt; *]).
Member (ContractStore t) effs =&gt;
ContractInstanceId -&gt; Eff effs (State t)
</span><a href="Plutus.PAB.Effects.Contract.html#getState"><span class="hs-identifier hs-var">Contract.getState</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680277087"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276912"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (PABEffects t env) (State t)
-&gt; (State t
    -&gt; Eff
         (PABEffects t env)
         (ContractInstanceId, PartiallyDecodedResponse PABReq))
-&gt; Eff
     (PABEffects t env)
     (ContractInstanceId, PartiallyDecodedResponse PABReq)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680276910"><span class="annot"><span class="annottext">State t
</span><a href="#local-6989586621680276910"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(ContractInstanceId, PartiallyDecodedResponse PABReq)
-&gt; Eff
     (PABEffects t env)
     (ContractInstanceId, PartiallyDecodedResponse PABReq)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276912"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ContractResponse Value Value PABResp PABReq
-&gt; PartiallyDecodedResponse PABReq
forall s v.
ContractResponse Value Value s v -&gt; PartiallyDecodedResponse v
</span><a href="Plutus.PAB.Events.ContractInstanceState.html#fromResp"><span class="hs-identifier hs-var">fromResp</span></a></span><span> </span><span class="annot"><span class="annottext">(ContractResponse Value Value PABResp PABReq
 -&gt; PartiallyDecodedResponse PABReq)
-&gt; ContractResponse Value Value PABResp PABReq
-&gt; PartiallyDecodedResponse PABReq
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy t -&gt; State t -&gt; ContractResponse Value Value PABResp PABReq
forall contract.
PABContract contract =&gt;
Proxy contract
-&gt; State contract -&gt; ContractResponse Value Value PABResp PABReq
</span><a href="Plutus.PAB.Effects.Contract.html#serialisableState"><span class="hs-identifier hs-var">Contract.serialisableState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy t
forall k (t :: k). Proxy t
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680277087"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">State t
</span><a href="#local-6989586621680276910"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ContractInstanceId]
</span><a href="#local-6989586621680276920"><span class="hs-identifier hs-var">activeContractIDs</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><span class="annottext">ContractReport (ContractDef t)
-&gt; PABAction t env (ContractReport (ContractDef t))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">ContractReport :: forall t.
[ContractSignatureResponse t]
-&gt; [(ContractInstanceId, PartiallyDecodedResponse PABReq)]
-&gt; ContractReport t
</span><a href="Plutus.PAB.Webserver.Types.html#ContractReport"><span class="hs-identifier hs-type">ContractReport</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">[ContractSignatureResponse (ContractDef t)]
crAvailableContracts :: [ContractSignatureResponse (ContractDef t)]
crAvailableContracts :: [ContractSignatureResponse (ContractDef t)]
</span><a href="#local-6989586621680276915"><span class="hs-identifier hs-var hs-var">crAvailableContracts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(ContractInstanceId, PartiallyDecodedResponse PABReq)]
crActiveContractStates :: [(ContractInstanceId, PartiallyDecodedResponse PABReq)]
crActiveContractStates :: [(ContractInstanceId, PartiallyDecodedResponse PABReq)]
</span><a href="#local-6989586621680276914"><span class="hs-identifier hs-var hs-var">crActiveContractStates</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="annot"><a href="Plutus.PAB.Webserver.Handler.html#getFullReport"><span class="hs-identifier hs-type">getFullReport</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680277063"><span class="annot"><a href="#local-6989586621680277063"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680277062"><span class="annot"><a href="#local-6989586621680277062"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#PABContract"><span class="hs-identifier hs-type">Contract.PABContract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277063"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277063"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277062"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#FullReport"><span class="hs-identifier hs-type">FullReport</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">Contract.ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277063"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span id="getFullReport"><span class="annot"><span class="annottext">getFullReport :: PABAction t env (FullReport (ContractDef t))
</span><a href="Plutus.PAB.Webserver.Handler.html#getFullReport"><span class="hs-identifier hs-var hs-var">getFullReport</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-68"></span><span>    </span><span id="local-6989586621680276908"><span class="annot"><span class="annottext">ContractReport (ContractDef t)
</span><a href="#local-6989586621680276908"><span class="hs-identifier hs-var">contractReport</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall env.
PABContract t =&gt;
PABAction t env (ContractReport (ContractDef t))
forall t env.
PABContract t =&gt;
PABAction t env (ContractReport (ContractDef t))
</span><a href="Plutus.PAB.Webserver.Handler.html#getContractReport"><span class="hs-identifier hs-var">getContractReport</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680277063"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-69"></span><span>    </span><span class="annot"><span class="annottext">FullReport (ContractDef t)
-&gt; PABAction t env (FullReport (ContractDef t))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">FullReport :: forall t. ContractReport t -&gt; ChainReport -&gt; FullReport t
</span><a href="Plutus.PAB.Webserver.Types.html#FullReport"><span class="hs-identifier hs-type">FullReport</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">ContractReport (ContractDef t)
contractReport :: ContractReport (ContractDef t)
contractReport :: ContractReport (ContractDef t)
</span><a href="#local-6989586621680276908"><span class="hs-identifier hs-var hs-var">contractReport</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">chainReport :: ChainReport
</span><a href="Plutus.PAB.Webserver.Types.html#chainReport"><span class="hs-identifier hs-var">chainReport</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChainReport
</span><a href="Plutus.PAB.Webserver.Types.html#emptyChainReport"><span class="hs-identifier hs-var">emptyChainReport</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="annot"><a href="Plutus.PAB.Webserver.Handler.html#contractSchema"><span class="hs-identifier hs-type">contractSchema</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680277057"><span class="annot"><a href="#local-6989586621680277057"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680277056"><span class="annot"><a href="#local-6989586621680277056"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277057"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277056"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractSignatureResponse"><span class="hs-identifier hs-type">ContractSignatureResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">Contract.ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277057"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span id="contractSchema"><span class="annot"><span class="annottext">contractSchema :: ContractInstanceId
-&gt; PABAction t env (ContractSignatureResponse (ContractDef t))
</span><a href="Plutus.PAB.Webserver.Handler.html#contractSchema"><span class="hs-identifier hs-var hs-var">contractSchema</span></a></span></span><span> </span><span id="local-6989586621680276907"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276907"><span class="hs-identifier hs-var">contractId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-73"></span><span>    </span><span id="local-6989586621680276906"><span class="annot"><span class="annottext">Maybe (ContractActivationArgs (ContractDef t))
</span><a href="#local-6989586621680276906"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
-&gt; Eff
     (PABEffects t env) (Maybe (ContractActivationArgs (ContractDef t)))
forall t (effs :: [* -&gt; *]).
Member (ContractStore t) effs =&gt;
ContractInstanceId
-&gt; Eff effs (Maybe (ContractActivationArgs (ContractDef t)))
</span><a href="Plutus.PAB.Effects.Contract.html#getDefinition"><span class="hs-identifier hs-var">Contract.getDefinition</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680277057"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276907"><span class="hs-identifier hs-var">contractId</span></a></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (ContractActivationArgs (ContractDef t))
</span><a href="#local-6989586621680276906"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-75"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractActivationArgs"><span class="hs-identifier hs-type">ContractActivationArgs</span></a></span><span class="hs-special">{</span><span id="local-6989586621680276904"><span class="annot"><span class="annottext">ContractDef t
caID :: ContractDef t
caID :: forall t. ContractActivationArgs t -&gt; t
</span><a href="#local-6989586621680276904"><span class="hs-identifier hs-var hs-var">caID</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ContractSignatureResponse (ContractDef t)
-&gt; PABAction t env (ContractSignatureResponse (ContractDef t))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(ContractSignatureResponse (ContractDef t)
 -&gt; PABAction t env (ContractSignatureResponse (ContractDef t)))
-&gt; ContractSignatureResponse (ContractDef t)
-&gt; PABAction t env (ContractSignatureResponse (ContractDef t))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ContractDef t -&gt; ContractSignatureResponse (ContractDef t)
forall t. t -&gt; ContractSignatureResponse t
</span><a href="Plutus.PAB.Webserver.Types.html#ContractSignatureResponse"><span class="hs-identifier hs-var">ContractSignatureResponse</span></a></span><span> </span><span class="annot"><span class="annottext">ContractDef t
</span><a href="#local-6989586621680276904"><span class="hs-identifier hs-var">caID</span></a></span><span>
</span><span id="line-76"></span><span>        </span><span class="annot"><span class="annottext">Maybe (ContractActivationArgs (ContractDef t))
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PABError
-&gt; PABAction t env (ContractSignatureResponse (ContractDef t))
forall e (effs :: [* -&gt; *]) a.
Member (Error e) effs =&gt;
e -&gt; Eff effs a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContractInstanceId -&gt; PABError
</span><a href="Plutus.PAB.Types.html#ContractInstanceNotFound"><span class="hs-identifier hs-var">ContractInstanceNotFound</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276907"><span class="hs-identifier hs-var">contractId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-comment">-- | Handler for the API</span><span>
</span><span id="line-79"></span><span class="annot"><a href="Plutus.PAB.Webserver.Handler.html#apiHandler"><span class="hs-identifier hs-type">apiHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-80"></span><span>       </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680276903"><span class="annot"><a href="#local-6989586621680276903"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680276902"><span class="annot"><a href="#local-6989586621680276902"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-81"></span><span>       </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#PABContract"><span class="hs-identifier hs-type">Contract.PABContract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276903"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-82"></span><span>       </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276903"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276902"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>       </span><span class="annot"><span class="hs-operator hs-type">:&lt;|&gt;</span></span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276903"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276902"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#FullReport"><span class="hs-identifier hs-type">FullReport</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">Contract.ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276903"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>       </span><span class="annot"><span class="hs-operator hs-type">:&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractActivationArgs"><span class="hs-identifier hs-type">ContractActivationArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">Contract.ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276903"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276903"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276902"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceId</span></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>              </span><span class="annot"><span class="hs-operator hs-type">:&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276903"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276902"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractInstanceClientState"><span class="hs-identifier hs-type">ContractInstanceClientState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">Contract.ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276903"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>                                          </span><span class="annot"><span class="hs-operator hs-type">:&lt;|&gt;</span></span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276903"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276902"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractSignatureResponse"><span class="hs-identifier hs-type">ContractSignatureResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">Contract.ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276903"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>                                          </span><span class="annot"><span class="hs-operator hs-type">:&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">JSON.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276903"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276902"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>                                          </span><span class="annot"><span class="hs-operator hs-type">:&lt;|&gt;</span></span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276903"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276902"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>                                          </span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>              </span><span class="annot"><span class="hs-operator hs-type">:&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WalletId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276903"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276902"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractInstanceClientState"><span class="hs-identifier hs-type">ContractInstanceClientState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">Contract.ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276903"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>              </span><span class="annot"><span class="hs-operator hs-type">:&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276903"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276902"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractInstanceClientState"><span class="hs-identifier hs-type">ContractInstanceClientState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">Contract.ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276903"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>              </span><span class="annot"><span class="hs-operator hs-type">:&lt;|&gt;</span></span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276903"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276902"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractSignatureResponse"><span class="hs-identifier hs-type">ContractSignatureResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">Contract.ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276903"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span id="apiHandler"><span class="annot"><span class="annottext">apiHandler :: PABAction t env ()
:&lt;|&gt; (PABAction t env (FullReport (ContractDef t))
      :&lt;|&gt; ((ContractActivationArgs (ContractDef t)
             -&gt; PABAction t env ContractInstanceId)
            :&lt;|&gt; ((ContractInstanceId
                   -&gt; PABAction t env (ContractInstanceClientState (ContractDef t))
                      :&lt;|&gt; (PABAction t env (ContractSignatureResponse (ContractDef t))
                            :&lt;|&gt; ((String -&gt; Value -&gt; PABAction t env ())
                                  :&lt;|&gt; PABAction t env ())))
                  :&lt;|&gt; ((WalletId
                         -&gt; Maybe Text
                         -&gt; PABAction t env [ContractInstanceClientState (ContractDef t)])
                        :&lt;|&gt; ((Maybe Text
                               -&gt; PABAction t env [ContractInstanceClientState (ContractDef t)])
                              :&lt;|&gt; PABAction
                                     t env [ContractSignatureResponse (ContractDef t)])))))
</span><a href="Plutus.PAB.Webserver.Handler.html#apiHandler"><span class="hs-identifier hs-var hs-var">apiHandler</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-95"></span><span>        </span><span class="annot"><span class="annottext">PABAction t env ()
forall t env. PABAction t env ()
</span><a href="Plutus.PAB.Webserver.Handler.html#healthcheck"><span class="hs-identifier hs-var">healthcheck</span></a></span><span>
</span><span id="line-96"></span><span>        </span><span class="annot"><span class="annottext">PABAction t env ()
-&gt; (PABAction t env (FullReport (ContractDef t))
    :&lt;|&gt; ((ContractActivationArgs (ContractDef t)
           -&gt; PABAction t env ContractInstanceId)
          :&lt;|&gt; ((ContractInstanceId
                 -&gt; PABAction t env (ContractInstanceClientState (ContractDef t))
                    :&lt;|&gt; (PABAction t env (ContractSignatureResponse (ContractDef t))
                          :&lt;|&gt; ((String -&gt; Value -&gt; PABAction t env ())
                                :&lt;|&gt; PABAction t env ())))
                :&lt;|&gt; ((WalletId
                       -&gt; Maybe Text
                       -&gt; PABAction t env [ContractInstanceClientState (ContractDef t)])
                      :&lt;|&gt; ((Maybe Text
                             -&gt; PABAction t env [ContractInstanceClientState (ContractDef t)])
                            :&lt;|&gt; PABAction
                                   t env [ContractSignatureResponse (ContractDef t)])))))
-&gt; PABAction t env ()
   :&lt;|&gt; (PABAction t env (FullReport (ContractDef t))
         :&lt;|&gt; ((ContractActivationArgs (ContractDef t)
                -&gt; PABAction t env ContractInstanceId)
               :&lt;|&gt; ((ContractInstanceId
                      -&gt; PABAction t env (ContractInstanceClientState (ContractDef t))
                         :&lt;|&gt; (PABAction t env (ContractSignatureResponse (ContractDef t))
                               :&lt;|&gt; ((String -&gt; Value -&gt; PABAction t env ())
                                     :&lt;|&gt; PABAction t env ())))
                     :&lt;|&gt; ((WalletId
                            -&gt; Maybe Text
                            -&gt; PABAction t env [ContractInstanceClientState (ContractDef t)])
                           :&lt;|&gt; ((Maybe Text
                                  -&gt; PABAction t env [ContractInstanceClientState (ContractDef t)])
                                 :&lt;|&gt; PABAction
                                        t env [ContractSignatureResponse (ContractDef t)])))))
forall a b. a -&gt; b -&gt; a :&lt;|&gt; b
</span><span class="hs-operator hs-var">:&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">PABAction t env (FullReport (ContractDef t))
forall t env.
PABContract t =&gt;
PABAction t env (FullReport (ContractDef t))
</span><a href="Plutus.PAB.Webserver.Handler.html#getFullReport"><span class="hs-identifier hs-var">getFullReport</span></a></span><span>
</span><span id="line-97"></span><span>        </span><span class="annot"><span class="annottext">PABAction t env (FullReport (ContractDef t))
-&gt; ((ContractActivationArgs (ContractDef t)
     -&gt; PABAction t env ContractInstanceId)
    :&lt;|&gt; ((ContractInstanceId
           -&gt; PABAction t env (ContractInstanceClientState (ContractDef t))
              :&lt;|&gt; (PABAction t env (ContractSignatureResponse (ContractDef t))
                    :&lt;|&gt; ((String -&gt; Value -&gt; PABAction t env ())
                          :&lt;|&gt; PABAction t env ())))
          :&lt;|&gt; ((WalletId
                 -&gt; Maybe Text
                 -&gt; PABAction t env [ContractInstanceClientState (ContractDef t)])
                :&lt;|&gt; ((Maybe Text
                       -&gt; PABAction t env [ContractInstanceClientState (ContractDef t)])
                      :&lt;|&gt; PABAction
                             t env [ContractSignatureResponse (ContractDef t)]))))
-&gt; PABAction t env (FullReport (ContractDef t))
   :&lt;|&gt; ((ContractActivationArgs (ContractDef t)
          -&gt; PABAction t env ContractInstanceId)
         :&lt;|&gt; ((ContractInstanceId
                -&gt; PABAction t env (ContractInstanceClientState (ContractDef t))
                   :&lt;|&gt; (PABAction t env (ContractSignatureResponse (ContractDef t))
                         :&lt;|&gt; ((String -&gt; Value -&gt; PABAction t env ())
                               :&lt;|&gt; PABAction t env ())))
               :&lt;|&gt; ((WalletId
                      -&gt; Maybe Text
                      -&gt; PABAction t env [ContractInstanceClientState (ContractDef t)])
                     :&lt;|&gt; ((Maybe Text
                            -&gt; PABAction t env [ContractInstanceClientState (ContractDef t)])
                           :&lt;|&gt; PABAction
                                  t env [ContractSignatureResponse (ContractDef t)]))))
forall a b. a -&gt; b -&gt; a :&lt;|&gt; b
</span><span class="hs-operator hs-var">:&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ContractActivationArgs (ContractDef t)
-&gt; PABAction t env ContractInstanceId
forall t env.
PABContract t =&gt;
ContractActivationArgs (ContractDef t)
-&gt; PABAction t env ContractInstanceId
</span><a href="Plutus.PAB.Webserver.Handler.html#activateContract"><span class="hs-identifier hs-var">activateContract</span></a></span><span>
</span><span id="line-98"></span><span>              </span><span class="annot"><span class="annottext">(ContractActivationArgs (ContractDef t)
 -&gt; PABAction t env ContractInstanceId)
-&gt; ((ContractInstanceId
     -&gt; PABAction t env (ContractInstanceClientState (ContractDef t))
        :&lt;|&gt; (PABAction t env (ContractSignatureResponse (ContractDef t))
              :&lt;|&gt; ((String -&gt; Value -&gt; PABAction t env ())
                    :&lt;|&gt; PABAction t env ())))
    :&lt;|&gt; ((WalletId
           -&gt; Maybe Text
           -&gt; PABAction t env [ContractInstanceClientState (ContractDef t)])
          :&lt;|&gt; ((Maybe Text
                 -&gt; PABAction t env [ContractInstanceClientState (ContractDef t)])
                :&lt;|&gt; PABAction t env [ContractSignatureResponse (ContractDef t)])))
-&gt; (ContractActivationArgs (ContractDef t)
    -&gt; PABAction t env ContractInstanceId)
   :&lt;|&gt; ((ContractInstanceId
          -&gt; PABAction t env (ContractInstanceClientState (ContractDef t))
             :&lt;|&gt; (PABAction t env (ContractSignatureResponse (ContractDef t))
                   :&lt;|&gt; ((String -&gt; Value -&gt; PABAction t env ())
                         :&lt;|&gt; PABAction t env ())))
         :&lt;|&gt; ((WalletId
                -&gt; Maybe Text
                -&gt; PABAction t env [ContractInstanceClientState (ContractDef t)])
               :&lt;|&gt; ((Maybe Text
                      -&gt; PABAction t env [ContractInstanceClientState (ContractDef t)])
                     :&lt;|&gt; PABAction t env [ContractSignatureResponse (ContractDef t)])))
forall a b. a -&gt; b -&gt; a :&lt;|&gt; b
</span><span class="hs-operator hs-var">:&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680276900"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276900"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
-&gt; PABAction t env (ContractInstanceClientState (ContractDef t))
forall t env.
PABContract t =&gt;
ContractInstanceId
-&gt; PABAction t env (ContractInstanceClientState (ContractDef t))
</span><a href="Plutus.PAB.Webserver.Handler.html#contractInstanceState"><span class="hs-identifier hs-var">contractInstanceState</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276900"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">PABAction t env (ContractInstanceClientState (ContractDef t))
-&gt; (PABAction t env (ContractSignatureResponse (ContractDef t))
    :&lt;|&gt; ((String -&gt; Value -&gt; PABAction t env ())
          :&lt;|&gt; PABAction t env ()))
-&gt; PABAction t env (ContractInstanceClientState (ContractDef t))
   :&lt;|&gt; (PABAction t env (ContractSignatureResponse (ContractDef t))
         :&lt;|&gt; ((String -&gt; Value -&gt; PABAction t env ())
               :&lt;|&gt; PABAction t env ()))
forall a b. a -&gt; b -&gt; a :&lt;|&gt; b
</span><span class="hs-operator hs-var">:&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
-&gt; PABAction t env (ContractSignatureResponse (ContractDef t))
forall t env.
ContractInstanceId
-&gt; PABAction t env (ContractSignatureResponse (ContractDef t))
</span><a href="Plutus.PAB.Webserver.Handler.html#contractSchema"><span class="hs-identifier hs-var">contractSchema</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276900"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">PABAction t env (ContractSignatureResponse (ContractDef t))
-&gt; ((String -&gt; Value -&gt; PABAction t env ())
    :&lt;|&gt; PABAction t env ())
-&gt; PABAction t env (ContractSignatureResponse (ContractDef t))
   :&lt;|&gt; ((String -&gt; Value -&gt; PABAction t env ())
         :&lt;|&gt; PABAction t env ())
forall a b. a -&gt; b -&gt; a :&lt;|&gt; b
</span><span class="hs-operator hs-var">:&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680276898"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680276898"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621680276897"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680276897"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; String -&gt; Value -&gt; PABAction t env ()
forall t env.
ContractInstanceId -&gt; String -&gt; Value -&gt; PABAction t env ()
</span><a href="Plutus.PAB.Webserver.Handler.html#callEndpoint"><span class="hs-identifier hs-var">callEndpoint</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276900"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680276898"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680276897"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Value -&gt; PABAction t env ())
-&gt; PABAction t env ()
-&gt; (String -&gt; Value -&gt; PABAction t env ()) :&lt;|&gt; PABAction t env ()
forall a b. a -&gt; b -&gt; a :&lt;|&gt; b
</span><span class="hs-operator hs-var">:&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; PABAction t env ()
forall t env. ContractInstanceId -&gt; PABAction t env ()
</span><a href="Plutus.PAB.Webserver.Handler.html#shutdown"><span class="hs-identifier hs-var">shutdown</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276900"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>              </span><span class="annot"><span class="annottext">(ContractInstanceId
 -&gt; PABAction t env (ContractInstanceClientState (ContractDef t))
    :&lt;|&gt; (PABAction t env (ContractSignatureResponse (ContractDef t))
          :&lt;|&gt; ((String -&gt; Value -&gt; PABAction t env ())
                :&lt;|&gt; PABAction t env ())))
-&gt; ((WalletId
     -&gt; Maybe Text
     -&gt; PABAction t env [ContractInstanceClientState (ContractDef t)])
    :&lt;|&gt; ((Maybe Text
           -&gt; PABAction t env [ContractInstanceClientState (ContractDef t)])
          :&lt;|&gt; PABAction t env [ContractSignatureResponse (ContractDef t)]))
-&gt; (ContractInstanceId
    -&gt; PABAction t env (ContractInstanceClientState (ContractDef t))
       :&lt;|&gt; (PABAction t env (ContractSignatureResponse (ContractDef t))
             :&lt;|&gt; ((String -&gt; Value -&gt; PABAction t env ())
                   :&lt;|&gt; PABAction t env ())))
   :&lt;|&gt; ((WalletId
          -&gt; Maybe Text
          -&gt; PABAction t env [ContractInstanceClientState (ContractDef t)])
         :&lt;|&gt; ((Maybe Text
                -&gt; PABAction t env [ContractInstanceClientState (ContractDef t)])
               :&lt;|&gt; PABAction t env [ContractSignatureResponse (ContractDef t)]))
forall a b. a -&gt; b -&gt; a :&lt;|&gt; b
</span><span class="hs-operator hs-var">:&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">WalletId
-&gt; Maybe Text
-&gt; PABAction t env [ContractInstanceClientState (ContractDef t)]
forall t env.
PABContract t =&gt;
WalletId
-&gt; Maybe Text
-&gt; PABAction t env [ContractInstanceClientState (ContractDef t)]
</span><a href="Plutus.PAB.Webserver.Handler.html#instancesForWallets"><span class="hs-identifier hs-var">instancesForWallets</span></a></span><span>
</span><span id="line-100"></span><span>              </span><span class="annot"><span class="annottext">(WalletId
 -&gt; Maybe Text
 -&gt; PABAction t env [ContractInstanceClientState (ContractDef t)])
-&gt; ((Maybe Text
     -&gt; PABAction t env [ContractInstanceClientState (ContractDef t)])
    :&lt;|&gt; PABAction t env [ContractSignatureResponse (ContractDef t)])
-&gt; (WalletId
    -&gt; Maybe Text
    -&gt; PABAction t env [ContractInstanceClientState (ContractDef t)])
   :&lt;|&gt; ((Maybe Text
          -&gt; PABAction t env [ContractInstanceClientState (ContractDef t)])
         :&lt;|&gt; PABAction t env [ContractSignatureResponse (ContractDef t)])
forall a b. a -&gt; b -&gt; a :&lt;|&gt; b
</span><span class="hs-operator hs-var">:&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
-&gt; PABAction t env [ContractInstanceClientState (ContractDef t)]
forall t env.
PABContract t =&gt;
Maybe Text
-&gt; PABAction t env [ContractInstanceClientState (ContractDef t)]
</span><a href="Plutus.PAB.Webserver.Handler.html#allInstanceStates"><span class="hs-identifier hs-var">allInstanceStates</span></a></span><span>
</span><span id="line-101"></span><span>              </span><span class="annot"><span class="annottext">(Maybe Text
 -&gt; PABAction t env [ContractInstanceClientState (ContractDef t)])
-&gt; PABAction t env [ContractSignatureResponse (ContractDef t)]
-&gt; (Maybe Text
    -&gt; PABAction t env [ContractInstanceClientState (ContractDef t)])
   :&lt;|&gt; PABAction t env [ContractSignatureResponse (ContractDef t)]
forall a b. a -&gt; b -&gt; a :&lt;|&gt; b
</span><span class="hs-operator hs-var">:&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">PABAction t env [ContractSignatureResponse (ContractDef t)]
forall t env.
PABAction t env [ContractSignatureResponse (ContractDef t)]
</span><a href="Plutus.PAB.Webserver.Handler.html#availableContracts"><span class="hs-identifier hs-var">availableContracts</span></a></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="annot"><a href="Plutus.PAB.Webserver.Handler.html#swagger"><span class="hs-identifier hs-type">swagger</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680276891"><span class="annot"><a href="#local-6989586621680276891"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680276890"><span class="annot"><a href="#local-6989586621680276890"><span class="hs-identifier hs-type">api</span></a></span></span><span> </span><span id="local-6989586621680276889"><span class="annot"><a href="#local-6989586621680276889"><span class="hs-identifier hs-type">dir</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Servant.Server</span></span><span> </span><span class="annot"><a href="#local-6989586621680276890"><span class="hs-identifier hs-type">api</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Servant.Handler</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">JSON.Value</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToSchema</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">Contract.ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276891"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Servant.Server</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SwaggerSchemaUI'</span></span><span> </span><span class="annot"><a href="#local-6989586621680276889"><span class="hs-identifier hs-type">dir</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276890"><span class="hs-identifier hs-type">api</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span id="swagger"><span class="annot"><span class="annottext">swagger :: Server (SwaggerSchemaUI' dir api)
</span><a href="Plutus.PAB.Webserver.Handler.html#swagger"><span class="hs-identifier hs-var hs-var">swagger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenApi -&gt; Server (SwaggerSchemaUI' dir api)
forall api a (dir :: Symbol).
(Server api ~ Handler Value, ToJSON a) =&gt;
a -&gt; Server (SwaggerSchemaUI' dir api)
</span><span class="hs-identifier hs-var">swaggerSchemaUIServer</span></span><span> </span><span class="annot"><span class="annottext">(OpenApi -&gt; Server (SwaggerSchemaUI' dir api))
-&gt; OpenApi -&gt; Server (SwaggerSchemaUI' dir api)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy (API (ContractDef t) Integer) -&gt; OpenApi
forall k (api :: k). HasOpenApi api =&gt; Proxy api -&gt; OpenApi
</span><span class="hs-identifier hs-var">toOpenApi</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (API (ContractDef t) Integer)
forall k (t :: k). Proxy t
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Webserver.API.html#API"><span class="hs-identifier hs-type">API</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">Contract.ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680276891"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/integer-gmp-1.0.3.0/src"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span id="local-6989586621680277002"><span class="annot"><a href="Plutus.PAB.Webserver.Handler.html#fromInternalState"><span class="hs-identifier hs-type">fromInternalState</span></a></span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680277002"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceId</span></span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractActivityStatus</span></span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Wallet</span></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Wallet.LocalClient.ExportTx.html#ExportTx"><span class="hs-identifier hs-type">ExportTx</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Events.ContractInstanceState.html#PartiallyDecodedResponse"><span class="hs-identifier hs-type">PartiallyDecodedResponse</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PABReq</span></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractInstanceClientState"><span class="hs-identifier hs-type">ContractInstanceClientState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277002"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-114"></span><span id="fromInternalState"><span class="annot"><span class="annottext">fromInternalState :: t
-&gt; ContractInstanceId
-&gt; ContractActivityStatus
-&gt; Wallet
-&gt; [ExportTx]
-&gt; PartiallyDecodedResponse PABReq
-&gt; ContractInstanceClientState t
</span><a href="Plutus.PAB.Webserver.Handler.html#fromInternalState"><span class="hs-identifier hs-var hs-var">fromInternalState</span></a></span></span><span> </span><span id="local-6989586621680276887"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680276887"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621680276886"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276886"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680276885"><span class="annot"><span class="annottext">ContractActivityStatus
</span><a href="#local-6989586621680276885"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621680276884"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680276884"><span class="hs-identifier hs-var">wallet</span></a></span></span><span> </span><span id="local-6989586621680276883"><span class="annot"><span class="annottext">[ExportTx]
</span><a href="#local-6989586621680276883"><span class="hs-identifier hs-var">yieldedExportTxs</span></a></span></span><span> </span><span id="local-6989586621680276882"><span class="annot"><span class="annottext">PartiallyDecodedResponse PABReq
</span><a href="#local-6989586621680276882"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-115"></span><span>    </span><span class="annot"><span class="annottext">ContractInstanceClientState :: forall t.
ContractInstanceId
-&gt; PartiallyDecodedResponse ActiveEndpoint
-&gt; Wallet
-&gt; t
-&gt; ContractActivityStatus
-&gt; [ExportTx]
-&gt; ContractInstanceClientState t
</span><a href="Plutus.PAB.Webserver.Types.html#ContractInstanceClientState"><span class="hs-identifier hs-type">ContractInstanceClientState</span></a></span><span>
</span><span id="line-116"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cicContract :: ContractInstanceId
</span><a href="Plutus.PAB.Webserver.Types.html#cicContract"><span class="hs-identifier hs-var">cicContract</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276886"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-117"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cicCurrentState :: PartiallyDecodedResponse ActiveEndpoint
</span><a href="Plutus.PAB.Webserver.Types.html#cicCurrentState"><span class="hs-identifier hs-var">cicCurrentState</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-118"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680276881"><span class="annot"><span class="annottext">hks' :: [Request ActiveEndpoint]
</span><a href="#local-6989586621680276881"><span class="hs-identifier hs-var hs-var">hks'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Request PABReq -&gt; Maybe (Request ActiveEndpoint))
-&gt; [Request PABReq] -&gt; [Request ActiveEndpoint]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PABReq -&gt; Maybe ActiveEndpoint)
-&gt; Request PABReq -&gt; Maybe (Request ActiveEndpoint)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting (First ActiveEndpoint) PABReq ActiveEndpoint
-&gt; PABReq -&gt; Maybe ActiveEndpoint
forall s (m :: * -&gt; *) a.
MonadReader s m =&gt;
Getting (First a) s a -&gt; m (Maybe a)
</span><span class="hs-identifier hs-var">preview</span></span><span> </span><span class="annot"><span class="annottext">Getting (First ActiveEndpoint) PABReq ActiveEndpoint
Prism' PABReq ActiveEndpoint
</span><span class="hs-identifier hs-var">_ExposeEndpointReq</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PartiallyDecodedResponse PABReq -&gt; [Request PABReq]
forall v. PartiallyDecodedResponse v -&gt; [Request v]
</span><a href="Plutus.PAB.Events.ContractInstanceState.html#hooks"><span class="hs-identifier hs-var hs-var">hooks</span></a></span><span> </span><span class="annot"><span class="annottext">PartiallyDecodedResponse PABReq
</span><a href="#local-6989586621680276882"><span class="hs-identifier hs-var">resp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">PartiallyDecodedResponse PABReq
</span><a href="#local-6989586621680276882"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">hooks :: [Request ActiveEndpoint]
</span><a href="Plutus.PAB.Events.ContractInstanceState.html#hooks"><span class="hs-identifier hs-var">hooks</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Request ActiveEndpoint]
</span><a href="#local-6989586621680276881"><span class="hs-identifier hs-var">hks'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-120"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cicWallet :: Wallet
</span><a href="Plutus.PAB.Webserver.Types.html#cicWallet"><span class="hs-identifier hs-var">cicWallet</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680276884"><span class="hs-identifier hs-var">wallet</span></a></span><span>
</span><span id="line-121"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cicDefinition :: t
</span><a href="Plutus.PAB.Webserver.Types.html#cicDefinition"><span class="hs-identifier hs-var">cicDefinition</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680276887"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-122"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cicStatus :: ContractActivityStatus
</span><a href="Plutus.PAB.Webserver.Types.html#cicStatus"><span class="hs-identifier hs-var">cicStatus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractActivityStatus
</span><a href="#local-6989586621680276885"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-123"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cicYieldedExportTxs :: [ExportTx]
</span><a href="Plutus.PAB.Webserver.Types.html#cicYieldedExportTxs"><span class="hs-identifier hs-var">cicYieldedExportTxs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ExportTx]
</span><a href="#local-6989586621680276883"><span class="hs-identifier hs-var">yieldedExportTxs</span></a></span><span>
</span><span id="line-124"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-comment">-- HANDLERS</span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="annot"><a href="Plutus.PAB.Webserver.Handler.html#activateContract"><span class="hs-identifier hs-type">activateContract</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680277061"><span class="annot"><a href="#local-6989586621680277061"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680277060"><span class="annot"><a href="#local-6989586621680277060"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#PABContract"><span class="hs-identifier hs-type">Contract.PABContract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277061"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractActivationArgs"><span class="hs-identifier hs-type">ContractActivationArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">Contract.ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277061"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277061"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277060"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceId</span></span><span>
</span><span id="line-129"></span><span id="activateContract"><span class="annot"><span class="annottext">activateContract :: ContractActivationArgs (ContractDef t)
-&gt; PABAction t env ContractInstanceId
</span><a href="Plutus.PAB.Webserver.Handler.html#activateContract"><span class="hs-identifier hs-var hs-var">activateContract</span></a></span></span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractActivationArgs"><span class="hs-identifier hs-type">ContractActivationArgs</span></a></span><span class="hs-special">{</span><span id="local-6989586621680276880"><span class="annot"><span class="annottext">ContractDef t
caID :: ContractDef t
caID :: forall t. ContractActivationArgs t -&gt; t
</span><a href="#local-6989586621680276880"><span class="hs-identifier hs-var hs-var">caID</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680276879"><span class="annot"><span class="annottext">Maybe Wallet
caWallet :: Maybe Wallet
caWallet :: forall t. ContractActivationArgs t -&gt; Maybe Wallet
</span><a href="#local-6989586621680276879"><span class="hs-identifier hs-var hs-var">caWallet</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-130"></span><span>    </span><span class="annot"><span class="annottext">Wallet -&gt; ContractDef t -&gt; PABAction t env ContractInstanceId
forall t env.
PABContract t =&gt;
Wallet -&gt; ContractDef t -&gt; PABAction t env ContractInstanceId
</span><a href="Plutus.PAB.Core.html#activateContract"><span class="hs-identifier hs-var">Core.activateContract</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; Maybe Wallet -&gt; Wallet
forall a. a -&gt; Maybe a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Wallet
</span><span class="hs-identifier hs-var">knownWallet</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Wallet
</span><a href="#local-6989586621680276879"><span class="hs-identifier hs-var">caWallet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ContractDef t
</span><a href="#local-6989586621680276880"><span class="hs-identifier hs-var">caID</span></a></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="annot"><a href="Plutus.PAB.Webserver.Handler.html#contractInstanceState"><span class="hs-identifier hs-type">contractInstanceState</span></a></span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680277059"><span class="annot"><a href="#local-6989586621680277059"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680277058"><span class="annot"><a href="#local-6989586621680277058"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#PABContract"><span class="hs-identifier hs-type">Contract.PABContract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277059"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceId</span></span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277059"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277058"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractInstanceClientState"><span class="hs-identifier hs-type">ContractInstanceClientState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">Contract.ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277059"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span id="contractInstanceState"><span class="annot"><span class="annottext">contractInstanceState :: ContractInstanceId
-&gt; PABAction t env (ContractInstanceClientState (ContractDef t))
</span><a href="Plutus.PAB.Webserver.Handler.html#contractInstanceState"><span class="hs-identifier hs-var hs-var">contractInstanceState</span></a></span></span><span> </span><span id="local-6989586621680276877"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276877"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-137"></span><span>  </span><span id="local-6989586621680276876"><span class="annot"><span class="annottext">Maybe (ContractActivationArgs (ContractDef t))
</span><a href="#local-6989586621680276876"><span class="hs-identifier hs-var">definition</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
-&gt; Eff
     (PABEffects t env) (Maybe (ContractActivationArgs (ContractDef t)))
forall t (effs :: [* -&gt; *]).
Member (ContractStore t) effs =&gt;
ContractInstanceId
-&gt; Eff effs (Maybe (ContractActivationArgs (ContractDef t)))
</span><a href="Plutus.PAB.Effects.Contract.html#getDefinition"><span class="hs-identifier hs-var">Contract.getDefinition</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680277059"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276877"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-138"></span><span>  </span><span id="local-6989586621680276875"><span class="annot"><span class="annottext">ContractActivityStatus
</span><a href="#local-6989586621680276875"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; PABAction t env ContractActivityStatus
forall t env.
ContractInstanceId -&gt; PABAction t env ContractActivityStatus
</span><a href="Plutus.PAB.Core.html#waitForInstanceStateWithResult"><span class="hs-identifier hs-var">Core.waitForInstanceStateWithResult</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276877"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (ContractActivationArgs (ContractDef t))
</span><a href="#local-6989586621680276876"><span class="hs-identifier hs-var">definition</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractActivationArgs"><span class="hs-identifier hs-type">ContractActivationArgs</span></a></span><span class="hs-special">{</span><span id="local-6989586621680276873"><span class="annot"><span class="annottext">Maybe Wallet
caWallet :: Maybe Wallet
caWallet :: forall t. ContractActivationArgs t -&gt; Maybe Wallet
</span><a href="#local-6989586621680276873"><span class="hs-identifier hs-var hs-var">caWallet</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680276872"><span class="annot"><span class="annottext">ContractDef t
caID :: ContractDef t
caID :: forall t. ContractActivationArgs t -&gt; t
</span><a href="#local-6989586621680276872"><span class="hs-identifier hs-var hs-var">caID</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-141"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680276871"><span class="annot"><span class="annottext">wallet :: Wallet
</span><a href="#local-6989586621680276871"><span class="hs-identifier hs-var hs-var">wallet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Maybe Wallet -&gt; Wallet
forall a. a -&gt; Maybe a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Wallet
</span><span class="hs-identifier hs-var">knownWallet</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Wallet
</span><a href="#local-6989586621680276873"><span class="hs-identifier hs-var">caWallet</span></a></span><span>
</span><span id="line-142"></span><span>      </span><span id="local-6989586621680276870"><span class="annot"><span class="annottext">[ExportTx]
</span><a href="#local-6989586621680276870"><span class="hs-identifier hs-var">yieldedExportedTxs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; PABAction t env [ExportTx]
forall t env. ContractInstanceId -&gt; PABAction t env [ExportTx]
</span><a href="Plutus.PAB.Core.html#yieldedExportTxs"><span class="hs-identifier hs-var">Core.yieldedExportTxs</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276877"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-143"></span><span>      </span><span id="local-6989586621680276868"><span class="annot"><span class="annottext">ContractInstanceClientState (ContractDef t)
</span><a href="#local-6989586621680276868"><span class="hs-identifier hs-var">istate</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(State t -&gt; ContractInstanceClientState (ContractDef t))
-&gt; Eff (PABEffects t env) (State t)
-&gt; PABAction t env (ContractInstanceClientState (ContractDef t))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ContractDef t
-&gt; ContractInstanceId
-&gt; ContractActivityStatus
-&gt; Wallet
-&gt; [ExportTx]
-&gt; PartiallyDecodedResponse PABReq
-&gt; ContractInstanceClientState (ContractDef t)
forall t.
t
-&gt; ContractInstanceId
-&gt; ContractActivityStatus
-&gt; Wallet
-&gt; [ExportTx]
-&gt; PartiallyDecodedResponse PABReq
-&gt; ContractInstanceClientState t
</span><a href="Plutus.PAB.Webserver.Handler.html#fromInternalState"><span class="hs-identifier hs-var">fromInternalState</span></a></span><span> </span><span class="annot"><span class="annottext">ContractDef t
</span><a href="#local-6989586621680276872"><span class="hs-identifier hs-var">caID</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276877"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">ContractActivityStatus
</span><a href="#local-6989586621680276875"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680276871"><span class="hs-identifier hs-var">wallet</span></a></span><span> </span><span class="annot"><span class="annottext">[ExportTx]
</span><a href="#local-6989586621680276870"><span class="hs-identifier hs-var">yieldedExportedTxs</span></a></span><span>
</span><span id="line-144"></span><span>                       </span><span class="annot"><span class="annottext">(PartiallyDecodedResponse PABReq
 -&gt; ContractInstanceClientState (ContractDef t))
-&gt; (State t -&gt; PartiallyDecodedResponse PABReq)
-&gt; State t
-&gt; ContractInstanceClientState (ContractDef t)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ContractResponse Value Value PABResp PABReq
-&gt; PartiallyDecodedResponse PABReq
forall s v.
ContractResponse Value Value s v -&gt; PartiallyDecodedResponse v
</span><a href="Plutus.PAB.Events.ContractInstanceState.html#fromResp"><span class="hs-identifier hs-var">fromResp</span></a></span><span>
</span><span id="line-145"></span><span>                       </span><span class="annot"><span class="annottext">(ContractResponse Value Value PABResp PABReq
 -&gt; PartiallyDecodedResponse PABReq)
-&gt; (State t -&gt; ContractResponse Value Value PABResp PABReq)
-&gt; State t
-&gt; PartiallyDecodedResponse PABReq
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy t -&gt; State t -&gt; ContractResponse Value Value PABResp PABReq
forall contract.
PABContract contract =&gt;
Proxy contract
-&gt; State contract -&gt; ContractResponse Value Value PABResp PABReq
</span><a href="Plutus.PAB.Effects.Contract.html#serialisableState"><span class="hs-identifier hs-var">Contract.serialisableState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy t
forall k (t :: k). Proxy t
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680277059"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>                     </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Eff (PABEffects t env) (State t)
 -&gt; PABAction t env (ContractInstanceClientState (ContractDef t)))
-&gt; Eff (PABEffects t env) (State t)
-&gt; PABAction t env (ContractInstanceClientState (ContractDef t))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; Eff (PABEffects t env) (State t)
forall t (effs :: [* -&gt; *]).
Member (ContractStore t) effs =&gt;
ContractInstanceId -&gt; Eff effs (State t)
</span><a href="Plutus.PAB.Effects.Contract.html#getState"><span class="hs-identifier hs-var">Contract.getState</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680277059"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276877"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-147"></span><span>      </span><span class="annot"><span class="annottext">ContractActivityStatus -&gt; ContractInstanceId -&gt; PABAction t env ()
forall t env.
ContractActivityStatus -&gt; ContractInstanceId -&gt; PABAction t env ()
</span><a href="Plutus.PAB.Webserver.Handler.html#removeUnlessActive"><span class="hs-identifier hs-var">removeUnlessActive</span></a></span><span> </span><span class="annot"><span class="annottext">ContractActivityStatus
</span><a href="#local-6989586621680276875"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276877"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-148"></span><span>      </span><span class="annot"><span class="annottext">ContractInstanceClientState (ContractDef t)
-&gt; PABAction t env (ContractInstanceClientState (ContractDef t))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceClientState (ContractDef t)
</span><a href="#local-6989586621680276868"><span class="hs-identifier hs-var">istate</span></a></span><span>
</span><span id="line-149"></span><span>    </span><span class="annot"><span class="annottext">Maybe (ContractActivationArgs (ContractDef t))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PABError
-&gt; PABAction t env (ContractInstanceClientState (ContractDef t))
forall e (effs :: [* -&gt; *]) a.
Member (Error e) effs =&gt;
e -&gt; Eff effs a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.PAB.Types.html#PABError"><span class="hs-identifier hs-type">PABError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContractInstanceId -&gt; PABError
</span><a href="Plutus.PAB.Types.html#ContractInstanceNotFound"><span class="hs-identifier hs-var">ContractInstanceNotFound</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276877"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span id="local-6989586621680277000"><span id="local-6989586621680277001"><span class="annot"><a href="Plutus.PAB.Webserver.Handler.html#removeUnlessActive"><span class="hs-identifier hs-type">removeUnlessActive</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractActivityStatus</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277001"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277000"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-152"></span><span id="removeUnlessActive"><span class="annot"><span class="annottext">removeUnlessActive :: ContractActivityStatus -&gt; ContractInstanceId -&gt; PABAction t env ()
</span><a href="Plutus.PAB.Webserver.Handler.html#removeUnlessActive"><span class="hs-identifier hs-var hs-var">removeUnlessActive</span></a></span></span><span> </span><span id="local-6989586621680276866"><span class="annot"><span class="annottext">ContractActivityStatus
</span><a href="#local-6989586621680276866"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621680276865"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276865"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; PABAction t env () -&gt; PABAction t env ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContractActivityStatus
</span><a href="#local-6989586621680276866"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ContractActivityStatus -&gt; ContractActivityStatus -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">ContractActivityStatus
</span><span class="hs-identifier hs-var">Active</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContractInstanceId -&gt; PABAction t env ()
forall t env. ContractInstanceId -&gt; PABAction t env ()
</span><a href="Plutus.PAB.Core.html#removeInstance"><span class="hs-identifier hs-var">Core.removeInstance</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276865"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="annot"><a href="Plutus.PAB.Webserver.Handler.html#callEndpoint"><span class="hs-identifier hs-type">callEndpoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680277055"><span class="annot"><a href="#local-6989586621680277055"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680277054"><span class="annot"><a href="#local-6989586621680277054"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">JSON.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277055"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277054"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span id="callEndpoint"><span class="annot"><span class="annottext">callEndpoint :: ContractInstanceId -&gt; String -&gt; Value -&gt; PABAction t env ()
</span><a href="Plutus.PAB.Webserver.Handler.html#callEndpoint"><span class="hs-identifier hs-var hs-var">callEndpoint</span></a></span></span><span> </span><span id="local-6989586621680276863"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276863"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680276862"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680276862"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680276861"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680276861"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
-&gt; String -&gt; Value -&gt; PABAction t env (Maybe NotificationError)
forall t env a.
ToJSON a =&gt;
ContractInstanceId
-&gt; String -&gt; a -&gt; PABAction t env (Maybe NotificationError)
</span><a href="Plutus.PAB.Core.html#callEndpointOnInstance"><span class="hs-identifier hs-var">Core.callEndpointOnInstance</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276863"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680276862"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680276861"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">PABAction t env (Maybe NotificationError)
-&gt; (Maybe NotificationError -&gt; PABAction t env ())
-&gt; PABAction t env ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(NotificationError -&gt; Eff (PABEffects t env) Any)
-&gt; Maybe NotificationError -&gt; PABAction t env ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]) a.
Member (Error PABError) effs =&gt;
PABError -&gt; Eff effs a
forall e (effs :: [* -&gt; *]) a.
Member (Error e) effs =&gt;
e -&gt; Eff effs a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.PAB.Types.html#PABError"><span class="hs-identifier hs-type">PABError</span></a></span><span> </span><span class="annot"><span class="annottext">(PABError -&gt; Eff (PABEffects t env) Any)
-&gt; (NotificationError -&gt; PABError)
-&gt; NotificationError
-&gt; Eff (PABEffects t env) Any
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">NotificationError -&gt; PABError
</span><a href="Plutus.PAB.Types.html#EndpointCallError"><span class="hs-identifier hs-var">EndpointCallError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="annot"><a href="Plutus.PAB.Webserver.Handler.html#instancesForWallets"><span class="hs-identifier hs-type">instancesForWallets</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680277051"><span class="annot"><a href="#local-6989586621680277051"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680277050"><span class="annot"><a href="#local-6989586621680277050"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#PABContract"><span class="hs-identifier hs-type">Contract.PABContract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277051"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WalletId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277051"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277050"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractInstanceClientState"><span class="hs-identifier hs-type">ContractInstanceClientState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">Contract.ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277051"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-158"></span><span id="instancesForWallets"><span class="annot"><span class="annottext">instancesForWallets :: WalletId
-&gt; Maybe Text
-&gt; PABAction t env [ContractInstanceClientState (ContractDef t)]
</span><a href="Plutus.PAB.Webserver.Handler.html#instancesForWallets"><span class="hs-identifier hs-var hs-var">instancesForWallets</span></a></span></span><span> </span><span id="local-6989586621680276859"><span class="annot"><span class="annottext">WalletId
</span><a href="#local-6989586621680276859"><span class="hs-identifier hs-var">wallet</span></a></span></span><span> </span><span id="local-6989586621680276858"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621680276858"><span class="hs-identifier hs-var">mStatus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ContractInstanceClientState (ContractDef t) -&gt; Bool)
-&gt; [ContractInstanceClientState (ContractDef t)]
-&gt; [ContractInstanceClientState (ContractDef t)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WalletId -&gt; WalletId -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">(==)</span></a></span><span> </span><span class="annot"><span class="annottext">WalletId
</span><a href="#local-6989586621680276859"><span class="hs-identifier hs-var">wallet</span></a></span><span> </span><span class="annot"><span class="annottext">(WalletId -&gt; Bool)
-&gt; (ContractInstanceClientState (ContractDef t) -&gt; WalletId)
-&gt; ContractInstanceClientState (ContractDef t)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; WalletId
</span><span class="hs-identifier hs-var hs-var">getWalletId</span></span><span> </span><span class="annot"><span class="annottext">(Wallet -&gt; WalletId)
-&gt; (ContractInstanceClientState (ContractDef t) -&gt; Wallet)
-&gt; ContractInstanceClientState (ContractDef t)
-&gt; WalletId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceClientState (ContractDef t) -&gt; Wallet
forall t. ContractInstanceClientState t -&gt; Wallet
</span><a href="Plutus.PAB.Webserver.Types.html#cicWallet"><span class="hs-identifier hs-var hs-var">cicWallet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ContractInstanceClientState (ContractDef t)]
 -&gt; [ContractInstanceClientState (ContractDef t)])
-&gt; PABAction t env [ContractInstanceClientState (ContractDef t)]
-&gt; PABAction t env [ContractInstanceClientState (ContractDef t)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
-&gt; PABAction t env [ContractInstanceClientState (ContractDef t)]
forall t env.
PABContract t =&gt;
Maybe Text
-&gt; PABAction t env [ContractInstanceClientState (ContractDef t)]
</span><a href="Plutus.PAB.Webserver.Handler.html#allInstanceStates"><span class="hs-identifier hs-var">allInstanceStates</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621680276858"><span class="hs-identifier hs-var">mStatus</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="annot"><a href="Plutus.PAB.Webserver.Handler.html#allInstanceStates"><span class="hs-identifier hs-type">allInstanceStates</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680277049"><span class="annot"><a href="#local-6989586621680277049"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680277048"><span class="annot"><a href="#local-6989586621680277048"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#PABContract"><span class="hs-identifier hs-type">Contract.PABContract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277049"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277049"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277048"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractInstanceClientState"><span class="hs-identifier hs-type">ContractInstanceClientState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">Contract.ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277049"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-161"></span><span id="allInstanceStates"><span class="annot"><span class="annottext">allInstanceStates :: Maybe Text
-&gt; PABAction t env [ContractInstanceClientState (ContractDef t)]
</span><a href="Plutus.PAB.Webserver.Handler.html#allInstanceStates"><span class="hs-identifier hs-var hs-var">allInstanceStates</span></a></span></span><span> </span><span id="local-6989586621680276857"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621680276857"><span class="hs-identifier hs-var">mStatus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-162"></span><span>    </span><span id="local-6989586621680276856"><span class="annot"><span class="annottext">Map ContractInstanceId ContractActivityStatus
</span><a href="#local-6989586621680276856"><span class="hs-identifier hs-var">instWithStatuses</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PABAction t env (Map ContractInstanceId ContractActivityStatus)
forall t env.
PABAction t env (Map ContractInstanceId ContractActivityStatus)
</span><a href="Plutus.PAB.Core.html#instancesWithStatuses"><span class="hs-identifier hs-var">Core.instancesWithStatuses</span></a></span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680276854"><span class="annot"><span class="annottext">mActivityStatus :: Maybe ContractActivityStatus
</span><a href="#local-6989586621680276854"><span class="hs-identifier hs-var hs-var">mActivityStatus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Maybe ContractActivityStatus)
-&gt; Maybe ContractActivityStatus
forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">join</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Maybe ContractActivityStatus)
 -&gt; Maybe ContractActivityStatus)
-&gt; Maybe (Maybe ContractActivityStatus)
-&gt; Maybe ContractActivityStatus
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe ContractActivityStatus
</span><span class="hs-identifier hs-var">parseContractActivityStatus</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Maybe ContractActivityStatus)
-&gt; Maybe Text -&gt; Maybe (Maybe ContractActivityStatus)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621680276857"><span class="hs-identifier hs-var">mStatus</span></a></span><span>
</span><span id="line-164"></span><span>        </span><span id="local-6989586621680276853"><span class="annot"><span class="annottext">isInstanceStatusMatch :: ContractActivityStatus -&gt; Bool
</span><a href="#local-6989586621680276853"><span class="hs-identifier hs-var hs-var">isInstanceStatusMatch</span></a></span></span><span> </span><span id="local-6989586621680276852"><span class="annot"><span class="annottext">ContractActivityStatus
</span><a href="#local-6989586621680276852"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; (ContractActivityStatus -&gt; Bool)
-&gt; Maybe ContractActivityStatus
-&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContractActivityStatus -&gt; ContractActivityStatus -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">(==)</span></a></span><span> </span><span class="annot"><span class="annottext">ContractActivityStatus
</span><a href="#local-6989586621680276852"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe ContractActivityStatus
</span><a href="#local-6989586621680276854"><span class="hs-identifier hs-var">mActivityStatus</span></a></span><span>
</span><span id="line-165"></span><span>        </span><span id="local-6989586621680276850"><span class="annot"><span class="annottext">getStatus :: (ContractInstanceId, ContractActivationArgs (ContractDef t))
-&gt; Maybe
     (ContractInstanceId, ContractActivationArgs (ContractDef t),
      ContractActivityStatus)
</span><a href="#local-6989586621680276850"><span class="hs-identifier hs-var hs-var">getStatus</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680276849"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276849"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680276848"><span class="annot"><span class="annottext">ContractActivationArgs (ContractDef t)
</span><a href="#local-6989586621680276848"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276849"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ContractActivationArgs (ContractDef t)
</span><a href="#local-6989586621680276848"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ContractActivityStatus
 -&gt; (ContractInstanceId, ContractActivationArgs (ContractDef t),
     ContractActivityStatus))
-&gt; Maybe ContractActivityStatus
-&gt; Maybe
     (ContractInstanceId, ContractActivationArgs (ContractDef t),
      ContractActivityStatus)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
-&gt; Map ContractInstanceId ContractActivityStatus
-&gt; Maybe ContractActivityStatus
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276849"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Map ContractInstanceId ContractActivityStatus
</span><a href="#local-6989586621680276856"><span class="hs-identifier hs-var">instWithStatuses</span></a></span><span>
</span><span id="line-166"></span><span>        </span><span id="local-6989586621680276846"><span class="annot"><span class="annottext">get :: (ContractInstanceId, ContractActivationArgs (ContractDef t),
 ContractActivityStatus)
-&gt; Eff
     (PABEffects t env) (ContractInstanceClientState (ContractDef t))
</span><a href="#local-6989586621680276846"><span class="hs-identifier hs-var hs-var">get</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680276845"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276845"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractActivationArgs"><span class="hs-identifier hs-type">ContractActivationArgs</span></a></span><span class="hs-special">{</span><span id="local-6989586621680276844"><span class="annot"><span class="annottext">Maybe Wallet
caWallet :: Maybe Wallet
caWallet :: forall t. ContractActivationArgs t -&gt; Maybe Wallet
</span><a href="#local-6989586621680276844"><span class="hs-identifier hs-var hs-var">caWallet</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680276843"><span class="annot"><span class="annottext">ContractDef t
caID :: ContractDef t
caID :: forall t. ContractActivationArgs t -&gt; t
</span><a href="#local-6989586621680276843"><span class="hs-identifier hs-var hs-var">caID</span></a></span></span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span id="local-6989586621680276842"><span class="annot"><span class="annottext">ContractActivityStatus
</span><a href="#local-6989586621680276842"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-167"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680276841"><span class="annot"><span class="annottext">wallet :: Wallet
</span><a href="#local-6989586621680276841"><span class="hs-identifier hs-var hs-var">wallet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Maybe Wallet -&gt; Wallet
forall a. a -&gt; Maybe a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Wallet
</span><span class="hs-identifier hs-var">knownWallet</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Wallet
</span><a href="#local-6989586621680276844"><span class="hs-identifier hs-var">caWallet</span></a></span><span>
</span><span id="line-168"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-169"></span><span>                </span><span id="local-6989586621680276840"><span class="annot"><span class="annottext">[ExportTx]
</span><a href="#local-6989586621680276840"><span class="hs-identifier hs-var">yieldedExportedTxs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; PABAction t env [ExportTx]
forall t env. ContractInstanceId -&gt; PABAction t env [ExportTx]
</span><a href="Plutus.PAB.Core.html#yieldedExportTxs"><span class="hs-identifier hs-var">Core.yieldedExportTxs</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276845"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-170"></span><span>                </span><span class="annot"><span class="annottext">(State t -&gt; ContractInstanceClientState (ContractDef t))
-&gt; Eff (PABEffects t env) (State t)
-&gt; Eff
     (PABEffects t env) (ContractInstanceClientState (ContractDef t))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ContractDef t
-&gt; ContractInstanceId
-&gt; ContractActivityStatus
-&gt; Wallet
-&gt; [ExportTx]
-&gt; PartiallyDecodedResponse PABReq
-&gt; ContractInstanceClientState (ContractDef t)
forall t.
t
-&gt; ContractInstanceId
-&gt; ContractActivityStatus
-&gt; Wallet
-&gt; [ExportTx]
-&gt; PartiallyDecodedResponse PABReq
-&gt; ContractInstanceClientState t
</span><a href="Plutus.PAB.Webserver.Handler.html#fromInternalState"><span class="hs-identifier hs-var">fromInternalState</span></a></span><span> </span><span class="annot"><span class="annottext">ContractDef t
</span><a href="#local-6989586621680276843"><span class="hs-identifier hs-var">caID</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276845"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">ContractActivityStatus
</span><a href="#local-6989586621680276842"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680276841"><span class="hs-identifier hs-var">wallet</span></a></span><span> </span><span class="annot"><span class="annottext">[ExportTx]
</span><a href="#local-6989586621680276840"><span class="hs-identifier hs-var">yieldedExportedTxs</span></a></span><span>
</span><span id="line-171"></span><span>                     </span><span class="annot"><span class="annottext">(PartiallyDecodedResponse PABReq
 -&gt; ContractInstanceClientState (ContractDef t))
-&gt; (State t -&gt; PartiallyDecodedResponse PABReq)
-&gt; State t
-&gt; ContractInstanceClientState (ContractDef t)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ContractResponse Value Value PABResp PABReq
-&gt; PartiallyDecodedResponse PABReq
forall s v.
ContractResponse Value Value s v -&gt; PartiallyDecodedResponse v
</span><a href="Plutus.PAB.Events.ContractInstanceState.html#fromResp"><span class="hs-identifier hs-var">fromResp</span></a></span><span>
</span><span id="line-172"></span><span>                     </span><span class="annot"><span class="annottext">(ContractResponse Value Value PABResp PABReq
 -&gt; PartiallyDecodedResponse PABReq)
-&gt; (State t -&gt; ContractResponse Value Value PABResp PABReq)
-&gt; State t
-&gt; PartiallyDecodedResponse PABReq
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy t -&gt; State t -&gt; ContractResponse Value Value PABResp PABReq
forall contract.
PABContract contract =&gt;
Proxy contract
-&gt; State contract -&gt; ContractResponse Value Value PABResp PABReq
</span><a href="Plutus.PAB.Effects.Contract.html#serialisableState"><span class="hs-identifier hs-var">Contract.serialisableState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy t
forall k (t :: k). Proxy t
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680277049"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>                     </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Eff (PABEffects t env) (State t)
 -&gt; Eff
      (PABEffects t env) (ContractInstanceClientState (ContractDef t)))
-&gt; Eff (PABEffects t env) (State t)
-&gt; Eff
     (PABEffects t env) (ContractInstanceClientState (ContractDef t))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; Eff (PABEffects t env) (State t)
forall t (effs :: [* -&gt; *]).
Member (ContractStore t) effs =&gt;
ContractInstanceId -&gt; Eff effs (State t)
</span><a href="Plutus.PAB.Effects.Contract.html#getState"><span class="hs-identifier hs-var">Contract.getState</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680277049"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276845"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-174"></span><span>    </span><span id="local-6989586621680276839"><span class="annot"><span class="annottext">Map ContractInstanceId (ContractActivationArgs (ContractDef t))
</span><a href="#local-6989586621680276839"><span class="hs-identifier hs-var">mp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe ContractActivityStatus
-&gt; Eff
     (PABEffects t env)
     (Map ContractInstanceId (ContractActivationArgs (ContractDef t)))
forall t (effs :: [* -&gt; *]).
Member (ContractStore t) effs =&gt;
Maybe ContractActivityStatus
-&gt; Eff
     effs
     (Map ContractInstanceId (ContractActivationArgs (ContractDef t)))
</span><a href="Plutus.PAB.Effects.Contract.html#getContracts"><span class="hs-identifier hs-var">Contract.getContracts</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680277049"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ContractActivityStatus
</span><a href="#local-6989586621680276854"><span class="hs-identifier hs-var">mActivityStatus</span></a></span><span>
</span><span id="line-175"></span><span>    </span><span class="annot"><span class="annottext">(ContractInstanceClientState (ContractDef t) -&gt; Bool)
-&gt; [ContractInstanceClientState (ContractDef t)]
-&gt; [ContractInstanceClientState (ContractDef t)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContractActivityStatus -&gt; Bool
</span><a href="#local-6989586621680276853"><span class="hs-identifier hs-var">isInstanceStatusMatch</span></a></span><span> </span><span class="annot"><span class="annottext">(ContractActivityStatus -&gt; Bool)
-&gt; (ContractInstanceClientState (ContractDef t)
    -&gt; ContractActivityStatus)
-&gt; ContractInstanceClientState (ContractDef t)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceClientState (ContractDef t)
-&gt; ContractActivityStatus
forall t. ContractInstanceClientState t -&gt; ContractActivityStatus
</span><a href="Plutus.PAB.Webserver.Types.html#cicStatus"><span class="hs-identifier hs-var hs-var">cicStatus</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>        </span><span class="annot"><span class="annottext">([ContractInstanceClientState (ContractDef t)]
 -&gt; [ContractInstanceClientState (ContractDef t)])
-&gt; PABAction t env [ContractInstanceClientState (ContractDef t)]
-&gt; PABAction t env [ContractInstanceClientState (ContractDef t)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">((ContractInstanceId, ContractActivationArgs (ContractDef t),
  ContractActivityStatus)
 -&gt; Eff
      (PABEffects t env) (ContractInstanceClientState (ContractDef t)))
-&gt; [(ContractInstanceId, ContractActivationArgs (ContractDef t),
     ContractActivityStatus)]
-&gt; PABAction t env [ContractInstanceClientState (ContractDef t)]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">(ContractInstanceId, ContractActivationArgs (ContractDef t),
 ContractActivityStatus)
-&gt; Eff
     (PABEffects t env) (ContractInstanceClientState (ContractDef t))
</span><a href="#local-6989586621680276846"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((ContractInstanceId, ContractActivationArgs (ContractDef t))
 -&gt; Maybe
      (ContractInstanceId, ContractActivationArgs (ContractDef t),
       ContractActivityStatus))
-&gt; [(ContractInstanceId, ContractActivationArgs (ContractDef t))]
-&gt; [(ContractInstanceId, ContractActivationArgs (ContractDef t),
     ContractActivityStatus)]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">(ContractInstanceId, ContractActivationArgs (ContractDef t))
-&gt; Maybe
     (ContractInstanceId, ContractActivationArgs (ContractDef t),
      ContractActivityStatus)
</span><a href="#local-6989586621680276850"><span class="hs-identifier hs-var">getStatus</span></a></span><span> </span><span class="annot"><span class="annottext">([(ContractInstanceId, ContractActivationArgs (ContractDef t))]
 -&gt; [(ContractInstanceId, ContractActivationArgs (ContractDef t),
      ContractActivityStatus)])
-&gt; [(ContractInstanceId, ContractActivationArgs (ContractDef t))]
-&gt; [(ContractInstanceId, ContractActivationArgs (ContractDef t),
     ContractActivityStatus)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Map ContractInstanceId (ContractActivationArgs (ContractDef t))
-&gt; [(ContractInstanceId, ContractActivationArgs (ContractDef t))]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">Map ContractInstanceId (ContractActivationArgs (ContractDef t))
</span><a href="#local-6989586621680276839"><span class="hs-identifier hs-var">mp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="annot"><a href="Plutus.PAB.Webserver.Handler.html#availableContracts"><span class="hs-identifier hs-type">availableContracts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680277047"><span class="annot"><a href="#local-6989586621680277047"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680277046"><span class="annot"><a href="#local-6989586621680277046"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277047"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277046"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractSignatureResponse"><span class="hs-identifier hs-type">ContractSignatureResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">Contract.ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277047"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-179"></span><span id="availableContracts"><span class="annot"><span class="annottext">availableContracts :: PABAction t env [ContractSignatureResponse (ContractDef t)]
</span><a href="Plutus.PAB.Webserver.Handler.html#availableContracts"><span class="hs-identifier hs-var hs-var">availableContracts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><span class="annottext">(ContractDef t -&gt; ContractSignatureResponse (ContractDef t))
-&gt; [ContractDef t] -&gt; [ContractSignatureResponse (ContractDef t)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">ContractDef t -&gt; ContractSignatureResponse (ContractDef t)
forall t. t -&gt; ContractSignatureResponse t
</span><a href="Plutus.PAB.Webserver.Types.html#ContractSignatureResponse"><span class="hs-identifier hs-var">ContractSignatureResponse</span></a></span><span> </span><span class="annot"><span class="annottext">([ContractDef t] -&gt; [ContractSignatureResponse (ContractDef t)])
-&gt; Eff (PABEffects t env) [ContractDef t]
-&gt; PABAction t env [ContractSignatureResponse (ContractDef t)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (ContractDefinition t) effs =&gt;
Eff effs [ContractDef t]
forall t (effs :: [* -&gt; *]).
Member (ContractDefinition t) effs =&gt;
Eff effs [ContractDef t]
</span><a href="Plutus.PAB.Effects.Contract.html#getDefinitions"><span class="hs-identifier hs-var">Contract.getDefinitions</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680277047"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="annot"><a href="Plutus.PAB.Webserver.Handler.html#shutdown"><span class="hs-identifier hs-type">shutdown</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680277053"><span class="annot"><a href="#local-6989586621680277053"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680277052"><span class="annot"><a href="#local-6989586621680277052"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277053"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680277052"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span id="shutdown"><span class="annot"><span class="annottext">shutdown :: ContractInstanceId -&gt; PABAction t env ()
</span><a href="Plutus.PAB.Webserver.Handler.html#shutdown"><span class="hs-identifier hs-var hs-var">shutdown</span></a></span></span><span> </span><span id="local-6989586621680276837"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276837"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-184"></span><span>    </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; PABAction t env ()
forall t env. ContractInstanceId -&gt; PABAction t env ()
</span><a href="Plutus.PAB.Core.html#stopInstance"><span class="hs-identifier hs-var">Core.stopInstance</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276837"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-185"></span><span>    </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; PABAction t env ()
forall t env. ContractInstanceId -&gt; PABAction t env ()
</span><a href="Plutus.PAB.Core.html#removeInstance"><span class="hs-identifier hs-var">Core.removeInstance</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680276837"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-186"></span></pre></body></html>