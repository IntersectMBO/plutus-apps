<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds           #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies  #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts    #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase          #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns      #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE NumericUnderscores  #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings   #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE TupleSections       #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications    #-}</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- | Start a local cluster of cardano nodes and PAB(s)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Plutus.PAB.LocalCluster.Run</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Api</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CAPI</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.BM.Backend.EKGView</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">EKG</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.BM.Data.Severity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Severity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Notice</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.BM.Data.Tracer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">HasPrivacyAnnotation</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">HasSeverityAnnotation</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.BM.Plugin</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">loadPlugin</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.BM.Tracing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">HasSeverityAnnotation</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">getSeverityAnnotation</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Severity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Debug</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Info</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.CLI</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">LogOutput</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">LogToFile</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">LogToStdStreams</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Port</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ekgEnabled</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getEKGURL</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getPrometheusURL</span></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>                    </span><span class="annot"><span class="hs-identifier">withLoggingNamed</span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.ChainIndex.Types.html"><span class="hs-identifier">Cardano.ChainIndex.Types</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PAB.CI</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Launcher.Node</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">nodeSocketFile</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Mnemonic</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SomeMnemonic</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SomeMnemonic</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Node.Emulator.Internal.Node</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SlotConfig</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SlotConfig</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Node.Emulator.Internal.Node.TimeSlot</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TimeSlot</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Node.Socket.Emulator.Types</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NodeServerConfig</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Node.Types.html"><span class="hs-identifier">Cardano.Node.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Node.Types.html#NodeMode"><span class="hs-identifier">NodeMode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Node.Types.html#AlonzoNode"><span class="hs-identifier">AlonzoNode</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Node.Types.html#PABServerConfig"><span class="hs-identifier">PABServerConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Node.Types.html#pscNodeMode"><span class="hs-identifier">pscNodeMode</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Node.Types.html#pscNodeServerConfig"><span class="hs-identifier">pscNodeServerConfig</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Startup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">installSignalHandlers</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">setDefaultFilePermissions</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">withUtf8Encoding</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Wallet.Api.Client</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">WalletClient</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Wallet.Api.Server</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Listen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ListenOnPort</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Wallet.Api.Types</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ApiMnemonicT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ApiMnemonicT</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ApiT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ApiT</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ApiWallet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ApiWallet</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>                                 </span><span class="annot"><span class="hs-identifier">EncodeAddress</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">encodeAddress</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">WalletOrAccountPostData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">WalletOrAccountPostData</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>                                 </span><span class="annot"><span class="hs-identifier">postData</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Wallet.Api.Types</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Wallet.Types</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Wallet.Logging</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">stdoutTextTracer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">trMessageText</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Wallet.Primitive.AddressDerivation</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NetworkDiscriminant</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Mainnet</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Wallet.Primitive.Passphrase.Types</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Passphrase</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Passphrase</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Wallet.Primitive.SyncProgress</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SyncTolerance</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SyncTolerance</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Wallet.Primitive.Types</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">GenesisParameters</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">GenesisParameters</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>                                       </span><span class="annot"><span class="hs-identifier">NetworkParameters</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NetworkParameters</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">slottingParameters</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>                                       </span><span class="annot"><span class="hs-identifier">SlotLength</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SlotLength</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>                                       </span><span class="annot"><span class="hs-identifier">SlottingParameters</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SlottingParameters</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getSecurityParameter</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>                                       </span><span class="annot"><span class="hs-identifier">StartTime</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">StartTime</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">WalletName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">WalletName</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Wallet.Primitive.Types.Coin</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Coin</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Coin</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Wallet.Shelley</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SomeNetworkDiscriminant</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SomeNetworkDiscriminant</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">serveWallet</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">setupTracers</span></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>                               </span><span class="annot"><span class="hs-identifier">tracerSeverities</span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Wallet.Shelley.BlockchainSource</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">BlockchainSource</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NodeSource</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Wallet.Shelley.Launch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">withSystemTempDir</span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Wallet.Shelley.Launch.Cluster</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ClusterLog</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Credential</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">KeyCredential</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">RunningNode</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">RunningNode</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>                                              </span><span class="annot"><span class="hs-identifier">localClusterConfigFromEnv</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">moveInstantaneousRewardsTo</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">oneMillionAda</span></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>                                              </span><span class="annot"><span class="hs-identifier">sendFaucetAssetsTo</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">testMinSeverityFromEnv</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">tokenMetadataServerFromEnv</span></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>                                              </span><span class="annot"><span class="hs-identifier">walletMinSeverityFromEnv</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">withCluster</span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Types.html"><span class="hs-identifier">Cardano.Wallet.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Types.html#WalletUrl"><span class="hs-identifier">WalletUrl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Types.html#WalletUrl"><span class="hs-identifier">WalletUrl</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Types.html"><span class="hs-identifier">Cardano.Wallet.Types</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Wallet.Config</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Arrow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">first</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Concurrent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">threadDelay</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Concurrent.Async</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">async</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">contramap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">set</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator">(&amp;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.~)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(^.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">void</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">when</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Freer.Extras.Beam.Sqlite</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">DbConfig</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">dbConfigFile</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Tracer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">traceWith</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">FromJSON</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ToJSON</span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Default</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Default</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">def</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.OpenApi.Schema</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">OpenApi</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Proxy</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Quantity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Quantity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">getQuantity</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.String</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">IsString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">fromString</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ToText</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toText</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Time.Clock</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">nominalDiffTimeToSeconds</span></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Client</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">defaultManagerSettings</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">newManager</span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ouroboros.Network.Client.Wallet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">tunedForMainnetPipeliningStrategy</span></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.ChainIndex.App</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ChainIndex</span></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.ChainIndex.Config</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CI</span></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.ChainIndex.Logging</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ChainIndex.Logging</span></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.ChainIndex.Types</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Point</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.App.html"><span class="hs-identifier">Plutus.PAB.App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.App.html#StorageBackend"><span class="hs-identifier">StorageBackend</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.App.html#BeamBackend"><span class="hs-identifier">BeamBackend</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.Builtin.html"><span class="hs-identifier">Plutus.PAB.Effects.Contract.Builtin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.Builtin.html#BuiltinHandler"><span class="hs-identifier">BuiltinHandler</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.Builtin.html#HasDefinitions"><span class="hs-identifier">HasDefinitions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Run.html"><span class="hs-identifier">Plutus.PAB.Run</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PAB.Run</span></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Run.Command.html"><span class="hs-identifier">Plutus.PAB.Run.Command</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Run.Command.html#ConfigCommand"><span class="hs-identifier">ConfigCommand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Run.Command.html#Migrate"><span class="hs-identifier">Migrate</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Run.Command.html#PABWebserver"><span class="hs-identifier">PABWebserver</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Run.CommandParser.html"><span class="hs-identifier">Plutus.PAB.Run.CommandParser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Run.CommandParser.html#AppOpts"><span class="hs-identifier">AppOpts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Run.CommandParser.html#AppOpts"><span class="hs-identifier">AppOpts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Run.CommandParser.html#cmd"><span class="hs-identifier">cmd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Run.CommandParser.html#configPath"><span class="hs-identifier">configPath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Run.CommandParser.html#logConfigPath"><span class="hs-identifier">logConfigPath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Run.CommandParser.html#minLogLevel"><span class="hs-identifier">minLogLevel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Run.CommandParser.html#resumeFrom"><span class="hs-identifier">resumeFrom</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Run.CommandParser.html#rollbackHistory"><span class="hs-identifier">rollbackHistory</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Run.CommandParser.html#runEkgServer"><span class="hs-identifier">runEkgServer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Run.CommandParser.html#storageBackend"><span class="hs-identifier">storageBackend</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Run.CommandParser.html"><span class="hs-identifier">Plutus.PAB.Run.CommandParser</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PAB.Command</span></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html"><span class="hs-identifier">Plutus.PAB.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Types.html#ChainQueryConfig"><span class="hs-identifier">ChainQueryConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Types.html#ChainIndexConfig"><span class="hs-identifier">ChainIndexConfig</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-86"></span><span>                         </span><span class="annot"><a href="Plutus.PAB.Types.html#Config"><span class="hs-identifier">Config</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Types.html#chainQueryConfig"><span class="hs-identifier">chainQueryConfig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html#dbConfig"><span class="hs-identifier">dbConfig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html#nodeServerConfig"><span class="hs-identifier">nodeServerConfig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html#walletServerConfig"><span class="hs-identifier">walletServerConfig</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html#DbConfig"><span class="hs-identifier">DbConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Types.html#SqliteDB"><span class="hs-identifier">SqliteDB</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html"><span class="hs-identifier">Plutus.PAB.Types</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PAB.Config</span></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prettyprinter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Pretty</span></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Servant</span></span><span> </span><span class="hs-keyword">qualified</span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Servant.Client</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">BaseUrl</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">BaseUrl</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">baseUrlHost</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">baseUrlPath</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">baseUrlPort</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">baseUrlScheme</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Scheme</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Http</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-91"></span><span>                       </span><span class="annot"><span class="hs-identifier">mkClientEnv</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runClientM</span></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Directory</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">createDirectory</span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.FilePath</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;/&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.Integration.Faucet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">genRewardAccounts</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">maryIntegrationTestAssets</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mirMnemonics</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">shelleyIntegrationTestFunds</span></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.Integration.Faucet</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Faucet</span></span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.Integration.Framework.DSL</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fixturePassphrase</span></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-keyword">data</span><span> </span><span id="LogOutputs"><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#LogOutputs"><span class="hs-identifier hs-var">LogOutputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-99"></span><span>    </span><span id="LogOutputs"><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#LogOutputs"><span class="hs-identifier hs-var">LogOutputs</span></a></span></span><span>
</span><span id="line-100"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="loCluster"><span class="annot"><span class="annottext">LogOutputs -&gt; [LogOutput]
</span><a href="Plutus.PAB.LocalCluster.Run.html#loCluster"><span class="hs-identifier hs-var hs-var">loCluster</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">LogOutput</span></span><span class="hs-special">]</span><span>
</span><span id="line-101"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="loWallet"><span class="annot"><span class="annottext">LogOutputs -&gt; [LogOutput]
</span><a href="Plutus.PAB.LocalCluster.Run.html#loWallet"><span class="hs-identifier hs-var hs-var">loWallet</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">LogOutput</span></span><span class="hs-special">]</span><span>
</span><span id="line-102"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">-- Do all the program setup required for running the local cluster, create a</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- temporary directory, log output configurations, and pass these to the given</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- main action.</span><span>
</span><span id="line-107"></span><span id="local-6989586621680280976"><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#withLocalClusterSetup"><span class="hs-identifier hs-type">withLocalClusterSetup</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#LogOutputs"><span class="hs-identifier hs-type">LogOutputs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680280976"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680280976"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-110"></span><span id="withLocalClusterSetup"><span class="annot"><span class="annottext">withLocalClusterSetup :: (FilePath -&gt; LogOutputs -&gt; IO a) -&gt; IO a
</span><a href="Plutus.PAB.LocalCluster.Run.html#withLocalClusterSetup"><span class="hs-identifier hs-var hs-var">withLocalClusterSetup</span></a></span></span><span> </span><span id="local-6989586621680280642"><span class="annot"><span class="annottext">FilePath -&gt; LogOutputs -&gt; IO a
</span><a href="#local-6989586621680280642"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-111"></span><span>    </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">putStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Starting PAB local cluster. Please make sure the SHELLEY_TEST_DATA environment variable is set to 'plutus-pab/local-cluster/cluster-data/cardano-node-shelley' in the plutus-apps repository.&quot;</span></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-comment">-- Handle SIGTERM properly</span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; IO ()
</span><span class="hs-identifier hs-var">installSignalHandlers</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">putStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Terminated&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-comment">-- Ensure key files have correct permissions for cardano-cli</span><span>
</span><span id="line-117"></span><span>    </span><span class="annot"><span class="annottext">IO ()
</span><span class="hs-identifier hs-var">setDefaultFilePermissions</span></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-comment">-- Set UTF-8, regardless of user locale</span><span>
</span><span id="line-120"></span><span>    </span><span class="annot"><span class="annottext">IO a -&gt; IO a
forall a. IO a -&gt; IO a
</span><span class="hs-identifier hs-var">withUtf8Encoding</span></span><span> </span><span class="annot"><span class="annottext">(IO a -&gt; IO a) -&gt; IO a -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-121"></span><span>        </span><span class="hs-comment">-- This temporary directory will contain logs, and all other data</span><span>
</span><span id="line-122"></span><span>        </span><span class="hs-comment">-- produced by the local test cluster.</span><span>
</span><span id="line-123"></span><span>        </span><span class="annot"><span class="annottext">Tracer IO TempDirLog -&gt; FilePath -&gt; (FilePath -&gt; IO a) -&gt; IO a
forall (m :: * -&gt; *) a.
MonadUnliftIO m =&gt;
Tracer m TempDirLog -&gt; FilePath -&gt; (FilePath -&gt; m a) -&gt; m a
</span><span class="hs-identifier hs-var">withSystemTempDir</span></span><span> </span><span class="annot"><span class="annottext">Tracer IO TempDirLog
forall (m :: * -&gt; *) a. (MonadIO m, ToText a) =&gt; Tracer m a
</span><span class="hs-identifier hs-var">stdoutTextTracer</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;test-cluster&quot;</span></span><span> </span><span class="annot"><span class="annottext">((FilePath -&gt; IO a) -&gt; IO a) -&gt; (FilePath -&gt; IO a) -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680280640"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280640"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-124"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680280639"><span class="annot"><span class="annottext">logOutputs :: FilePath -&gt; Severity -&gt; [LogOutput]
</span><a href="#local-6989586621680280639"><span class="hs-identifier hs-var hs-var">logOutputs</span></a></span></span><span> </span><span id="local-6989586621680280638"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280638"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621680280637"><span class="annot"><span class="annottext">Severity
</span><a href="#local-6989586621680280637"><span class="hs-identifier hs-var">minSev</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-125"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Severity -&gt; LogOutput
</span><span class="hs-identifier hs-var">LogToFile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280640"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280638"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Severity -&gt; Severity -&gt; Severity
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">min</span></a></span><span> </span><span class="annot"><span class="annottext">Severity
</span><a href="#local-6989586621680280637"><span class="hs-identifier hs-var">minSev</span></a></span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Info</span></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Severity -&gt; LogOutput
</span><span class="hs-identifier hs-var">LogToStdStreams</span></span><span> </span><span class="annot"><span class="annottext">Severity
</span><a href="#local-6989586621680280637"><span class="hs-identifier hs-var">minSev</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span>            </span><span id="local-6989586621680280635"><span class="annot"><span class="annottext">LogOutputs
</span><a href="#local-6989586621680280635"><span class="hs-identifier hs-var">lops</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-129"></span><span>                </span><span class="annot"><span class="annottext">[LogOutput] -&gt; [LogOutput] -&gt; LogOutputs
</span><a href="Plutus.PAB.LocalCluster.Run.html#LogOutputs"><span class="hs-identifier hs-var">LogOutputs</span></a></span><span>
</span><span id="line-130"></span><span>                    </span><span class="annot"><span class="annottext">([LogOutput] -&gt; [LogOutput] -&gt; LogOutputs)
-&gt; IO [LogOutput] -&gt; IO ([LogOutput] -&gt; LogOutputs)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Severity -&gt; [LogOutput]
</span><a href="#local-6989586621680280639"><span class="hs-identifier hs-var">logOutputs</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;cluster.log&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Severity -&gt; [LogOutput]) -&gt; IO Severity -&gt; IO [LogOutput]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IO Severity
</span><span class="hs-identifier hs-var">testMinSeverityFromEnv</span></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>                    </span><span class="annot"><span class="annottext">IO ([LogOutput] -&gt; LogOutputs) -&gt; IO [LogOutput] -&gt; IO LogOutputs
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Severity -&gt; [LogOutput]
</span><a href="#local-6989586621680280639"><span class="hs-identifier hs-var">logOutputs</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;wallet.log&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Severity -&gt; [LogOutput]) -&gt; IO Severity -&gt; IO [LogOutput]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IO Severity
</span><span class="hs-identifier hs-var">walletMinSeverityFromEnv</span></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span>            </span><span class="annot"><span class="annottext">FilePath -&gt; LogOutputs -&gt; IO a
</span><a href="#local-6989586621680280642"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280640"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">LogOutputs
</span><a href="#local-6989586621680280635"><span class="hs-identifier hs-var">lops</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#runWith"><span class="hs-identifier hs-type">runWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680280632"><span class="annot"><a href="#local-6989586621680280632"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680280632"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680280632"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680280632"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680280632"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621680280632"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Servant.MimeUnrender</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Servant.JSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680280632"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.Builtin.html#HasDefinitions"><span class="hs-identifier hs-type">HasDefinitions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680280632"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">OpenApi.ToSchema</span></span><span> </span><span class="annot"><a href="#local-6989586621680280632"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.Builtin.html#BuiltinHandler"><span class="hs-identifier hs-type">BuiltinHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680280632"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span id="runWith"><span class="annot"><span class="annottext">runWith :: BuiltinHandler a -&gt; IO ()
</span><a href="Plutus.PAB.LocalCluster.Run.html#runWith"><span class="hs-identifier hs-var hs-var">runWith</span></a></span></span><span> </span><span id="local-6989586621680280631"><span class="annot"><span class="annottext">BuiltinHandler a
</span><a href="#local-6989586621680280631"><span class="hs-identifier hs-var">userContractHandler</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; LogOutputs -&gt; IO ()) -&gt; IO ()
forall a. (FilePath -&gt; LogOutputs -&gt; IO a) -&gt; IO a
</span><a href="Plutus.PAB.LocalCluster.Run.html#withLocalClusterSetup"><span class="hs-identifier hs-var">withLocalClusterSetup</span></a></span><span> </span><span class="annot"><span class="annottext">((FilePath -&gt; LogOutputs -&gt; IO ()) -&gt; IO ())
-&gt; (FilePath -&gt; LogOutputs -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680280630"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280630"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span id="local-6989586621680280629"><span class="annot"><span class="annottext">lo :: LogOutputs
</span><a href="#local-6989586621680280629"><span class="hs-identifier hs-var">lo</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#LogOutputs"><span class="hs-identifier hs-type">LogOutputs</span></a></span><span class="hs-special">{</span><span id="local-6989586621680280628"><span class="annot"><span class="annottext">[LogOutput]
loCluster :: [LogOutput]
loCluster :: LogOutputs -&gt; [LogOutput]
</span><a href="#local-6989586621680280628"><span class="hs-identifier hs-var hs-var">loCluster</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-148"></span><span>    </span><span class="annot"><span class="annottext">LoggerName
-&gt; [LogOutput]
-&gt; ((Switchboard LoggerName, (Configuration, Trace IO LoggerName))
    -&gt; IO ())
-&gt; IO ()
forall a.
LoggerName
-&gt; [LogOutput]
-&gt; ((Switchboard LoggerName, (Configuration, Trace IO LoggerName))
    -&gt; IO a)
-&gt; IO a
</span><span class="hs-identifier hs-var">withLoggingNamed</span></span><span> </span><span class="annot"><span class="annottext">LoggerName
</span><span class="hs-string">&quot;cluster&quot;</span></span><span> </span><span class="annot"><span class="annottext">[LogOutput]
</span><a href="#local-6989586621680280628"><span class="hs-identifier hs-var">loCluster</span></a></span><span> </span><span class="annot"><span class="annottext">(((Switchboard LoggerName, (Configuration, Trace IO LoggerName))
  -&gt; IO ())
 -&gt; IO ())
-&gt; ((Switchboard LoggerName, (Configuration, Trace IO LoggerName))
    -&gt; IO ())
-&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Switchboard LoggerName
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Configuration
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680280627"><span class="annot"><span class="annottext">Trace IO LoggerName
</span><a href="#local-6989586621680280627"><span class="hs-identifier hs-var">trCluster</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-149"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680280626"><span class="annot"><span class="annottext">tr' :: Tracer IO ClusterLog
</span><a href="#local-6989586621680280626"><span class="hs-identifier hs-var hs-var">tr'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ClusterLog -&gt; TestsLog)
-&gt; Tracer IO TestsLog -&gt; Tracer IO ClusterLog
forall (f :: * -&gt; *) a b. Contravariant f =&gt; (a -&gt; b) -&gt; f b -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">contramap</span></a></span><span> </span><span class="annot"><span class="annottext">ClusterLog -&gt; TestsLog
</span><a href="Plutus.PAB.LocalCluster.Run.html#MsgCluster"><span class="hs-identifier hs-var">MsgCluster</span></a></span><span> </span><span class="annot"><span class="annottext">(Tracer IO TestsLog -&gt; Tracer IO ClusterLog)
-&gt; Tracer IO TestsLog -&gt; Tracer IO ClusterLog
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Trace IO LoggerName -&gt; Tracer IO TestsLog
forall (m :: * -&gt; *) a.
(MonadIO m, ToText a, HasPrivacyAnnotation a,
 HasSeverityAnnotation a) =&gt;
Tracer m (LoggerName, LogObject LoggerName) -&gt; Tracer m a
</span><span class="hs-identifier hs-var">trMessageText</span></span><span> </span><span class="annot"><span class="annottext">Trace IO LoggerName
</span><a href="#local-6989586621680280627"><span class="hs-identifier hs-var">trCluster</span></a></span><span>
</span><span id="line-150"></span><span>        </span><span id="local-6989586621680280624"><span class="annot"><span class="annottext">LocalClusterConfig
</span><a href="#local-6989586621680280624"><span class="hs-identifier hs-var">clusterCfg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO LocalClusterConfig
</span><span class="hs-identifier hs-var">localClusterConfigFromEnv</span></span><span>
</span><span id="line-151"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680280623"><span class="annot"><span class="annottext">initialFunds :: [(Address, Coin)]
</span><a href="#local-6989586621680280623"><span class="hs-identifier hs-var hs-var">initialFunds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Address, Coin)]
</span><span class="hs-identifier hs-var">shelleyIntegrationTestFunds</span></span><span>
</span><span id="line-152"></span><span>        </span><span class="annot"><span class="annottext">Tracer IO ClusterLog
-&gt; FilePath
-&gt; LocalClusterConfig
-&gt; [(Address, Coin)]
-&gt; (RunningNode -&gt; IO ())
-&gt; IO ()
forall a.
Tracer IO ClusterLog
-&gt; FilePath
-&gt; LocalClusterConfig
-&gt; [(Address, Coin)]
-&gt; (RunningNode -&gt; IO a)
-&gt; IO a
</span><span class="hs-identifier hs-var">withCluster</span></span><span> </span><span class="annot"><span class="annottext">Tracer IO ClusterLog
</span><a href="#local-6989586621680280626"><span class="hs-identifier hs-var">tr'</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280630"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">LocalClusterConfig
</span><a href="#local-6989586621680280624"><span class="hs-identifier hs-var">clusterCfg</span></a></span><span> </span><span class="annot"><span class="annottext">[(Address, Coin)]
</span><a href="#local-6989586621680280623"><span class="hs-identifier hs-var">initialFunds</span></a></span><span>
</span><span id="line-153"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
-&gt; Tracer IO TestsLog -&gt; LogOutputs -&gt; RunningNode -&gt; IO ()
</span><a href="#local-6989586621680280622"><span class="hs-identifier hs-var">whenReady</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280630"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trace IO LoggerName -&gt; Tracer IO TestsLog
forall (m :: * -&gt; *) a.
(MonadIO m, ToText a, HasPrivacyAnnotation a,
 HasSeverityAnnotation a) =&gt;
Tracer m (LoggerName, LogObject LoggerName) -&gt; Tracer m a
</span><span class="hs-identifier hs-var">trMessageText</span></span><span> </span><span class="annot"><span class="annottext">Trace IO LoggerName
</span><a href="#local-6989586621680280627"><span class="hs-identifier hs-var">trCluster</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LogOutputs
</span><a href="#local-6989586621680280629"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-155"></span><span>    </span><span id="local-6989586621680280621"><span class="annot"><span class="annottext">setupFaucet :: FilePath -&gt; Tracer IO TestsLog -&gt; RunningNode -&gt; IO ()
</span><a href="#local-6989586621680280621"><span class="hs-identifier hs-var hs-var">setupFaucet</span></a></span></span><span> </span><span id="local-6989586621680280620"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280620"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span id="local-6989586621680280619"><span class="annot"><span class="annottext">Tracer IO TestsLog
</span><a href="#local-6989586621680280619"><span class="hs-identifier hs-var">trCluster</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RunningNode</span></span><span> </span><span id="local-6989586621680280618"><span class="annot"><span class="annottext">CardanoNodeConn
</span><a href="#local-6989586621680280618"><span class="hs-identifier hs-var">socketPath</span></a></span></span><span> </span><span class="annot"><span class="annottext">Block
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">(NetworkParameters, NodeToClientVersionData)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[PoolCertificate]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-156"></span><span>        </span><span class="annot"><span class="annottext">Tracer IO TestsLog -&gt; TestsLog -&gt; IO ()
forall (m :: * -&gt; *) a. Tracer m a -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">traceWith</span></span><span> </span><span class="annot"><span class="annottext">Tracer IO TestsLog
</span><a href="#local-6989586621680280619"><span class="hs-identifier hs-var">trCluster</span></a></span><span> </span><span class="annot"><span class="annottext">TestsLog
</span><a href="Plutus.PAB.LocalCluster.Run.html#MsgSettingUpFaucet"><span class="hs-identifier hs-var">MsgSettingUpFaucet</span></a></span><span>
</span><span id="line-157"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680280616"><span class="annot"><span class="annottext">trCluster' :: Tracer IO ClusterLog
</span><a href="#local-6989586621680280616"><span class="hs-identifier hs-var hs-var">trCluster'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ClusterLog -&gt; TestsLog)
-&gt; Tracer IO TestsLog -&gt; Tracer IO ClusterLog
forall (f :: * -&gt; *) a b. Contravariant f =&gt; (a -&gt; b) -&gt; f b -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">contramap</span></a></span><span> </span><span class="annot"><span class="annottext">ClusterLog -&gt; TestsLog
</span><a href="Plutus.PAB.LocalCluster.Run.html#MsgCluster"><span class="hs-identifier hs-var">MsgCluster</span></a></span><span> </span><span class="annot"><span class="annottext">Tracer IO TestsLog
</span><a href="#local-6989586621680280619"><span class="hs-identifier hs-var">trCluster</span></a></span><span>
</span><span id="line-158"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680280615"><span class="annot"><span class="annottext">encodeAddresses :: [(Address, d)] -&gt; [(FilePath, d)]
</span><a href="#local-6989586621680280615"><span class="hs-identifier hs-var hs-var">encodeAddresses</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Address, d) -&gt; (FilePath, d))
-&gt; [(Address, d)] -&gt; [(FilePath, d)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Address -&gt; FilePath) -&gt; (Address, d) -&gt; (FilePath, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LoggerName -&gt; FilePath
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(LoggerName -&gt; FilePath)
-&gt; (Address -&gt; LoggerName) -&gt; Address -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">EncodeAddress 'Mainnet =&gt; Address -&gt; LoggerName
forall (n :: NetworkDiscriminant).
EncodeAddress n =&gt;
Address -&gt; LoggerName
</span><span class="hs-identifier hs-var">encodeAddress</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Mainnet</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680280612"><span class="annot"><span class="annottext">accts :: [Credential]
</span><a href="#local-6989586621680280612"><span class="hs-identifier hs-var hs-var">accts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPub -&gt; Credential
</span><span class="hs-identifier hs-var">KeyCredential</span></span><span> </span><span class="annot"><span class="annottext">(XPub -&gt; Credential) -&gt; [XPub] -&gt; [Credential]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Mnemonic 24 -&gt; [XPub]) -&gt; [Mnemonic 24] -&gt; [XPub]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">Mnemonic 24 -&gt; [XPub]
</span><span class="hs-identifier hs-var">genRewardAccounts</span></span><span> </span><span class="annot"><span class="annottext">[Mnemonic 24]
</span><span class="hs-identifier hs-var">mirMnemonics</span></span><span>
</span><span id="line-160"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680280610"><span class="annot"><span class="annottext">rewards :: [(Credential, Coin)]
</span><a href="#local-6989586621680280610"><span class="hs-identifier hs-var hs-var">rewards</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Coin
</span><span class="hs-identifier hs-var">Coin</span></span><span> </span><span class="annot"><span class="annottext">(Natural -&gt; Coin) -&gt; Natural -&gt; Coin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier hs-var">oneMillionAda</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Credential -&gt; (Credential, Coin))
-&gt; [Credential] -&gt; [(Credential, Coin)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Credential]
</span><a href="#local-6989586621680280612"><span class="hs-identifier hs-var">accts</span></a></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span>        </span><span class="annot"><span class="annottext">Tracer IO ClusterLog
-&gt; CardanoNodeConn
-&gt; FilePath
-&gt; Int
-&gt; [(FilePath, (TokenBundle, [(FilePath, FilePath)]))]
-&gt; IO ()
</span><span class="hs-identifier hs-var">sendFaucetAssetsTo</span></span><span> </span><span class="annot"><span class="annottext">Tracer IO ClusterLog
</span><a href="#local-6989586621680280616"><span class="hs-identifier hs-var">trCluster'</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoNodeConn
</span><a href="#local-6989586621680280618"><span class="hs-identifier hs-var">socketPath</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280620"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">([(FilePath, (TokenBundle, [(FilePath, FilePath)]))] -&gt; IO ())
-&gt; [(FilePath, (TokenBundle, [(FilePath, FilePath)]))] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(Address, (TokenBundle, [(FilePath, FilePath)]))]
-&gt; [(FilePath, (TokenBundle, [(FilePath, FilePath)]))]
forall d. [(Address, d)] -&gt; [(FilePath, d)]
</span><a href="#local-6989586621680280615"><span class="hs-identifier hs-var">encodeAddresses</span></a></span><span> </span><span class="annot"><span class="annottext">([(Address, (TokenBundle, [(FilePath, FilePath)]))]
 -&gt; [(FilePath, (TokenBundle, [(FilePath, FilePath)]))])
-&gt; [(Address, (TokenBundle, [(FilePath, FilePath)]))]
-&gt; [(FilePath, (TokenBundle, [(FilePath, FilePath)]))]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-163"></span><span>            </span><span class="annot"><span class="annottext">Coin -&gt; [(Address, (TokenBundle, [(FilePath, FilePath)]))]
</span><span class="hs-identifier hs-var">maryIntegrationTestAssets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; Coin
</span><span class="hs-identifier hs-var">Coin</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1_000_000_000</span></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>        </span><span class="annot"><span class="annottext">Tracer IO ClusterLog
-&gt; CardanoNodeConn -&gt; FilePath -&gt; [(Credential, Coin)] -&gt; IO ()
</span><span class="hs-identifier hs-var">moveInstantaneousRewardsTo</span></span><span> </span><span class="annot"><span class="annottext">Tracer IO ClusterLog
</span><a href="#local-6989586621680280616"><span class="hs-identifier hs-var">trCluster'</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoNodeConn
</span><a href="#local-6989586621680280618"><span class="hs-identifier hs-var">socketPath</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280620"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">[(Credential, Coin)]
</span><a href="#local-6989586621680280610"><span class="hs-identifier hs-var">rewards</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621680280622"><span class="annot"><span class="annottext">whenReady :: FilePath
-&gt; Tracer IO TestsLog -&gt; LogOutputs -&gt; RunningNode -&gt; IO ()
</span><a href="#local-6989586621680280622"><span class="hs-identifier hs-var hs-var">whenReady</span></a></span></span><span> </span><span id="local-6989586621680280609"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280609"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span id="local-6989586621680280608"><span class="annot"><span class="annottext">Tracer IO TestsLog
</span><a href="#local-6989586621680280608"><span class="hs-identifier hs-var">trCluster</span></a></span></span><span> </span><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#LogOutputs"><span class="hs-identifier hs-type">LogOutputs</span></a></span><span class="hs-special">{</span><span id="local-6989586621680280607"><span class="annot"><span class="annottext">[LogOutput]
loWallet :: [LogOutput]
loWallet :: LogOutputs -&gt; [LogOutput]
</span><a href="#local-6989586621680280607"><span class="hs-identifier hs-var hs-var">loWallet</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621680280606"><span class="annot"><span class="annottext">rn :: RunningNode
</span><a href="#local-6989586621680280606"><span class="hs-identifier hs-var">rn</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RunningNode</span></span><span> </span><span id="local-6989586621680280605"><span class="annot"><span class="annottext">CardanoNodeConn
</span><a href="#local-6989586621680280605"><span class="hs-identifier hs-var">socketPath</span></a></span></span><span> </span><span id="local-6989586621680280604"><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621680280604"><span class="hs-identifier hs-var">block0</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680280603"><span class="annot"><span class="annottext">NetworkParameters
</span><a href="#local-6989586621680280603"><span class="hs-identifier hs-var">gp</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680280602"><span class="annot"><span class="annottext">NodeToClientVersionData
</span><a href="#local-6989586621680280602"><span class="hs-identifier hs-var">vData</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680280601"><span class="annot"><span class="annottext">[PoolCertificate]
</span><a href="#local-6989586621680280601"><span class="hs-identifier hs-var">poolCertificates</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-167"></span><span>        </span><span class="annot"><span class="annottext">LoggerName
-&gt; [LogOutput]
-&gt; ((Switchboard LoggerName, (Configuration, Trace IO LoggerName))
    -&gt; IO ())
-&gt; IO ()
forall a.
LoggerName
-&gt; [LogOutput]
-&gt; ((Switchboard LoggerName, (Configuration, Trace IO LoggerName))
    -&gt; IO a)
-&gt; IO a
</span><span class="hs-identifier hs-var">withLoggingNamed</span></span><span> </span><span class="annot"><span class="annottext">LoggerName
</span><span class="hs-string">&quot;cardano-wallet&quot;</span></span><span> </span><span class="annot"><span class="annottext">[LogOutput]
</span><a href="#local-6989586621680280607"><span class="hs-identifier hs-var">loWallet</span></a></span><span> </span><span class="annot"><span class="annottext">(((Switchboard LoggerName, (Configuration, Trace IO LoggerName))
  -&gt; IO ())
 -&gt; IO ())
-&gt; ((Switchboard LoggerName, (Configuration, Trace IO LoggerName))
    -&gt; IO ())
-&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680280600"><span class="annot"><span class="annottext">Switchboard LoggerName
</span><a href="#local-6989586621680280600"><span class="hs-identifier hs-var">sb</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680280599"><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621680280599"><span class="hs-identifier hs-var">cfg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680280598"><span class="annot"><span class="annottext">Trace IO LoggerName
</span><a href="#local-6989586621680280598"><span class="hs-identifier hs-var">tr</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-168"></span><span>            </span><span class="annot"><span class="annottext">FilePath -&gt; Tracer IO TestsLog -&gt; RunningNode -&gt; IO ()
</span><a href="#local-6989586621680280621"><span class="hs-identifier hs-var">setupFaucet</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280609"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">Tracer IO TestsLog
</span><a href="#local-6989586621680280608"><span class="hs-identifier hs-var">trCluster</span></a></span><span> </span><span class="annot"><span class="annottext">RunningNode
</span><a href="#local-6989586621680280606"><span class="hs-identifier hs-var">rn</span></a></span><span>
</span><span id="line-169"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680280597"><span class="annot"><span class="annottext">walletHost :: FilePath
</span><a href="#local-6989586621680280597"><span class="hs-identifier hs-var hs-var">walletHost</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;127.0.0.1&quot;</span></span><span>
</span><span id="line-170"></span><span>                </span><span id="local-6989586621680280596"><span class="annot"><span class="annottext">walletPort :: Int
</span><a href="#local-6989586621680280596"><span class="hs-identifier hs-var hs-var">walletPort</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">46493</span></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span>            </span><span class="annot"><span class="annottext">BuiltinHandler a
-&gt; FilePath -&gt; Int -&gt; FilePath -&gt; RunningNode -&gt; IO ()
forall a.
(Show a, Ord a, FromJSON a, ToJSON a, Pretty a,
 MimeUnrender JSON a, HasDefinitions a, ToSchema a) =&gt;
BuiltinHandler a
-&gt; FilePath -&gt; Int -&gt; FilePath -&gt; RunningNode -&gt; IO ()
</span><a href="Plutus.PAB.LocalCluster.Run.html#setupPABServices"><span class="hs-identifier hs-var">setupPABServices</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinHandler a
</span><a href="#local-6989586621680280631"><span class="hs-identifier hs-var">userContractHandler</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280597"><span class="hs-identifier hs-var">walletHost</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680280596"><span class="hs-identifier hs-var">walletPort</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280609"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">RunningNode
</span><a href="#local-6989586621680280606"><span class="hs-identifier hs-var">rn</span></a></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span>            </span><span class="annot"><span class="annottext">IO Bool
</span><span class="hs-identifier hs-var">ekgEnabled</span></span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; (Bool -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; IO () -&gt; IO ()) -&gt; IO () -&gt; Bool -&gt; IO ()
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Configuration
-&gt; Trace IO LoggerName
-&gt; Switchboard LoggerName
-&gt; IO (Plugin LoggerName)
forall (s :: * -&gt; *) a.
(IsEffectuator s a, ToJSON a, FromJSON a) =&gt;
Configuration -&gt; Trace IO a -&gt; s a -&gt; IO (Plugin a)
</span><span class="hs-identifier hs-var">EKG.plugin</span></span><span> </span><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621680280599"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">Trace IO LoggerName
</span><a href="#local-6989586621680280598"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">Switchboard LoggerName
</span><a href="#local-6989586621680280600"><span class="hs-identifier hs-var">sb</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Plugin LoggerName) -&gt; (Plugin LoggerName -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Switchboard LoggerName -&gt; Plugin LoggerName -&gt; IO ()
forall a. Switchboard a -&gt; Plugin a -&gt; IO ()
</span><span class="hs-identifier hs-var">loadPlugin</span></span><span> </span><span class="annot"><span class="annottext">Switchboard LoggerName
</span><a href="#local-6989586621680280600"><span class="hs-identifier hs-var">sb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680280592"><span class="annot"><span class="annottext">tracers :: Tracers IO
</span><a href="#local-6989586621680280592"><span class="hs-identifier hs-var hs-var">tracers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TracerSeverities -&gt; Trace IO LoggerName -&gt; Tracers IO
</span><span class="hs-identifier hs-var">setupTracers</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Severity -&gt; TracerSeverities
</span><span class="hs-identifier hs-var">tracerSeverities</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Severity -&gt; Maybe Severity
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Debug</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Trace IO LoggerName
</span><a href="#local-6989586621680280598"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-177"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680280591"><span class="annot"><span class="annottext">db :: FilePath
</span><a href="#local-6989586621680280591"><span class="hs-identifier hs-var hs-var">db</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280609"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;wallets&quot;</span></span><span>
</span><span id="line-178"></span><span>            </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">createDirectory</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280591"><span class="hs-identifier hs-var">db</span></a></span><span>
</span><span id="line-179"></span><span>            </span><span id="local-6989586621680280590"><span class="annot"><span class="annottext">Maybe TokenMetadataServer
</span><a href="#local-6989586621680280590"><span class="hs-identifier hs-var">tokenMetadataServer</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe TokenMetadataServer)
</span><span class="hs-identifier hs-var">tokenMetadataServerFromEnv</span></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span>            </span><span id="local-6989586621680280589"><span class="annot"><span class="annottext">LoggerName
</span><a href="#local-6989586621680280589"><span class="hs-identifier hs-var">prometheusUrl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LoggerName
-&gt; ((FilePath, Port &quot;Prometheus&quot;) -&gt; LoggerName)
-&gt; Maybe (FilePath, Port &quot;Prometheus&quot;)
-&gt; LoggerName
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">LoggerName
</span><span class="hs-string">&quot;none&quot;</span></span><span>
</span><span id="line-182"></span><span>                    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680280587"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280587"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680280586"><span class="annot"><span class="annottext">Port &quot;Prometheus&quot;
</span><a href="#local-6989586621680280586"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; LoggerName
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280587"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">LoggerName -&gt; LoggerName -&gt; LoggerName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LoggerName
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">LoggerName -&gt; LoggerName -&gt; LoggerName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Port &quot;Prometheus&quot; -&gt; LoggerName
forall a. ToText a =&gt; a -&gt; LoggerName
</span><span class="hs-identifier hs-var">toText</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Port</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Prometheus&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Port &quot;Prometheus&quot;
</span><a href="#local-6989586621680280586"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>                </span><span class="annot"><span class="annottext">(Maybe (FilePath, Port &quot;Prometheus&quot;) -&gt; LoggerName)
-&gt; IO (Maybe (FilePath, Port &quot;Prometheus&quot;)) -&gt; IO LoggerName
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Maybe (FilePath, Port &quot;Prometheus&quot;))
</span><span class="hs-identifier hs-var">getPrometheusURL</span></span><span>
</span><span id="line-184"></span><span>            </span><span id="local-6989586621680280584"><span class="annot"><span class="annottext">LoggerName
</span><a href="#local-6989586621680280584"><span class="hs-identifier hs-var">ekgUrl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LoggerName
-&gt; ((FilePath, Port &quot;EKG&quot;) -&gt; LoggerName)
-&gt; Maybe (FilePath, Port &quot;EKG&quot;)
-&gt; LoggerName
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">LoggerName
</span><span class="hs-string">&quot;none&quot;</span></span><span>
</span><span id="line-185"></span><span>                    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680280583"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280583"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680280582"><span class="annot"><span class="annottext">Port &quot;EKG&quot;
</span><a href="#local-6989586621680280582"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; LoggerName
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280583"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">LoggerName -&gt; LoggerName -&gt; LoggerName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LoggerName
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">LoggerName -&gt; LoggerName -&gt; LoggerName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Port &quot;EKG&quot; -&gt; LoggerName
forall a. ToText a =&gt; a -&gt; LoggerName
</span><span class="hs-identifier hs-var">toText</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Port</span></span><span> </span><span class="annot"><span class="hs-string">&quot;EKG&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Port &quot;EKG&quot;
</span><a href="#local-6989586621680280582"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>                </span><span class="annot"><span class="annottext">(Maybe (FilePath, Port &quot;EKG&quot;) -&gt; LoggerName)
-&gt; IO (Maybe (FilePath, Port &quot;EKG&quot;)) -&gt; IO LoggerName
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Maybe (FilePath, Port &quot;EKG&quot;))
</span><span class="hs-identifier hs-var">getEKGURL</span></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span>            </span><span class="annot"><span class="annottext">IO ExitCode -&gt; IO ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">(IO ExitCode -&gt; IO ()) -&gt; IO ExitCode -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BlockchainSource
-&gt; NetworkParameters
-&gt; PipeliningStrategy (CardanoBlock StandardCrypto)
-&gt; SomeNetworkDiscriminant
-&gt; [PoolCertificate]
-&gt; Tracers IO
-&gt; Maybe FilePath
-&gt; Maybe (DBDecorator IO)
-&gt; HostPreference
-&gt; Listen
-&gt; Maybe TlsConfiguration
-&gt; Maybe Settings
-&gt; Maybe TokenMetadataServer
-&gt; Block
-&gt; (URI -&gt; IO ())
-&gt; IO ExitCode
</span><span class="hs-identifier hs-var">serveWallet</span></span><span>
</span><span id="line-189"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardanoNodeConn
-&gt; NodeToClientVersionData -&gt; SyncTolerance -&gt; BlockchainSource
</span><span class="hs-identifier hs-var">NodeSource</span></span><span> </span><span class="annot"><span class="annottext">CardanoNodeConn
</span><a href="#local-6989586621680280605"><span class="hs-identifier hs-var">socketPath</span></a></span><span> </span><span class="annot"><span class="annottext">NodeToClientVersionData
</span><a href="#local-6989586621680280602"><span class="hs-identifier hs-var">vData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NominalDiffTime -&gt; SyncTolerance
</span><span class="hs-identifier hs-var">SyncTolerance</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>                </span><span class="annot"><span class="annottext">NetworkParameters
</span><a href="#local-6989586621680280603"><span class="hs-identifier hs-var">gp</span></a></span><span>
</span><span id="line-191"></span><span>                </span><span class="annot"><span class="annottext">PipeliningStrategy (CardanoBlock StandardCrypto)
forall block. HasHeader block =&gt; PipeliningStrategy block
</span><span class="hs-identifier hs-var">tunedForMainnetPipeliningStrategy</span></span><span>
</span><span id="line-192"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy 'Mainnet -&gt; SomeNetworkDiscriminant
forall (n :: NetworkDiscriminant).
(NetworkDiscriminantVal n, PaymentAddress n IcarusKey,
 PaymentAddress n ByronKey, PaymentAddress n ShelleyKey,
 DelegationAddress n ShelleyKey, HasNetworkId n, DecodeAddress n,
 EncodeAddress n, DecodeStakeAddress n, EncodeStakeAddress n,
 Typeable n) =&gt;
Proxy n -&gt; SomeNetworkDiscriminant
</span><span class="hs-identifier hs-var">SomeNetworkDiscriminant</span></span><span> </span><span class="annot"><span class="annottext">(Proxy 'Mainnet -&gt; SomeNetworkDiscriminant)
-&gt; Proxy 'Mainnet -&gt; SomeNetworkDiscriminant
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy 'Mainnet
forall k (t :: k). Proxy t
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Mainnet</span></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>                </span><span class="annot"><span class="annottext">[PoolCertificate]
</span><a href="#local-6989586621680280601"><span class="hs-identifier hs-var">poolCertificates</span></a></span><span>
</span><span id="line-194"></span><span>                </span><span class="annot"><span class="annottext">Tracers IO
</span><a href="#local-6989586621680280592"><span class="hs-identifier hs-var">tracers</span></a></span><span>
</span><span id="line-195"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Maybe FilePath
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280591"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>                </span><span class="annot"><span class="annottext">Maybe (DBDecorator IO)
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-197"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; HostPreference
forall a. IsString a =&gt; FilePath -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromString</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280597"><span class="hs-identifier hs-var">walletHost</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Listen
</span><span class="hs-identifier hs-var">ListenOnPort</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680280596"><span class="hs-identifier hs-var">walletPort</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>                </span><span class="annot"><span class="annottext">Maybe TlsConfiguration
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-200"></span><span>                </span><span class="annot"><span class="annottext">Maybe Settings
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-201"></span><span>                </span><span class="annot"><span class="annottext">Maybe TokenMetadataServer
</span><a href="#local-6989586621680280590"><span class="hs-identifier hs-var">tokenMetadataServer</span></a></span><span>
</span><span id="line-202"></span><span>                </span><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621680280604"><span class="hs-identifier hs-var">block0</span></a></span><span>
</span><span id="line-203"></span><span>                </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680280581"><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621680280581"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Tracer IO TestsLog -&gt; TestsLog -&gt; IO ()
forall (m :: * -&gt; *) a. Tracer m a -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">traceWith</span></span><span> </span><span class="annot"><span class="annottext">Tracer IO TestsLog
</span><a href="#local-6989586621680280608"><span class="hs-identifier hs-var">trCluster</span></a></span><span> </span><span class="annot"><span class="annottext">(TestsLog -&gt; IO ()) -&gt; TestsLog -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">LoggerName -&gt; LoggerName -&gt; LoggerName -&gt; TestsLog
</span><a href="Plutus.PAB.LocalCluster.Run.html#MsgBaseUrl"><span class="hs-identifier hs-var">MsgBaseUrl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; LoggerName
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; LoggerName) -&gt; (URI -&gt; FilePath) -&gt; URI -&gt; LoggerName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">URI -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(URI -&gt; LoggerName) -&gt; URI -&gt; LoggerName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621680280581"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>                    </span><span class="annot"><span class="annottext">LoggerName
</span><a href="#local-6989586621680280584"><span class="hs-identifier hs-var">ekgUrl</span></a></span><span> </span><span class="annot"><span class="annottext">LoggerName
</span><a href="#local-6989586621680280589"><span class="hs-identifier hs-var">prometheusUrl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-keyword">newtype</span><span> </span><span id="ChainIndexPort"><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#ChainIndexPort"><span class="hs-identifier hs-var">ChainIndexPort</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ChainIndexPort"><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#ChainIndexPort"><span class="hs-identifier hs-var">ChainIndexPort</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#setupPABServices"><span class="hs-identifier hs-type">setupPABServices</span></a></span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680280923"><span class="annot"><a href="#local-6989586621680280923"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680280923"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680280923"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680280923"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680280923"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621680280923"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Servant.MimeUnrender</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Servant.JSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680280923"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.Builtin.html#HasDefinitions"><span class="hs-identifier hs-type">HasDefinitions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680280923"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">OpenApi.ToSchema</span></span><span> </span><span class="annot"><a href="#local-6989586621680280923"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.Builtin.html#BuiltinHandler"><span class="hs-identifier hs-type">BuiltinHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680280923"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RunningNode</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span id="setupPABServices"><span class="annot"><span class="annottext">setupPABServices :: BuiltinHandler a
-&gt; FilePath -&gt; Int -&gt; FilePath -&gt; RunningNode -&gt; IO ()
</span><a href="Plutus.PAB.LocalCluster.Run.html#setupPABServices"><span class="hs-identifier hs-var hs-var">setupPABServices</span></a></span></span><span> </span><span id="local-6989586621680280576"><span class="annot"><span class="annottext">BuiltinHandler a
</span><a href="#local-6989586621680280576"><span class="hs-identifier hs-var">userContractHandler</span></a></span></span><span> </span><span id="local-6989586621680280575"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280575"><span class="hs-identifier hs-var">walletHost</span></a></span></span><span> </span><span id="local-6989586621680280574"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680280574"><span class="hs-identifier hs-var">walletPort</span></a></span></span><span> </span><span id="local-6989586621680280573"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280573"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span id="local-6989586621680280572"><span class="annot"><span class="annottext">RunningNode
</span><a href="#local-6989586621680280572"><span class="hs-identifier hs-var">rn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Async ()) -&gt; IO ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Async ()) -&gt; IO ()) -&gt; IO (Async ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO (Async ())
forall a. IO a -&gt; IO (Async a)
</span><span class="hs-identifier hs-var">async</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO (Async ())) -&gt; IO () -&gt; IO (Async ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- TODO: better types for arguments</span><span>
</span><span id="line-221"></span><span>    </span><span id="local-6989586621680280571"><span class="annot"><span class="annottext">BaseUrl
</span><a href="#local-6989586621680280571"><span class="hs-identifier hs-var">walletUrl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Int -&gt; IO BaseUrl
</span><a href="Plutus.PAB.LocalCluster.Run.html#restoreWallets"><span class="hs-identifier hs-var">restoreWallets</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280575"><span class="hs-identifier hs-var">walletHost</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680280574"><span class="hs-identifier hs-var">walletPort</span></a></span><span>
</span><span id="line-222"></span><span>    </span><span id="local-6989586621680280569"><span class="annot"><span class="annottext">ChainIndexPort
</span><a href="#local-6989586621680280569"><span class="hs-identifier hs-var">chainIndexPort</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; RunningNode -&gt; IO ChainIndexPort
</span><a href="Plutus.PAB.LocalCluster.Run.html#launchChainIndex"><span class="hs-identifier hs-var">launchChainIndex</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280573"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">RunningNode
</span><a href="#local-6989586621680280572"><span class="hs-identifier hs-var">rn</span></a></span><span>
</span><span id="line-223"></span><span>    </span><span class="annot"><span class="annottext">BuiltinHandler a
-&gt; LoggerName
-&gt; FilePath
-&gt; BaseUrl
-&gt; RunningNode
-&gt; ChainIndexPort
-&gt; IO ()
forall a.
(Show a, Ord a, FromJSON a, ToJSON a, Pretty a,
 MimeUnrender JSON a, HasDefinitions a, ToSchema a) =&gt;
BuiltinHandler a
-&gt; LoggerName
-&gt; FilePath
-&gt; BaseUrl
-&gt; RunningNode
-&gt; ChainIndexPort
-&gt; IO ()
</span><a href="Plutus.PAB.LocalCluster.Run.html#launchPAB"><span class="hs-identifier hs-var">launchPAB</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinHandler a
</span><a href="#local-6989586621680280576"><span class="hs-identifier hs-var">userContractHandler</span></a></span><span> </span><span class="annot"><span class="annottext">LoggerName
</span><span class="hs-identifier hs-var">fixturePassphrase</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280573"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">BaseUrl
</span><a href="#local-6989586621680280571"><span class="hs-identifier hs-var">walletUrl</span></a></span><span> </span><span class="annot"><span class="annottext">RunningNode
</span><a href="#local-6989586621680280572"><span class="hs-identifier hs-var">rn</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexPort
</span><a href="#local-6989586621680280569"><span class="hs-identifier hs-var">chainIndexPort</span></a></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="hs-comment">{-| Launch the chain index in a separate thread.
-}</span><span>
</span><span id="line-227"></span><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#launchChainIndex"><span class="hs-identifier hs-type">launchChainIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RunningNode</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#ChainIndexPort"><span class="hs-identifier hs-type">ChainIndexPort</span></a></span><span>
</span><span id="line-228"></span><span id="launchChainIndex"><span class="annot"><span class="annottext">launchChainIndex :: FilePath -&gt; RunningNode -&gt; IO ChainIndexPort
</span><a href="Plutus.PAB.LocalCluster.Run.html#launchChainIndex"><span class="hs-identifier hs-var hs-var">launchChainIndex</span></a></span></span><span> </span><span id="local-6989586621680280566"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280566"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RunningNode</span></span><span> </span><span id="local-6989586621680280565"><span class="annot"><span class="annottext">CardanoNodeConn
</span><a href="#local-6989586621680280565"><span class="hs-identifier hs-var">socketPath</span></a></span></span><span> </span><span id="local-6989586621680280564"><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621680280564"><span class="hs-identifier hs-var">_block0</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680280563"><span class="annot"><span class="annottext">NetworkParameters
</span><a href="#local-6989586621680280563"><span class="hs-identifier hs-var">_gp</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680280562"><span class="annot"><span class="annottext">NodeToClientVersionData
</span><a href="#local-6989586621680280562"><span class="hs-identifier hs-var">_vData</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PoolCertificate]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-229"></span><span>    </span><span id="local-6989586621680280561"><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621680280561"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Configuration
</span><span class="hs-identifier hs-var">ChainIndex.Logging.defaultConfig</span></span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680280559"><span class="annot"><span class="annottext">dbPath :: FilePath
</span><a href="#local-6989586621680280559"><span class="hs-identifier hs-var hs-var">dbPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280566"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;chain-index.db&quot;</span></span><span>
</span><span id="line-231"></span><span>        </span><span id="local-6989586621680280558"><span class="annot"><span class="annottext">chainIndexConfig :: ChainIndexConfig
</span><a href="#local-6989586621680280558"><span class="hs-identifier hs-var hs-var">chainIndexConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChainIndexConfig
</span><span class="hs-identifier hs-var">CI.defaultConfig</span></span><span>
</span><span id="line-232"></span><span>                    </span><span class="annot"><span class="annottext">ChainIndexConfig
-&gt; (ChainIndexConfig -&gt; ChainIndexConfig) -&gt; ChainIndexConfig
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Identity FilePath)
-&gt; ChainIndexConfig -&gt; Identity ChainIndexConfig
Lens' ChainIndexConfig FilePath
</span><span class="hs-identifier hs-var">CI.socketPath</span></span><span> </span><span class="annot"><span class="annottext">((FilePath -&gt; Identity FilePath)
 -&gt; ChainIndexConfig -&gt; Identity ChainIndexConfig)
-&gt; FilePath -&gt; ChainIndexConfig -&gt; ChainIndexConfig
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">CardanoNodeConn -&gt; FilePath
</span><span class="hs-identifier hs-var">nodeSocketFile</span></span><span> </span><span class="annot"><span class="annottext">CardanoNodeConn
</span><a href="#local-6989586621680280565"><span class="hs-identifier hs-var">socketPath</span></a></span><span>
</span><span id="line-233"></span><span>                    </span><span class="annot"><span class="annottext">ChainIndexConfig
-&gt; (ChainIndexConfig -&gt; ChainIndexConfig) -&gt; ChainIndexConfig
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Identity FilePath)
-&gt; ChainIndexConfig -&gt; Identity ChainIndexConfig
Lens' ChainIndexConfig FilePath
</span><span class="hs-identifier hs-var">CI.dbPath</span></span><span> </span><span class="annot"><span class="annottext">((FilePath -&gt; Identity FilePath)
 -&gt; ChainIndexConfig -&gt; Identity ChainIndexConfig)
-&gt; FilePath -&gt; ChainIndexConfig -&gt; ChainIndexConfig
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280559"><span class="hs-identifier hs-var">dbPath</span></a></span><span>
</span><span id="line-234"></span><span>                    </span><span class="annot"><span class="annottext">ChainIndexConfig
-&gt; (ChainIndexConfig -&gt; ChainIndexConfig) -&gt; ChainIndexConfig
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(NetworkId -&gt; Identity NetworkId)
-&gt; ChainIndexConfig -&gt; Identity ChainIndexConfig
Lens' ChainIndexConfig NetworkId
</span><span class="hs-identifier hs-var">CI.networkId</span></span><span> </span><span class="annot"><span class="annottext">((NetworkId -&gt; Identity NetworkId)
 -&gt; ChainIndexConfig -&gt; Identity ChainIndexConfig)
-&gt; NetworkId -&gt; ChainIndexConfig -&gt; ChainIndexConfig
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><span class="hs-identifier hs-var">CAPI.Mainnet</span></span><span>
</span><span id="line-235"></span><span>    </span><span class="annot"><span class="annottext">IO (Async ()) -&gt; IO ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Async ()) -&gt; IO ())
-&gt; (IO () -&gt; IO (Async ())) -&gt; IO () -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO (Async ())
forall a. IO a -&gt; IO (Async a)
</span><span class="hs-identifier hs-var">async</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Configuration -&gt; ChainIndexConfig -&gt; IO ()
</span><span class="hs-identifier hs-var">ChainIndex.runMain</span></span><span> </span><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621680280561"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexConfig
</span><a href="#local-6989586621680280558"><span class="hs-identifier hs-var">chainIndexConfig</span></a></span><span>
</span><span id="line-236"></span><span>    </span><span class="annot"><span class="annottext">ChainIndexPort -&gt; IO ChainIndexPort
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexPort -&gt; IO ChainIndexPort)
-&gt; ChainIndexPort -&gt; IO ChainIndexPort
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ChainIndexPort
</span><a href="Plutus.PAB.LocalCluster.Run.html#ChainIndexPort"><span class="hs-identifier hs-var">ChainIndexPort</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; ChainIndexPort) -&gt; Int -&gt; ChainIndexPort
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexConfig
</span><a href="#local-6989586621680280558"><span class="hs-identifier hs-var">chainIndexConfig</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexConfig -&gt; Getting Int ChainIndexConfig Int -&gt; Int
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting Int ChainIndexConfig Int
Lens' ChainIndexConfig Int
</span><span class="hs-identifier hs-var">CI.port</span></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-comment">{-| Launch the PAB in a separate thread.
-}</span><span>
</span><span id="line-240"></span><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#launchPAB"><span class="hs-identifier hs-type">launchPAB</span></a></span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680280855"><span class="annot"><a href="#local-6989586621680280855"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-242"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680280855"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680280855"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680280855"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680280855"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-246"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621680280855"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Servant.MimeUnrender</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Servant.JSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680280855"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.Builtin.html#HasDefinitions"><span class="hs-identifier hs-type">HasDefinitions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680280855"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">OpenApi.ToSchema</span></span><span> </span><span class="annot"><a href="#local-6989586621680280855"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.Builtin.html#BuiltinHandler"><span class="hs-identifier hs-type">BuiltinHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680280855"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-comment">-- ^ Passphrase</span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-comment">-- ^ Temp directory</span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BaseUrl</span></span><span> </span><span class="hs-comment">-- ^ wallet url</span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RunningNode</span></span><span> </span><span class="hs-comment">-- ^ Socket path</span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#ChainIndexPort"><span class="hs-identifier hs-type">ChainIndexPort</span></a></span><span> </span><span class="hs-comment">-- ^ Port of the chain index</span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span id="launchPAB"><span class="annot"><span class="annottext">launchPAB :: BuiltinHandler a
-&gt; LoggerName
-&gt; FilePath
-&gt; BaseUrl
-&gt; RunningNode
-&gt; ChainIndexPort
-&gt; IO ()
</span><a href="Plutus.PAB.LocalCluster.Run.html#launchPAB"><span class="hs-identifier hs-var hs-var">launchPAB</span></a></span></span><span> </span><span id="local-6989586621680280550"><span class="annot"><span class="annottext">BuiltinHandler a
</span><a href="#local-6989586621680280550"><span class="hs-identifier hs-var">userContractHandler</span></a></span></span><span>
</span><span id="line-259"></span><span>    </span><span id="local-6989586621680280549"><span class="annot"><span class="annottext">LoggerName
</span><a href="#local-6989586621680280549"><span class="hs-identifier hs-var">passPhrase</span></a></span></span><span>
</span><span id="line-260"></span><span>    </span><span id="local-6989586621680280548"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280548"><span class="hs-identifier hs-var">dir</span></a></span></span><span>
</span><span id="line-261"></span><span>    </span><span id="local-6989586621680280547"><span class="annot"><span class="annottext">BaseUrl
</span><a href="#local-6989586621680280547"><span class="hs-identifier hs-var">walletUrl</span></a></span></span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RunningNode</span></span><span> </span><span id="local-6989586621680280546"><span class="annot"><span class="annottext">CardanoNodeConn
</span><a href="#local-6989586621680280546"><span class="hs-identifier hs-var">socketPath</span></a></span></span><span> </span><span id="local-6989586621680280545"><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621680280545"><span class="hs-identifier hs-var">_block0</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680280544"><span class="annot"><span class="annottext">NetworkParameters
</span><a href="#local-6989586621680280544"><span class="hs-identifier hs-var">networkParameters</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NodeToClientVersionData
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PoolCertificate]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#ChainIndexPort"><span class="hs-identifier hs-type">ChainIndexPort</span></a></span><span> </span><span id="local-6989586621680280543"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680280543"><span class="hs-identifier hs-var">chainIndexPort</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680280542"><span class="annot"><span class="annottext">opts :: AppOpts
</span><a href="#local-6989586621680280542"><span class="hs-identifier hs-var hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AppOpts :: Maybe Severity
-&gt; Maybe FilePath
-&gt; Maybe FilePath
-&gt; Maybe LoggerName
-&gt; Maybe Int
-&gt; Point
-&gt; Bool
-&gt; StorageBackend
-&gt; ConfigCommand
-&gt; AppOpts
</span><a href="Plutus.PAB.Run.CommandParser.html#AppOpts"><span class="hs-identifier hs-type">AppOpts</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">minLogLevel :: Maybe Severity
</span><a href="Plutus.PAB.Run.CommandParser.html#minLogLevel"><span class="hs-identifier hs-var">minLogLevel</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Severity
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-266"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">logConfigPath :: Maybe FilePath
</span><a href="Plutus.PAB.Run.CommandParser.html#logConfigPath"><span class="hs-identifier hs-var">logConfigPath</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-267"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">configPath :: Maybe FilePath
</span><a href="Plutus.PAB.Run.CommandParser.html#configPath"><span class="hs-identifier hs-var">configPath</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-268"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rollbackHistory :: Maybe Int
</span><a href="Plutus.PAB.Run.CommandParser.html#rollbackHistory"><span class="hs-identifier hs-var">rollbackHistory</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-269"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">resumeFrom :: Point
</span><a href="Plutus.PAB.Run.CommandParser.html#resumeFrom"><span class="hs-identifier hs-var">resumeFrom</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point
</span><span class="hs-identifier hs-var">PointAtGenesis</span></span><span>
</span><span id="line-270"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">runEkgServer :: Bool
</span><a href="Plutus.PAB.Run.CommandParser.html#runEkgServer"><span class="hs-identifier hs-var">runEkgServer</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-271"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">storageBackend :: StorageBackend
</span><a href="Plutus.PAB.Run.CommandParser.html#storageBackend"><span class="hs-identifier hs-var">storageBackend</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StorageBackend
</span><a href="Plutus.PAB.App.html#BeamBackend"><span class="hs-identifier hs-var">BeamBackend</span></a></span><span>
</span><span id="line-272"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cmd :: ConfigCommand
</span><a href="Plutus.PAB.Run.CommandParser.html#cmd"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConfigCommand
</span><a href="Plutus.PAB.Run.Command.html#PABWebserver"><span class="hs-identifier hs-var">PABWebserver</span></a></span><span>
</span><span id="line-273"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">passphrase :: Maybe LoggerName
</span><a href="#local-6989586621680280540"><span class="hs-identifier hs-var">PAB.Command.passphrase</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LoggerName -&gt; Maybe LoggerName
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">LoggerName
</span><a href="#local-6989586621680280549"><span class="hs-identifier hs-var">passPhrase</span></a></span><span>
</span><span id="line-274"></span><span>                       </span><span class="hs-special">}</span><span>
</span><span id="line-275"></span><span>        </span><span id="local-6989586621680280539"><span class="annot"><span class="annottext">networkID :: NetworkId
</span><a href="#local-6989586621680280539"><span class="hs-identifier hs-var hs-var">networkID</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><span class="hs-identifier hs-var">CAPI.Mainnet</span></span><span>
</span><span id="line-276"></span><span>        </span><span class="hs-comment">-- TODO: Remove when PAB queries local node for slot config</span><span>
</span><span id="line-277"></span><span>        </span><span id="local-6989586621680280538"><span class="annot"><span class="annottext">slotConfig :: SlotConfig
</span><a href="#local-6989586621680280538"><span class="hs-identifier hs-var hs-var">slotConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NetworkParameters -&gt; SlotConfig
</span><a href="Plutus.PAB.LocalCluster.Run.html#slotConfigOfNetworkParameters"><span class="hs-identifier hs-var">slotConfigOfNetworkParameters</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkParameters
</span><a href="#local-6989586621680280544"><span class="hs-identifier hs-var">networkParameters</span></a></span><span>
</span><span id="line-278"></span><span>        </span><span class="hs-comment">-- TODO: Remove when PAB queries local node for security param</span><span>
</span><span id="line-279"></span><span>        </span><span id="local-6989586621680280536"><span class="annot"><span class="annottext">securityParam :: Integer
</span><a href="#local-6989586621680280536"><span class="hs-identifier hs-var hs-var">securityParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span>
</span><span id="line-280"></span><span>                      </span><span class="annot"><span class="annottext">(Word32 -&gt; Integer) -&gt; Word32 -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Quantity &quot;block&quot; Word32 -&gt; Word32
forall (unit :: Symbol) a. Quantity unit a -&gt; a
</span><span class="hs-identifier hs-var hs-var">getQuantity</span></span><span>
</span><span id="line-281"></span><span>                      </span><span class="annot"><span class="annottext">(Quantity &quot;block&quot; Word32 -&gt; Word32)
-&gt; Quantity &quot;block&quot; Word32 -&gt; Word32
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SlottingParameters -&gt; Quantity &quot;block&quot; Word32
</span><span class="hs-identifier hs-var hs-var">getSecurityParameter</span></span><span>
</span><span id="line-282"></span><span>                      </span><span class="annot"><span class="annottext">(SlottingParameters -&gt; Quantity &quot;block&quot; Word32)
-&gt; SlottingParameters -&gt; Quantity &quot;block&quot; Word32
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkParameters -&gt; SlottingParameters
</span><span class="hs-identifier hs-var hs-var">slottingParameters</span></span><span> </span><span class="annot"><span class="annottext">NetworkParameters
</span><a href="#local-6989586621680280544"><span class="hs-identifier hs-var">networkParameters</span></a></span><span>
</span><span id="line-283"></span><span>        </span><span id="local-6989586621680280535"><span class="annot"><span class="annottext">config :: Config
</span><a href="#local-6989586621680280535"><span class="hs-identifier hs-var hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-284"></span><span>            </span><span class="annot"><span class="annottext">Config
</span><a href="Plutus.PAB.Types.html#defaultConfig"><span class="hs-identifier hs-var">PAB.Config.defaultConfig</span></a></span><span>
</span><span id="line-285"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">nodeServerConfig :: PABServerConfig
</span><a href="Plutus.PAB.Types.html#nodeServerConfig"><span class="hs-identifier hs-var">nodeServerConfig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PABServerConfig
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-286"></span><span>                    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">pscNodeMode :: NodeMode
</span><a href="Cardano.Node.Types.html#pscNodeMode"><span class="hs-identifier hs-var">pscNodeMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeMode
</span><a href="Cardano.Node.Types.html#AlonzoNode"><span class="hs-identifier hs-var">AlonzoNode</span></a></span><span>
</span><span id="line-287"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pscNodeServerConfig :: NodeServerConfig
</span><a href="Cardano.Node.Types.html#pscNodeServerConfig"><span class="hs-identifier hs-var">pscNodeServerConfig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeServerConfig
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-288"></span><span>                        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">nscSocketPath :: FilePath
</span><span class="hs-identifier hs-var">nscSocketPath</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CardanoNodeConn -&gt; FilePath
</span><span class="hs-identifier hs-var">nodeSocketFile</span></span><span> </span><span class="annot"><span class="annottext">CardanoNodeConn
</span><a href="#local-6989586621680280546"><span class="hs-identifier hs-var">socketPath</span></a></span><span>
</span><span id="line-289"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nscNetworkId :: NetworkId
</span><span class="hs-identifier hs-var">nscNetworkId</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621680280539"><span class="hs-identifier hs-var">networkID</span></a></span><span>
</span><span id="line-290"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nscSlotConfig :: SlotConfig
</span><span class="hs-identifier hs-var">nscSlotConfig</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SlotConfig
</span><a href="#local-6989586621680280538"><span class="hs-identifier hs-var">slotConfig</span></a></span><span>
</span><span id="line-291"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nscKeptBlocks :: Integer
</span><span class="hs-identifier hs-var">nscKeptBlocks</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680280536"><span class="hs-identifier hs-var">securityParam</span></a></span><span>
</span><span id="line-292"></span><span>                        </span><span class="hs-special">}</span><span>
</span><span id="line-293"></span><span>                    </span><span class="hs-special">}</span><span>
</span><span id="line-294"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dbConfig :: DbConfig
</span><a href="Plutus.PAB.Types.html#dbConfig"><span class="hs-identifier hs-var">dbConfig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DbConfig -&gt; DbConfig
</span><a href="Plutus.PAB.Types.html#SqliteDB"><span class="hs-identifier hs-var">SqliteDB</span></a></span><span> </span><span class="annot"><span class="annottext">DbConfig
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dbConfigFile :: LoggerName
</span><span class="hs-identifier hs-var">dbConfigFile</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; LoggerName
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280548"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;plutus-pab.db&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-295"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">chainQueryConfig :: ChainQueryConfig
</span><a href="Plutus.PAB.Types.html#chainQueryConfig"><span class="hs-identifier hs-var">chainQueryConfig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChainIndexConfig -&gt; ChainQueryConfig
</span><a href="Plutus.PAB.Types.html#ChainIndexConfig"><span class="hs-identifier hs-var">ChainIndexConfig</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexConfig
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">ciBaseUrl :: ChainIndexUrl
</span><a href="Cardano.ChainIndex.Types.html#ciBaseUrl"><span class="hs-identifier hs-var">PAB.CI.ciBaseUrl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseUrl -&gt; ChainIndexUrl
</span><a href="Cardano.ChainIndex.Types.html#ChainIndexUrl"><span class="hs-identifier hs-var">PAB.CI.ChainIndexUrl</span></a></span><span> </span><span class="annot"><span class="annottext">(BaseUrl -&gt; ChainIndexUrl) -&gt; BaseUrl -&gt; ChainIndexUrl
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Scheme -&gt; FilePath -&gt; Int -&gt; FilePath -&gt; BaseUrl
</span><span class="hs-identifier hs-var">BaseUrl</span></span><span> </span><span class="annot"><span class="annottext">Scheme
</span><span class="hs-identifier hs-var">Http</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;localhost&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680280543"><span class="hs-identifier hs-var">chainIndexPort</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">}</span><span>
</span><span id="line-296"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">walletServerConfig :: WalletConfig
</span><a href="Plutus.PAB.Types.html#walletServerConfig"><span class="hs-identifier hs-var">walletServerConfig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASetter WalletConfig WalletConfig WalletUrl WalletUrl
-&gt; WalletUrl -&gt; WalletConfig -&gt; WalletConfig
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LocalWalletSettings -&gt; Identity LocalWalletSettings)
-&gt; WalletConfig -&gt; Identity WalletConfig
Traversal' WalletConfig LocalWalletSettings
</span><a href="Cardano.Wallet.Types.html#walletSettingsL"><span class="hs-identifier hs-var">Wallet.Config.walletSettingsL</span></a></span><span> </span><span class="annot"><span class="annottext">((LocalWalletSettings -&gt; Identity LocalWalletSettings)
 -&gt; WalletConfig -&gt; Identity WalletConfig)
-&gt; ((WalletUrl -&gt; Identity WalletUrl)
    -&gt; LocalWalletSettings -&gt; Identity LocalWalletSettings)
-&gt; ASetter WalletConfig WalletConfig WalletUrl WalletUrl
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(WalletUrl -&gt; Identity WalletUrl)
-&gt; LocalWalletSettings -&gt; Identity LocalWalletSettings
Lens' LocalWalletSettings WalletUrl
</span><a href="Cardano.Wallet.Types.html#baseUrlL"><span class="hs-identifier hs-var">Wallet.Config.baseUrlL</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseUrl -&gt; WalletUrl
</span><a href="Cardano.Wallet.Types.html#WalletUrl"><span class="hs-identifier hs-var">WalletUrl</span></a></span><span> </span><span class="annot"><span class="annottext">BaseUrl
</span><a href="#local-6989586621680280547"><span class="hs-identifier hs-var">walletUrl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WalletConfig
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-297"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-298"></span><span>    </span><span class="annot"><span class="annottext">BuiltinHandler a -&gt; Maybe Config -&gt; AppOpts -&gt; IO ()
forall a.
(Show a, Ord a, FromJSON a, ToJSON a, Pretty a,
 MimeUnrender JSON a, HasDefinitions a, ToSchema a) =&gt;
BuiltinHandler a -&gt; Maybe Config -&gt; AppOpts -&gt; IO ()
</span><a href="Plutus.PAB.Run.html#runWithOpts"><span class="hs-identifier hs-var">PAB.Run.runWithOpts</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinHandler a
</span><a href="#local-6989586621680280550"><span class="hs-identifier hs-var">userContractHandler</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Config -&gt; Maybe Config
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680280535"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AppOpts
</span><a href="#local-6989586621680280542"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cmd :: ConfigCommand
</span><a href="Plutus.PAB.Run.CommandParser.html#cmd"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConfigCommand
</span><a href="Plutus.PAB.Run.Command.html#Migrate"><span class="hs-identifier hs-var">Migrate</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-299"></span><span>    </span><span class="annot"><span class="annottext">BuiltinHandler a -&gt; Maybe Config -&gt; AppOpts -&gt; IO ()
forall a.
(Show a, Ord a, FromJSON a, ToJSON a, Pretty a,
 MimeUnrender JSON a, HasDefinitions a, ToSchema a) =&gt;
BuiltinHandler a -&gt; Maybe Config -&gt; AppOpts -&gt; IO ()
</span><a href="Plutus.PAB.Run.html#runWithOpts"><span class="hs-identifier hs-var">PAB.Run.runWithOpts</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinHandler a
</span><a href="#local-6989586621680280550"><span class="hs-identifier hs-var">userContractHandler</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Config -&gt; Maybe Config
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680280535"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AppOpts
</span><a href="#local-6989586621680280542"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cmd :: ConfigCommand
</span><a href="Plutus.PAB.Run.CommandParser.html#cmd"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConfigCommand
</span><a href="Plutus.PAB.Run.Command.html#PABWebserver"><span class="hs-identifier hs-var">PABWebserver</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#slotConfigOfNetworkParameters"><span class="hs-identifier hs-type">slotConfigOfNetworkParameters</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NetworkParameters</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotConfig</span></span><span>
</span><span id="line-302"></span><span id="slotConfigOfNetworkParameters"><span class="annot"><span class="annottext">slotConfigOfNetworkParameters :: NetworkParameters -&gt; SlotConfig
</span><a href="Plutus.PAB.LocalCluster.Run.html#slotConfigOfNetworkParameters"><span class="hs-identifier hs-var hs-var">slotConfigOfNetworkParameters</span></a></span></span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NetworkParameters</span></span><span>
</span><span id="line-304"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GenesisParameters</span></span><span> </span><span class="annot"><span class="annottext">Hash &quot;Genesis&quot;
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StartTime</span></span><span> </span><span id="local-6989586621680280524"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621680280524"><span class="hs-identifier hs-var">startUtcTime</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SlottingParameters</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SlotLength</span></span><span> </span><span id="local-6989586621680280523"><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621680280523"><span class="hs-identifier hs-var">nominalDiffTime</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EpochLength
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ActiveSlotCoefficient
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Quantity &quot;block&quot; Word32
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ProtocolParameters
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><span class="annottext">Integer -&gt; POSIXTime -&gt; SlotConfig
</span><span class="hs-identifier hs-var">SlotConfig</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pico -&gt; Integer
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">floor</span></a></span><span> </span><span class="annot"><span class="annottext">(Pico -&gt; Integer) -&gt; Pico -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Pico
</span><span class="hs-number">1000</span></span><span> </span><span class="annot"><span class="annottext">Pico -&gt; Pico -&gt; Pico
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; Pico
</span><span class="hs-identifier hs-var">nominalDiffTimeToSeconds</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621680280523"><span class="hs-identifier hs-var">nominalDiffTime</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTCTime -&gt; POSIXTime
</span><span class="hs-identifier hs-var">TimeSlot.utcTimeToPOSIXTime</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621680280524"><span class="hs-identifier hs-var">startUtcTime</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="hs-comment">{-| Set up wallets
-}</span><span>
</span><span id="line-310"></span><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#restoreWallets"><span class="hs-identifier hs-type">restoreWallets</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BaseUrl</span></span><span>
</span><span id="line-311"></span><span id="restoreWallets"><span class="annot"><span class="annottext">restoreWallets :: FilePath -&gt; Int -&gt; IO BaseUrl
</span><a href="Plutus.PAB.LocalCluster.Run.html#restoreWallets"><span class="hs-identifier hs-var hs-var">restoreWallets</span></a></span></span><span> </span><span id="local-6989586621680280519"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280519"><span class="hs-identifier hs-var">walletHost</span></a></span></span><span> </span><span id="local-6989586621680280518"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680280518"><span class="hs-identifier hs-var">walletPort</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-312"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; IO ()
</span><a href="Plutus.PAB.LocalCluster.Run.html#sleep"><span class="hs-identifier hs-var">sleep</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">15</span></span><span>
</span><span id="line-313"></span><span>    </span><span id="local-6989586621680280516"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621680280516"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ManagerSettings -&gt; IO Manager
</span><span class="hs-identifier hs-var">newManager</span></span><span> </span><span class="annot"><span class="annottext">ManagerSettings
</span><span class="hs-identifier hs-var">defaultManagerSettings</span></span><span>
</span><span id="line-314"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680280515"><span class="annot"><span class="annottext">baseUrl :: BaseUrl
</span><a href="#local-6989586621680280515"><span class="hs-identifier hs-var hs-var">baseUrl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BaseUrl :: Scheme -&gt; FilePath -&gt; Int -&gt; FilePath -&gt; BaseUrl
</span><span class="hs-identifier hs-type">BaseUrl</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">baseUrlScheme :: Scheme
</span><span class="hs-identifier hs-var">baseUrlScheme</span></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">Scheme
</span><span class="hs-identifier hs-var">Http</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">baseUrlHost :: FilePath
</span><span class="hs-identifier hs-var">baseUrlHost</span></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280519"><span class="hs-identifier hs-var">walletHost</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">baseUrlPort :: Int
</span><span class="hs-identifier hs-var">baseUrlPort</span></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680280518"><span class="hs-identifier hs-var">walletPort</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">baseUrlPath :: FilePath
</span><span class="hs-identifier hs-var">baseUrlPath</span></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">}</span><span>
</span><span id="line-315"></span><span>        </span><span id="local-6989586621680280514"><span class="annot"><span class="annottext">clientEnv :: ClientEnv
</span><a href="#local-6989586621680280514"><span class="hs-identifier hs-var hs-var">clientEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Manager -&gt; BaseUrl -&gt; ClientEnv
</span><span class="hs-identifier hs-var">mkClientEnv</span></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621680280516"><span class="hs-identifier hs-var">manager</span></a></span><span> </span><span class="annot"><span class="annottext">BaseUrl
</span><a href="#local-6989586621680280515"><span class="hs-identifier hs-var">baseUrl</span></a></span><span>
</span><span id="line-316"></span><span>        </span><span id="local-6989586621680280513"><span class="annot"><span class="annottext">ApiMnemonicT '[15, 18, 21, 24]
</span><a href="#local-6989586621680280513"><span class="hs-identifier hs-var">mnemonic</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ApiMnemonicT</span></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-number">15</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">18</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">21</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">24</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SomeMnemonic -&gt; ApiMnemonicT '[15, 18, 21, 24]
forall (sizes :: [Nat]). SomeMnemonic -&gt; ApiMnemonicT sizes
</span><span class="hs-identifier hs-var">ApiMnemonicT</span></span><span> </span><span class="annot"><span class="annottext">(SomeMnemonic -&gt; ApiMnemonicT '[15, 18, 21, 24])
-&gt; SomeMnemonic -&gt; ApiMnemonicT '[15, 18, 21, 24]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Mnemonic 15 -&gt; SomeMnemonic
forall (mw :: Nat). KnownNat mw =&gt; Mnemonic mw -&gt; SomeMnemonic
</span><span class="hs-identifier hs-var">SomeMnemonic</span></span><span> </span><span class="annot"><span class="annottext">(Mnemonic 15 -&gt; SomeMnemonic) -&gt; Mnemonic 15 -&gt; SomeMnemonic
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Mnemonic 15] -&gt; Mnemonic 15
forall a. [a] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="annot"><span class="annottext">[Mnemonic 15]
</span><span class="hs-identifier hs-var">Faucet.seqMnemonics</span></span><span>
</span><span id="line-317"></span><span>        </span><span id="local-6989586621680280510"><span class="annot"><span class="annottext">wpData :: WalletPostData
</span><a href="#local-6989586621680280510"><span class="hs-identifier hs-var hs-var">wpData</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (ApiT AddressPoolGap)
-&gt; ApiMnemonicT (AllowedMnemonics 'Shelley)
-&gt; Maybe (ApiMnemonicT (AllowedMnemonics 'SndFactor))
-&gt; ApiT WalletName
-&gt; ApiT (Passphrase &quot;user&quot;)
-&gt; WalletPostData
</span><span class="hs-identifier hs-var">Wallet.Types.WalletPostData</span></span><span>
</span><span id="line-318"></span><span>                        </span><span class="annot"><span class="annottext">Maybe (ApiT AddressPoolGap)
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-319"></span><span>                        </span><span class="annot"><span class="annottext">ApiMnemonicT '[15, 18, 21, 24]
ApiMnemonicT (AllowedMnemonics 'Shelley)
</span><a href="#local-6989586621680280513"><span class="hs-identifier hs-var">mnemonic</span></a></span><span>
</span><span id="line-320"></span><span>                        </span><span class="annot"><span class="annottext">Maybe (ApiMnemonicT (AllowedMnemonics 'SndFactor))
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-321"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WalletName -&gt; ApiT WalletName
forall a. a -&gt; ApiT a
</span><span class="hs-identifier hs-var">ApiT</span></span><span> </span><span class="annot"><span class="annottext">(WalletName -&gt; ApiT WalletName) -&gt; WalletName -&gt; ApiT WalletName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">LoggerName -&gt; WalletName
</span><span class="hs-identifier hs-var">WalletName</span></span><span> </span><span class="annot"><span class="annottext">LoggerName
</span><span class="hs-string">&quot;plutus-wallet&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Passphrase &quot;user&quot; -&gt; ApiT (Passphrase &quot;user&quot;)
forall a. a -&gt; ApiT a
</span><span class="hs-identifier hs-var">ApiT</span></span><span> </span><span class="annot"><span class="annottext">(Passphrase &quot;user&quot; -&gt; ApiT (Passphrase &quot;user&quot;))
-&gt; Passphrase &quot;user&quot; -&gt; ApiT (Passphrase &quot;user&quot;)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes -&gt; Passphrase &quot;user&quot;
forall (purpose :: Symbol). ScrubbedBytes -&gt; Passphrase purpose
</span><span class="hs-identifier hs-var">Passphrase</span></span><span> </span><span class="annot"><span class="annottext">(ScrubbedBytes -&gt; Passphrase &quot;user&quot;)
-&gt; ScrubbedBytes -&gt; Passphrase &quot;user&quot;
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ScrubbedBytes
forall a. IsString a =&gt; FilePath -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromString</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; ScrubbedBytes) -&gt; FilePath -&gt; ScrubbedBytes
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">LoggerName -&gt; FilePath
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">LoggerName
</span><span class="hs-identifier hs-var">fixturePassphrase</span></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>        </span><span id="local-6989586621680280508"><span class="annot"><span class="annottext">walletAcc :: WalletOrAccountPostData
</span><a href="#local-6989586621680280508"><span class="hs-identifier hs-var hs-var">walletAcc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WalletOrAccountPostData :: Either WalletPostData AccountPostData -&gt; WalletOrAccountPostData
</span><span class="hs-identifier hs-type">WalletOrAccountPostData</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:postData:WalletOrAccountPostData :: Either WalletPostData AccountPostData
</span><span class="hs-identifier hs-var">postData</span></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">WalletPostData -&gt; Either WalletPostData AccountPostData
forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">WalletPostData
</span><a href="#local-6989586621680280510"><span class="hs-identifier hs-var">wpData</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-324"></span><span>    </span><span id="local-6989586621680280507"><span class="annot"><span class="annottext">Either ClientError ApiWallet
</span><a href="#local-6989586621680280507"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ClientM ApiWallet
 -&gt; ClientEnv -&gt; IO (Either ClientError ApiWallet))
-&gt; ClientEnv
-&gt; ClientM ApiWallet
-&gt; IO (Either ClientError ApiWallet)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">ClientM ApiWallet -&gt; ClientEnv -&gt; IO (Either ClientError ApiWallet)
forall a. ClientM a -&gt; ClientEnv -&gt; IO (Either ClientError a)
</span><span class="hs-identifier hs-var">runClientM</span></span><span> </span><span class="annot"><span class="annottext">ClientEnv
</span><a href="#local-6989586621680280514"><span class="hs-identifier hs-var">clientEnv</span></a></span><span> </span><span class="annot"><span class="annottext">(ClientM ApiWallet -&gt; IO (Either ClientError ApiWallet))
-&gt; ClientM ApiWallet -&gt; IO (Either ClientError ApiWallet)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">WalletClient ApiWallet -&gt; PostData ApiWallet -&gt; ClientM ApiWallet
forall wallet.
WalletClient wallet -&gt; PostData wallet -&gt; ClientM wallet
</span><span class="hs-identifier hs-var hs-var">WalletClient.postWallet</span></span><span> </span><span class="annot"><span class="annottext">WalletClient ApiWallet
</span><span class="hs-identifier hs-var">WalletClient.walletClient</span></span><span> </span><span class="annot"><span class="annottext">PostData ApiWallet
WalletOrAccountPostData
</span><a href="#local-6989586621680280508"><span class="hs-identifier hs-var">walletAcc</span></a></span><span>
</span><span id="line-325"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either ClientError ApiWallet
</span><a href="#local-6989586621680280507"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-326"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621680280504"><span class="annot"><span class="annottext">ClientError
</span><a href="#local-6989586621680280504"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-327"></span><span>            </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">putStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;restoreWallet failed&quot;</span></span><span>
</span><span id="line-328"></span><span>            </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">putStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; FilePath -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Error: &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ClientError -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">ClientError
</span><a href="#local-6989586621680280504"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-329"></span><span>            </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">putStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;restoreWallet: trying again in 30s&quot;</span></span><span>
</span><span id="line-330"></span><span>            </span><span class="annot"><span class="annottext">Int -&gt; IO ()
</span><a href="Plutus.PAB.LocalCluster.Run.html#sleep"><span class="hs-identifier hs-var">sleep</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">15</span></span><span>
</span><span id="line-331"></span><span>            </span><span class="annot"><span class="annottext">FilePath -&gt; Int -&gt; IO BaseUrl
</span><a href="Plutus.PAB.LocalCluster.Run.html#restoreWallets"><span class="hs-identifier hs-var">restoreWallets</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680280519"><span class="hs-identifier hs-var">walletHost</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680280518"><span class="hs-identifier hs-var">walletPort</span></a></span><span>
</span><span id="line-332"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ApiWallet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ApiT</span></span><span> </span><span id="local-6989586621680280503"><span class="annot"><span class="annottext">WalletId
</span><a href="#local-6989586621680280503"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ApiT AddressPoolGap
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ApiWalletBalance
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ApiWalletAssetsBalance
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ApiWalletDelegation
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ApiT WalletName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe ApiWalletPassphraseInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ApiT SyncProgress
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ApiBlockReference
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-333"></span><span>            </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">putStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; FilePath -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Restored wallet: &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">WalletId -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">WalletId
</span><a href="#local-6989586621680280503"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-334"></span><span>            </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">putStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; FilePath -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Passphrase: &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LoggerName -&gt; FilePath
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">LoggerName
</span><span class="hs-identifier hs-var">fixturePassphrase</span></span><span>
</span><span id="line-335"></span><span>            </span><span class="annot"><span class="annottext">BaseUrl -&gt; IO BaseUrl
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">BaseUrl
</span><a href="#local-6989586621680280515"><span class="hs-identifier hs-var">baseUrl</span></a></span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#sleep"><span class="hs-identifier hs-type">sleep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span id="sleep"><span class="annot"><span class="annottext">sleep :: Int -&gt; IO ()
</span><a href="Plutus.PAB.LocalCluster.Run.html#sleep"><span class="hs-identifier hs-var hs-var">sleep</span></a></span></span><span> </span><span id="local-6989586621680280502"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680280502"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">threadDelay</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; IO ()) -&gt; Int -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680280502"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1_000_000</span></span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span class="hs-comment">-- Logging</span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span class="hs-keyword">data</span><span> </span><span id="TestsLog"><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#TestsLog"><span class="hs-identifier hs-var">TestsLog</span></a></span></span><span>
</span><span id="line-344"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="MsgBaseUrl"><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#MsgBaseUrl"><span class="hs-identifier hs-var">MsgBaseUrl</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-comment">-- wallet url, ekg url, prometheus url</span><span>
</span><span id="line-345"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="MsgSettingUpFaucet"><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#MsgSettingUpFaucet"><span class="hs-identifier hs-var">MsgSettingUpFaucet</span></a></span></span><span>
</span><span id="line-346"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="MsgCluster"><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#MsgCluster"><span class="hs-identifier hs-var">MsgCluster</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ClusterLog</span></span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680280496"><span id="local-6989586621680280498"><span id="local-6989586621680280500"><span class="annot"><span class="annottext">Int -&gt; TestsLog -&gt; FilePath -&gt; FilePath
[TestsLog] -&gt; FilePath -&gt; FilePath
TestsLog -&gt; FilePath
(Int -&gt; TestsLog -&gt; FilePath -&gt; FilePath)
-&gt; (TestsLog -&gt; FilePath)
-&gt; ([TestsLog] -&gt; FilePath -&gt; FilePath)
-&gt; Show TestsLog
forall a.
(Int -&gt; a -&gt; FilePath -&gt; FilePath)
-&gt; (a -&gt; FilePath) -&gt; ([a] -&gt; FilePath -&gt; FilePath) -&gt; Show a
showList :: [TestsLog] -&gt; FilePath -&gt; FilePath
$cshowList :: [TestsLog] -&gt; FilePath -&gt; FilePath
show :: TestsLog -&gt; FilePath
$cshow :: TestsLog -&gt; FilePath
showsPrec :: Int -&gt; TestsLog -&gt; FilePath -&gt; FilePath
$cshowsPrec :: Int -&gt; TestsLog -&gt; FilePath -&gt; FilePath
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToText</span></span><span> </span><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#TestsLog"><span class="hs-identifier hs-type">TestsLog</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-350"></span><span>    </span><span id="local-6989586621680280492"><span class="annot"><span class="annottext">toText :: TestsLog -&gt; LoggerName
</span><a href="#local-6989586621680280492"><span class="hs-identifier hs-var hs-var hs-var hs-var">toText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-351"></span><span>        </span><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#MsgBaseUrl"><span class="hs-identifier hs-type">MsgBaseUrl</span></a></span><span> </span><span id="local-6989586621680280491"><span class="annot"><span class="annottext">LoggerName
</span><a href="#local-6989586621680280491"><span class="hs-identifier hs-var">walletUrl</span></a></span></span><span> </span><span id="local-6989586621680280490"><span class="annot"><span class="annottext">LoggerName
</span><a href="#local-6989586621680280490"><span class="hs-identifier hs-var">ekgUrl</span></a></span></span><span> </span><span id="local-6989586621680280489"><span class="annot"><span class="annottext">LoggerName
</span><a href="#local-6989586621680280489"><span class="hs-identifier hs-var">prometheusUrl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[LoggerName] -&gt; LoggerName
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-352"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LoggerName
</span><span class="hs-string">&quot;Wallet url: &quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LoggerName
</span><a href="#local-6989586621680280491"><span class="hs-identifier hs-var">walletUrl</span></a></span><span>
</span><span id="line-353"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LoggerName
</span><span class="hs-string">&quot;, EKG url: &quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LoggerName
</span><a href="#local-6989586621680280490"><span class="hs-identifier hs-var">ekgUrl</span></a></span><span>
</span><span id="line-354"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LoggerName
</span><span class="hs-string">&quot;, Prometheus url:&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LoggerName
</span><a href="#local-6989586621680280489"><span class="hs-identifier hs-var">prometheusUrl</span></a></span><span>
</span><span id="line-355"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-356"></span><span>        </span><span class="annot"><span class="annottext">TestsLog
</span><a href="Plutus.PAB.LocalCluster.Run.html#MsgSettingUpFaucet"><span class="hs-identifier hs-var">MsgSettingUpFaucet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LoggerName
</span><span class="hs-string">&quot;Setting up faucet...&quot;</span></span><span>
</span><span id="line-357"></span><span>        </span><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#MsgCluster"><span class="hs-identifier hs-type">MsgCluster</span></a></span><span> </span><span id="local-6989586621680280488"><span class="annot"><span class="annottext">ClusterLog
</span><a href="#local-6989586621680280488"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ClusterLog -&gt; LoggerName
forall a. ToText a =&gt; a -&gt; LoggerName
</span><span class="hs-identifier hs-var">toText</span></span><span> </span><span class="annot"><span class="annottext">ClusterLog
</span><a href="#local-6989586621680280488"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680280486"><span class="annot"><span class="hs-identifier hs-type">HasPrivacyAnnotation</span></span><span> </span><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#TestsLog"><span class="hs-identifier hs-type">TestsLog</span></a></span></span><span>
</span><span id="line-360"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasSeverityAnnotation</span></span><span> </span><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#TestsLog"><span class="hs-identifier hs-type">TestsLog</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-361"></span><span>    </span><span id="local-6989586621680280482"><span class="annot"><span class="annottext">getSeverityAnnotation :: TestsLog -&gt; Severity
</span><a href="#local-6989586621680280482"><span class="hs-identifier hs-var hs-var hs-var hs-var">getSeverityAnnotation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-362"></span><span>        </span><span class="annot"><span class="annottext">TestsLog
</span><a href="Plutus.PAB.LocalCluster.Run.html#MsgSettingUpFaucet"><span class="hs-identifier hs-var">MsgSettingUpFaucet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Notice</span></span><span>
</span><span id="line-363"></span><span>        </span><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#MsgBaseUrl"><span class="hs-identifier hs-type">MsgBaseUrl</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Notice</span></span><span>
</span><span id="line-364"></span><span>        </span><span class="annot"><a href="Plutus.PAB.LocalCluster.Run.html#MsgCluster"><span class="hs-identifier hs-type">MsgCluster</span></a></span><span> </span><span id="local-6989586621680280481"><span class="annot"><span class="annottext">ClusterLog
</span><a href="#local-6989586621680280481"><span class="hs-identifier hs-var">msg</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ClusterLog -&gt; Severity
forall a. HasSeverityAnnotation a =&gt; a -&gt; Severity
</span><span class="hs-identifier hs-var">getSeverityAnnotation</span></span><span> </span><span class="annot"><span class="annottext">ClusterLog
</span><a href="#local-6989586621680280481"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span></pre></body></html>