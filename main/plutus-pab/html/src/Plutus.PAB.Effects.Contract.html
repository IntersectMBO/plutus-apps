<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds           #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies  #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts    #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE GADTs               #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE StrictData          #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications    #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies        #-}</span><span>
</span><span id="line-9"></span><span class="hs-comment">{-

Effects for running contract instances and for storing and loading their state.

-}</span><span>
</span><span id="line-14"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Plutus.PAB.Effects.Contract</span><span class="hs-special">(</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#PABContract"><span class="hs-identifier">PABContract</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#requests"><span class="hs-identifier">requests</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractEffect"><span class="hs-identifier">ContractEffect</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#initialState"><span class="hs-identifier">initialState</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#updateContract"><span class="hs-identifier">updateContract</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Storing and retrieving contract state</span></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier">ContractStore</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#putState"><span class="hs-identifier">putState</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#getState"><span class="hs-identifier">getState</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#getDefinition"><span class="hs-identifier">getDefinition</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#getActiveContracts"><span class="hs-identifier">getActiveContracts</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#getContracts"><span class="hs-identifier">getContracts</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#putStartInstance"><span class="hs-identifier">putStartInstance</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#putStopInstance"><span class="hs-identifier">putStopInstance</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#deleteState"><span class="hs-identifier">deleteState</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Storing and retrieving definitions of contracts</span></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDefinition"><span class="hs-identifier">ContractDefinition</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#addDefinition"><span class="hs-identifier">addDefinition</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#getDefinitions"><span class="hs-identifier">getDefinitions</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Freer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Eff</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Member</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">send</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Value</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Contract.Effects</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PABReq</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PABResp</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Contract.Resumable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Request</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Response</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Contract.State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ContractResponse</span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Contract.State</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html"><span class="hs-identifier">Plutus.PAB.Webserver.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractActivationArgs"><span class="hs-identifier">ContractActivationArgs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Wallet.Types</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ContractActivityStatus</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ContractInstanceId</span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-comment">-- | A class of contracts running in the PAB. The purpose of the type</span><span>
</span><span id="line-49"></span><span class="hs-comment">--   parameter @contract@ is to allow for different ways of running</span><span>
</span><span id="line-50"></span><span class="hs-comment">--   contracts, for example: A compiled executable running in a separate</span><span>
</span><span id="line-51"></span><span class="hs-comment">--   process, or an &quot;inline&quot; contract that was compiled with the PAB and</span><span>
</span><span id="line-52"></span><span class="hs-comment">--   runs in the same process.</span><span>
</span><span id="line-53"></span><span class="hs-comment">--</span><span>
</span><span id="line-54"></span><span class="hs-comment">--   The associated type families correspond to the type arguments needed</span><span>
</span><span id="line-55"></span><span class="hs-comment">--   for the 'ContractRequest' and 'ContractResponse' types from</span><span>
</span><span id="line-56"></span><span class="hs-comment">--   'Plutus.Contract.State'.</span><span>
</span><span id="line-57"></span><span class="hs-keyword">class</span><span> </span><span id="PABContract"><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#PABContract"><span class="hs-identifier hs-var">PABContract</span></a></span></span><span> </span><span id="local-6989586621680272636"><span class="annot"><a href="#local-6989586621680272636"><span class="hs-identifier hs-type">contract</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-comment">-- | Any data needed to identify the contract. For example, the location of the executable.</span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="ContractDef"><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-var">ContractDef</span></a></span></span><span> </span><span id="local-6989586621680272636"><span class="annot"><a href="#local-6989586621680272636"><span class="hs-identifier hs-type">contract</span></a></span></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-comment">-- | Contract state type</span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="State"><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#State"><span class="hs-identifier hs-var">State</span></a></span></span><span> </span><span id="local-6989586621680272636"><span class="annot"><a href="#local-6989586621680272636"><span class="hs-identifier hs-type">contract</span></a></span></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-comment">-- | Extract the serialisable state from the contract instance state.</span><span>
</span><span id="line-65"></span><span>    </span><span id="serialisableState"><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#serialisableState"><span class="hs-identifier hs-type">serialisableState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272636"><span class="hs-identifier hs-type">contract</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272636"><span class="hs-identifier hs-type">contract</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractResponse</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PABResp</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PABReq</span></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-comment">-- | The open requests of the contract instance.</span><span>
</span><span id="line-68"></span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#requests"><span class="hs-identifier hs-type">requests</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680272560"><span class="annot"><a href="#local-6989586621680272560"><span class="hs-identifier hs-type">contract</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#PABContract"><span class="hs-identifier hs-type">PABContract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272560"><span class="hs-identifier hs-type">contract</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272560"><span class="hs-identifier hs-type">contract</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Request</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PABReq</span></span><span class="hs-special">]</span><span>
</span><span id="line-69"></span><span id="requests"><span class="annot"><span class="annottext">requests :: State contract -&gt; [Request PABReq]
</span><a href="Plutus.PAB.Effects.Contract.html#requests"><span class="hs-identifier hs-var hs-var">requests</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractResponse Value Value PABResp PABReq -&gt; [Request PABReq]
forall w e s h. ContractResponse w e s h -&gt; [Request h]
</span><span class="hs-identifier hs-var hs-var">C.hooks</span></span><span> </span><span class="annot"><span class="annottext">(ContractResponse Value Value PABResp PABReq -&gt; [Request PABReq])
-&gt; (State contract -&gt; ContractResponse Value Value PABResp PABReq)
-&gt; State contract
-&gt; [Request PABReq]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy contract
-&gt; State contract -&gt; ContractResponse Value Value PABResp PABReq
forall contract.
PABContract contract =&gt;
Proxy contract
-&gt; State contract -&gt; ContractResponse Value Value PABResp PABReq
</span><a href="Plutus.PAB.Effects.Contract.html#serialisableState"><span class="hs-identifier hs-var">serialisableState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy contract
forall k (t :: k). Proxy t
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680272560"><span class="hs-identifier hs-type">contract</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">-- | An effect for sending updates to contracts that implement @PABContract@</span><span>
</span><span id="line-72"></span><span class="hs-keyword">data</span><span> </span><span id="ContractEffect"><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractEffect"><span class="hs-identifier hs-var">ContractEffect</span></a></span></span><span> </span><span id="local-6989586621680272556"><span class="annot"><a href="#local-6989586621680272556"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680272555"><span class="annot"><a href="#local-6989586621680272555"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-73"></span><span>    </span><span id="local-6989586621680272626"><span id="InitialState"><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#InitialState"><span class="hs-identifier hs-var">InitialState</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#PABContract"><span class="hs-identifier hs-type">PABContract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272626"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272626"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractEffect"><span class="hs-identifier hs-type">ContractEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272626"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272626"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ The initial state of the contract's instance</span></span><span>
</span><span id="line-74"></span><span>    </span><span id="local-6989586621680272618"><span id="UpdateContract"><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#UpdateContract"><span class="hs-identifier hs-var">UpdateContract</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#PABContract"><span class="hs-identifier hs-type">PABContract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272618"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272618"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272618"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Response</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PABResp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractEffect"><span class="hs-identifier hs-type">ContractEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272618"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272618"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Send an update to the contract and return the new state.</span></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- | Get the initial state of a contract</span><span>
</span><span id="line-77"></span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#initialState"><span class="hs-identifier hs-type">initialState</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680272552"><span class="annot"><a href="#local-6989586621680272552"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680272551"><span class="annot"><a href="#local-6989586621680272551"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractEffect"><span class="hs-identifier hs-type">ContractEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272552"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680272551"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#PABContract"><span class="hs-identifier hs-type">PABContract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272552"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceId</span></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272552"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680272551"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272552"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span id="initialState"><span class="annot"><span class="annottext">initialState :: ContractInstanceId -&gt; ContractDef t -&gt; Eff effs (State t)
</span><a href="Plutus.PAB.Effects.Contract.html#initialState"><span class="hs-identifier hs-var hs-var">initialState</span></a></span></span><span> </span><span id="local-6989586621680272550"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680272550"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680272549"><span class="annot"><span class="annottext">ContractDef t
</span><a href="#local-6989586621680272549"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680272548"><span class="annot"><span class="annottext">ContractEffect t (State t)
</span><a href="#local-6989586621680272548"><span class="hs-identifier hs-var">command</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractEffect"><span class="hs-identifier hs-type">ContractEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272552"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272552"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; ContractDef t -&gt; ContractEffect t (State t)
forall t.
PABContract t =&gt;
ContractInstanceId -&gt; ContractDef t -&gt; ContractEffect t (State t)
</span><a href="Plutus.PAB.Effects.Contract.html#InitialState"><span class="hs-identifier hs-var">InitialState</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680272550"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">ContractDef t
</span><a href="#local-6989586621680272549"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ContractEffect t (State t) -&gt; Eff effs (State t)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]) a.
Member eff effs =&gt;
eff a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">send</span></span><span> </span><span class="annot"><span class="annottext">ContractEffect t (State t)
</span><a href="#local-6989586621680272548"><span class="hs-identifier hs-var">command</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">-- | Send an update to the contract and return the new state.</span><span>
</span><span id="line-90"></span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#updateContract"><span class="hs-identifier hs-type">updateContract</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680272547"><span class="annot"><a href="#local-6989586621680272547"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680272546"><span class="annot"><a href="#local-6989586621680272546"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractEffect"><span class="hs-identifier hs-type">ContractEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272547"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680272546"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#PABContract"><span class="hs-identifier hs-type">PABContract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272547"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceId</span></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272547"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272547"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Response</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PABResp</span></span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680272546"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272547"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span id="updateContract"><span class="annot"><span class="annottext">updateContract :: ContractInstanceId
-&gt; ContractDef t
-&gt; State t
-&gt; Response PABResp
-&gt; Eff effs (State t)
</span><a href="Plutus.PAB.Effects.Contract.html#updateContract"><span class="hs-identifier hs-var hs-var">updateContract</span></a></span></span><span> </span><span id="local-6989586621680272545"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680272545"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680272544"><span class="annot"><span class="annottext">ContractDef t
</span><a href="#local-6989586621680272544"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span id="local-6989586621680272543"><span class="annot"><span class="annottext">State t
</span><a href="#local-6989586621680272543"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span id="local-6989586621680272542"><span class="annot"><span class="annottext">Response PABResp
</span><a href="#local-6989586621680272542"><span class="hs-identifier hs-var">request</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680272541"><span class="annot"><span class="annottext">ContractEffect t (State t)
</span><a href="#local-6989586621680272541"><span class="hs-identifier hs-var">command</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractEffect"><span class="hs-identifier hs-type">ContractEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272547"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272547"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
-&gt; ContractDef t
-&gt; State t
-&gt; Response PABResp
-&gt; ContractEffect t (State t)
forall t.
PABContract t =&gt;
ContractInstanceId
-&gt; ContractDef t
-&gt; State t
-&gt; Response PABResp
-&gt; ContractEffect t (State t)
</span><a href="Plutus.PAB.Effects.Contract.html#UpdateContract"><span class="hs-identifier hs-var">UpdateContract</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680272545"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">ContractDef t
</span><a href="#local-6989586621680272544"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">State t
</span><a href="#local-6989586621680272543"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="annot"><span class="annottext">Response PABResp
</span><a href="#local-6989586621680272542"><span class="hs-identifier hs-var">request</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ContractEffect t (State t) -&gt; Eff effs (State t)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]) a.
Member eff effs =&gt;
eff a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">send</span></span><span> </span><span class="annot"><span class="annottext">ContractEffect t (State t)
</span><a href="#local-6989586621680272541"><span class="hs-identifier hs-var">command</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">-- | Storing and retrieving the state of a contract instance</span><span>
</span><span id="line-105"></span><span class="hs-keyword">data</span><span> </span><span id="ContractStore"><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier hs-var">ContractStore</span></a></span></span><span> </span><span id="local-6989586621680272540"><span class="annot"><a href="#local-6989586621680272540"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680272539"><span class="annot"><a href="#local-6989586621680272539"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-106"></span><span>    </span><span id="local-6989586621680272613"><span id="PutStartInstance"><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#PutStartInstance"><span class="hs-identifier hs-var">PutStartInstance</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractActivationArgs"><span class="hs-identifier hs-type">ContractActivationArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272613"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier hs-type">ContractStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272613"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Record the starting of a new contract instance</span></span><span>
</span><span id="line-107"></span><span>    </span><span id="local-6989586621680272607"><span id="PutState"><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#PutState"><span class="hs-identifier hs-var">PutState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractActivationArgs"><span class="hs-identifier hs-type">ContractActivationArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272607"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272607"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier hs-type">ContractStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272607"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Record the updated state of the contract instance</span></span><span>
</span><span id="line-108"></span><span>    </span><span id="local-6989586621680272604"><span id="GetState"><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#GetState"><span class="hs-identifier hs-var">GetState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier hs-type">ContractStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272604"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272604"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Retrieve the last recorded state of the contract instance</span></span><span>
</span><span id="line-109"></span><span>    </span><span id="local-6989586621680272610"><span id="PutStopInstance"><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#PutStopInstance"><span class="hs-identifier hs-var">PutStopInstance</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier hs-type">ContractStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272610"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Record the fact that a contract instance has stopped</span></span><span>
</span><span id="line-110"></span><span>    </span><span id="local-6989586621680272594"><span id="GetContracts"><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#GetContracts"><span class="hs-identifier hs-var">GetContracts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractActivityStatus</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier hs-type">ContractStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272594"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceId</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractActivationArgs"><span class="hs-identifier hs-type">ContractActivationArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272594"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Get contracts with their activation args by status (all by default)</span></span><span>
</span><span id="line-111"></span><span>    </span><span id="local-6989586621680272533"><span id="DeleteState"><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#DeleteState"><span class="hs-identifier hs-var">DeleteState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier hs-type">ContractStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272533"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Delete the state of a contract instance</span></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#putStartInstance"><span class="hs-identifier hs-type">putStartInstance</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680272531"><span class="annot"><a href="#local-6989586621680272531"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680272530"><span class="annot"><a href="#local-6989586621680272530"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier hs-type">ContractStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272531"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680272530"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractActivationArgs"><span class="hs-identifier hs-type">ContractActivationArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272531"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceId</span></span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680272530"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span id="putStartInstance"><span class="annot"><span class="annottext">putStartInstance :: ContractActivationArgs (ContractDef t)
-&gt; ContractInstanceId -&gt; Eff effs ()
</span><a href="Plutus.PAB.Effects.Contract.html#putStartInstance"><span class="hs-identifier hs-var hs-var">putStartInstance</span></a></span></span><span> </span><span id="local-6989586621680272529"><span class="annot"><span class="annottext">ContractActivationArgs (ContractDef t)
</span><a href="#local-6989586621680272529"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span id="local-6989586621680272528"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680272528"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680272527"><span class="annot"><span class="annottext">ContractStore t ()
</span><a href="#local-6989586621680272527"><span class="hs-identifier hs-var">command</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier hs-type">ContractStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272531"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractActivationArgs (ContractDef t)
-&gt; ContractInstanceId -&gt; ContractStore t ()
forall t.
ContractActivationArgs (ContractDef t)
-&gt; ContractInstanceId -&gt; ContractStore t ()
</span><a href="Plutus.PAB.Effects.Contract.html#PutStartInstance"><span class="hs-identifier hs-var">PutStartInstance</span></a></span><span> </span><span class="annot"><span class="annottext">ContractActivationArgs (ContractDef t)
</span><a href="#local-6989586621680272529"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680272528"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ContractStore t () -&gt; Eff effs ()
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]) a.
Member eff effs =&gt;
eff a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">send</span></span><span> </span><span class="annot"><span class="annottext">ContractStore t ()
</span><a href="#local-6989586621680272527"><span class="hs-identifier hs-var">command</span></a></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#putStopInstance"><span class="hs-identifier hs-type">putStopInstance</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680272526"><span class="annot"><a href="#local-6989586621680272526"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680272525"><span class="annot"><a href="#local-6989586621680272525"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier hs-type">ContractStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272526"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680272525"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceId</span></span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680272525"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span id="putStopInstance"><span class="annot"><span class="annottext">putStopInstance :: ContractInstanceId -&gt; Eff effs ()
</span><a href="Plutus.PAB.Effects.Contract.html#putStopInstance"><span class="hs-identifier hs-var hs-var">putStopInstance</span></a></span></span><span> </span><span id="local-6989586621680272524"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680272524"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680272523"><span class="annot"><span class="annottext">ContractStore t ()
</span><a href="#local-6989586621680272523"><span class="hs-identifier hs-var">command</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier hs-type">ContractStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272526"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; ContractStore t ()
forall t. ContractInstanceId -&gt; ContractStore t ()
</span><a href="Plutus.PAB.Effects.Contract.html#PutStopInstance"><span class="hs-identifier hs-var">PutStopInstance</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680272524"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ContractStore t () -&gt; Eff effs ()
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]) a.
Member eff effs =&gt;
eff a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">send</span></span><span> </span><span class="annot"><span class="annottext">ContractStore t ()
</span><a href="#local-6989586621680272523"><span class="hs-identifier hs-var">command</span></a></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-comment">-- | Store the state of the contract instance</span><span>
</span><span id="line-135"></span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#putState"><span class="hs-identifier hs-type">putState</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680272522"><span class="annot"><a href="#local-6989586621680272522"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680272521"><span class="annot"><a href="#local-6989586621680272521"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier hs-type">ContractStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272522"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680272521"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractActivationArgs"><span class="hs-identifier hs-type">ContractActivationArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272522"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceId</span></span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272522"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680272521"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span id="putState"><span class="annot"><span class="annottext">putState :: ContractActivationArgs (ContractDef t)
-&gt; ContractInstanceId -&gt; State t -&gt; Eff effs ()
</span><a href="Plutus.PAB.Effects.Contract.html#putState"><span class="hs-identifier hs-var hs-var">putState</span></a></span></span><span> </span><span id="local-6989586621680272520"><span class="annot"><span class="annottext">ContractActivationArgs (ContractDef t)
</span><a href="#local-6989586621680272520"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span id="local-6989586621680272519"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680272519"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680272518"><span class="annot"><span class="annottext">State t
</span><a href="#local-6989586621680272518"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680272517"><span class="annot"><span class="annottext">ContractStore t ()
</span><a href="#local-6989586621680272517"><span class="hs-identifier hs-var">command</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier hs-type">ContractStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272522"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractActivationArgs (ContractDef t)
-&gt; ContractInstanceId -&gt; State t -&gt; ContractStore t ()
forall t.
ContractActivationArgs (ContractDef t)
-&gt; ContractInstanceId -&gt; State t -&gt; ContractStore t ()
</span><a href="Plutus.PAB.Effects.Contract.html#PutState"><span class="hs-identifier hs-var">PutState</span></a></span><span> </span><span class="annot"><span class="annottext">ContractActivationArgs (ContractDef t)
</span><a href="#local-6989586621680272520"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680272519"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">State t
</span><a href="#local-6989586621680272518"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ContractStore t () -&gt; Eff effs ()
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]) a.
Member eff effs =&gt;
eff a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">send</span></span><span> </span><span class="annot"><span class="annottext">ContractStore t ()
</span><a href="#local-6989586621680272517"><span class="hs-identifier hs-var">command</span></a></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="hs-comment">-- | Load the state of the contract instance</span><span>
</span><span id="line-148"></span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#getState"><span class="hs-identifier hs-type">getState</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680272516"><span class="annot"><a href="#local-6989586621680272516"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680272515"><span class="annot"><a href="#local-6989586621680272515"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier hs-type">ContractStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272516"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680272515"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceId</span></span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680272515"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272516"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span id="getState"><span class="annot"><span class="annottext">getState :: ContractInstanceId -&gt; Eff effs (State t)
</span><a href="Plutus.PAB.Effects.Contract.html#getState"><span class="hs-identifier hs-var hs-var">getState</span></a></span></span><span> </span><span id="local-6989586621680272514"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680272514"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680272513"><span class="annot"><span class="annottext">ContractStore t (State t)
</span><a href="#local-6989586621680272513"><span class="hs-identifier hs-var">command</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier hs-type">ContractStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272516"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272516"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; ContractStore t (State t)
forall t. ContractInstanceId -&gt; ContractStore t (State t)
</span><a href="Plutus.PAB.Effects.Contract.html#GetState"><span class="hs-identifier hs-var">GetState</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680272514"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ContractStore t (State t) -&gt; Eff effs (State t)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]) a.
Member eff effs =&gt;
eff a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">send</span></span><span> </span><span class="annot"><span class="annottext">ContractStore t (State t)
</span><a href="#local-6989586621680272513"><span class="hs-identifier hs-var">command</span></a></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-comment">-- | All active contracts with their definitions</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- WARNING : definition is misleading as this function is retrieving all instances (i.e., not only active ones),</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- especially when the in memory database setting is used</span><span>
</span><span id="line-161"></span><span class="hs-comment">-- Indeed, handler defined in ContractStore ignores the status parameter given in GetContracts.</span><span>
</span><span id="line-162"></span><span class="hs-comment">-- Note also that a contract instance added in the db has active status set to True.</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- This status is set to False only when the contract is explicitly stopped.</span><span>
</span><span id="line-164"></span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#getActiveContracts"><span class="hs-identifier hs-type">getActiveContracts</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680272583"><span class="annot"><a href="#local-6989586621680272583"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680272584"><span class="annot"><a href="#local-6989586621680272584"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier hs-type">ContractStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272583"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680272584"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680272584"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceId</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractActivationArgs"><span class="hs-identifier hs-type">ContractActivationArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272583"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span id="getActiveContracts"><span class="annot"><span class="annottext">getActiveContracts :: Eff
  effs
  (Map ContractInstanceId (ContractActivationArgs (ContractDef t)))
</span><a href="Plutus.PAB.Effects.Contract.html#getActiveContracts"><span class="hs-identifier hs-var hs-var">getActiveContracts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ContractActivityStatus
-&gt; Eff
     effs
     (Map ContractInstanceId (ContractActivationArgs (ContractDef t)))
forall t (effs :: [* -&gt; *]).
Member (ContractStore t) effs =&gt;
Maybe ContractActivityStatus
-&gt; Eff
     effs
     (Map ContractInstanceId (ContractActivationArgs (ContractDef t)))
</span><a href="Plutus.PAB.Effects.Contract.html#getContracts"><span class="hs-identifier hs-var">getContracts</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680272583"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContractActivityStatus -&gt; Maybe ContractActivityStatus
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ContractActivityStatus
</span><span class="hs-identifier hs-var">Active</span></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-comment">-- | All contracts with their definitions by given status (all by default)</span><span>
</span><span id="line-172"></span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#getContracts"><span class="hs-identifier hs-type">getContracts</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680272599"><span class="annot"><a href="#local-6989586621680272599"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680272598"><span class="annot"><a href="#local-6989586621680272598"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier hs-type">ContractStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272599"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680272598"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractActivityStatus</span></span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680272598"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceId</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractActivationArgs"><span class="hs-identifier hs-type">ContractActivationArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272599"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span id="getContracts"><span class="annot"><span class="annottext">getContracts :: Maybe ContractActivityStatus
-&gt; Eff
     effs
     (Map ContractInstanceId (ContractActivationArgs (ContractDef t)))
</span><a href="Plutus.PAB.Effects.Contract.html#getContracts"><span class="hs-identifier hs-var hs-var">getContracts</span></a></span></span><span> </span><span id="local-6989586621680272511"><span class="annot"><span class="annottext">Maybe ContractActivityStatus
</span><a href="#local-6989586621680272511"><span class="hs-identifier hs-var">mStatus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680272510"><span class="annot"><span class="annottext">ContractStore
  t (Map ContractInstanceId (ContractActivationArgs (ContractDef t)))
</span><a href="#local-6989586621680272510"><span class="hs-identifier hs-var">command</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier hs-type">ContractStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272599"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceId</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractActivationArgs"><span class="hs-identifier hs-type">ContractActivationArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272599"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ContractActivityStatus
-&gt; ContractStore
     t (Map ContractInstanceId (ContractActivationArgs (ContractDef t)))
forall t.
Maybe ContractActivityStatus
-&gt; ContractStore
     t (Map ContractInstanceId (ContractActivationArgs (ContractDef t)))
</span><a href="Plutus.PAB.Effects.Contract.html#GetContracts"><span class="hs-identifier hs-var">GetContracts</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ContractActivityStatus
</span><a href="#local-6989586621680272511"><span class="hs-identifier hs-var">mStatus</span></a></span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ContractStore
  t (Map ContractInstanceId (ContractActivationArgs (ContractDef t)))
-&gt; Eff
     effs
     (Map ContractInstanceId (ContractActivationArgs (ContractDef t)))
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]) a.
Member eff effs =&gt;
eff a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">send</span></span><span> </span><span class="annot"><span class="annottext">ContractStore
  t (Map ContractInstanceId (ContractActivationArgs (ContractDef t)))
</span><a href="#local-6989586621680272510"><span class="hs-identifier hs-var">command</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#deleteState"><span class="hs-identifier hs-type">deleteState</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680272509"><span class="annot"><a href="#local-6989586621680272509"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680272508"><span class="annot"><a href="#local-6989586621680272508"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier hs-type">ContractStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272509"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680272508"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceId</span></span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680272508"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span id="deleteState"><span class="annot"><span class="annottext">deleteState :: ContractInstanceId -&gt; Eff effs ()
</span><a href="Plutus.PAB.Effects.Contract.html#deleteState"><span class="hs-identifier hs-var hs-var">deleteState</span></a></span></span><span> </span><span id="local-6989586621680272507"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680272507"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680272506"><span class="annot"><span class="annottext">ContractStore t ()
</span><a href="#local-6989586621680272506"><span class="hs-identifier hs-var">command</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier hs-type">ContractStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272509"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; ContractStore t ()
forall t. ContractInstanceId -&gt; ContractStore t ()
</span><a href="Plutus.PAB.Effects.Contract.html#DeleteState"><span class="hs-identifier hs-var">DeleteState</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680272507"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ContractStore t () -&gt; Eff effs ()
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]) a.
Member eff effs =&gt;
eff a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">send</span></span><span> </span><span class="annot"><span class="annottext">ContractStore t ()
</span><a href="#local-6989586621680272506"><span class="hs-identifier hs-var">command</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-comment">-- | Get the definition of a running contract</span><span>
</span><span id="line-193"></span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#getDefinition"><span class="hs-identifier hs-type">getDefinition</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680272505"><span class="annot"><a href="#local-6989586621680272505"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680272504"><span class="annot"><a href="#local-6989586621680272504"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier hs-type">ContractStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272505"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680272504"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceId</span></span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680272504"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractActivationArgs"><span class="hs-identifier hs-type">ContractActivationArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272505"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span id="getDefinition"><span class="annot"><span class="annottext">getDefinition :: ContractInstanceId
-&gt; Eff effs (Maybe (ContractActivationArgs (ContractDef t)))
</span><a href="Plutus.PAB.Effects.Contract.html#getDefinition"><span class="hs-identifier hs-var hs-var">getDefinition</span></a></span></span><span> </span><span id="local-6989586621680272503"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680272503"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
-&gt; Map ContractInstanceId (ContractActivationArgs (ContractDef t))
-&gt; Maybe (ContractActivationArgs (ContractDef t))
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680272503"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">(Map ContractInstanceId (ContractActivationArgs (ContractDef t))
 -&gt; Maybe (ContractActivationArgs (ContractDef t)))
-&gt; Eff
     effs
     (Map ContractInstanceId (ContractActivationArgs (ContractDef t)))
-&gt; Eff effs (Maybe (ContractActivationArgs (ContractDef t)))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (ContractStore t) effs =&gt;
Eff
  effs
  (Map ContractInstanceId (ContractActivationArgs (ContractDef t)))
forall t (effs :: [* -&gt; *]).
Member (ContractStore t) effs =&gt;
Eff
  effs
  (Map ContractInstanceId (ContractActivationArgs (ContractDef t)))
</span><a href="Plutus.PAB.Effects.Contract.html#getActiveContracts"><span class="hs-identifier hs-var">getActiveContracts</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680272505"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="hs-comment">-- | Storing and retrieving definitions of contracts.</span><span>
</span><span id="line-201"></span><span class="hs-comment">--   (Not all 't's support this)</span><span>
</span><span id="line-202"></span><span class="hs-keyword">data</span><span> </span><span id="ContractDefinition"><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDefinition"><span class="hs-identifier hs-var">ContractDefinition</span></a></span></span><span> </span><span id="local-6989586621680272500"><span class="annot"><a href="#local-6989586621680272500"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680272499"><span class="annot"><a href="#local-6989586621680272499"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-203"></span><span>    </span><span id="local-6989586621680272579"><span id="AddDefinition"><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#AddDefinition"><span class="hs-identifier hs-var">AddDefinition</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272579"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDefinition"><span class="hs-identifier hs-type">ContractDefinition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272579"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-204"></span><span>    </span><span id="local-6989586621680272576"><span id="GetDefinitions"><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#GetDefinitions"><span class="hs-identifier hs-var">GetDefinitions</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDefinition"><span class="hs-identifier hs-type">ContractDefinition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272576"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272576"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#addDefinition"><span class="hs-identifier hs-type">addDefinition</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680272496"><span class="annot"><a href="#local-6989586621680272496"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680272495"><span class="annot"><a href="#local-6989586621680272495"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDefinition"><span class="hs-identifier hs-type">ContractDefinition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272496"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680272495"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272496"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680272495"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span id="addDefinition"><span class="annot"><span class="annottext">addDefinition :: ContractDef t -&gt; Eff effs ()
</span><a href="Plutus.PAB.Effects.Contract.html#addDefinition"><span class="hs-identifier hs-var hs-var">addDefinition</span></a></span></span><span> </span><span id="local-6989586621680272494"><span class="annot"><span class="annottext">ContractDef t
</span><a href="#local-6989586621680272494"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621680272493"><span class="hs-identifier hs-type">command</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDefinition"><span class="hs-identifier hs-type">ContractDefinition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272496"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>        </span><span id="local-6989586621680272493"><span class="annot"><span class="annottext">command :: ContractDefinition t ()
</span><a href="#local-6989586621680272493"><span class="hs-identifier hs-var hs-var">command</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractDef t -&gt; ContractDefinition t ()
forall t. ContractDef t -&gt; ContractDefinition t ()
</span><a href="Plutus.PAB.Effects.Contract.html#AddDefinition"><span class="hs-identifier hs-var">AddDefinition</span></a></span><span> </span><span class="annot"><span class="annottext">ContractDef t
</span><a href="#local-6989586621680272494"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ContractDefinition t () -&gt; Eff effs ()
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]) a.
Member eff effs =&gt;
eff a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">send</span></span><span> </span><span class="annot"><span class="annottext">ContractDefinition t ()
</span><a href="#local-6989586621680272493"><span class="hs-identifier hs-var">command</span></a></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#getDefinitions"><span class="hs-identifier hs-type">getDefinitions</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680272492"><span class="annot"><a href="#local-6989586621680272492"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680272491"><span class="annot"><a href="#local-6989586621680272491"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDefinition"><span class="hs-identifier hs-type">ContractDefinition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272492"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680272491"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680272491"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272492"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-222"></span><span id="getDefinitions"><span class="annot"><span class="annottext">getDefinitions :: Eff effs [ContractDef t]
</span><a href="Plutus.PAB.Effects.Contract.html#getDefinitions"><span class="hs-identifier hs-var hs-var">getDefinitions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractDefinition t [ContractDef t] -&gt; Eff effs [ContractDef t]
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]) a.
Member eff effs =&gt;
eff a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">send</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDefinition"><span class="hs-identifier hs-type">ContractDefinition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680272492"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ContractDefinition t [ContractDef t]
forall t. ContractDefinition t [ContractDef t]
</span><a href="Plutus.PAB.Effects.Contract.html#GetDefinitions"><span class="hs-identifier hs-var">GetDefinitions</span></a></span><span>
</span><span id="line-223"></span></pre></body></html>