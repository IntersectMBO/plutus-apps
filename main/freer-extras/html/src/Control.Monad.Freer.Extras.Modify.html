<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes   #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds             #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts      #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances     #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE GADTs                 #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase            #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE Rank2Types            #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables   #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications      #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies          #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators         #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances  #-}</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control.Monad.Freer.Extras.Modify</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><span class="hs-comment">-- * change the list of effects</span></span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#mapEffs"><span class="hs-identifier">mapEffs</span></a></span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><span class="hs-comment">-- * under functions</span></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#UnderN"><span class="hs-identifier">UnderN</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#under"><span class="hs-identifier">under</span></a></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><span class="hs-comment">-- * weaken functions</span></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#CanWeakenEnd"><span class="hs-identifier">CanWeakenEnd</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#weakenUnder"><span class="hs-identifier">weakenUnder</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#weakenNUnder"><span class="hs-identifier">weakenNUnder</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#weakenMUnderN"><span class="hs-identifier">weakenMUnderN</span></a></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><span class="hs-comment">-- * raise functions</span></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#raiseEnd"><span class="hs-identifier">raiseEnd</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#raiseUnder"><span class="hs-identifier">raiseUnder</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#raiseUnder2"><span class="hs-identifier">raiseUnder2</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#raise2Under"><span class="hs-identifier">raise2Under</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#raiseNUnder"><span class="hs-identifier">raiseNUnder</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#raiseMUnderN"><span class="hs-identifier">raiseMUnderN</span></a></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><span class="hs-comment">-- * zoom functions</span></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#handleZoomedState"><span class="hs-identifier">handleZoomedState</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#handleZoomedError"><span class="hs-identifier">handleZoomedError</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#handleZoomedWriter"><span class="hs-identifier">handleZoomedWriter</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#handleZoomedReader"><span class="hs-identifier">handleZoomedReader</span></a></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><span class="hs-comment">-- * manipulation</span></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#writeIntoState"><span class="hs-identifier">writeIntoState</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#stateToMonadState"><span class="hs-identifier">stateToMonadState</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#monadStateToState"><span class="hs-identifier">monadStateToState</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#errorToMonadError"><span class="hs-identifier">errorToMonadError</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#wrapError"><span class="hs-identifier">wrapError</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">under</span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MTL</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Freer</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Freer.Error</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Freer.Internal</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Freer.Reader</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Freer.State</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Freer.Writer</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MTL</span></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span id="local-6989586621679216783"><span id="local-6989586621679216784"><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#mapEffs"><span class="hs-identifier hs-type">mapEffs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Union</span></span><span> </span><span class="annot"><a href="#local-6989586621679216784"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Union</span></span><span> </span><span class="annot"><a href="#local-6989586621679216783"><span class="hs-identifier hs-type">effs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621679216784"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621679216783"><span class="hs-identifier hs-type">effs'</span></a></span></span></span><span>
</span><span id="line-62"></span><span id="mapEffs"><span class="annot"><span class="annottext">mapEffs :: (Union effs ~&gt; Union effs') -&gt; Eff effs ~&gt; Eff effs'
</span><a href="Control.Monad.Freer.Extras.Modify.html#mapEffs"><span class="hs-identifier hs-var hs-var">mapEffs</span></a></span></span><span> </span><span id="local-6989586621679216628"><span class="annot"><span class="annottext">Union effs ~&gt; Union effs'
</span><a href="#local-6989586621679216628"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Eff effs x -&gt; Eff effs' x
</span><a href="#local-6989586621679216627"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-63"></span><span>    </span><span id="local-6989586621679216627"><span class="annot"><span class="annottext">loop :: Eff effs x -&gt; Eff effs' x
</span><a href="#local-6989586621679216627"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-64"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Val</span></span><span> </span><span id="local-6989586621679216625"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679216625"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">x -&gt; Eff effs' x
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679216625"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-65"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">E</span></span><span> </span><span id="local-6989586621679216623"><span class="annot"><span class="annottext">Union effs b
</span><a href="#local-6989586621679216623"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679216622"><span class="annot"><span class="annottext">Arrs effs b x
</span><a href="#local-6989586621679216622"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Union effs' b -&gt; Arrs effs' b x -&gt; Eff effs' x
forall (effs :: [* -&gt; *]) a b.
Union effs b -&gt; Arrs effs b a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">E</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Union effs b -&gt; Union effs' b
Union effs ~&gt; Union effs'
</span><a href="#local-6989586621679216628"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Union effs b
</span><a href="#local-6989586621679216623"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; Eff effs' x) -&gt; Arrs effs' b x
forall a (m :: * -&gt; *) b. (a -&gt; m b) -&gt; FTCQueue m a b
</span><span class="hs-identifier hs-var">tsingleton</span></span><span> </span><span class="annot"><span class="annottext">((b -&gt; Eff effs' x) -&gt; Arrs effs' b x)
-&gt; (b -&gt; Eff effs' x) -&gt; Arrs effs' b x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Arrs effs b x -&gt; (Eff effs x -&gt; Eff effs' x) -&gt; b -&gt; Eff effs' x
forall (effs :: [* -&gt; *]) a b (effs' :: [* -&gt; *]) c.
Arrs effs a b -&gt; (Eff effs b -&gt; Eff effs' c) -&gt; Arr effs' a c
</span><span class="hs-identifier hs-var">qComp</span></span><span> </span><span class="annot"><span class="annottext">Arrs effs b x
</span><a href="#local-6989586621679216622"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Eff effs x -&gt; Eff effs' x
</span><a href="#local-6989586621679216627"><span class="hs-identifier hs-var">loop</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span id="local-6989586621679216823"><span id="local-6989586621679216824"><span id="local-6989586621679216825"><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#under"><span class="hs-identifier hs-type">under</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Union</span></span><span> </span><span class="annot"><a href="#local-6989586621679216825"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Union</span></span><span> </span><span class="annot"><a href="#local-6989586621679216824"><span class="hs-identifier hs-type">effs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Union</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216823"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679216825"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Union</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216823"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679216824"><span class="hs-identifier hs-type">effs'</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-69"></span><span id="under"><span class="annot"><span class="annottext">under :: (Union effs ~&gt; Union effs')
-&gt; Union (a : effs) ~&gt; Union (a : effs')
</span><a href="Control.Monad.Freer.Extras.Modify.html#under"><span class="hs-identifier hs-var hs-var">under</span></a></span></span><span> </span><span id="local-6989586621679216619"><span class="annot"><span class="annottext">Union effs ~&gt; Union effs'
</span><a href="#local-6989586621679216619"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679216618"><span class="annot"><span class="annottext">Union (a : effs) x
</span><a href="#local-6989586621679216618"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Union (a : effs) x -&gt; Either (Union effs x) (a x)
forall (t :: * -&gt; *) (r :: [* -&gt; *]) a.
Union (t : r) a -&gt; Either (Union r a) (t a)
</span><span class="hs-identifier hs-var">decomp</span></span><span> </span><span class="annot"><span class="annottext">Union (a : effs) x
</span><a href="#local-6989586621679216618"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679216616"><span class="annot"><span class="annottext">Union effs x
</span><a href="#local-6989586621679216616"><span class="hs-identifier hs-var">u'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Union effs' x -&gt; Union (a : effs') x
forall k (r :: [* -&gt; *]) (a :: k) (any :: * -&gt; *).
Union r a -&gt; Union (any : r) a
</span><span class="hs-identifier hs-var">weaken</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Union effs x -&gt; Union effs' x
Union effs ~&gt; Union effs'
</span><a href="#local-6989586621679216619"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Union effs x
</span><a href="#local-6989586621679216616"><span class="hs-identifier hs-var">u'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679216614"><span class="annot"><span class="annottext">a x
</span><a href="#local-6989586621679216614"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a x -&gt; Union (a : effs') x
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]) a.
Member eff effs =&gt;
eff a -&gt; Union effs a
</span><span class="hs-identifier hs-var">inj</span></span><span> </span><span class="annot"><span class="annottext">a x
</span><a href="#local-6989586621679216614"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-keyword">class</span><span> </span><span id="UnderN"><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#UnderN"><span class="hs-identifier hs-var">UnderN</span></a></span></span><span> </span><span id="local-6989586621679216834"><span class="annot"><a href="#local-6989586621679216834"><span class="hs-keyword hs-type">as</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-74"></span><span>    </span><span id="local-6989586621679216837"><span id="local-6989586621679216838"><span id="underN"><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#underN"><span class="hs-identifier hs-type">underN</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Union</span></span><span> </span><span class="annot"><a href="#local-6989586621679216838"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Union</span></span><span> </span><span class="annot"><a href="#local-6989586621679216837"><span class="hs-identifier hs-type">effs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Union</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216834"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:++:</span></span><span> </span><span class="annot"><a href="#local-6989586621679216838"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Union</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216834"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:++:</span></span><span> </span><span class="annot"><a href="#local-6989586621679216837"><span class="hs-identifier hs-type">effs'</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-75"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#UnderN"><span class="hs-identifier hs-type">UnderN</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-76"></span><span>    </span><span id="local-6989586621679216609"><span class="annot"><span class="annottext">underN :: (Union effs ~&gt; Union effs')
-&gt; Union ('[] :++: effs) ~&gt; Union ('[] :++: effs')
</span><a href="#local-6989586621679216609"><span class="hs-identifier hs-var hs-var hs-var hs-var">underN</span></a></span></span><span> </span><span id="local-6989586621679216608"><span class="annot"><span class="annottext">Union effs ~&gt; Union effs'
</span><a href="#local-6989586621679216608"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Union ('[] :++: effs) x -&gt; Union ('[] :++: effs') x
Union effs ~&gt; Union effs'
</span><a href="#local-6989586621679216608"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-77"></span><span id="local-6989586621679216606"><span id="local-6989586621679216607"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#UnderN"><span class="hs-identifier hs-type">UnderN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679216607"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#UnderN"><span class="hs-identifier hs-type">UnderN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216606"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679216607"><span class="hs-keyword hs-type">as</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-78"></span><span>    </span><span id="local-6989586621679216604"><span class="annot"><span class="annottext">underN :: (Union effs ~&gt; Union effs')
-&gt; Union ((a : as) :++: effs) ~&gt; Union ((a : as) :++: effs')
</span><a href="#local-6989586621679216604"><span class="hs-identifier hs-var hs-var hs-var hs-var">underN</span></a></span></span><span> </span><span id="local-6989586621679216603"><span class="annot"><span class="annottext">Union effs ~&gt; Union effs'
</span><a href="#local-6989586621679216603"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Union (as :++: effs) ~&gt; Union (as :++: effs'))
-&gt; Union (a : (as :++: effs)) ~&gt; Union (a : (as :++: effs'))
forall (effs :: [* -&gt; *]) (effs' :: [* -&gt; *]) (a :: * -&gt; *).
(Union effs ~&gt; Union effs')
-&gt; Union (a : effs) ~&gt; Union (a : effs')
</span><a href="Control.Monad.Freer.Extras.Modify.html#under"><span class="hs-identifier hs-var">under</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Union effs ~&gt; Union effs')
-&gt; Union (as :++: effs) ~&gt; Union (as :++: effs')
forall (as :: [* -&gt; *]) (effs :: [* -&gt; *]) (effs' :: [* -&gt; *]).
UnderN as =&gt;
(Union effs ~&gt; Union effs')
-&gt; Union (as :++: effs) ~&gt; Union (as :++: effs')
</span><a href="Control.Monad.Freer.Extras.Modify.html#underN"><span class="hs-identifier hs-var">underN</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679216607"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><span class="annottext">Union effs ~&gt; Union effs'
</span><a href="#local-6989586621679216603"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">{- Note [Various raising helpers]
These are all to help with the issue where you have something of type

Eff effs a

where effs is some *fixed* list of effects. You may then need to insert
more effects *under* effs to interpret them in terms of. It turns out that
inserting effects at the *end* of the list is tricky.

I have no idea what I'm doing, these are partially stolen from freer-simple/polysemy
with a lot of hacking around.

The first instance of CanWeakenEnd is for the case where the fixed list has length 1.
The second instance is for cases where the fixed list has a length of 2 or more,
hence the double cons in the types to prevent overlap with the first instance.
-}</span><span>
</span><span id="line-97"></span><span class="hs-keyword">class</span><span> </span><span id="CanWeakenEnd"><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#CanWeakenEnd"><span class="hs-identifier hs-var">CanWeakenEnd</span></a></span></span><span> </span><span id="local-6989586621679216818"><span class="annot"><a href="#local-6989586621679216818"><span class="hs-keyword hs-type">as</span></a></span></span><span> </span><span id="local-6989586621679216817"><span class="annot"><a href="#local-6989586621679216817"><span class="hs-identifier hs-type">effs</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-98"></span><span>    </span><span id="weakenEnd"><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#weakenEnd"><span class="hs-identifier hs-type">weakenEnd</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Union</span></span><span> </span><span class="annot"><a href="#local-6989586621679216818"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Union</span></span><span> </span><span class="annot"><a href="#local-6989586621679216817"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-99"></span><span id="local-6989586621679216599"><span id="local-6989586621679216600"><span id="local-6989586621679216601"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="#local-6989586621679216601"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216600"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679216599"><span class="hs-identifier hs-type">effs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#CanWeakenEnd"><span class="hs-identifier hs-type">CanWeakenEnd</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679216600"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679216601"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-100"></span><span>    </span><span id="local-6989586621679216596"><span class="annot"><span class="annottext">weakenEnd :: Union '[a] x -&gt; Union effs x
</span><a href="#local-6989586621679216596"><span class="hs-identifier hs-var hs-var hs-var hs-var">weakenEnd</span></a></span></span><span> </span><span id="local-6989586621679216595"><span class="annot"><span class="annottext">Union '[a] x
</span><a href="#local-6989586621679216595"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a x -&gt; Union effs x
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]) a.
Member eff effs =&gt;
eff a -&gt; Union effs a
</span><span class="hs-identifier hs-var">inj</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Union '[a] x -&gt; a x
forall (t :: * -&gt; *) a. Union '[t] a -&gt; t a
</span><span class="hs-identifier hs-var">extract</span></span><span> </span><span class="annot"><span class="annottext">Union '[a] x
</span><a href="#local-6989586621679216595"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-101"></span><span id="local-6989586621679216589"><span id="local-6989586621679216590"><span id="local-6989586621679216591"><span id="local-6989586621679216592"><span id="local-6989586621679216593"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216593"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216592"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679216591"><span class="hs-identifier hs-type">effs'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#CanWeakenEnd"><span class="hs-identifier hs-type">CanWeakenEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216590"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679216589"><span class="hs-keyword hs-type">as</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679216591"><span class="hs-identifier hs-type">effs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#CanWeakenEnd"><span class="hs-identifier hs-type">CanWeakenEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216592"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679216590"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679216589"><span class="hs-keyword hs-type">as</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679216593"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621679216587"><span class="annot"><span class="annottext">weakenEnd :: Union (a : b : as) x -&gt; Union effs x
</span><a href="#local-6989586621679216587"><span class="hs-identifier hs-var hs-var hs-var hs-var">weakenEnd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Union (b : as) ~&gt; Union effs')
-&gt; Union (a : b : as) ~&gt; Union (a : effs')
forall (effs :: [* -&gt; *]) (effs' :: [* -&gt; *]) (a :: * -&gt; *).
(Union effs ~&gt; Union effs')
-&gt; Union (a : effs) ~&gt; Union (a : effs')
</span><a href="Control.Monad.Freer.Extras.Modify.html#under"><span class="hs-identifier hs-var">under</span></a></span><span> </span><span class="annot"><span class="annottext">forall (as :: [* -&gt; *]) (effs :: [* -&gt; *]).
CanWeakenEnd as effs =&gt;
Union as ~&gt; Union effs
Union (b : as) ~&gt; Union effs'
</span><a href="Control.Monad.Freer.Extras.Modify.html#weakenEnd"><span class="hs-identifier hs-var">weakenEnd</span></a></span></span></span></span></span></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#weakenUnder"><span class="hs-identifier hs-type">weakenUnder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679216777"><span class="annot"><a href="#local-6989586621679216777"><span class="hs-identifier hs-type">effs</span></a></span></span><span> </span><span id="local-6989586621679216778"><span class="annot"><a href="#local-6989586621679216778"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679216776"><span class="annot"><a href="#local-6989586621679216776"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Union</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216778"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679216777"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Union</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216778"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679216776"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679216777"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span id="weakenUnder"><span class="annot"><span class="annottext">weakenUnder :: Union (a : effs) x -&gt; Union (a : b : effs) x
</span><a href="Control.Monad.Freer.Extras.Modify.html#weakenUnder"><span class="hs-identifier hs-var hs-var">weakenUnder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Union effs ~&gt; Union (b : effs))
-&gt; Union (a : effs) ~&gt; Union (a : b : effs)
forall (effs :: [* -&gt; *]) (effs' :: [* -&gt; *]) (a :: * -&gt; *).
(Union effs ~&gt; Union effs')
-&gt; Union (a : effs) ~&gt; Union (a : effs')
</span><a href="Control.Monad.Freer.Extras.Modify.html#under"><span class="hs-identifier hs-var">under</span></a></span><span> </span><span class="annot"><span class="annottext">Union effs ~&gt; Union (b : effs)
forall k (r :: [* -&gt; *]) (a :: k) (any :: * -&gt; *).
Union r a -&gt; Union (any : r) a
</span><span class="hs-identifier hs-var">weaken</span></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#weakenNUnder"><span class="hs-identifier hs-type">weakenNUnder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679216754"><span class="annot"><a href="#local-6989586621679216754"><span class="hs-identifier hs-type">effs'</span></a></span></span><span> </span><span id="local-6989586621679216752"><span class="annot"><a href="#local-6989586621679216752"><span class="hs-identifier hs-type">effs</span></a></span></span><span> </span><span id="local-6989586621679216753"><span class="annot"><a href="#local-6989586621679216753"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Weakens</span></span><span> </span><span class="annot"><a href="#local-6989586621679216754"><span class="hs-identifier hs-type">effs'</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Union</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216753"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679216752"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Union</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216753"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216754"><span class="hs-identifier hs-type">effs'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:++:</span></span><span> </span><span class="annot"><a href="#local-6989586621679216752"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span id="weakenNUnder"><span class="annot"><span class="annottext">weakenNUnder :: Union (a : effs) ~&gt; Union (a : (effs' :++: effs))
</span><a href="Control.Monad.Freer.Extras.Modify.html#weakenNUnder"><span class="hs-identifier hs-var hs-var">weakenNUnder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Union effs ~&gt; Union (effs' :++: effs))
-&gt; Union (a : effs) ~&gt; Union (a : (effs' :++: effs))
forall (effs :: [* -&gt; *]) (effs' :: [* -&gt; *]) (a :: * -&gt; *).
(Union effs ~&gt; Union effs')
-&gt; Union (a : effs) ~&gt; Union (a : effs')
</span><a href="Control.Monad.Freer.Extras.Modify.html#under"><span class="hs-identifier hs-var">under</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (q :: [* -&gt; *]) k (r :: [* -&gt; *]) (a :: k).
Weakens q =&gt;
Union r a -&gt; Union (q :++: r) a
Union effs ~&gt; Union (effs' :++: effs)
</span><span class="hs-identifier hs-var">weakens</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679216754"><span class="hs-identifier hs-type">effs'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679216752"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-comment">-- basically applies `under` n times to `weaken` composed m times, n = length as, m = length effs'</span><span>
</span><span id="line-111"></span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#weakenMUnderN"><span class="hs-identifier hs-type">weakenMUnderN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679216745"><span class="annot"><a href="#local-6989586621679216745"><span class="hs-identifier hs-type">effs'</span></a></span></span><span> </span><span id="local-6989586621679216746"><span class="annot"><a href="#local-6989586621679216746"><span class="hs-keyword hs-type">as</span></a></span></span><span> </span><span id="local-6989586621679216744"><span class="annot"><a href="#local-6989586621679216744"><span class="hs-identifier hs-type">effs</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#UnderN"><span class="hs-identifier hs-type">UnderN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679216746"><span class="hs-keyword hs-type">as</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Weakens</span></span><span> </span><span class="annot"><a href="#local-6989586621679216745"><span class="hs-identifier hs-type">effs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Union</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216746"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:++:</span></span><span> </span><span class="annot"><a href="#local-6989586621679216744"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Union</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216746"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:++:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216745"><span class="hs-identifier hs-type">effs'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:++:</span></span><span> </span><span class="annot"><a href="#local-6989586621679216744"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span id="weakenMUnderN"><span class="annot"><span class="annottext">weakenMUnderN :: Union (as :++: effs) ~&gt; Union (as :++: (effs' :++: effs))
</span><a href="Control.Monad.Freer.Extras.Modify.html#weakenMUnderN"><span class="hs-identifier hs-var hs-var">weakenMUnderN</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Union effs ~&gt; Union (effs' :++: effs))
-&gt; Union (as :++: effs) ~&gt; Union (as :++: (effs' :++: effs))
forall (as :: [* -&gt; *]) (effs :: [* -&gt; *]) (effs' :: [* -&gt; *]).
UnderN as =&gt;
(Union effs ~&gt; Union effs')
-&gt; Union (as :++: effs) ~&gt; Union (as :++: effs')
</span><a href="Control.Monad.Freer.Extras.Modify.html#underN"><span class="hs-identifier hs-var">underN</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679216746"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (q :: [* -&gt; *]) k (r :: [* -&gt; *]) (a :: k).
Weakens q =&gt;
Union r a -&gt; Union (q :++: r) a
Union effs ~&gt; Union (effs' :++: effs)
</span><span class="hs-identifier hs-var">weakens</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679216745"><span class="hs-identifier hs-type">effs'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679216744"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#raiseEnd"><span class="hs-identifier hs-type">raiseEnd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679216585"><span class="annot"><a href="#local-6989586621679216585"><span class="hs-identifier hs-type">effs</span></a></span></span><span> </span><span id="local-6989586621679216584"><span class="annot"><a href="#local-6989586621679216584"><span class="hs-keyword hs-type">as</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#CanWeakenEnd"><span class="hs-identifier hs-type">CanWeakenEnd</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679216584"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679216585"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621679216584"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621679216585"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-116"></span><span id="raiseEnd"><span class="annot"><span class="annottext">raiseEnd :: Eff as ~&gt; Eff effs
</span><a href="Control.Monad.Freer.Extras.Modify.html#raiseEnd"><span class="hs-identifier hs-var hs-var">raiseEnd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Union as ~&gt; Union effs) -&gt; Eff as ~&gt; Eff effs
forall (effs :: [* -&gt; *]) (effs' :: [* -&gt; *]).
(Union effs ~&gt; Union effs') -&gt; Eff effs ~&gt; Eff effs'
</span><a href="Control.Monad.Freer.Extras.Modify.html#mapEffs"><span class="hs-identifier hs-var">mapEffs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (as :: [* -&gt; *]) (effs :: [* -&gt; *]).
CanWeakenEnd as effs =&gt;
Union as ~&gt; Union effs
Union as ~&gt; Union effs
</span><a href="Control.Monad.Freer.Extras.Modify.html#weakenEnd"><span class="hs-identifier hs-var">weakenEnd</span></a></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#raiseUnder"><span class="hs-identifier hs-type">raiseUnder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679216583"><span class="annot"><a href="#local-6989586621679216583"><span class="hs-identifier hs-type">effs</span></a></span></span><span> </span><span id="local-6989586621679216582"><span class="annot"><a href="#local-6989586621679216582"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679216581"><span class="annot"><a href="#local-6989586621679216581"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216582"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679216583"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216582"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679216581"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679216583"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span id="raiseUnder"><span class="annot"><span class="annottext">raiseUnder :: Eff (a : effs) x -&gt; Eff (a : b : effs) x
</span><a href="Control.Monad.Freer.Extras.Modify.html#raiseUnder"><span class="hs-identifier hs-var hs-var">raiseUnder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Union (a : effs) ~&gt; Union (a : b : effs))
-&gt; Eff (a : effs) ~&gt; Eff (a : b : effs)
forall (effs :: [* -&gt; *]) (effs' :: [* -&gt; *]).
(Union effs ~&gt; Union effs') -&gt; Eff effs ~&gt; Eff effs'
</span><a href="Control.Monad.Freer.Extras.Modify.html#mapEffs"><span class="hs-identifier hs-var">mapEffs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]) (a :: * -&gt; *) (b :: * -&gt; *).
Union (a : effs) ~&gt; Union (a : b : effs)
Union (a : effs) ~&gt; Union (a : b : effs)
</span><a href="Control.Monad.Freer.Extras.Modify.html#weakenUnder"><span class="hs-identifier hs-var">weakenUnder</span></a></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#raiseUnder2"><span class="hs-identifier hs-type">raiseUnder2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679216580"><span class="annot"><a href="#local-6989586621679216580"><span class="hs-identifier hs-type">effs</span></a></span></span><span> </span><span id="local-6989586621679216579"><span class="annot"><a href="#local-6989586621679216579"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679216578"><span class="annot"><a href="#local-6989586621679216578"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679216577"><span class="annot"><a href="#local-6989586621679216577"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216579"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679216578"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679216580"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216579"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679216578"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679216577"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679216580"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span id="raiseUnder2"><span class="annot"><span class="annottext">raiseUnder2 :: Eff (a : b : effs) x -&gt; Eff (a : b : c : effs) x
</span><a href="Control.Monad.Freer.Extras.Modify.html#raiseUnder2"><span class="hs-identifier hs-var hs-var">raiseUnder2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Union (a : b : effs) ~&gt; Union (a : b : c : effs))
-&gt; Eff (a : b : effs) ~&gt; Eff (a : b : c : effs)
forall (effs :: [* -&gt; *]) (effs' :: [* -&gt; *]).
(Union effs ~&gt; Union effs') -&gt; Eff effs ~&gt; Eff effs'
</span><a href="Control.Monad.Freer.Extras.Modify.html#mapEffs"><span class="hs-identifier hs-var">mapEffs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Union (b : effs) ~&gt; Union (b : c : effs))
-&gt; Union (a : b : effs) ~&gt; Union (a : b : c : effs)
forall (effs :: [* -&gt; *]) (effs' :: [* -&gt; *]) (a :: * -&gt; *).
(Union effs ~&gt; Union effs')
-&gt; Union (a : effs) ~&gt; Union (a : effs')
</span><a href="Control.Monad.Freer.Extras.Modify.html#under"><span class="hs-identifier hs-var">under</span></a></span><span> </span><span class="annot"><span class="annottext">((Union (b : effs) ~&gt; Union (b : c : effs))
 -&gt; Union (a : b : effs) ~&gt; Union (a : b : c : effs))
-&gt; (Union (b : effs) ~&gt; Union (b : c : effs))
-&gt; Union (a : b : effs) ~&gt; Union (a : b : c : effs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Union effs ~&gt; Union (c : effs))
-&gt; Union (b : effs) ~&gt; Union (b : c : effs)
forall (effs :: [* -&gt; *]) (effs' :: [* -&gt; *]) (a :: * -&gt; *).
(Union effs ~&gt; Union effs')
-&gt; Union (a : effs) ~&gt; Union (a : effs')
</span><a href="Control.Monad.Freer.Extras.Modify.html#under"><span class="hs-identifier hs-var">under</span></a></span><span> </span><span class="annot"><span class="annottext">Union effs ~&gt; Union (c : effs)
forall k (r :: [* -&gt; *]) (a :: k) (any :: * -&gt; *).
Union r a -&gt; Union (any : r) a
</span><span class="hs-identifier hs-var">weaken</span></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#raise2Under"><span class="hs-identifier hs-type">raise2Under</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679216576"><span class="annot"><a href="#local-6989586621679216576"><span class="hs-identifier hs-type">effs</span></a></span></span><span> </span><span id="local-6989586621679216575"><span class="annot"><a href="#local-6989586621679216575"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679216574"><span class="annot"><a href="#local-6989586621679216574"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679216573"><span class="annot"><a href="#local-6989586621679216573"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216575"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679216576"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216575"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679216574"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679216573"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679216576"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span id="raise2Under"><span class="annot"><span class="annottext">raise2Under :: Eff (a : effs) x -&gt; Eff (a : b : c : effs) x
</span><a href="Control.Monad.Freer.Extras.Modify.html#raise2Under"><span class="hs-identifier hs-var hs-var">raise2Under</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Union (a : effs) ~&gt; Union (a : b : c : effs))
-&gt; Eff (a : effs) ~&gt; Eff (a : b : c : effs)
forall (effs :: [* -&gt; *]) (effs' :: [* -&gt; *]).
(Union effs ~&gt; Union effs') -&gt; Eff effs ~&gt; Eff effs'
</span><a href="Control.Monad.Freer.Extras.Modify.html#mapEffs"><span class="hs-identifier hs-var">mapEffs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Union effs ~&gt; Union (b : c : effs))
-&gt; Union (a : effs) ~&gt; Union (a : b : c : effs)
forall (effs :: [* -&gt; *]) (effs' :: [* -&gt; *]) (a :: * -&gt; *).
(Union effs ~&gt; Union effs')
-&gt; Union (a : effs) ~&gt; Union (a : effs')
</span><a href="Control.Monad.Freer.Extras.Modify.html#under"><span class="hs-identifier hs-var">under</span></a></span><span> </span><span class="annot"><span class="annottext">((Union effs ~&gt; Union (b : c : effs))
 -&gt; Union (a : effs) ~&gt; Union (a : b : c : effs))
-&gt; (Union effs ~&gt; Union (b : c : effs))
-&gt; Union (a : effs) ~&gt; Union (a : b : c : effs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Union (c : effs) x -&gt; Union (b : c : effs) x
forall k (r :: [* -&gt; *]) (a :: k) (any :: * -&gt; *).
Union r a -&gt; Union (any : r) a
</span><span class="hs-identifier hs-var">weaken</span></span><span> </span><span class="annot"><span class="annottext">(Union (c : effs) x -&gt; Union (b : c : effs) x)
-&gt; (Union effs x -&gt; Union (c : effs) x)
-&gt; Union effs x
-&gt; Union (b : c : effs) x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Union effs x -&gt; Union (c : effs) x
forall k (r :: [* -&gt; *]) (a :: k) (any :: * -&gt; *).
Union r a -&gt; Union (any : r) a
</span><span class="hs-identifier hs-var">weaken</span></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#raiseNUnder"><span class="hs-identifier hs-type">raiseNUnder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679216571"><span class="annot"><a href="#local-6989586621679216571"><span class="hs-identifier hs-type">effs'</span></a></span></span><span> </span><span id="local-6989586621679216570"><span class="annot"><a href="#local-6989586621679216570"><span class="hs-identifier hs-type">effs</span></a></span></span><span> </span><span id="local-6989586621679216569"><span class="annot"><a href="#local-6989586621679216569"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Weakens</span></span><span> </span><span class="annot"><a href="#local-6989586621679216571"><span class="hs-identifier hs-type">effs'</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216569"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679216570"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216569"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216571"><span class="hs-identifier hs-type">effs'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:++:</span></span><span> </span><span class="annot"><a href="#local-6989586621679216570"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span id="raiseNUnder"><span class="annot"><span class="annottext">raiseNUnder :: Eff (a : effs) ~&gt; Eff (a : (effs' :++: effs))
</span><a href="Control.Monad.Freer.Extras.Modify.html#raiseNUnder"><span class="hs-identifier hs-var hs-var">raiseNUnder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Union (a : effs) ~&gt; Union (a : (effs' :++: effs)))
-&gt; Eff (a : effs) ~&gt; Eff (a : (effs' :++: effs))
forall (effs :: [* -&gt; *]) (effs' :: [* -&gt; *]).
(Union effs ~&gt; Union effs') -&gt; Eff effs ~&gt; Eff effs'
</span><a href="Control.Monad.Freer.Extras.Modify.html#mapEffs"><span class="hs-identifier hs-var">mapEffs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Weakens effs' =&gt; Union (a : effs) ~&gt; Union (a : (effs' :++: effs))
forall (effs' :: [* -&gt; *]) (effs :: [* -&gt; *]) (a :: * -&gt; *).
Weakens effs' =&gt;
Union (a : effs) ~&gt; Union (a : (effs' :++: effs))
</span><a href="Control.Monad.Freer.Extras.Modify.html#weakenNUnder"><span class="hs-identifier hs-var">weakenNUnder</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679216571"><span class="hs-identifier hs-type">effs'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679216570"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679216569"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-comment">-- | Raise m effects under the top n effects</span><span>
</span><span id="line-131"></span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#raiseMUnderN"><span class="hs-identifier hs-type">raiseMUnderN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679216568"><span class="annot"><a href="#local-6989586621679216568"><span class="hs-identifier hs-type">effs'</span></a></span></span><span> </span><span id="local-6989586621679216567"><span class="annot"><a href="#local-6989586621679216567"><span class="hs-keyword hs-type">as</span></a></span></span><span> </span><span id="local-6989586621679216566"><span class="annot"><a href="#local-6989586621679216566"><span class="hs-identifier hs-type">effs</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#UnderN"><span class="hs-identifier hs-type">UnderN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679216567"><span class="hs-keyword hs-type">as</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Weakens</span></span><span> </span><span class="annot"><a href="#local-6989586621679216568"><span class="hs-identifier hs-type">effs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216567"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:++:</span></span><span> </span><span class="annot"><a href="#local-6989586621679216566"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216567"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:++:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216568"><span class="hs-identifier hs-type">effs'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:++:</span></span><span> </span><span class="annot"><a href="#local-6989586621679216566"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span id="raiseMUnderN"><span class="annot"><span class="annottext">raiseMUnderN :: Eff (as :++: effs) ~&gt; Eff (as :++: (effs' :++: effs))
</span><a href="Control.Monad.Freer.Extras.Modify.html#raiseMUnderN"><span class="hs-identifier hs-var hs-var">raiseMUnderN</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Union (as :++: effs) ~&gt; Union (as :++: (effs' :++: effs)))
-&gt; Eff (as :++: effs) ~&gt; Eff (as :++: (effs' :++: effs))
forall (effs :: [* -&gt; *]) (effs' :: [* -&gt; *]).
(Union effs ~&gt; Union effs') -&gt; Eff effs ~&gt; Eff effs'
</span><a href="Control.Monad.Freer.Extras.Modify.html#mapEffs"><span class="hs-identifier hs-var">mapEffs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(UnderN as, Weakens effs') =&gt;
Union (as :++: effs) ~&gt; Union (as :++: (effs' :++: effs))
forall (effs' :: [* -&gt; *]) (as :: [* -&gt; *]) (effs :: [* -&gt; *]).
(UnderN as, Weakens effs') =&gt;
Union (as :++: effs) ~&gt; Union (as :++: (effs' :++: effs))
</span><a href="Control.Monad.Freer.Extras.Modify.html#weakenMUnderN"><span class="hs-identifier hs-var">weakenMUnderN</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679216568"><span class="hs-identifier hs-type">effs'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679216567"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679216566"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-comment">-- | Handle a 'State' effect in terms of a &quot;larger&quot; 'State' effect from which we have a lens.</span><span>
</span><span id="line-136"></span><span id="local-6989586621679216563"><span id="local-6989586621679216564"><span id="local-6989586621679216565"><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#handleZoomedState"><span class="hs-identifier hs-type">handleZoomedState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><a href="#local-6989586621679216565"><span class="hs-identifier hs-type">s2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679216564"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="#local-6989586621679216565"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679216563"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><a href="#local-6989586621679216563"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621679216564"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-137"></span><span id="handleZoomedState"><span class="annot"><span class="annottext">handleZoomedState :: Lens' s2 s1 -&gt; State s1 ~&gt; Eff effs
</span><a href="Control.Monad.Freer.Extras.Modify.html#handleZoomedState"><span class="hs-identifier hs-var hs-var">handleZoomedState</span></a></span></span><span> </span><span id="local-6989586621679216562"><span class="annot"><span class="annottext">Lens' s2 s1
</span><a href="#local-6989586621679216562"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-138"></span><span>    </span><span class="annot"><span class="annottext">State s1 x
</span><span class="hs-identifier hs-var">Get</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Getting s1 s2 s1 -&gt; s2 -&gt; s1
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting s1 s2 s1
Lens' s2 s1
</span><a href="#local-6989586621679216562"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">(s2 -&gt; x) -&gt; Eff effs s2 -&gt; Eff effs x
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Eff effs s2
forall s (effs :: [* -&gt; *]). Member (State s) effs =&gt; Eff effs s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-139"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Put</span></span><span> </span><span id="local-6989586621679216556"><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679216556"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(s2 -&gt; s2) -&gt; Eff effs ()
forall s (effs :: [* -&gt; *]).
Member (State s) effs =&gt;
(s -&gt; s) -&gt; Eff effs ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASetter s2 s2 s1 s1 -&gt; s1 -&gt; s2 -&gt; s2
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">set</span></span><span> </span><span class="annot"><span class="annottext">ASetter s2 s2 s1 s1
Lens' s2 s1
</span><a href="#local-6989586621679216562"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679216556"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-comment">-- | Handle a 'Writer' effect in terms of a &quot;larger&quot; 'Writer' effect from which we have a review.</span><span>
</span><span id="line-142"></span><span id="local-6989586621679216551"><span id="local-6989586621679216552"><span id="local-6989586621679216553"><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#handleZoomedWriter"><span class="hs-identifier hs-type">handleZoomedWriter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Writer</span></span><span> </span><span class="annot"><a href="#local-6989586621679216553"><span class="hs-identifier hs-type">s2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679216552"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AReview</span></span><span> </span><span class="annot"><a href="#local-6989586621679216553"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679216551"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Writer</span></span><span> </span><span class="annot"><a href="#local-6989586621679216551"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621679216552"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-143"></span><span id="handleZoomedWriter"><span class="annot"><span class="annottext">handleZoomedWriter :: AReview s2 s1 -&gt; Writer s1 ~&gt; Eff effs
</span><a href="Control.Monad.Freer.Extras.Modify.html#handleZoomedWriter"><span class="hs-identifier hs-var hs-var">handleZoomedWriter</span></a></span></span><span> </span><span id="local-6989586621679216550"><span class="annot"><span class="annottext">AReview s2 s1
</span><a href="#local-6989586621679216550"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-144"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Tell</span></span><span> </span><span id="local-6989586621679216548"><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679216548"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">s2 -&gt; Eff effs ()
forall w (effs :: [* -&gt; *]).
Member (Writer w) effs =&gt;
w -&gt; Eff effs ()
</span><span class="hs-identifier hs-var">tell</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AReview s2 s1 -&gt; s1 -&gt; s2
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview s2 s1
</span><a href="#local-6989586621679216550"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679216548"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">-- | Handle an 'Error' effect in terms of a &quot;larger&quot; 'Error' effect from which we have a review.</span><span>
</span><span id="line-147"></span><span id="local-6989586621679216543"><span id="local-6989586621679216544"><span id="local-6989586621679216545"><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#handleZoomedError"><span class="hs-identifier hs-type">handleZoomedError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="annot"><a href="#local-6989586621679216545"><span class="hs-identifier hs-type">s2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679216544"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AReview</span></span><span> </span><span class="annot"><a href="#local-6989586621679216545"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679216543"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="annot"><a href="#local-6989586621679216543"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621679216544"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-148"></span><span id="handleZoomedError"><span class="annot"><span class="annottext">handleZoomedError :: AReview s2 s1 -&gt; Error s1 ~&gt; Eff effs
</span><a href="Control.Monad.Freer.Extras.Modify.html#handleZoomedError"><span class="hs-identifier hs-var hs-var">handleZoomedError</span></a></span></span><span> </span><span id="local-6989586621679216542"><span class="annot"><span class="annottext">AReview s2 s1
</span><a href="#local-6989586621679216542"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-149"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span id="local-6989586621679216540"><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679216540"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">s2 -&gt; Eff effs x
forall e (effs :: [* -&gt; *]) a.
Member (Error e) effs =&gt;
e -&gt; Eff effs a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AReview s2 s1 -&gt; s1 -&gt; s2
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview s2 s1
</span><a href="#local-6989586621679216542"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679216540"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-comment">-- | Handle a 'Reader' effect in terms of a &quot;larger&quot; 'Reader' effect from which we have a getter.</span><span>
</span><span id="line-152"></span><span id="local-6989586621679216536"><span id="local-6989586621679216537"><span id="local-6989586621679216538"><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#handleZoomedReader"><span class="hs-identifier hs-type">handleZoomedReader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Reader</span></span><span> </span><span class="annot"><a href="#local-6989586621679216538"><span class="hs-identifier hs-type">s2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679216537"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Getter</span></span><span> </span><span class="annot"><a href="#local-6989586621679216538"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679216536"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Reader</span></span><span> </span><span class="annot"><a href="#local-6989586621679216536"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621679216537"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-153"></span><span id="handleZoomedReader"><span class="annot"><span class="annottext">handleZoomedReader :: Getter s2 s1 -&gt; Reader s1 ~&gt; Eff effs
</span><a href="Control.Monad.Freer.Extras.Modify.html#handleZoomedReader"><span class="hs-identifier hs-var hs-var">handleZoomedReader</span></a></span></span><span> </span><span id="local-6989586621679216535"><span class="annot"><span class="annottext">Getter s2 s1
</span><a href="#local-6989586621679216535"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-154"></span><span>    </span><span class="annot"><span class="annottext">Reader s1 x
</span><span class="hs-identifier hs-var">Ask</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Getting s1 s2 s1 -&gt; s2 -&gt; s1
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting s1 s2 s1
Getter s2 s1
</span><a href="#local-6989586621679216535"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">(s2 -&gt; x) -&gt; Eff effs s2 -&gt; Eff effs x
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Eff effs s2
forall r (effs :: [* -&gt; *]). Member (Reader r) effs =&gt; Eff effs r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-comment">-- | Handle a 'Writer' effect in terms of a &quot;larger&quot; 'State' effect from which we have a setter.</span><span>
</span><span id="line-157"></span><span id="local-6989586621679216530"><span id="local-6989586621679216531"><span id="local-6989586621679216532"><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#writeIntoState"><span class="hs-identifier hs-type">writeIntoState</span></a></span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679216532"><span class="hs-identifier hs-type">s1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><a href="#local-6989586621679216531"><span class="hs-identifier hs-type">s2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679216530"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Setter'</span></span><span> </span><span class="annot"><a href="#local-6989586621679216531"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679216532"><span class="hs-identifier hs-type">s1</span></a></span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Writer</span></span><span> </span><span class="annot"><a href="#local-6989586621679216532"><span class="hs-identifier hs-type">s1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621679216530"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-161"></span><span id="writeIntoState"><span class="annot"><span class="annottext">writeIntoState :: Setter' s2 s1 -&gt; Writer s1 ~&gt; Eff effs
</span><a href="Control.Monad.Freer.Extras.Modify.html#writeIntoState"><span class="hs-identifier hs-var hs-var">writeIntoState</span></a></span></span><span> </span><span id="local-6989586621679216529"><span class="annot"><span class="annottext">Setter' s2 s1
</span><a href="#local-6989586621679216529"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-162"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Tell</span></span><span> </span><span id="local-6989586621679216528"><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679216528"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(s2 -&gt; s2) -&gt; Eff effs ()
forall s (effs :: [* -&gt; *]).
Member (State s) effs =&gt;
(s -&gt; s) -&gt; Eff effs ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679216527"><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679216527"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">s2
</span><a href="#local-6989586621679216527"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">s2 -&gt; (s2 -&gt; s2) -&gt; s2
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(s1 -&gt; Identity s1) -&gt; s2 -&gt; Identity s2
Setter' s2 s1
</span><a href="#local-6989586621679216529"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">((s1 -&gt; Identity s1) -&gt; s2 -&gt; Identity s2) -&gt; s1 -&gt; s2 -&gt; s2
forall a s t. Semigroup a =&gt; ASetter s t a a -&gt; a -&gt; s -&gt; t
</span><span class="hs-operator hs-var">&lt;&gt;~</span></span><span> </span><span class="annot"><span class="annottext">s1
</span><a href="#local-6989586621679216528"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">-- | Handle a 'State' effect in terms of a monadic effect which has a 'MTL.MonadState' instance.</span><span>
</span><span id="line-165"></span><span id="local-6989586621679216523"><span id="local-6989586621679216524"><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#stateToMonadState"><span class="hs-identifier hs-type">stateToMonadState</span></a></span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MTL.MonadState</span></span><span> </span><span class="annot"><a href="#local-6989586621679216524"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679216523"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><a href="#local-6989586621679216524"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679216523"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-168"></span><span id="stateToMonadState"><span class="annot"><span class="annottext">stateToMonadState :: State s ~&gt; m
</span><a href="Control.Monad.Freer.Extras.Modify.html#stateToMonadState"><span class="hs-identifier hs-var hs-var">stateToMonadState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-169"></span><span>    </span><span class="annot"><span class="annottext">State s x
</span><span class="hs-identifier hs-var">Get</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m x
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">MTL.get</span></span><span>
</span><span id="line-170"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Put</span></span><span> </span><span id="local-6989586621679216521"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679216521"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">s -&gt; m ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">MTL.put</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679216521"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span id="local-6989586621679216517"><span id="local-6989586621679216518"><span id="local-6989586621679216519"><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#monadStateToState"><span class="hs-identifier hs-type">monadStateToState</span></a></span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><a href="#local-6989586621679216519"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679216518"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MTL.State</span></span><span> </span><span class="annot"><a href="#local-6989586621679216519"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679216517"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621679216518"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679216517"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-176"></span><span id="monadStateToState"><span class="annot"><span class="annottext">monadStateToState :: State s a -&gt; Eff effs a
</span><a href="Control.Monad.Freer.Extras.Modify.html#monadStateToState"><span class="hs-identifier hs-var hs-var">monadStateToState</span></a></span></span><span> </span><span id="local-6989586621679216516"><span class="annot"><span class="annottext">State s a
</span><a href="#local-6989586621679216516"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-177"></span><span>    </span><span id="local-6989586621679216515"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679216515"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff effs s
forall s (effs :: [* -&gt; *]). Member (State s) effs =&gt; Eff effs s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679216514"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679216514"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679216513"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679216513"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State s a -&gt; s -&gt; (a, s)
forall s a. State s a -&gt; s -&gt; (a, s)
</span><span class="hs-identifier hs-var">MTL.runState</span></span><span> </span><span class="annot"><span class="annottext">State s a
</span><a href="#local-6989586621679216516"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679216515"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span class="annot"><span class="annottext">s -&gt; Eff effs ()
forall s (effs :: [* -&gt; *]).
Member (State s) effs =&gt;
s -&gt; Eff effs ()
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679216513"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><span class="annottext">a -&gt; Eff effs a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679216514"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-comment">-- | Handle an 'Error' effect in terms of a monadic effect which has a 'MTL.MonadError' instance.</span><span>
</span><span id="line-183"></span><span id="local-6989586621679216509"><span id="local-6989586621679216510"><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#errorToMonadError"><span class="hs-identifier hs-type">errorToMonadError</span></a></span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MTL.MonadError</span></span><span> </span><span class="annot"><a href="#local-6989586621679216510"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679216509"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="annot"><a href="#local-6989586621679216510"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679216509"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-186"></span><span id="errorToMonadError"><span class="annot"><span class="annottext">errorToMonadError :: Error e ~&gt; m
</span><a href="Control.Monad.Freer.Extras.Modify.html#errorToMonadError"><span class="hs-identifier hs-var hs-var">errorToMonadError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-187"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span id="local-6989586621679216508"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679216508"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e -&gt; m x
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">MTL.throwError</span></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679216508"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-comment">-- | Transform an error type</span><span>
</span><span id="line-190"></span><span class="annot"><a href="Control.Monad.Freer.Extras.Modify.html#wrapError"><span class="hs-identifier hs-type">wrapError</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679216506"><span class="annot"><a href="#local-6989586621679216506"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679216505"><span class="annot"><a href="#local-6989586621679216505"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679216504"><span class="annot"><a href="#local-6989586621679216504"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="annot"><a href="#local-6989586621679216505"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679216504"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679216506"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679216505"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="annot"><a href="#local-6989586621679216506"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679216504"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621679216504"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-195"></span><span id="wrapError"><span class="annot"><span class="annottext">wrapError :: (e -&gt; f) -&gt; Eff (Error e : effs) ~&gt; Eff effs
</span><a href="Control.Monad.Freer.Extras.Modify.html#wrapError"><span class="hs-identifier hs-var hs-var">wrapError</span></a></span></span><span> </span><span id="local-6989586621679216503"><span class="annot"><span class="annottext">e -&gt; f
</span><a href="#local-6989586621679216503"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Eff (Error e : effs) x -&gt; (e -&gt; Eff effs x) -&gt; Eff effs x)
-&gt; (e -&gt; Eff effs x) -&gt; Eff (Error e : effs) x -&gt; Eff effs x
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (Error e : effs) x -&gt; (e -&gt; Eff effs x) -&gt; Eff effs x
forall e (effs :: [* -&gt; *]) a.
Eff (Error e : effs) a -&gt; (e -&gt; Eff effs a) -&gt; Eff effs a
</span><span class="hs-identifier hs-var">handleError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]) a.
Member (Error f) effs =&gt;
f -&gt; Eff effs a
forall e (effs :: [* -&gt; *]) a.
Member (Error e) effs =&gt;
e -&gt; Eff effs a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679216505"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="annottext">(f -&gt; Eff effs x) -&gt; (e -&gt; f) -&gt; e -&gt; Eff effs x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">e -&gt; f
</span><a href="#local-6989586621679216503"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span></pre></body></html>