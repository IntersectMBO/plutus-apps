<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds           #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE NumericUnderscores  #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings   #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards     #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE TupleSections       #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications    #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies        #-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-comment">-- | Generators for constructing blockchains and transactions for use in property-based testing.</span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.Node.Emulator.Generators</span><span class="hs-special">(</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Mockchain</span></span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier">Mockchain</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genMockchain"><span class="hs-identifier">genMockchain</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genMockchain%27"><span class="hs-identifier">genMockchain'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#emptyChain"><span class="hs-identifier">emptyChain</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#GeneratorModel"><span class="hs-identifier">GeneratorModel</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#generatorModel"><span class="hs-identifier">generatorModel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Transactions</span></span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValidTransaction"><span class="hs-identifier">genValidTransaction</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionBody"><span class="hs-identifier">genValidTransactionBody</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValidTransaction%27"><span class="hs-identifier">genValidTransaction'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionSpending"><span class="hs-identifier">genValidTransactionSpending</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionSpending%27"><span class="hs-identifier">genValidTransactionSpending'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genInitialTransaction"><span class="hs-identifier">genInitialTransaction</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#makeTx"><span class="hs-identifier">makeTx</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Assertions</span></span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#assertValid"><span class="hs-identifier">assertValid</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Time</span></span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genInterval"><span class="hs-identifier">genInterval</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genSlotRange"><span class="hs-identifier">genSlotRange</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genTimeRange"><span class="hs-identifier">genTimeRange</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genSlot"><span class="hs-identifier">genSlot</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genPOSIXTime"><span class="hs-identifier">genPOSIXTime</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genSlotConfig"><span class="hs-identifier">genSlotConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Etc.</span></span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#failOnCardanoError"><span class="hs-identifier">failOnCardanoError</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genPolicyId"><span class="hs-identifier">genPolicyId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genAssetId"><span class="hs-identifier">genAssetId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><span class="hs-identifier">Gen.genAssetName</span></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genSingleton"><span class="hs-identifier">genSingleton</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValue"><span class="hs-identifier">genValue</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValueNonNegative"><span class="hs-identifier">genValueNonNegative</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genSizedByteString"><span class="hs-identifier">genSizedByteString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genSeed"><span class="hs-identifier">genSeed</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genPassphrase"><span class="hs-identifier">genPassphrase</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#splitVal"><span class="hs-identifier">splitVal</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#validateMockchain"><span class="hs-identifier">validateMockchain</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#signAll"><span class="hs-identifier">signAll</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><span class="hs-identifier">CW.knownAddresses</span></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><span class="hs-identifier">CW.knownPaymentPublicKeys</span></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><span class="hs-identifier">CW.knownPaymentPrivateKeys</span></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><span class="hs-identifier">CW.knownPaymentKeys</span></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#knownXPrvs"><span class="hs-identifier">knownXPrvs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#alwaysSucceedPolicy"><span class="hs-identifier">alwaysSucceedPolicy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#alwaysSucceedPolicyId"><span class="hs-identifier">alwaysSucceedPolicyId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#someTokenValue"><span class="hs-identifier">someTokenValue</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><span class="hs-identifier">Tx.emptyTxBodyContent</span></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Api</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Api.Shelley</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Crypto.Wallet</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Crypto</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Internal.Node.Params.html"><span class="hs-identifier">Cardano.Node.Emulator.Internal.Node.Params</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Node.Emulator.Internal.Node.Params.html#Params"><span class="hs-identifier">Params</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Node.Emulator.Internal.Node.Params.html#pSlotConfig"><span class="hs-identifier">pSlotConfig</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">testnet</span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Internal.Node.TimeSlot.html"><span class="hs-identifier">Cardano.Node.Emulator.Internal.Node.TimeSlot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Node.Emulator.Internal.Node.TimeSlot.html#SlotConfig"><span class="hs-identifier">SlotConfig</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Internal.Node.TimeSlot.html"><span class="hs-identifier">Cardano.Node.Emulator.Internal.Node.TimeSlot</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TimeSlot</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Internal.Node.Validation.html"><span class="hs-identifier">Cardano.Node.Emulator.Internal.Node.Validation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Node.Emulator.Internal.Node.Validation.html#validateCardanoTx"><span class="hs-identifier">validateCardanoTx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">guard</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">replicateM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Bifunctor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Bifunctor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">first</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Default</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Default</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">def</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">def</span></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">fold</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">foldl'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Functor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator">($&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">sort</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">fromMaybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">isNothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.String</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">fromString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Stack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">HasCallStack</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Gen.Cardano.Api.Typed</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Gen</span></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hedgehog</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Gen</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MonadGen</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MonadTest</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Range</span></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hedgehog</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">H</span></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hedgehog.Gen</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Gen</span></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hedgehog.Range</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Range</span></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CardanoTx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CardanoEmulatorEraTx</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Interval</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MintingPolicy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">getMintingPolicy</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-89"></span><span>               </span><span class="annot"><span class="hs-identifier">POSIXTime</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">POSIXTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getPOSIXTime</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">POSIXTimeRange</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Passphrase</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Passphrase</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-90"></span><span>               </span><span class="annot"><span class="hs-identifier">PaymentPrivateKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unPaymentPrivateKey</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PaymentPubKey</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Slot</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Slot</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SlotRange</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxOut</span></span><span class="hs-special">,</span><span>
</span><span id="line-91"></span><span>               </span><span class="annot"><span class="hs-identifier">ValidationErrorInPhase</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ValidationPhase</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Phase1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Phase2</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ValidationResult</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">FailPhase1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">FailPhase2</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-92"></span><span>               </span><span class="annot"><span class="hs-identifier">addCardanoTxSignature</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">createGenesisTransaction</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">minLovelaceTxOutEstimated</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">pubKeyAddress</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">txOutValue</span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.CardanoWallet</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CW</span></span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Tx</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Tx</span></span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Tx.CardanoAPI</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ToCardanoError</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromCardanoPlutusScript</span></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Tx.CardanoAPI</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">makeTransactionBody</span></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Value.CardanoAPI</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Value</span></span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Numeric.Natural</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Natural</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.V1.Ledger.Api</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V1</span></span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.V1.Ledger.Interval</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Interval</span></span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.V1.Ledger.Scripts</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Script</span></span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PlutusTx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toData</span></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">-- | Attach signatures of all known private keys to a transaction.</span><span>
</span><span id="line-105"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#signAll"><span class="hs-identifier hs-type">signAll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span>
</span><span id="line-106"></span><span id="signAll"><span class="annot"><span class="annottext">signAll :: CardanoTx -&gt; CardanoTx
</span><a href="Cardano.Node.Emulator.Generators.html#signAll"><span class="hs-identifier hs-var hs-var">signAll</span></a></span></span><span> </span><span id="local-6989586621679392343"><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621679392343"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CardanoTx -&gt; PrivateKey -&gt; CardanoTx)
-&gt; CardanoTx -&gt; [PrivateKey] -&gt; CardanoTx
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PrivateKey -&gt; CardanoTx -&gt; CardanoTx)
-&gt; CardanoTx -&gt; PrivateKey -&gt; CardanoTx
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateKey -&gt; CardanoTx -&gt; CardanoTx
</span><span class="hs-identifier hs-var">addCardanoTxSignature</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621679392343"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-107"></span><span>           </span><span class="annot"><span class="annottext">([PrivateKey] -&gt; CardanoTx) -&gt; [PrivateKey] -&gt; CardanoTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(PaymentPrivateKey -&gt; PrivateKey)
-&gt; [PaymentPrivateKey] -&gt; [PrivateKey]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentPrivateKey -&gt; PrivateKey
</span><span class="hs-identifier hs-var hs-var">unPaymentPrivateKey</span></span><span> </span><span class="annot"><span class="annottext">[PaymentPrivateKey]
</span><span class="hs-identifier hs-var">CW.knownPaymentPrivateKeys</span></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">-- | The parameters for the generators in this module.</span><span>
</span><span id="line-110"></span><span class="hs-keyword">data</span><span> </span><span id="GeneratorModel"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#GeneratorModel"><span class="hs-identifier hs-var">GeneratorModel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GeneratorModel"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#GeneratorModel"><span class="hs-identifier hs-var">GeneratorModel</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-111"></span><span>    </span><span id="gmInitialBalance"><span class="annot"><span class="annottext">GeneratorModel -&gt; Map PaymentPubKey Lovelace
</span><a href="Cardano.Node.Emulator.Generators.html#gmInitialBalance"><span class="hs-identifier hs-var hs-var">gmInitialBalance</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PaymentPubKey</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Lovelace</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-comment">-- ^ Value created at the beginning of the blockchain.</span><span>
</span><span id="line-113"></span><span>    </span><span id="gmPubKeys"><span class="annot"><span class="annottext">GeneratorModel -&gt; Set PaymentPubKey
</span><a href="Cardano.Node.Emulator.Generators.html#gmPubKeys"><span class="hs-identifier hs-var hs-var">gmPubKeys</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PaymentPubKey</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-comment">-- ^ Public keys that are to be used for generating transactions.</span><span>
</span><span id="line-115"></span><span>    </span><span id="gmMaxCollateralInputs"><span class="annot"><span class="annottext">GeneratorModel -&gt; Maybe Natural
</span><a href="Cardano.Node.Emulator.Generators.html#gmMaxCollateralInputs"><span class="hs-identifier hs-var hs-var">gmMaxCollateralInputs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Natural</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679392332"><span id="local-6989586621679392334"><span id="local-6989586621679392336"><span class="annot"><span class="annottext">Int -&gt; GeneratorModel -&gt; ShowS
[GeneratorModel] -&gt; ShowS
GeneratorModel -&gt; String
(Int -&gt; GeneratorModel -&gt; ShowS)
-&gt; (GeneratorModel -&gt; String)
-&gt; ([GeneratorModel] -&gt; ShowS)
-&gt; Show GeneratorModel
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [GeneratorModel] -&gt; ShowS
$cshowList :: [GeneratorModel] -&gt; ShowS
show :: GeneratorModel -&gt; String
$cshow :: GeneratorModel -&gt; String
showsPrec :: Int -&gt; GeneratorModel -&gt; ShowS
$cshowsPrec :: Int -&gt; GeneratorModel -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="hs-comment">-- | A generator model with some sensible defaults.</span><span>
</span><span id="line-119"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#generatorModel"><span class="hs-identifier hs-type">generatorModel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#GeneratorModel"><span class="hs-identifier hs-type">GeneratorModel</span></a></span><span>
</span><span id="line-120"></span><span id="generatorModel"><span class="annot"><span class="annottext">generatorModel :: GeneratorModel
</span><a href="Cardano.Node.Emulator.Generators.html#generatorModel"><span class="hs-identifier hs-var hs-var">generatorModel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679392330"><span class="annot"><span class="annottext">vl :: Lovelace
</span><a href="#local-6989586621679392330"><span class="hs-identifier hs-var hs-var">vl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Lovelace
</span><span class="hs-identifier hs-var">C.Lovelace</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Lovelace) -&gt; Integer -&gt; Lovelace
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1_000_000</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">100</span></span><span>
</span><span id="line-122"></span><span>        </span><span id="local-6989586621679392327"><span class="annot"><span class="annottext">pubKeys :: [PaymentPubKey]
</span><a href="#local-6989586621679392327"><span class="hs-identifier hs-var hs-var">pubKeys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PaymentPubKey]
</span><span class="hs-identifier hs-var">CW.knownPaymentPublicKeys</span></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-keyword">in</span><span>
</span><span id="line-125"></span><span>    </span><span class="annot"><span class="annottext">GeneratorModel :: Map PaymentPubKey Lovelace
-&gt; Set PaymentPubKey -&gt; Maybe Natural -&gt; GeneratorModel
</span><a href="Cardano.Node.Emulator.Generators.html#GeneratorModel"><span class="hs-identifier hs-type">GeneratorModel</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">gmInitialBalance :: Map PaymentPubKey Lovelace
</span><a href="Cardano.Node.Emulator.Generators.html#gmInitialBalance"><span class="hs-identifier hs-var">gmInitialBalance</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(PaymentPubKey, Lovelace)] -&gt; Map PaymentPubKey Lovelace
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(PaymentPubKey, Lovelace)] -&gt; Map PaymentPubKey Lovelace)
-&gt; [(PaymentPubKey, Lovelace)] -&gt; Map PaymentPubKey Lovelace
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[PaymentPubKey] -&gt; [Lovelace] -&gt; [(PaymentPubKey, Lovelace)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[PaymentPubKey]
</span><a href="#local-6989586621679392327"><span class="hs-identifier hs-var">pubKeys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lovelace -&gt; [Lovelace]
forall a. a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">repeat</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679392330"><span class="hs-identifier hs-var">vl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">gmPubKeys :: Set PaymentPubKey
</span><a href="Cardano.Node.Emulator.Generators.html#gmPubKeys"><span class="hs-identifier hs-var">gmPubKeys</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PaymentPubKey] -&gt; Set PaymentPubKey
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">[PaymentPubKey]
</span><a href="#local-6989586621679392327"><span class="hs-identifier hs-var">pubKeys</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">gmMaxCollateralInputs :: Maybe Natural
</span><a href="Cardano.Node.Emulator.Generators.html#gmMaxCollateralInputs"><span class="hs-identifier hs-var">gmMaxCollateralInputs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProtocolParameters -&gt; Maybe Natural
</span><span class="hs-identifier hs-var hs-var">C.protocolParamMaxCollateralInputs</span></span><span> </span><span class="annot"><span class="annottext">ProtocolParameters
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="hs-comment">-- | Blockchain for testing the emulator implementation and traces.</span><span>
</span><span id="line-132"></span><span class="hs-comment">--</span><span>
</span><span id="line-133"></span><span class="hs-comment">--   To avoid having to rely on functions from the implementation of</span><span>
</span><span id="line-134"></span><span class="hs-comment">--   plutus-ledger (in particular, 'Ledger.Tx.unspentOutputs') we note the</span><span>
</span><span id="line-135"></span><span class="hs-comment">--   unspent outputs of the chain when it is first created.</span><span>
</span><span id="line-136"></span><span class="hs-keyword">data</span><span> </span><span id="Mockchain"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-var">Mockchain</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Mockchain"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-var">Mockchain</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-137"></span><span>    </span><span id="mockchainInitialTxPool"><span class="annot"><span class="annottext">Mockchain -&gt; [CardanoTx]
</span><a href="Cardano.Node.Emulator.Generators.html#mockchainInitialTxPool"><span class="hs-identifier hs-var hs-var">mockchainInitialTxPool</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-138"></span><span>    </span><span id="mockchainUtxo"><span class="annot"><span class="annottext">Mockchain -&gt; Map TxIn TxOut
</span><a href="Cardano.Node.Emulator.Generators.html#mockchainUtxo"><span class="hs-identifier hs-var hs-var">mockchainUtxo</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.TxIn</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span class="hs-special">,</span><span>
</span><span id="line-139"></span><span>    </span><span id="mockchainParams"><span class="annot"><span class="annottext">Mockchain -&gt; Params
</span><a href="Cardano.Node.Emulator.Generators.html#mockchainParams"><span class="hs-identifier hs-var hs-var">mockchainParams</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Internal.Node.Params.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679392313"><span id="local-6989586621679392315"><span id="local-6989586621679392317"><span class="annot"><span class="annottext">Int -&gt; Mockchain -&gt; ShowS
[Mockchain] -&gt; ShowS
Mockchain -&gt; String
(Int -&gt; Mockchain -&gt; ShowS)
-&gt; (Mockchain -&gt; String)
-&gt; ([Mockchain] -&gt; ShowS)
-&gt; Show Mockchain
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Mockchain] -&gt; ShowS
$cshowList :: [Mockchain] -&gt; ShowS
show :: Mockchain -&gt; String
$cshow :: Mockchain -&gt; String
showsPrec :: Int -&gt; Mockchain -&gt; ShowS
$cshowsPrec :: Int -&gt; Mockchain -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-comment">-- | The empty mockchain.</span><span>
</span><span id="line-143"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#emptyChain"><span class="hs-identifier hs-type">emptyChain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-type">Mockchain</span></a></span><span>
</span><span id="line-144"></span><span id="emptyChain"><span class="annot"><span class="annottext">emptyChain :: Mockchain
</span><a href="Cardano.Node.Emulator.Generators.html#emptyChain"><span class="hs-identifier hs-var hs-var">emptyChain</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CardanoTx] -&gt; Map TxIn TxOut -&gt; Params -&gt; Mockchain
</span><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-var">Mockchain</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Map TxIn TxOut
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span> </span><span class="annot"><span class="annottext">Params
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">-- | Generate a mockchain.</span><span>
</span><span id="line-147"></span><span class="hs-comment">--</span><span>
</span><span id="line-148"></span><span class="hs-comment">--   TODO: Generate more than 1 txn</span><span>
</span><span id="line-149"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genMockchain%27"><span class="hs-identifier hs-type">genMockchain'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-150"></span><span>       </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#GeneratorModel"><span class="hs-identifier hs-type">GeneratorModel</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-type">Mockchain</span></a></span><span>
</span><span id="line-152"></span><span id="genMockchain%27"><span class="annot"><span class="annottext">genMockchain' :: GeneratorModel -&gt; Gen Mockchain
</span><a href="Cardano.Node.Emulator.Generators.html#genMockchain%27"><span class="hs-identifier hs-var hs-var">genMockchain'</span></a></span></span><span> </span><span id="local-6989586621679392311"><span class="annot"><span class="annottext">GeneratorModel
</span><a href="#local-6989586621679392311"><span class="hs-identifier hs-var">gm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-153"></span><span>    </span><span id="local-6989586621679392310"><span class="annot"><span class="annottext">SlotConfig
</span><a href="#local-6989586621679392310"><span class="hs-identifier hs-var">slotCfg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenT Identity SlotConfig
forall (m :: * -&gt; *). MonadGen m =&gt; m SlotConfig
</span><a href="Cardano.Node.Emulator.Generators.html#genSlotConfig"><span class="hs-identifier hs-var">genSlotConfig</span></a></span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679392309"><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621679392309"><span class="hs-identifier hs-var">txn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679392308"><span class="annot"><span class="annottext">[TxOut]
</span><a href="#local-6989586621679392308"><span class="hs-identifier hs-var">ot</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GeneratorModel -&gt; Gen (CardanoTx, [TxOut])
</span><a href="Cardano.Node.Emulator.Generators.html#genInitialTransaction"><span class="hs-identifier hs-var">genInitialTransaction</span></a></span><span> </span><span class="annot"><span class="annottext">GeneratorModel
</span><a href="#local-6989586621679392311"><span class="hs-identifier hs-var">gm</span></a></span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679392307"><span class="annot"><span class="annottext">params :: Params
</span><a href="#local-6989586621679392307"><span class="hs-identifier hs-var hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">pSlotConfig :: SlotConfig
</span><a href="Cardano.Node.Emulator.Internal.Node.Params.html#pSlotConfig"><span class="hs-identifier hs-var">pSlotConfig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SlotConfig
</span><a href="#local-6989586621679392310"><span class="hs-identifier hs-var">slotCfg</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-156"></span><span>        </span><span class="hs-comment">-- There is a problem that txId of emulator tx and tx of cardano tx are different.</span><span>
</span><span id="line-157"></span><span>        </span><span class="hs-comment">-- We convert the emulator tx to cardano tx here to get the correct transaction id</span><span>
</span><span id="line-158"></span><span>        </span><span class="hs-comment">-- because later we anyway will use the converted cardano tx so the utxo should match it.</span><span>
</span><span id="line-159"></span><span>        </span><span id="local-6989586621679392306"><span class="annot"><span class="annottext">tid :: TxId
</span><a href="#local-6989586621679392306"><span class="hs-identifier hs-var hs-var">tid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CardanoTx -&gt; TxId
</span><span class="hs-identifier hs-var">Tx.getCardanoTxId</span></span><span> </span><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621679392309"><span class="hs-identifier hs-var">txn</span></a></span><span>
</span><span id="line-160"></span><span>    </span><span class="annot"><span class="annottext">Mockchain -&gt; Gen Mockchain
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Mockchain :: [CardanoTx] -&gt; Map TxIn TxOut -&gt; Params -&gt; Mockchain
</span><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-type">Mockchain</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-161"></span><span>        </span><span class="annot"><span class="annottext">mockchainInitialTxPool :: [CardanoTx]
</span><a href="Cardano.Node.Emulator.Generators.html#mockchainInitialTxPool"><span class="hs-identifier hs-var">mockchainInitialTxPool</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621679392309"><span class="hs-identifier hs-var">txn</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-162"></span><span>        </span><span class="annot"><span class="annottext">mockchainUtxo :: Map TxIn TxOut
</span><a href="Cardano.Node.Emulator.Generators.html#mockchainUtxo"><span class="hs-identifier hs-var">mockchainUtxo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(TxIn, TxOut)] -&gt; Map TxIn TxOut
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(TxIn, TxOut)] -&gt; Map TxIn TxOut)
-&gt; [(TxIn, TxOut)] -&gt; Map TxIn TxOut
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Word -&gt; TxIn) -&gt; (Word, TxOut) -&gt; (TxIn, TxOut)
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxId -&gt; TxIx -&gt; TxIn
</span><span class="hs-identifier hs-var">C.TxIn</span></span><span> </span><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621679392306"><span class="hs-identifier hs-var">tid</span></a></span><span> </span><span class="annot"><span class="annottext">(TxIx -&gt; TxIn) -&gt; (Word -&gt; TxIx) -&gt; Word -&gt; TxIn
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; TxIx
</span><span class="hs-identifier hs-var">C.TxIx</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Word, TxOut) -&gt; (TxIn, TxOut))
-&gt; [(Word, TxOut)] -&gt; [(TxIn, TxOut)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Word] -&gt; [TxOut] -&gt; [(Word, TxOut)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[TxOut]
</span><a href="#local-6989586621679392308"><span class="hs-identifier hs-var">ot</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-163"></span><span>        </span><span class="annot"><span class="annottext">mockchainParams :: Params
</span><a href="Cardano.Node.Emulator.Generators.html#mockchainParams"><span class="hs-identifier hs-var">mockchainParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679392307"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-164"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-comment">-- | Generate a mockchain using the default 'GeneratorModel'.</span><span>
</span><span id="line-167"></span><span class="hs-comment">--</span><span>
</span><span id="line-168"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genMockchain"><span class="hs-identifier hs-type">genMockchain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-type">Mockchain</span></a></span><span>
</span><span id="line-169"></span><span id="genMockchain"><span class="annot"><span class="annottext">genMockchain :: Gen Mockchain
</span><a href="Cardano.Node.Emulator.Generators.html#genMockchain"><span class="hs-identifier hs-var hs-var">genMockchain</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneratorModel -&gt; Gen Mockchain
</span><a href="Cardano.Node.Emulator.Generators.html#genMockchain%27"><span class="hs-identifier hs-var">genMockchain'</span></a></span><span> </span><span class="annot"><span class="annottext">GeneratorModel
</span><a href="Cardano.Node.Emulator.Generators.html#generatorModel"><span class="hs-identifier hs-var">generatorModel</span></a></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-comment">-- | A transaction with no inputs that mints some value (to be used at the</span><span>
</span><span id="line-172"></span><span class="hs-comment">--   beginning of a blockchain).</span><span>
</span><span id="line-173"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genInitialTransaction"><span class="hs-identifier hs-type">genInitialTransaction</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-174"></span><span>       </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#GeneratorModel"><span class="hs-identifier hs-type">GeneratorModel</span></a></span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span id="genInitialTransaction"><span class="annot"><span class="annottext">genInitialTransaction :: GeneratorModel -&gt; Gen (CardanoTx, [TxOut])
</span><a href="Cardano.Node.Emulator.Generators.html#genInitialTransaction"><span class="hs-identifier hs-var hs-var">genInitialTransaction</span></a></span></span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#GeneratorModel"><span class="hs-identifier hs-type">GeneratorModel</span></a></span><span class="hs-special">{</span><span id="local-6989586621679392298"><span id="local-6989586621679392299"><span id="local-6989586621679392300"><span class="annot"><span class="annottext">Maybe Natural
Map PaymentPubKey Lovelace
Set PaymentPubKey
gmMaxCollateralInputs :: Maybe Natural
gmPubKeys :: Set PaymentPubKey
gmInitialBalance :: Map PaymentPubKey Lovelace
gmMaxCollateralInputs :: GeneratorModel -&gt; Maybe Natural
gmPubKeys :: GeneratorModel -&gt; Set PaymentPubKey
gmInitialBalance :: GeneratorModel -&gt; Map PaymentPubKey Lovelace
</span><a href="#local-6989586621679392298"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679392297"><span class="annot"><span class="annottext">pkAddr :: PaymentPubKey -&gt; AddressInEra BabbageEra
</span><a href="#local-6989586621679392297"><span class="hs-identifier hs-var hs-var">pkAddr</span></a></span></span><span> </span><span id="local-6989586621679392296"><span class="annot"><span class="annottext">PaymentPubKey
</span><a href="#local-6989586621679392296"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ToCardanoError -&gt; AddressInEra BabbageEra)
-&gt; (AddressInEra BabbageEra -&gt; AddressInEra BabbageEra)
-&gt; Either ToCardanoError (AddressInEra BabbageEra)
-&gt; AddressInEra BabbageEra
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; AddressInEra BabbageEra
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; AddressInEra BabbageEra)
-&gt; (ToCardanoError -&gt; String)
-&gt; ToCardanoError
-&gt; AddressInEra BabbageEra
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ToCardanoError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AddressInEra BabbageEra -&gt; AddressInEra BabbageEra
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ToCardanoError (AddressInEra BabbageEra)
 -&gt; AddressInEra BabbageEra)
-&gt; Either ToCardanoError (AddressInEra BabbageEra)
-&gt; AddressInEra BabbageEra
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
-&gt; Address -&gt; Either ToCardanoError (AddressInEra BabbageEra)
</span><span class="hs-identifier hs-var">C.toCardanoAddressInEra</span></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><span class="hs-identifier hs-var">testnet</span></span><span> </span><span class="annot"><span class="annottext">(Address -&gt; Either ToCardanoError (AddressInEra BabbageEra))
-&gt; Address -&gt; Either ToCardanoError (AddressInEra BabbageEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentPubKey -&gt; Maybe StakingCredential -&gt; Address
</span><span class="hs-identifier hs-var">pubKeyAddress</span></span><span> </span><span class="annot"><span class="annottext">PaymentPubKey
</span><a href="#local-6989586621679392296"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe StakingCredential
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-178"></span><span>        </span><span id="local-6989586621679392290"><span class="annot"><span class="annottext">initialDist :: Map (AddressInEra BabbageEra) Value
</span><a href="#local-6989586621679392290"><span class="hs-identifier hs-var hs-var">initialDist</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PaymentPubKey -&gt; AddressInEra BabbageEra)
-&gt; Map PaymentPubKey Value -&gt; Map (AddressInEra BabbageEra) Value
forall k2 k1 a. Ord k2 =&gt; (k1 -&gt; k2) -&gt; Map k1 a -&gt; Map k2 a
</span><span class="hs-identifier hs-var">Map.mapKeys</span></span><span> </span><span class="annot"><span class="annottext">PaymentPubKey -&gt; AddressInEra BabbageEra
</span><a href="#local-6989586621679392297"><span class="hs-identifier hs-var">pkAddr</span></a></span><span> </span><span class="annot"><span class="annottext">(Map PaymentPubKey Value -&gt; Map (AddressInEra BabbageEra) Value)
-&gt; Map PaymentPubKey Value -&gt; Map (AddressInEra BabbageEra) Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Lovelace -&gt; Value)
-&gt; Map PaymentPubKey Lovelace -&gt; Map PaymentPubKey Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Value
</span><span class="hs-identifier hs-var">Value.lovelaceToValue</span></span><span> </span><span class="annot"><span class="annottext">Map PaymentPubKey Lovelace
</span><a href="#local-6989586621679392300"><span class="hs-identifier hs-var">gmInitialBalance</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679392287"><span class="annot"><span class="annottext">tx :: CardanoTx
</span><a href="#local-6989586621679392287"><span class="hs-identifier hs-var">tx</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CardanoEmulatorEraTx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.Tx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.TxBody</span></span><span> </span><span id="local-6989586621679392284"><span class="annot"><span class="annottext">TxBodyContent ViewTx BabbageEra
</span><a href="#local-6989586621679392284"><span class="hs-identifier hs-var">txBodyContent</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[KeyWitness BabbageEra]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (AddressInEra BabbageEra) Value -&gt; CardanoTx
</span><span class="hs-identifier hs-var">createGenesisTransaction</span></span><span> </span><span class="annot"><span class="annottext">Map (AddressInEra BabbageEra) Value
</span><a href="#local-6989586621679392290"><span class="hs-identifier hs-var">initialDist</span></a></span><span>
</span><span id="line-180"></span><span>        </span><span id="local-6989586621679392283"><span class="annot"><span class="annottext">txOuts :: [TxOut]
</span><a href="#local-6989586621679392283"><span class="hs-identifier hs-var hs-var">txOuts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOut CtxTx BabbageEra -&gt; TxOut
</span><span class="hs-identifier hs-var">Tx.TxOut</span></span><span> </span><span class="annot"><span class="annottext">(TxOut CtxTx BabbageEra -&gt; TxOut)
-&gt; [TxOut CtxTx BabbageEra] -&gt; [TxOut]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyContent ViewTx BabbageEra -&gt; [TxOut CtxTx BabbageEra]
forall build era. TxBodyContent build era -&gt; [TxOut CtxTx era]
</span><span class="hs-identifier hs-var hs-var">C.txOuts</span></span><span> </span><span class="annot"><span class="annottext">TxBodyContent ViewTx BabbageEra
</span><a href="#local-6989586621679392284"><span class="hs-identifier hs-var">txBodyContent</span></a></span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><span class="annottext">(CardanoTx, [TxOut]) -&gt; Gen (CardanoTx, [TxOut])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621679392287"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TxOut]
</span><a href="#local-6989586621679392283"><span class="hs-identifier hs-var">txOuts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-comment">-- | Generate a valid transaction, using the unspent outputs provided.</span><span>
</span><span id="line-184"></span><span class="hs-comment">--   Fails if the there are no unspent outputs, or if the total value</span><span>
</span><span id="line-185"></span><span class="hs-comment">--   of the unspent outputs is smaller than the minimum fee.</span><span>
</span><span id="line-186"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValidTransaction"><span class="hs-identifier hs-type">genValidTransaction</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-type">Mockchain</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span>
</span><span id="line-189"></span><span id="genValidTransaction"><span class="annot"><span class="annottext">genValidTransaction :: Mockchain -&gt; Gen CardanoTx
</span><a href="Cardano.Node.Emulator.Generators.html#genValidTransaction"><span class="hs-identifier hs-var hs-var">genValidTransaction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneratorModel -&gt; Mockchain -&gt; Gen CardanoTx
</span><a href="Cardano.Node.Emulator.Generators.html#genValidTransaction%27"><span class="hs-identifier hs-var">genValidTransaction'</span></a></span><span> </span><span class="annot"><span class="annottext">GeneratorModel
</span><a href="Cardano.Node.Emulator.Generators.html#generatorModel"><span class="hs-identifier hs-var">generatorModel</span></a></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionBody"><span class="hs-identifier hs-type">genValidTransactionBody</span></a></span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-type">Mockchain</span></a></span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.TxBodyContent</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.BuildTx</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.BabbageEra</span></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span id="genValidTransactionBody"><span class="annot"><span class="annottext">genValidTransactionBody :: Mockchain -&gt; Gen (TxBodyContent BuildTx BabbageEra)
</span><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionBody"><span class="hs-identifier hs-var hs-var">genValidTransactionBody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneratorModel
-&gt; Mockchain -&gt; Gen (TxBodyContent BuildTx BabbageEra)
</span><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionBody%27"><span class="hs-identifier hs-var">genValidTransactionBody'</span></a></span><span> </span><span class="annot"><span class="annottext">GeneratorModel
</span><a href="Cardano.Node.Emulator.Generators.html#generatorModel"><span class="hs-identifier hs-var">generatorModel</span></a></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-comment">-- | Generate a valid transaction, using the unspent outputs provided.</span><span>
</span><span id="line-197"></span><span class="hs-comment">--   Fails if the there are no unspent outputs, or if the total value</span><span>
</span><span id="line-198"></span><span class="hs-comment">--   of the unspent outputs is smaller than the estimated fee.</span><span>
</span><span id="line-199"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValidTransaction%27"><span class="hs-identifier hs-type">genValidTransaction'</span></a></span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#GeneratorModel"><span class="hs-identifier hs-type">GeneratorModel</span></a></span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-type">Mockchain</span></a></span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span>
</span><span id="line-203"></span><span id="genValidTransaction%27"><span class="annot"><span class="annottext">genValidTransaction' :: GeneratorModel -&gt; Mockchain -&gt; Gen CardanoTx
</span><a href="Cardano.Node.Emulator.Generators.html#genValidTransaction%27"><span class="hs-identifier hs-var hs-var">genValidTransaction'</span></a></span></span><span> </span><span id="local-6989586621679392279"><span class="annot"><span class="annottext">GeneratorModel
</span><a href="#local-6989586621679392279"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679392278"><span class="annot"><span class="annottext">Mockchain
</span><a href="#local-6989586621679392278"><span class="hs-identifier hs-var">chain</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneratorModel
-&gt; Mockchain -&gt; Gen (TxBodyContent BuildTx BabbageEra)
</span><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionBody%27"><span class="hs-identifier hs-var">genValidTransactionBody'</span></a></span><span> </span><span class="annot"><span class="annottext">GeneratorModel
</span><a href="#local-6989586621679392279"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Mockchain
</span><a href="#local-6989586621679392278"><span class="hs-identifier hs-var">chain</span></a></span><span> </span><span class="annot"><span class="annottext">Gen (TxBodyContent BuildTx BabbageEra)
-&gt; (TxBodyContent BuildTx BabbageEra -&gt; Gen CardanoTx)
-&gt; Gen CardanoTx
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyContent BuildTx BabbageEra -&gt; Gen CardanoTx
forall (m :: * -&gt; *).
MonadFail m =&gt;
TxBodyContent BuildTx BabbageEra -&gt; m CardanoTx
</span><a href="Cardano.Node.Emulator.Generators.html#makeTx"><span class="hs-identifier hs-var">makeTx</span></a></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionSpending"><span class="hs-identifier hs-type">genValidTransactionSpending</span></a></span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">C.TxIn</span></span><span class="hs-special">]</span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Value</span></span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span>
</span><span id="line-209"></span><span id="genValidTransactionSpending"><span class="annot"><span class="annottext">genValidTransactionSpending :: [TxIn] -&gt; Value -&gt; Gen CardanoTx
</span><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionSpending"><span class="hs-identifier hs-var hs-var">genValidTransactionSpending</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneratorModel -&gt; [TxIn] -&gt; Value -&gt; Gen CardanoTx
</span><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionSpending%27"><span class="hs-identifier hs-var">genValidTransactionSpending'</span></a></span><span> </span><span class="annot"><span class="annottext">GeneratorModel
</span><a href="Cardano.Node.Emulator.Generators.html#generatorModel"><span class="hs-identifier hs-var">generatorModel</span></a></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionSpending%27"><span class="hs-identifier hs-type">genValidTransactionSpending'</span></a></span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#GeneratorModel"><span class="hs-identifier hs-type">GeneratorModel</span></a></span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">C.TxIn</span></span><span class="hs-special">]</span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Value</span></span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span>
</span><span id="line-216"></span><span id="genValidTransactionSpending%27"><span class="annot"><span class="annottext">genValidTransactionSpending' :: GeneratorModel -&gt; [TxIn] -&gt; Value -&gt; Gen CardanoTx
</span><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionSpending%27"><span class="hs-identifier hs-var hs-var">genValidTransactionSpending'</span></a></span></span><span> </span><span id="local-6989586621679392277"><span class="annot"><span class="annottext">GeneratorModel
</span><a href="#local-6989586621679392277"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679392276"><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621679392276"><span class="hs-identifier hs-var">ins</span></a></span></span><span> </span><span id="local-6989586621679392275"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679392275"><span class="hs-identifier hs-var">totalVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><span class="annottext">GeneratorModel
-&gt; [TxIn] -&gt; Value -&gt; Gen (TxBodyContent BuildTx BabbageEra)
</span><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionBodySpending%27"><span class="hs-identifier hs-var">genValidTransactionBodySpending'</span></a></span><span> </span><span class="annot"><span class="annottext">GeneratorModel
</span><a href="#local-6989586621679392277"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621679392276"><span class="hs-identifier hs-var">ins</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679392275"><span class="hs-identifier hs-var">totalVal</span></a></span><span> </span><span class="annot"><span class="annottext">Gen (TxBodyContent BuildTx BabbageEra)
-&gt; (TxBodyContent BuildTx BabbageEra -&gt; Gen CardanoTx)
-&gt; Gen CardanoTx
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyContent BuildTx BabbageEra -&gt; Gen CardanoTx
forall (m :: * -&gt; *).
MonadFail m =&gt;
TxBodyContent BuildTx BabbageEra -&gt; m CardanoTx
</span><a href="Cardano.Node.Emulator.Generators.html#makeTx"><span class="hs-identifier hs-var">makeTx</span></a></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span id="local-6989586621679392600"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#makeTx"><span class="hs-identifier hs-type">makeTx</span></a></span><span>
</span><span id="line-221"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadFail</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392600"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-222"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.TxBodyContent</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.BuildTx</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.BabbageEra</span></span><span>
</span><span id="line-223"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392600"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span></span><span>
</span><span id="line-224"></span><span id="makeTx"><span class="annot"><span class="annottext">makeTx :: TxBodyContent BuildTx BabbageEra -&gt; m CardanoTx
</span><a href="Cardano.Node.Emulator.Generators.html#makeTx"><span class="hs-identifier hs-var hs-var">makeTx</span></a></span></span><span> </span><span id="local-6989586621679392273"><span class="annot"><span class="annottext">TxBodyContent BuildTx BabbageEra
</span><a href="#local-6989586621679392273"><span class="hs-identifier hs-var">bodyContent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-225"></span><span>    </span><span id="local-6989586621679392272"><span class="annot"><span class="annottext">TxBody BabbageEra
</span><a href="#local-6989586621679392272"><span class="hs-identifier hs-var">txBody</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TxBodyError -&gt; m (TxBody BabbageEra))
-&gt; (TxBody BabbageEra -&gt; m (TxBody BabbageEra))
-&gt; Either TxBodyError (TxBody BabbageEra)
-&gt; m (TxBody BabbageEra)
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; m (TxBody BabbageEra)
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m (TxBody BabbageEra))
-&gt; (TxBodyError -&gt; String) -&gt; TxBodyError -&gt; m (TxBody BabbageEra)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;makeTx: Can't create TxBody: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; (TxBodyError -&gt; String) -&gt; TxBodyError -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxBody BabbageEra -&gt; m (TxBody BabbageEra)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Either TxBodyError (TxBody BabbageEra) -&gt; m (TxBody BabbageEra))
-&gt; Either TxBodyError (TxBody BabbageEra) -&gt; m (TxBody BabbageEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyContent BuildTx BabbageEra
-&gt; Either TxBodyError (TxBody BabbageEra)
forall era.
IsCardanoEra era =&gt;
TxBodyContent BuildTx era -&gt; Either TxBodyError (TxBody era)
</span><span class="hs-identifier hs-var">C.makeTransactionBody</span></span><span> </span><span class="annot"><span class="annottext">TxBodyContent BuildTx BabbageEra
</span><a href="#local-6989586621679392273"><span class="hs-identifier hs-var">bodyContent</span></a></span><span>
</span><span id="line-226"></span><span>    </span><span class="annot"><span class="annottext">CardanoTx -&gt; m CardanoTx
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(CardanoTx -&gt; m CardanoTx) -&gt; CardanoTx -&gt; m CardanoTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoTx -&gt; CardanoTx
</span><a href="Cardano.Node.Emulator.Generators.html#signAll"><span class="hs-identifier hs-var">signAll</span></a></span><span> </span><span class="annot"><span class="annottext">(CardanoTx -&gt; CardanoTx) -&gt; CardanoTx -&gt; CardanoTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Tx BabbageEra -&gt; CardanoTx
</span><span class="hs-identifier hs-var">CardanoEmulatorEraTx</span></span><span> </span><span class="annot"><span class="annottext">(Tx BabbageEra -&gt; CardanoTx) -&gt; Tx BabbageEra -&gt; CardanoTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody BabbageEra -&gt; [KeyWitness BabbageEra] -&gt; Tx BabbageEra
forall era. TxBody era -&gt; [KeyWitness era] -&gt; Tx era
</span><span class="hs-identifier hs-var">C.Tx</span></span><span> </span><span class="annot"><span class="annottext">TxBody BabbageEra
</span><a href="#local-6989586621679392272"><span class="hs-identifier hs-var">txBody</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">-- | Generate a valid transaction, using the unspent outputs provided.</span><span>
</span><span id="line-229"></span><span class="hs-comment">--   Fails if the there are no unspent outputs, or if the total value</span><span>
</span><span id="line-230"></span><span class="hs-comment">--   of the unspent outputs is smaller than the estimated fee.</span><span>
</span><span id="line-231"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionBody%27"><span class="hs-identifier hs-type">genValidTransactionBody'</span></a></span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#GeneratorModel"><span class="hs-identifier hs-type">GeneratorModel</span></a></span><span>
</span><span id="line-233"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-type">Mockchain</span></a></span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.TxBodyContent</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.BuildTx</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.BabbageEra</span></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span id="genValidTransactionBody%27"><span class="annot"><span class="annottext">genValidTransactionBody' :: GeneratorModel
-&gt; Mockchain -&gt; Gen (TxBodyContent BuildTx BabbageEra)
</span><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionBody%27"><span class="hs-identifier hs-var hs-var">genValidTransactionBody'</span></a></span></span><span> </span><span id="local-6989586621679392270"><span class="annot"><span class="annottext">GeneratorModel
</span><a href="#local-6989586621679392270"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-type">Mockchain</span></a></span><span> </span><span class="annot"><span class="annottext">[CardanoTx]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679392269"><span class="annot"><span class="annottext">Map TxIn TxOut
</span><a href="#local-6989586621679392269"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="annot"><span class="annottext">Params
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-comment">-- Take a random number of UTXO from the input</span><span>
</span><span id="line-237"></span><span>    </span><span id="local-6989586621679392268"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392268"><span class="hs-identifier hs-var">nUtxo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Map TxIn TxOut -&gt; Bool
forall k a. Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">Map.null</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn TxOut
</span><a href="#local-6989586621679392269"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-238"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">GenT Identity Int
forall (m :: * -&gt; *) a. MonadGen m =&gt; m a
</span><span class="hs-identifier hs-var">Gen.discard</span></span><span>
</span><span id="line-239"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Range Int -&gt; GenT Identity Int
forall (m :: * -&gt; *). MonadGen m =&gt; Range Int -&gt; m Int
</span><span class="hs-identifier hs-var">Gen.int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Range Int
forall a. Integral a =&gt; a -&gt; a -&gt; Range a
</span><span class="hs-identifier hs-var">Range.linear</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxIn TxOut -&gt; Int
forall k a. Map k a -&gt; Int
</span><span class="hs-identifier hs-var">Map.size</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn TxOut
</span><a href="#local-6989586621679392269"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679392262"><span class="annot"><span class="annottext">ins :: [TxIn]
</span><a href="#local-6989586621679392262"><span class="hs-identifier hs-var hs-var">ins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TxIn, TxOut) -&gt; TxIn
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((TxIn, TxOut) -&gt; TxIn) -&gt; [(TxIn, TxOut)] -&gt; [TxIn]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[(TxIn, TxOut)]
</span><a href="#local-6989586621679392261"><span class="hs-identifier hs-var">inUTXO</span></a></span><span>
</span><span id="line-241"></span><span>        </span><span id="local-6989586621679392261"><span class="annot"><span class="annottext">inUTXO :: [(TxIn, TxOut)]
</span><a href="#local-6989586621679392261"><span class="hs-identifier hs-var hs-var">inUTXO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [(TxIn, TxOut)] -&gt; [(TxIn, TxOut)]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392268"><span class="hs-identifier hs-var">nUtxo</span></a></span><span> </span><span class="annot"><span class="annottext">([(TxIn, TxOut)] -&gt; [(TxIn, TxOut)])
-&gt; [(TxIn, TxOut)] -&gt; [(TxIn, TxOut)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn TxOut -&gt; [(TxIn, TxOut)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn TxOut
</span><a href="#local-6989586621679392269"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-242"></span><span>        </span><span id="local-6989586621679392258"><span class="annot"><span class="annottext">totalVal :: Value
</span><a href="#local-6989586621679392258"><span class="hs-identifier hs-var hs-var">totalVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((TxIn, TxOut) -&gt; Value) -&gt; [(TxIn, TxOut)] -&gt; Value
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOut -&gt; Value
</span><span class="hs-identifier hs-var">txOutValue</span></span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; Value)
-&gt; ((TxIn, TxOut) -&gt; TxOut) -&gt; (TxIn, TxOut) -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(TxIn, TxOut) -&gt; TxOut
forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(TxIn, TxOut)]
</span><a href="#local-6989586621679392261"><span class="hs-identifier hs-var">inUTXO</span></a></span><span>
</span><span id="line-243"></span><span>    </span><span class="annot"><span class="annottext">GeneratorModel
-&gt; [TxIn] -&gt; Value -&gt; Gen (TxBodyContent BuildTx BabbageEra)
</span><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionBodySpending%27"><span class="hs-identifier hs-var">genValidTransactionBodySpending'</span></a></span><span> </span><span class="annot"><span class="annottext">GeneratorModel
</span><a href="#local-6989586621679392270"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621679392262"><span class="hs-identifier hs-var">ins</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679392258"><span class="hs-identifier hs-var">totalVal</span></a></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionBodySpending%27"><span class="hs-identifier hs-type">genValidTransactionBodySpending'</span></a></span><span>
</span><span id="line-246"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#GeneratorModel"><span class="hs-identifier hs-type">GeneratorModel</span></a></span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">C.TxIn</span></span><span class="hs-special">]</span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Value</span></span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.TxBodyContent</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.BuildTx</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.BabbageEra</span></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span id="genValidTransactionBodySpending%27"><span class="annot"><span class="annottext">genValidTransactionBodySpending' :: GeneratorModel
-&gt; [TxIn] -&gt; Value -&gt; Gen (TxBodyContent BuildTx BabbageEra)
</span><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionBodySpending%27"><span class="hs-identifier hs-var hs-var">genValidTransactionBodySpending'</span></a></span></span><span> </span><span id="local-6989586621679392256"><span class="annot"><span class="annottext">GeneratorModel
</span><a href="#local-6989586621679392256"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679392255"><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621679392255"><span class="hs-identifier hs-var">ins</span></a></span></span><span> </span><span id="local-6989586621679392254"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679392254"><span class="hs-identifier hs-var">totalVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-251"></span><span>    </span><span id="local-6989586621679392253"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679392253"><span class="hs-identifier hs-var">mintAmount</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">toInteger</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Integer) -&gt; GenT Identity Int -&gt; GenT Identity Integer
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Range Int -&gt; GenT Identity Int
forall (m :: * -&gt; *). MonadGen m =&gt; Range Int -&gt; m Int
</span><span class="hs-identifier hs-var">Gen.int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Range Int
forall a. Integral a =&gt; a -&gt; a -&gt; Range a
</span><span class="hs-identifier hs-var">Range.linear</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
forall a. Bounded a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maxBound</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>    </span><span id="local-6989586621679392251"><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679392251"><span class="hs-identifier hs-var">mintTokenName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen AssetName
</span><span class="hs-identifier hs-var">Gen.genAssetName</span></span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679392250"><span class="annot"><span class="annottext">mintValue :: Maybe Value
</span><a href="#local-6989586621679392250"><span class="hs-identifier hs-var hs-var">mintValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679392253"><span class="hs-identifier hs-var">mintAmount</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe () -&gt; Value -&gt; Maybe Value
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">AssetName -&gt; Integer -&gt; Value
</span><a href="Cardano.Node.Emulator.Generators.html#someTokenValue"><span class="hs-identifier hs-var">someTokenValue</span></a></span><span> </span><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679392251"><span class="hs-identifier hs-var">mintTokenName</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679392253"><span class="hs-identifier hs-var">mintAmount</span></a></span><span>
</span><span id="line-254"></span><span>        </span><span id="local-6989586621679392249"><span class="annot"><span class="annottext">fee' :: Lovelace
</span><a href="#local-6989586621679392249"><span class="hs-identifier hs-var hs-var">fee'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Lovelace
</span><span class="hs-identifier hs-var">C.Lovelace</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">300000</span></span><span>
</span><span id="line-255"></span><span>        </span><span id="local-6989586621679392248"><span class="annot"><span class="annottext">numOut :: Int
</span><a href="#local-6989586621679392248"><span class="hs-identifier hs-var hs-var">numOut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set PaymentPubKey -&gt; Int
forall a. Set a -&gt; Int
</span><span class="hs-identifier hs-var">Set.size</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeneratorModel -&gt; Set PaymentPubKey
</span><a href="Cardano.Node.Emulator.Generators.html#gmPubKeys"><span class="hs-identifier hs-var hs-var">gmPubKeys</span></a></span><span> </span><span class="annot"><span class="annottext">GeneratorModel
</span><a href="#local-6989586621679392256"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-256"></span><span>        </span><span id="local-6989586621679392246"><span class="annot"><span class="annottext">totalValAda :: Lovelace
</span><a href="#local-6989586621679392246"><span class="hs-identifier hs-var hs-var">totalValAda</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Lovelace
</span><span class="hs-identifier hs-var">C.selectLovelace</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679392254"><span class="hs-identifier hs-var">totalVal</span></a></span><span>
</span><span id="line-257"></span><span>        </span><span id="local-6989586621679392244"><span class="annot"><span class="annottext">totalValTokens :: Maybe Value
</span><a href="#local-6989586621679392244"><span class="hs-identifier hs-var hs-var">totalValTokens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Bool
</span><span class="hs-identifier hs-var">Value.isZero</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Value
</span><span class="hs-identifier hs-var">Value.noAdaValue</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679392254"><span class="hs-identifier hs-var">totalVal</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe () -&gt; Value -&gt; Maybe Value
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value
</span><span class="hs-identifier hs-var">Value.noAdaValue</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679392254"><span class="hs-identifier hs-var">totalVal</span></a></span><span>
</span><span id="line-258"></span><span>        </span><span id="local-6989586621679392241"><span class="annot"><span class="annottext">canPayTheFees :: Bool
</span><a href="#local-6989586621679392241"><span class="hs-identifier hs-var hs-var">canPayTheFees</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679392249"><span class="hs-identifier hs-var">fee'</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Lovelace -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679392246"><span class="hs-identifier hs-var">totalValAda</span></a></span><span>
</span><span id="line-259"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; GenT Identity ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679392241"><span class="hs-identifier hs-var">canPayTheFees</span></a></span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-comment">-- We only split the Ada part of the input value</span><span>
</span><span id="line-261"></span><span>    </span><span id="local-6989586621679392239"><span class="annot"><span class="annottext">[Lovelace]
</span><a href="#local-6989586621679392239"><span class="hs-identifier hs-var">splitOutVals</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Lovelace -&gt; GenT Identity [Lovelace]
forall (m :: * -&gt; *) n.
(MonadGen m, Integral n) =&gt;
Int -&gt; n -&gt; m [n]
</span><a href="Cardano.Node.Emulator.Generators.html#splitVal"><span class="hs-identifier hs-var">splitVal</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392248"><span class="hs-identifier hs-var">numOut</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679392246"><span class="hs-identifier hs-var">totalValAda</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Lovelace -&gt; Lovelace
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679392249"><span class="hs-identifier hs-var">fee'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679392238"><span class="annot"><span class="annottext">outVals :: [Value]
</span><a href="#local-6989586621679392238"><span class="hs-identifier hs-var hs-var">outVals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621679392244"><span class="hs-identifier hs-var">totalValTokens</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Value -&gt; Maybe Value -&gt; Maybe Value
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621679392250"><span class="hs-identifier hs-var">mintValue</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-263"></span><span>            </span><span class="annot"><span class="annottext">Maybe Value
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Value
</span><span class="hs-identifier hs-var">Value.lovelaceToValue</span></span><span> </span><span class="annot"><span class="annottext">(Lovelace -&gt; Value) -&gt; [Lovelace] -&gt; [Value]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Lovelace]
</span><a href="#local-6989586621679392239"><span class="hs-identifier hs-var">splitOutVals</span></a></span><span>
</span><span id="line-264"></span><span>            </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679392237"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679392237"><span class="hs-identifier hs-var">mv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-265"></span><span>                </span><span class="hs-comment">-- If there is a minted value, we look for a value in the</span><span>
</span><span id="line-266"></span><span>                </span><span class="hs-comment">-- splitted values which can be associated with it.</span><span>
</span><span id="line-267"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679392236"><span class="annot"><span class="annottext">outValForMint :: Lovelace
</span><a href="#local-6989586621679392236"><span class="hs-identifier hs-var hs-var">outValForMint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-268"></span><span>                        </span><span class="annot"><span class="annottext">Lovelace -&gt; Maybe Lovelace -&gt; Lovelace
forall a. a -&gt; Maybe a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Lovelace -&gt; Lovelace) -&gt; Maybe Lovelace -&gt; Lovelace
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Lovelace -&gt; Bool) -&gt; [Lovelace] -&gt; Maybe Lovelace
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">List.find</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lovelace -&gt; Lovelace -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><span class="hs-identifier hs-var">Ledger.minLovelaceTxOutEstimated</span></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>                                         </span><span class="annot"><span class="annottext">([Lovelace] -&gt; Maybe Lovelace) -&gt; [Lovelace] -&gt; Maybe Lovelace
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Lovelace] -&gt; [Lovelace]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">List.sort</span></a></span><span> </span><span class="annot"><span class="annottext">[Lovelace]
</span><a href="#local-6989586621679392239"><span class="hs-identifier hs-var">splitOutVals</span></a></span><span>
</span><span id="line-270"></span><span>                </span><span class="annot"><span class="annottext">Lovelace -&gt; Value
</span><span class="hs-identifier hs-var">Value.lovelaceToValue</span></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679392236"><span class="hs-identifier hs-var">outValForMint</span></a></span><span>
</span><span id="line-271"></span><span>                    </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; Value
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679392237"><span class="hs-identifier hs-var">mv</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; [Value] -&gt; [Value]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">(Lovelace -&gt; Value) -&gt; [Lovelace] -&gt; [Value]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Value
</span><span class="hs-identifier hs-var">Value.lovelaceToValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lovelace -&gt; [Lovelace] -&gt; [Lovelace]
forall a. Eq a =&gt; a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">List.delete</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679392236"><span class="hs-identifier hs-var">outValForMint</span></a></span><span> </span><span class="annot"><span class="annottext">[Lovelace]
</span><a href="#local-6989586621679392239"><span class="hs-identifier hs-var">splitOutVals</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>    </span><span id="local-6989586621679392233"><span class="annot"><span class="annottext">[PaymentPubKey]
</span><a href="#local-6989586621679392233"><span class="hs-identifier hs-var">pubKeys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[PaymentPubKey] -&gt; GenT Identity [PaymentPubKey]
forall (m :: * -&gt; *) a. MonadGen m =&gt; [a] -&gt; m [a]
</span><span class="hs-identifier hs-var">Gen.shuffle</span></span><span> </span><span class="annot"><span class="annottext">([PaymentPubKey] -&gt; GenT Identity [PaymentPubKey])
-&gt; [PaymentPubKey] -&gt; GenT Identity [PaymentPubKey]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Set PaymentPubKey -&gt; [PaymentPubKey]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">(Set PaymentPubKey -&gt; [PaymentPubKey])
-&gt; Set PaymentPubKey -&gt; [PaymentPubKey]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">GeneratorModel -&gt; Set PaymentPubKey
</span><a href="Cardano.Node.Emulator.Generators.html#gmPubKeys"><span class="hs-identifier hs-var hs-var">gmPubKeys</span></a></span><span> </span><span class="annot"><span class="annottext">GeneratorModel
</span><a href="#local-6989586621679392256"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679392230"><span class="annot"><span class="annottext">txOutputs :: [TxOut]
</span><a href="#local-6989586621679392230"><span class="hs-identifier hs-var hs-var">txOutputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ToCardanoError -&gt; [TxOut])
-&gt; ([TxOut] -&gt; [TxOut]) -&gt; Either ToCardanoError [TxOut] -&gt; [TxOut]
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [TxOut]
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; [TxOut])
-&gt; (ToCardanoError -&gt; String) -&gt; ToCardanoError -&gt; [TxOut]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot create outputs: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; (ToCardanoError -&gt; String) -&gt; ToCardanoError -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ToCardanoError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TxOut] -&gt; [TxOut]
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-274"></span><span>                    </span><span class="annot"><span class="annottext">(Either ToCardanoError [TxOut] -&gt; [TxOut])
-&gt; Either ToCardanoError [TxOut] -&gt; [TxOut]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((Value, PaymentPubKey) -&gt; Either ToCardanoError TxOut)
-&gt; [(Value, PaymentPubKey)] -&gt; Either ToCardanoError [TxOut]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679392228"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679392228"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679392227"><span class="annot"><span class="annottext">PaymentPubKey
</span><a href="#local-6989586621679392227"><span class="hs-identifier hs-var">ppk</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Value
-&gt; PaymentPubKey
-&gt; Maybe StakingCredential
-&gt; Either ToCardanoError TxOut
</span><a href="Cardano.Node.Emulator.Generators.html#pubKeyTxOut"><span class="hs-identifier hs-var">pubKeyTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679392228"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentPubKey
</span><a href="#local-6989586621679392227"><span class="hs-identifier hs-var">ppk</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe StakingCredential
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>                    </span><span class="annot"><span class="annottext">([(Value, PaymentPubKey)] -&gt; Either ToCardanoError [TxOut])
-&gt; [(Value, PaymentPubKey)] -&gt; Either ToCardanoError [TxOut]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; [PaymentPubKey] -&gt; [(Value, PaymentPubKey)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679392238"><span class="hs-identifier hs-var">outVals</span></a></span><span> </span><span class="annot"><span class="annottext">[PaymentPubKey]
</span><a href="#local-6989586621679392233"><span class="hs-identifier hs-var">pubKeys</span></a></span><span>
</span><span id="line-276"></span><span>    </span><span id="local-6989586621679392225"><span class="annot"><span class="annottext">ScriptWitness WitCtxMint BabbageEra
</span><a href="#local-6989586621679392225"><span class="hs-identifier hs-var">mintWitness</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra)
-&gt; GenT Identity (ScriptWitness WitCtxMint BabbageEra)
forall (m :: * -&gt; *) a.
MonadFail m =&gt;
Either ToCardanoError a -&gt; m a
</span><a href="Cardano.Node.Emulator.Generators.html#failOnCardanoError"><span class="hs-identifier hs-var">failOnCardanoError</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra)
 -&gt; GenT Identity (ScriptWitness WitCtxMint BabbageEra))
-&gt; Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra)
-&gt; GenT Identity (ScriptWitness WitCtxMint BabbageEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptLanguageInEra PlutusScriptV2 BabbageEra
-&gt; PlutusScriptVersion PlutusScriptV2
-&gt; PlutusScriptOrReferenceInput PlutusScriptV2
-&gt; ScriptDatum WitCtxMint
-&gt; ScriptRedeemer
-&gt; ExecutionUnits
-&gt; ScriptWitness WitCtxMint BabbageEra
forall lang era witctx.
ScriptLanguageInEra lang era
-&gt; PlutusScriptVersion lang
-&gt; PlutusScriptOrReferenceInput lang
-&gt; ScriptDatum witctx
-&gt; ScriptRedeemer
-&gt; ExecutionUnits
-&gt; ScriptWitness witctx era
</span><span class="hs-identifier hs-var">C.PlutusScriptWitness</span></span><span> </span><span class="annot"><span class="annottext">ScriptLanguageInEra PlutusScriptV2 BabbageEra
</span><span class="hs-identifier hs-var">C.PlutusScriptV2InBabbage</span></span><span> </span><span class="annot"><span class="annottext">PlutusScriptVersion PlutusScriptV2
</span><span class="hs-identifier hs-var">C.PlutusScriptV2</span></span><span>
</span><span id="line-277"></span><span>                           </span><span class="annot"><span class="annottext">(PlutusScriptOrReferenceInput PlutusScriptV2
 -&gt; ScriptDatum WitCtxMint
 -&gt; ScriptRedeemer
 -&gt; ExecutionUnits
 -&gt; ScriptWitness WitCtxMint BabbageEra)
-&gt; Either
     ToCardanoError (PlutusScriptOrReferenceInput PlutusScriptV2)
-&gt; Either
     ToCardanoError
     (ScriptDatum WitCtxMint
      -&gt; ScriptRedeemer
      -&gt; ExecutionUnits
      -&gt; ScriptWitness WitCtxMint BabbageEra)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlutusScript PlutusScriptV2
-&gt; PlutusScriptOrReferenceInput PlutusScriptV2
forall lang. PlutusScript lang -&gt; PlutusScriptOrReferenceInput lang
</span><span class="hs-identifier hs-var">C.PScript</span></span><span> </span><span class="annot"><span class="annottext">(PlutusScript PlutusScriptV2
 -&gt; PlutusScriptOrReferenceInput PlutusScriptV2)
-&gt; Either ToCardanoError (PlutusScript PlutusScriptV2)
-&gt; Either
     ToCardanoError (PlutusScriptOrReferenceInput PlutusScriptV2)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">AsType (PlutusScript PlutusScriptV2)
-&gt; Script -&gt; Either ToCardanoError (PlutusScript PlutusScriptV2)
forall plutusScript.
SerialiseAsRawBytes plutusScript =&gt;
AsType plutusScript -&gt; Script -&gt; Either ToCardanoError plutusScript
</span><span class="hs-identifier hs-var">C.toCardanoPlutusScript</span></span><span>
</span><span id="line-278"></span><span>                                                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AsType PlutusScriptV2 -&gt; AsType (PlutusScript PlutusScriptV2)
forall lang. AsType lang -&gt; AsType (PlutusScript lang)
</span><span class="hs-identifier hs-var">C.AsPlutusScript</span></span><span> </span><span class="annot"><span class="annottext">AsType PlutusScriptV2
</span><span class="hs-identifier hs-var">C.AsPlutusScriptV2</span></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>                                                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MintingPolicy -&gt; Script
</span><span class="hs-identifier hs-var hs-var">getMintingPolicy</span></span><span> </span><span class="annot"><span class="annottext">MintingPolicy
</span><a href="Cardano.Node.Emulator.Generators.html#alwaysSucceedPolicy"><span class="hs-identifier hs-var">alwaysSucceedPolicy</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>                           </span><span class="annot"><span class="annottext">Either
  ToCardanoError
  (ScriptDatum WitCtxMint
   -&gt; ScriptRedeemer
   -&gt; ExecutionUnits
   -&gt; ScriptWitness WitCtxMint BabbageEra)
-&gt; Either ToCardanoError (ScriptDatum WitCtxMint)
-&gt; Either
     ToCardanoError
     (ScriptRedeemer
      -&gt; ExecutionUnits -&gt; ScriptWitness WitCtxMint BabbageEra)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptDatum WitCtxMint
-&gt; Either ToCardanoError (ScriptDatum WitCtxMint)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptDatum WitCtxMint
</span><span class="hs-identifier hs-var">C.NoScriptDatumForMint</span></span><span>
</span><span id="line-281"></span><span>                           </span><span class="annot"><span class="annottext">Either
  ToCardanoError
  (ScriptRedeemer
   -&gt; ExecutionUnits -&gt; ScriptWitness WitCtxMint BabbageEra)
-&gt; Either ToCardanoError ScriptRedeemer
-&gt; Either
     ToCardanoError
     (ExecutionUnits -&gt; ScriptWitness WitCtxMint BabbageEra)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptRedeemer -&gt; Either ToCardanoError ScriptRedeemer
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Data -&gt; ScriptRedeemer
</span><span class="hs-identifier hs-var">C.fromPlutusData</span></span><span> </span><span class="annot"><span class="annottext">(Data -&gt; ScriptRedeemer) -&gt; Data -&gt; ScriptRedeemer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Redeemer -&gt; Data
forall a. ToData a =&gt; a -&gt; Data
</span><span class="hs-identifier hs-var">toData</span></span><span> </span><span class="annot"><span class="annottext">Redeemer
</span><span class="hs-identifier hs-var">Script.unitRedeemer</span></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>                           </span><span class="annot"><span class="annottext">Either
  ToCardanoError
  (ExecutionUnits -&gt; ScriptWitness WitCtxMint BabbageEra)
-&gt; Either ToCardanoError ExecutionUnits
-&gt; Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutionUnits -&gt; Either ToCardanoError ExecutionUnits
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutionUnits
</span><span class="hs-identifier hs-var">C.zeroExecutionUnits</span></span><span>
</span><span id="line-283"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679392213"><span class="annot"><span class="annottext">txMintValue :: TxMintValue BuildTx BabbageEra
</span><a href="#local-6989586621679392213"><span class="hs-identifier hs-var hs-var">txMintValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MultiAssetSupportedInEra BabbageEra
-&gt; Value
-&gt; BuildTxWith
     BuildTx (Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
-&gt; TxMintValue BuildTx BabbageEra
forall era build.
MultiAssetSupportedInEra era
-&gt; Value
-&gt; BuildTxWith build (Map PolicyId (ScriptWitness WitCtxMint era))
-&gt; TxMintValue build era
</span><span class="hs-identifier hs-var">C.TxMintValue</span></span><span> </span><span class="annot"><span class="annottext">MultiAssetSupportedInEra BabbageEra
</span><span class="hs-identifier hs-var">C.MultiAssetInBabbageEra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Maybe Value -&gt; Value
forall a. a -&gt; Maybe a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Value
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621679392250"><span class="hs-identifier hs-var">mintValue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>                          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map PolicyId (ScriptWitness WitCtxMint BabbageEra)
-&gt; BuildTxWith
     BuildTx (Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
forall a. a -&gt; BuildTxWith BuildTx a
</span><span class="hs-identifier hs-var">C.BuildTxWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PolicyId
-&gt; ScriptWitness WitCtxMint BabbageEra
-&gt; Map PolicyId (ScriptWitness WitCtxMint BabbageEra)
forall k a. k -&gt; a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.singleton</span></span><span> </span><span class="annot"><span class="annottext">PolicyId
</span><a href="Cardano.Node.Emulator.Generators.html#alwaysSucceedPolicyId"><span class="hs-identifier hs-var">alwaysSucceedPolicyId</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptWitness WitCtxMint BabbageEra
</span><a href="#local-6989586621679392225"><span class="hs-identifier hs-var">mintWitness</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>        </span><span id="local-6989586621679392208"><span class="annot"><span class="annottext">txIns :: [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
</span><a href="#local-6989586621679392208"><span class="hs-identifier hs-var hs-var">txIns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TxIn
 -&gt; (TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra)))
-&gt; [TxIn]
-&gt; [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span> </span><span class="annot"><span class="annottext">Witness WitCtxTxIn BabbageEra
-&gt; BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra)
forall a. a -&gt; BuildTxWith BuildTx a
</span><span class="hs-identifier hs-var">C.BuildTxWith</span></span><span> </span><span class="annot"><span class="annottext">(Witness WitCtxTxIn BabbageEra
 -&gt; BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))
-&gt; Witness WitCtxTxIn BabbageEra
-&gt; BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">KeyWitnessInCtx WitCtxTxIn -&gt; Witness WitCtxTxIn BabbageEra
forall witctx era. KeyWitnessInCtx witctx -&gt; Witness witctx era
</span><span class="hs-identifier hs-var">C.KeyWitness</span></span><span> </span><span class="annot"><span class="annottext">KeyWitnessInCtx WitCtxTxIn
</span><span class="hs-identifier hs-var">C.KeyWitnessForSpending</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621679392255"><span class="hs-identifier hs-var">ins</span></a></span><span>
</span><span id="line-286"></span><span>    </span><span id="local-6989586621679392205"><span class="annot"><span class="annottext">TxInsCollateral BabbageEra
</span><a href="#local-6989586621679392205"><span class="hs-identifier hs-var">txInsCollateral</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenT Identity (TxInsCollateral BabbageEra)
-&gt; (Natural -&gt; GenT Identity (TxInsCollateral BabbageEra))
-&gt; Maybe Natural
-&gt; GenT Identity (TxInsCollateral BabbageEra)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span>
</span><span id="line-287"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; GenT Identity (TxInsCollateral BabbageEra)
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot gen collateral&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxInsCollateral BabbageEra
-&gt; GenT Identity (TxInsCollateral BabbageEra)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(TxInsCollateral BabbageEra
 -&gt; GenT Identity (TxInsCollateral BabbageEra))
-&gt; (Natural -&gt; TxInsCollateral BabbageEra)
-&gt; Natural
-&gt; GenT Identity (TxInsCollateral BabbageEra)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">CollateralSupportedInEra BabbageEra
-&gt; [TxIn] -&gt; TxInsCollateral BabbageEra
forall era.
CollateralSupportedInEra era -&gt; [TxIn] -&gt; TxInsCollateral era
</span><span class="hs-identifier hs-var">C.TxInsCollateral</span></span><span> </span><span class="annot"><span class="annottext">CollateralSupportedInEra BabbageEra
</span><span class="hs-identifier hs-var">C.CollateralInBabbageEra</span></span><span> </span><span class="annot"><span class="annottext">([TxIn] -&gt; TxInsCollateral BabbageEra)
-&gt; (Natural -&gt; [TxIn]) -&gt; Natural -&gt; TxInsCollateral BabbageEra
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; [TxIn] -&gt; [TxIn]) -&gt; [TxIn] -&gt; Int -&gt; [TxIn]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [TxIn] -&gt; [TxIn]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621679392255"><span class="hs-identifier hs-var">ins</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; [TxIn]) -&gt; (Natural -&gt; Int) -&gt; Natural -&gt; [TxIn]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeneratorModel -&gt; Maybe Natural
</span><a href="Cardano.Node.Emulator.Generators.html#gmMaxCollateralInputs"><span class="hs-identifier hs-var hs-var">gmMaxCollateralInputs</span></a></span><span> </span><span class="annot"><span class="annottext">GeneratorModel
</span><a href="#local-6989586621679392256"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>    </span><span class="annot"><span class="annottext">TxBodyContent BuildTx BabbageEra
-&gt; Gen (TxBodyContent BuildTx BabbageEra)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(TxBodyContent BuildTx BabbageEra
 -&gt; Gen (TxBodyContent BuildTx BabbageEra))
-&gt; TxBodyContent BuildTx BabbageEra
-&gt; Gen (TxBodyContent BuildTx BabbageEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyContent BuildTx BabbageEra
</span><span class="hs-identifier hs-var">Tx.emptyTxBodyContent</span></span><span>
</span><span id="line-291"></span><span>           </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">[(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
txIns :: [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
txIns :: [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
</span><span class="hs-identifier hs-var hs-var">C.txIns</span></span><span>
</span><span id="line-292"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxInsCollateral BabbageEra
txInsCollateral :: TxInsCollateral BabbageEra
txInsCollateral :: TxInsCollateral BabbageEra
</span><span class="hs-identifier hs-var hs-var">C.txInsCollateral</span></span><span>
</span><span id="line-293"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxMintValue BuildTx BabbageEra
txMintValue :: TxMintValue BuildTx BabbageEra
txMintValue :: TxMintValue BuildTx BabbageEra
</span><span class="hs-identifier hs-var hs-var">C.txMintValue</span></span><span>
</span><span id="line-294"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txFee :: TxFee BabbageEra
</span><span class="hs-identifier hs-var">C.txFee</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; TxFee BabbageEra
</span><span class="hs-identifier hs-var">C.toCardanoFee</span></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679392249"><span class="hs-identifier hs-var">fee'</span></a></span><span>
</span><span id="line-295"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txOuts :: [TxOut CtxTx BabbageEra]
</span><span class="hs-identifier hs-var">C.txOuts</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; TxOut CtxTx BabbageEra
</span><span class="hs-identifier hs-var hs-var">Tx.getTxOut</span></span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; TxOut CtxTx BabbageEra)
-&gt; [TxOut] -&gt; [TxOut CtxTx BabbageEra]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut]
</span><a href="#local-6989586621679392230"><span class="hs-identifier hs-var">txOutputs</span></a></span><span>
</span><span id="line-296"></span><span>           </span><span class="hs-special">}</span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="hs-comment">-- | Create a transaction output locked by a public payment key and optionnaly a public stake key.</span><span>
</span><span id="line-299"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#pubKeyTxOut"><span class="hs-identifier hs-type">pubKeyTxOut</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PaymentPubKey</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">V1.StakingCredential</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToCardanoError</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span>
</span><span id="line-300"></span><span id="pubKeyTxOut"><span class="annot"><span class="annottext">pubKeyTxOut :: Value
-&gt; PaymentPubKey
-&gt; Maybe StakingCredential
-&gt; Either ToCardanoError TxOut
</span><a href="Cardano.Node.Emulator.Generators.html#pubKeyTxOut"><span class="hs-identifier hs-var hs-var">pubKeyTxOut</span></a></span></span><span> </span><span id="local-6989586621679392195"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679392195"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679392194"><span class="annot"><span class="annottext">PaymentPubKey
</span><a href="#local-6989586621679392194"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span id="local-6989586621679392193"><span class="annot"><span class="annottext">Maybe StakingCredential
</span><a href="#local-6989586621679392193"><span class="hs-identifier hs-var">sk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-301"></span><span>  </span><span id="local-6989586621679392192"><span class="annot"><span class="annottext">AddressInEra BabbageEra
</span><a href="#local-6989586621679392192"><span class="hs-identifier hs-var">aie</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NetworkId
-&gt; Address -&gt; Either ToCardanoError (AddressInEra BabbageEra)
</span><span class="hs-identifier hs-var">C.toCardanoAddressInEra</span></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><span class="hs-identifier hs-var">testnet</span></span><span> </span><span class="annot"><span class="annottext">(Address -&gt; Either ToCardanoError (AddressInEra BabbageEra))
-&gt; Address -&gt; Either ToCardanoError (AddressInEra BabbageEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentPubKey -&gt; Maybe StakingCredential -&gt; Address
</span><span class="hs-identifier hs-var">pubKeyAddress</span></span><span> </span><span class="annot"><span class="annottext">PaymentPubKey
</span><a href="#local-6989586621679392194"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe StakingCredential
</span><a href="#local-6989586621679392193"><span class="hs-identifier hs-var">sk</span></a></span><span>
</span><span id="line-302"></span><span>  </span><span class="annot"><span class="annottext">TxOut -&gt; Either ToCardanoError TxOut
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; Either ToCardanoError TxOut)
-&gt; TxOut -&gt; Either ToCardanoError TxOut
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut CtxTx BabbageEra -&gt; TxOut
</span><span class="hs-identifier hs-var">Tx.TxOut</span></span><span> </span><span class="annot"><span class="annottext">(TxOut CtxTx BabbageEra -&gt; TxOut)
-&gt; TxOut CtxTx BabbageEra -&gt; TxOut
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AddressInEra BabbageEra
-&gt; TxOutValue BabbageEra
-&gt; TxOutDatum CtxTx BabbageEra
-&gt; ReferenceScript BabbageEra
-&gt; TxOut CtxTx BabbageEra
forall ctx era.
AddressInEra era
-&gt; TxOutValue era
-&gt; TxOutDatum ctx era
-&gt; ReferenceScript era
-&gt; TxOut ctx era
</span><span class="hs-identifier hs-var">C.TxOut</span></span><span> </span><span class="annot"><span class="annottext">AddressInEra BabbageEra
</span><a href="#local-6989586621679392192"><span class="hs-identifier hs-var">aie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; TxOutValue BabbageEra
</span><span class="hs-identifier hs-var">C.toCardanoTxOutValue</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679392195"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxOutDatum CtxTx BabbageEra
forall ctx era. TxOutDatum ctx era
</span><span class="hs-identifier hs-var">C.TxOutDatumNone</span></span><span> </span><span class="annot"><span class="annottext">ReferenceScript BabbageEra
forall era. ReferenceScript era
</span><span class="hs-identifier hs-var">C.ReferenceScriptNone</span></span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="hs-comment">-- | Validate a transaction in a mockchain.</span><span>
</span><span id="line-305"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#validateMockchain"><span class="hs-identifier hs-type">validateMockchain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-type">Mockchain</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.ValidationErrorInPhase</span></span><span>
</span><span id="line-306"></span><span id="validateMockchain"><span class="annot"><span class="annottext">validateMockchain :: Mockchain -&gt; CardanoTx -&gt; Maybe ValidationErrorInPhase
</span><a href="Cardano.Node.Emulator.Generators.html#validateMockchain"><span class="hs-identifier hs-var hs-var">validateMockchain</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-type">Mockchain</span></a></span><span> </span><span class="annot"><span class="annottext">[CardanoTx]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679392187"><span class="annot"><span class="annottext">Map TxIn TxOut
</span><a href="#local-6989586621679392187"><span class="hs-identifier hs-var">utxo</span></a></span></span><span> </span><span id="local-6989586621679392186"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679392186"><span class="hs-identifier hs-var">params</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679392185"><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621679392185"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ValidationErrorInPhase
</span><a href="#local-6989586621679392184"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-307"></span><span>    </span><span id="local-6989586621679392183"><span class="annot"><span class="annottext">cUtxoIndex :: UTxO BabbageEra
</span><a href="#local-6989586621679392183"><span class="hs-identifier hs-var hs-var">cUtxoIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO BabbageEra) -&gt; UTxO BabbageEra
forall era. Map TxIn (TxOut CtxUTxO era) -&gt; UTxO era
</span><span class="hs-identifier hs-var">C.UTxO</span></span><span> </span><span class="annot"><span class="annottext">(Map TxIn (TxOut CtxUTxO BabbageEra) -&gt; UTxO BabbageEra)
-&gt; Map TxIn (TxOut CtxUTxO BabbageEra) -&gt; UTxO BabbageEra
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; TxOut CtxUTxO BabbageEra
</span><span class="hs-identifier hs-var">Tx.toCtxUTxOTxOut</span></span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; TxOut CtxUTxO BabbageEra)
-&gt; Map TxIn TxOut -&gt; Map TxIn (TxOut CtxUTxO BabbageEra)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn TxOut
</span><a href="#local-6989586621679392187"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-308"></span><span>    </span><span id="local-6989586621679392184"><span class="annot"><span class="annottext">result :: Maybe ValidationErrorInPhase
</span><a href="#local-6989586621679392184"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Params -&gt; Slot -&gt; UTxO BabbageEra -&gt; CardanoTx -&gt; ValidationResult
</span><a href="Cardano.Node.Emulator.Internal.Node.Validation.html#validateCardanoTx"><span class="hs-identifier hs-var">validateCardanoTx</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679392186"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">UTxO BabbageEra
</span><a href="#local-6989586621679392183"><span class="hs-identifier hs-var">cUtxoIndex</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621679392185"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-309"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">FailPhase1</span></span><span> </span><span class="annot"><span class="annottext">CardanoTx
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679392180"><span class="annot"><span class="annottext">ValidationError
</span><a href="#local-6989586621679392180"><span class="hs-identifier hs-var">err</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ValidationErrorInPhase -&gt; Maybe ValidationErrorInPhase
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ValidationPhase
</span><span class="hs-identifier hs-var">Phase1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ValidationError
</span><a href="#local-6989586621679392180"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">FailPhase2</span></span><span> </span><span class="annot"><span class="annottext">OnChainTx
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679392179"><span class="annot"><span class="annottext">ValidationError
</span><a href="#local-6989586621679392179"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ValidationErrorInPhase -&gt; Maybe ValidationErrorInPhase
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ValidationPhase
</span><span class="hs-identifier hs-var">Phase2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ValidationError
</span><a href="#local-6989586621679392179"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>        </span><span class="annot"><span class="annottext">ValidationResult
</span><span class="hs-identifier">_</span></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ValidationErrorInPhase
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="hs-comment">-- | Generate an 'Interval where the lower bound if less or equal than the</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- upper bound.</span><span>
</span><span id="line-315"></span><span id="local-6989586621679392468"><span id="local-6989586621679392469"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genInterval"><span class="hs-identifier hs-type">genInterval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadFail</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392469"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392468"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392469"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392468"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-317"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392469"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Interval</span></span><span> </span><span class="annot"><a href="#local-6989586621679392468"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-318"></span><span id="genInterval"><span class="annot"><span class="annottext">genInterval :: m a -&gt; m (Interval a)
</span><a href="Cardano.Node.Emulator.Generators.html#genInterval"><span class="hs-identifier hs-var hs-var">genInterval</span></a></span></span><span> </span><span id="local-6989586621679392178"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679392178"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-319"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621679392177"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392177"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679392176"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392176"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">sort</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; m [a] -&gt; m [a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; m a -&gt; m [a]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">replicateM</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679392178"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-320"></span><span>    </span><span class="annot"><span class="annottext">Interval a -&gt; m (Interval a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Interval a -&gt; m (Interval a)) -&gt; Interval a -&gt; m (Interval a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Interval a
forall a. a -&gt; a -&gt; Interval a
</span><span class="hs-identifier hs-var">Interval.interval</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392177"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392176"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="hs-comment">-- | Generate a 'SlotRange' where the lower bound if less or equal than the</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- upper bound.</span><span>
</span><span id="line-324"></span><span id="local-6989586621679392174"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genSlotRange"><span class="hs-identifier hs-type">genSlotRange</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadFail</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392174"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Hedgehog.MonadGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679392174"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392174"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotRange</span></span></span><span>
</span><span id="line-325"></span><span id="genSlotRange"><span class="annot"><span class="annottext">genSlotRange :: m SlotRange
</span><a href="Cardano.Node.Emulator.Generators.html#genSlotRange"><span class="hs-identifier hs-var hs-var">genSlotRange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Slot -&gt; m SlotRange
forall (m :: * -&gt; *) a.
(MonadFail m, Ord a) =&gt;
m a -&gt; m (Interval a)
</span><a href="Cardano.Node.Emulator.Generators.html#genInterval"><span class="hs-identifier hs-var">genInterval</span></a></span><span> </span><span class="annot"><span class="annottext">m Slot
forall (m :: * -&gt; *). MonadGen m =&gt; m Slot
</span><a href="Cardano.Node.Emulator.Generators.html#genSlot"><span class="hs-identifier hs-var">genSlot</span></a></span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span class="hs-comment">-- | Generate a 'POSIXTimeRange' where the lower bound if less or equal than the</span><span>
</span><span id="line-328"></span><span class="hs-comment">-- upper bound.</span><span>
</span><span id="line-329"></span><span id="local-6989586621679392173"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genTimeRange"><span class="hs-identifier hs-type">genTimeRange</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadFail</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392173"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Hedgehog.MonadGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679392173"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Internal.Node.TimeSlot.html#SlotConfig"><span class="hs-identifier hs-type">SlotConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392173"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">POSIXTimeRange</span></span></span><span>
</span><span id="line-330"></span><span id="genTimeRange"><span class="annot"><span class="annottext">genTimeRange :: SlotConfig -&gt; m POSIXTimeRange
</span><a href="Cardano.Node.Emulator.Generators.html#genTimeRange"><span class="hs-identifier hs-var hs-var">genTimeRange</span></a></span></span><span> </span><span id="local-6989586621679392172"><span class="annot"><span class="annottext">SlotConfig
</span><a href="#local-6989586621679392172"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m POSIXTime -&gt; m POSIXTimeRange
forall (m :: * -&gt; *) a.
(MonadFail m, Ord a) =&gt;
m a -&gt; m (Interval a)
</span><a href="Cardano.Node.Emulator.Generators.html#genInterval"><span class="hs-identifier hs-var">genInterval</span></a></span><span> </span><span class="annot"><span class="annottext">(m POSIXTime -&gt; m POSIXTimeRange)
-&gt; m POSIXTime -&gt; m POSIXTimeRange
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SlotConfig -&gt; m POSIXTime
forall (m :: * -&gt; *). MonadGen m =&gt; SlotConfig -&gt; m POSIXTime
</span><a href="Cardano.Node.Emulator.Generators.html#genPOSIXTime"><span class="hs-identifier hs-var">genPOSIXTime</span></a></span><span> </span><span class="annot"><span class="annottext">SlotConfig
</span><a href="#local-6989586621679392172"><span class="hs-identifier hs-var">sc</span></a></span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span class="hs-comment">-- | Generate a 'Slot' where the lowest slot number is 0.</span><span>
</span><span id="line-333"></span><span id="local-6989586621679392467"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genSlot"><span class="hs-identifier hs-type">genSlot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Hedgehog.MonadGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679392467"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392467"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Slot</span></span></span><span>
</span><span id="line-334"></span><span id="genSlot"><span class="annot"><span class="annottext">genSlot :: m Slot
</span><a href="Cardano.Node.Emulator.Generators.html#genSlot"><span class="hs-identifier hs-var hs-var">genSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Slot
</span><span class="hs-identifier hs-var">Slot</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Slot) -&gt; m Integer -&gt; m Slot
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Range Integer -&gt; m Integer
forall (m :: * -&gt; *) a. (MonadGen m, Integral a) =&gt; Range a -&gt; m a
</span><span class="hs-identifier hs-var">Gen.integral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Range Integer
forall a. Integral a =&gt; a -&gt; a -&gt; Range a
</span><span class="hs-identifier hs-var">Range.linear</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10000</span></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="hs-comment">-- | Generate a 'POSIXTime' where the lowest value is 'scSlotZeroTime' given a</span><span>
</span><span id="line-337"></span><span class="hs-comment">-- 'SlotConfig'.</span><span>
</span><span id="line-338"></span><span id="local-6989586621679392463"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genPOSIXTime"><span class="hs-identifier hs-type">genPOSIXTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Hedgehog.MonadGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679392463"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Internal.Node.TimeSlot.html#SlotConfig"><span class="hs-identifier hs-type">SlotConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392463"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">POSIXTime</span></span></span><span>
</span><span id="line-339"></span><span id="genPOSIXTime"><span class="annot"><span class="annottext">genPOSIXTime :: SlotConfig -&gt; m POSIXTime
</span><a href="Cardano.Node.Emulator.Generators.html#genPOSIXTime"><span class="hs-identifier hs-var hs-var">genPOSIXTime</span></a></span></span><span> </span><span id="local-6989586621679392170"><span class="annot"><span class="annottext">SlotConfig
</span><a href="#local-6989586621679392170"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-340"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679392169"><span class="annot"><span class="annottext">beginTime :: Integer
</span><a href="#local-6989586621679392169"><span class="hs-identifier hs-var hs-var">beginTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; Integer
</span><span class="hs-identifier hs-var hs-var">getPOSIXTime</span></span><span> </span><span class="annot"><span class="annottext">(POSIXTime -&gt; Integer) -&gt; POSIXTime -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SlotConfig -&gt; POSIXTime
</span><a href="Cardano.Node.Emulator.Internal.Node.TimeSlot.html#scSlotZeroTime"><span class="hs-identifier hs-var hs-var">TimeSlot.scSlotZeroTime</span></a></span><span> </span><span class="annot"><span class="annottext">SlotConfig
</span><a href="#local-6989586621679392170"><span class="hs-identifier hs-var">sc</span></a></span><span>
</span><span id="line-341"></span><span>    </span><span class="annot"><span class="annottext">Integer -&gt; POSIXTime
</span><span class="hs-identifier hs-var">POSIXTime</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; POSIXTime) -&gt; m Integer -&gt; m POSIXTime
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Range Integer -&gt; m Integer
forall (m :: * -&gt; *) a. (MonadGen m, Integral a) =&gt; Range a -&gt; m a
</span><span class="hs-identifier hs-var">Gen.integral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Range Integer
forall a. Integral a =&gt; a -&gt; a -&gt; Range a
</span><span class="hs-identifier hs-var">Range.linear</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679392169"><span class="hs-identifier hs-var">beginTime</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679392169"><span class="hs-identifier hs-var">beginTime</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10000000</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span class="hs-comment">-- | Generate a 'SlotConfig' where the slot length goes from 1 to 100000</span><span>
</span><span id="line-344"></span><span class="hs-comment">-- ms and the time of Slot 0 is the default 'scSlotZeroTime'.</span><span>
</span><span id="line-345"></span><span id="local-6989586621679392647"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genSlotConfig"><span class="hs-identifier hs-type">genSlotConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Hedgehog.MonadGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679392647"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392647"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Internal.Node.TimeSlot.html#SlotConfig"><span class="hs-identifier hs-type">SlotConfig</span></a></span></span><span>
</span><span id="line-346"></span><span id="genSlotConfig"><span class="annot"><span class="annottext">genSlotConfig :: m SlotConfig
</span><a href="Cardano.Node.Emulator.Generators.html#genSlotConfig"><span class="hs-identifier hs-var hs-var">genSlotConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-347"></span><span>    </span><span id="local-6989586621679392166"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679392166"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Range Integer -&gt; m Integer
forall (m :: * -&gt; *) a. (MonadGen m, Integral a) =&gt; Range a -&gt; m a
</span><span class="hs-identifier hs-var">Gen.integral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Range Integer
forall a. Integral a =&gt; a -&gt; a -&gt; Range a
</span><span class="hs-identifier hs-var">Range.linear</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1000000</span></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>    </span><span class="annot"><span class="annottext">SlotConfig -&gt; m SlotConfig
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(SlotConfig -&gt; m SlotConfig) -&gt; SlotConfig -&gt; m SlotConfig
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SlotConfig
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">scSlotLength :: Integer
</span><a href="Cardano.Node.Emulator.Internal.Node.TimeSlot.html#scSlotLength"><span class="hs-identifier hs-var">TimeSlot.scSlotLength</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679392166"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span class="hs-comment">-- | Generate a 'ByteString s' of up to @s@ bytes.</span><span>
</span><span id="line-351"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genSizedByteString"><span class="hs-identifier hs-type">genSizedByteString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679392164"><span class="annot"><a href="#local-6989586621679392164"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679392164"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392164"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span>
</span><span id="line-352"></span><span id="genSizedByteString"><span class="annot"><span class="annottext">genSizedByteString :: Int -&gt; m ByteString
</span><a href="Cardano.Node.Emulator.Generators.html#genSizedByteString"><span class="hs-identifier hs-var hs-var">genSizedByteString</span></a></span></span><span> </span><span id="local-6989586621679392163"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392163"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-353"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679392162"><span class="annot"><span class="annottext">range :: Range Int
</span><a href="#local-6989586621679392162"><span class="hs-identifier hs-var hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Range Int
forall a. Integral a =&gt; a -&gt; a -&gt; Range a
</span><span class="hs-identifier hs-var">Range.linear</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392163"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-354"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Range Int -&gt; m ByteString
forall (m :: * -&gt; *). MonadGen m =&gt; Range Int -&gt; m ByteString
</span><span class="hs-identifier hs-var">Gen.bytes</span></span><span> </span><span class="annot"><span class="annottext">Range Int
</span><a href="#local-6989586621679392162"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span class="hs-comment">-- Copied from Gen.Cardano.Api.Typed, because it's not exported.</span><span>
</span><span id="line-357"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genPolicyId"><span class="hs-identifier hs-type">genPolicyId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.PolicyId</span></span><span>
</span><span id="line-358"></span><span id="genPolicyId"><span class="annot"><span class="annottext">genPolicyId :: Gen PolicyId
</span><a href="Cardano.Node.Emulator.Generators.html#genPolicyId"><span class="hs-identifier hs-var hs-var">genPolicyId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-359"></span><span>  </span><span class="annot"><span class="annottext">[(Int, Gen PolicyId)] -&gt; Gen PolicyId
forall (m :: * -&gt; *) a. MonadGen m =&gt; [(Int, m a)] -&gt; m a
</span><span class="hs-identifier hs-var">Gen.frequency</span></span><span>
</span><span id="line-360"></span><span>      </span><span class="hs-comment">-- mostly from a small number of choices, so we get plenty of repetition</span><span>
</span><span id="line-361"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[PolicyId] -&gt; Gen PolicyId
forall (m :: * -&gt; *) a. MonadGen m =&gt; [a] -&gt; m a
</span><span class="hs-identifier hs-var">Gen.element</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; PolicyId
forall a. IsString a =&gt; String -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679392158"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">55</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'0'</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679392158"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679392158"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'c'</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span>       </span><span class="hs-comment">-- and some from the full range of the type</span><span>
</span><span id="line-364"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ScriptHash -&gt; PolicyId
</span><span class="hs-identifier hs-var">C.PolicyId</span></span><span> </span><span class="annot"><span class="annottext">(ScriptHash -&gt; PolicyId)
-&gt; GenT Identity ScriptHash -&gt; Gen PolicyId
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">GenT Identity ScriptHash
</span><span class="hs-identifier hs-var">Gen.genScriptHash</span></span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="hs-comment">-- Copied from Gen.Cardano.Api.Typed, because it's not exported.</span><span>
</span><span id="line-368"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genAssetId"><span class="hs-identifier hs-type">genAssetId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.AssetId</span></span><span>
</span><span id="line-369"></span><span id="genAssetId"><span class="annot"><span class="annottext">genAssetId :: Gen AssetId
</span><a href="Cardano.Node.Emulator.Generators.html#genAssetId"><span class="hs-identifier hs-var hs-var">genAssetId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Gen AssetId] -&gt; Gen AssetId
forall (m :: * -&gt; *) a. MonadGen m =&gt; [m a] -&gt; m a
</span><span class="hs-identifier hs-var">Gen.choice</span></span><span>
</span><span id="line-370"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">PolicyId -&gt; AssetName -&gt; AssetId
</span><span class="hs-identifier hs-var">C.AssetId</span></span><span> </span><span class="annot"><span class="annottext">(PolicyId -&gt; AssetName -&gt; AssetId)
-&gt; Gen PolicyId -&gt; GenT Identity (AssetName -&gt; AssetId)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Gen PolicyId
</span><a href="Cardano.Node.Emulator.Generators.html#genPolicyId"><span class="hs-identifier hs-var">genPolicyId</span></a></span><span> </span><span class="annot"><span class="annottext">GenT Identity (AssetName -&gt; AssetId)
-&gt; Gen AssetName -&gt; Gen AssetId
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Gen AssetName
</span><span class="hs-identifier hs-var">Gen.genAssetName</span></span><span>
</span><span id="line-371"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AssetId -&gt; Gen AssetId
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">AssetId
</span><span class="hs-identifier hs-var">C.AdaAssetId</span></span><span>
</span><span id="line-372"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genSingleton"><span class="hs-identifier hs-type">genSingleton</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Range</span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/integer-gmp-1.0.3.0/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Value</span></span><span>
</span><span id="line-375"></span><span id="genSingleton"><span class="annot"><span class="annottext">genSingleton :: Range Integer -&gt; Gen Value
</span><a href="Cardano.Node.Emulator.Generators.html#genSingleton"><span class="hs-identifier hs-var hs-var">genSingleton</span></a></span></span><span> </span><span id="local-6989586621679392151"><span class="annot"><span class="annottext">Range Integer
</span><a href="#local-6989586621679392151"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AssetId -&gt; Integer -&gt; Value
</span><span class="hs-identifier hs-var">Value.assetIdValue</span></span><span> </span><span class="annot"><span class="annottext">(AssetId -&gt; Integer -&gt; Value)
-&gt; Gen AssetId -&gt; GenT Identity (Integer -&gt; Value)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Gen AssetId
</span><a href="Cardano.Node.Emulator.Generators.html#genAssetId"><span class="hs-identifier hs-var">genAssetId</span></a></span><span> </span><span class="annot"><span class="annottext">GenT Identity (Integer -&gt; Value)
-&gt; GenT Identity Integer -&gt; Gen Value
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Range Integer -&gt; GenT Identity Integer
forall (m :: * -&gt; *) a. (MonadGen m, Integral a) =&gt; Range a -&gt; m a
</span><span class="hs-identifier hs-var">Gen.integral</span></span><span> </span><span class="annot"><span class="annottext">Range Integer
</span><a href="#local-6989586621679392151"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-376"></span><span>
</span><span id="line-377"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValue%27"><span class="hs-identifier hs-type">genValue'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Range</span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/integer-gmp-1.0.3.0/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Value</span></span><span>
</span><span id="line-378"></span><span id="genValue%27"><span class="annot"><span class="annottext">genValue' :: Range Integer -&gt; Gen Value
</span><a href="Cardano.Node.Emulator.Generators.html#genValue%27"><span class="hs-identifier hs-var hs-var">genValue'</span></a></span></span><span> </span><span id="local-6989586621679392148"><span class="annot"><span class="annottext">Range Integer
</span><a href="#local-6989586621679392148"><span class="hs-identifier hs-var">valueRange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-379"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-380"></span><span>        </span><span class="hs-comment">-- generate values with no more than 5 elements to avoid the tests</span><span>
</span><span id="line-381"></span><span>        </span><span class="hs-comment">-- taking too long (due to the map-as-list-of-kv-pairs implementation)</span><span>
</span><span id="line-382"></span><span>        </span><span id="local-6989586621679392147"><span class="annot"><span class="annottext">maxCurrencies :: Int
</span><a href="#local-6989586621679392147"><span class="hs-identifier hs-var hs-var">maxCurrencies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span>    </span><span id="local-6989586621679392146"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392146"><span class="hs-identifier hs-var">numValues</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Range Int -&gt; GenT Identity Int
forall (m :: * -&gt; *). MonadGen m =&gt; Range Int -&gt; m Int
</span><span class="hs-identifier hs-var">Gen.int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Range Int
forall a. Integral a =&gt; a -&gt; a -&gt; Range a
</span><span class="hs-identifier hs-var">Range.linear</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392147"><span class="hs-identifier hs-var">maxCurrencies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>    </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; GenT Identity [Value] -&gt; Gen Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Gen Value) -&gt; [Int] -&gt; GenT Identity [Value]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Gen Value -&gt; Int -&gt; Gen Value
forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">(Gen Value -&gt; Int -&gt; Gen Value) -&gt; Gen Value -&gt; Int -&gt; Gen Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Range Integer -&gt; Gen Value
</span><a href="Cardano.Node.Emulator.Generators.html#genSingleton"><span class="hs-identifier hs-var">genSingleton</span></a></span><span> </span><span class="annot"><span class="annottext">Range Integer
</span><a href="#local-6989586621679392148"><span class="hs-identifier hs-var">valueRange</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392146"><span class="hs-identifier hs-var">numValues</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span class="hs-comment">-- | Generate a 'Value' with a value range of @minBound .. maxBound@.</span><span>
</span><span id="line-388"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValue"><span class="hs-identifier hs-type">genValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Value</span></span><span>
</span><span id="line-389"></span><span id="genValue"><span class="annot"><span class="annottext">genValue :: Gen Value
</span><a href="Cardano.Node.Emulator.Generators.html#genValue"><span class="hs-identifier hs-var hs-var">genValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range Integer -&gt; Gen Value
</span><a href="Cardano.Node.Emulator.Generators.html#genValue%27"><span class="hs-identifier hs-var">genValue'</span></a></span><span> </span><span class="annot"><span class="annottext">(Range Integer -&gt; Gen Value) -&gt; Range Integer -&gt; Gen Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Integer) -&gt; Range Int -&gt; Range Integer
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Bounded Int, Integral Int) =&gt; Range Int
forall a. (Bounded a, Integral a) =&gt; Range a
</span><span class="hs-identifier hs-var">Range.linearBounded</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span class="hs-comment">-- | Generate a 'Value' with a value range of @0 .. maxBound@.</span><span>
</span><span id="line-392"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValueNonNegative"><span class="hs-identifier hs-type">genValueNonNegative</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Value</span></span><span>
</span><span id="line-393"></span><span id="genValueNonNegative"><span class="annot"><span class="annottext">genValueNonNegative :: Gen Value
</span><a href="Cardano.Node.Emulator.Generators.html#genValueNonNegative"><span class="hs-identifier hs-var hs-var">genValueNonNegative</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range Integer -&gt; Gen Value
</span><a href="Cardano.Node.Emulator.Generators.html#genValue%27"><span class="hs-identifier hs-var">genValue'</span></a></span><span> </span><span class="annot"><span class="annottext">(Range Integer -&gt; Gen Value) -&gt; Range Integer -&gt; Gen Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Integer) -&gt; Range Int -&gt; Range Integer
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Range Int
forall a. Integral a =&gt; a -&gt; a -&gt; Range a
</span><span class="hs-identifier hs-var">Range.linear</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
forall a. Bounded a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maxBound</span></a></span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span class="hs-comment">-- | Assert that a transaction is valid in a chain.</span><span>
</span><span id="line-396"></span><span id="local-6989586621679392143"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#assertValid"><span class="hs-identifier hs-type">assertValid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadTest</span></span><span> </span><span class="annot"><a href="#local-6989586621679392143"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span>
</span><span id="line-398"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-type">Mockchain</span></a></span><span>
</span><span id="line-399"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392143"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-400"></span><span id="assertValid"><span class="annot"><span class="annottext">assertValid :: CardanoTx -&gt; Mockchain -&gt; m ()
</span><a href="Cardano.Node.Emulator.Generators.html#assertValid"><span class="hs-identifier hs-var hs-var">assertValid</span></a></span></span><span> </span><span id="local-6989586621679392142"><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621679392142"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span id="local-6989586621679392141"><span class="annot"><span class="annottext">Mockchain
</span><a href="#local-6989586621679392141"><span class="hs-identifier hs-var">mc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679392140"><span class="annot"><span class="annottext">res :: Maybe ValidationErrorInPhase
</span><a href="#local-6989586621679392140"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Mockchain -&gt; CardanoTx -&gt; Maybe ValidationErrorInPhase
</span><a href="Cardano.Node.Emulator.Generators.html#validateMockchain"><span class="hs-identifier hs-var">validateMockchain</span></a></span><span> </span><span class="annot"><span class="annottext">Mockchain
</span><a href="#local-6989586621679392141"><span class="hs-identifier hs-var">mc</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621679392142"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-401"></span><span>    </span><span class="annot"><span class="annottext">Maybe ValidationErrorInPhase -&gt; m ()
forall (m :: * -&gt; *) a.
(MonadTest m, Show a, HasCallStack) =&gt;
a -&gt; m ()
</span><span class="hs-identifier hs-var">H.annotateShow</span></span><span> </span><span class="annot"><span class="annottext">Maybe ValidationErrorInPhase
</span><a href="#local-6989586621679392140"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-402"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; m ()
forall (m :: * -&gt; *). (MonadTest m, HasCallStack) =&gt; Bool -&gt; m ()
</span><span class="hs-identifier hs-var">H.assert</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; m ()) -&gt; Bool -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ValidationErrorInPhase -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">isNothing</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ValidationErrorInPhase
</span><a href="#local-6989586621679392140"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span class="hs-comment">{- | Split a value into max. n positive-valued parts such that the sum of the
     parts equals the original value. Each part should contain the required
     minimum amount of Ada.

     I noticed how for values of `mx` &gt; 1000 the resulting lists are much smaller than
     one would expect. I think this may be caused by the way we select the next value
     for the split. It looks like the available funds get exhausted quite fast, which
     makes the function return before generating anything close to `mx` values.
-}</span><span>
</span><span id="line-413"></span><span id="local-6989586621679392561"><span id="local-6989586621679392562"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#splitVal"><span class="hs-identifier hs-type">splitVal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679392562"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392561"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392561"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392562"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679392561"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-414"></span><span id="splitVal"><span class="annot"><span class="annottext">splitVal :: Int -&gt; n -&gt; m [n]
</span><a href="Cardano.Node.Emulator.Generators.html#splitVal"><span class="hs-identifier hs-var hs-var">splitVal</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="annottext">n
</span><span class="hs-number">0</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[n] -&gt; m [n]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-415"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#splitVal"><span class="hs-identifier hs-var">splitVal</span></a></span><span> </span><span id="local-6989586621679392137"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392137"><span class="hs-identifier hs-var">mx</span></a></span></span><span> </span><span id="local-6989586621679392136"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679392136"><span class="hs-identifier hs-var">init'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; n -&gt; [n] -&gt; m [n]
</span><a href="#local-6989586621679392135"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">n
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-416"></span><span>    </span><span id="local-6989586621679392135"><span class="annot"><span class="annottext">go :: Int -&gt; n -&gt; [n] -&gt; m [n]
</span><a href="#local-6989586621679392135"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679392134"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392134"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679392133"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679392133"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679392132"><span class="annot"><span class="annottext">[n]
</span><a href="#local-6989586621679392132"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-417"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392134"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Enum a =&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pred</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392137"><span class="hs-identifier hs-var">mx</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679392136"><span class="hs-identifier hs-var">init'</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679392133"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679392129"><span class="hs-identifier hs-var">minAda</span></a></span><span>
</span><span id="line-418"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[n] -&gt; m [n]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">([n] -&gt; m [n]) -&gt; [n] -&gt; m [n]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679392136"><span class="hs-identifier hs-var">init'</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679392133"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">n -&gt; [n] -&gt; [n]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[n]
</span><a href="#local-6989586621679392132"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-419"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-420"></span><span>            </span><span id="local-6989586621679392128"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679392128"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Range n -&gt; m n
forall (m :: * -&gt; *) a. (MonadGen m, Integral a) =&gt; Range a -&gt; m a
</span><span class="hs-identifier hs-var">Gen.integral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n -&gt; n -&gt; Range n
forall a. Integral a =&gt; a -&gt; a -&gt; Range a
</span><span class="hs-identifier hs-var">Range.linear</span></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679392129"><span class="hs-identifier hs-var">minAda</span></a></span><span> </span><span class="annot"><span class="annottext">(n -&gt; Range n) -&gt; n -&gt; Range n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679392136"><span class="hs-identifier hs-var">init'</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679392133"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679392129"><span class="hs-identifier hs-var">minAda</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679392128"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679392133"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679392136"><span class="hs-identifier hs-var">init'</span></a></span><span>
</span><span id="line-422"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[n] -&gt; m [n]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">([n] -&gt; m [n]) -&gt; [n] -&gt; m [n]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679392128"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; [n] -&gt; [n]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[n]
</span><a href="#local-6989586621679392132"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-423"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; n -&gt; [n] -&gt; m [n]
</span><a href="#local-6989586621679392135"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Enum a =&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">succ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679392134"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679392128"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679392133"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679392128"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; [n] -&gt; [n]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[n]
</span><a href="#local-6989586621679392132"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-424"></span><span>    </span><span id="local-6989586621679392129"><span class="annot"><span class="annottext">minAda :: n
</span><a href="#local-6989586621679392129"><span class="hs-identifier hs-var hs-var">minAda</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n
</span><span class="hs-number">3_000_000</span></span><span> </span><span class="hs-comment">-- For fee and min Ada for tx outs</span><span>
</span><span id="line-425"></span><span>
</span><span id="line-426"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#knownXPrvs"><span class="hs-identifier hs-type">knownXPrvs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Crypto.XPrv</span></span><span class="hs-special">]</span><span>
</span><span id="line-427"></span><span id="knownXPrvs"><span class="annot"><span class="annottext">knownXPrvs :: [PrivateKey]
</span><a href="Cardano.Node.Emulator.Generators.html#knownXPrvs"><span class="hs-identifier hs-var hs-var">knownXPrvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PaymentPrivateKey -&gt; PrivateKey
</span><span class="hs-identifier hs-var hs-var">unPaymentPrivateKey</span></span><span> </span><span class="annot"><span class="annottext">(PaymentPrivateKey -&gt; PrivateKey)
-&gt; [PaymentPrivateKey] -&gt; [PrivateKey]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[PaymentPrivateKey]
</span><span class="hs-identifier hs-var">CW.knownPaymentPrivateKeys</span></span><span>
</span><span id="line-428"></span><span>
</span><span id="line-429"></span><span class="hs-comment">-- | Seed suitable for testing a seed but not for actual wallets as ScrubbedBytes isn't used to ensure</span><span>
</span><span id="line-430"></span><span class="hs-comment">--  memory isn't inspectable</span><span>
</span><span id="line-431"></span><span id="local-6989586621679392125"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genSeed"><span class="hs-identifier hs-type">genSeed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679392125"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392125"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span></span><span>
</span><span id="line-432"></span><span id="genSeed"><span class="annot"><span class="annottext">genSeed :: m ByteString
</span><a href="Cardano.Node.Emulator.Generators.html#genSeed"><span class="hs-identifier hs-var hs-var">genSeed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Range Int -&gt; m ByteString
forall (m :: * -&gt; *). MonadGen m =&gt; Range Int -&gt; m ByteString
</span><span class="hs-identifier hs-var">Gen.bytes</span></span><span> </span><span class="annot"><span class="annottext">(Range Int -&gt; m ByteString) -&gt; Range Int -&gt; m ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Range Int
forall a. a -&gt; Range a
</span><span class="hs-identifier hs-var">Range.singleton</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span>
</span><span id="line-433"></span><span>
</span><span id="line-434"></span><span id="local-6989586621679392123"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genPassphrase"><span class="hs-identifier hs-type">genPassphrase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679392123"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392123"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Passphrase</span></span></span><span>
</span><span id="line-435"></span><span id="genPassphrase"><span class="annot"><span class="annottext">genPassphrase :: m Passphrase
</span><a href="Cardano.Node.Emulator.Generators.html#genPassphrase"><span class="hs-identifier hs-var hs-var">genPassphrase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-436"></span><span>  </span><span class="annot"><span class="annottext">ByteString -&gt; Passphrase
</span><span class="hs-identifier hs-var">Passphrase</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Passphrase) -&gt; m ByteString -&gt; m Passphrase
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Range Int -&gt; m Char -&gt; m ByteString
forall (m :: * -&gt; *).
MonadGen m =&gt;
Range Int -&gt; m Char -&gt; m ByteString
</span><span class="hs-identifier hs-var">Gen.utf8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Range Int
forall a. a -&gt; Range a
</span><span class="hs-identifier hs-var">Range.singleton</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m Char
forall (m :: * -&gt; *). MonadGen m =&gt; m Char
</span><span class="hs-identifier hs-var">Gen.unicode</span></span><span>
</span><span id="line-437"></span><span>
</span><span id="line-438"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#alwaysSucceedPolicy"><span class="hs-identifier hs-type">alwaysSucceedPolicy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Script.MintingPolicy</span></span><span>
</span><span id="line-439"></span><span id="alwaysSucceedPolicy"><span class="annot"><span class="annottext">alwaysSucceedPolicy :: MintingPolicy
</span><a href="Cardano.Node.Emulator.Generators.html#alwaysSucceedPolicy"><span class="hs-identifier hs-var hs-var">alwaysSucceedPolicy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Script -&gt; MintingPolicy
</span><span class="hs-identifier hs-var">Script.MintingPolicy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlutusScript PlutusScriptV1 -&gt; Script
forall lang. HasTypeProxy lang =&gt; PlutusScript lang -&gt; Script
</span><span class="hs-identifier hs-var">fromCardanoPlutusScript</span></span><span> </span><span class="annot"><span class="annottext">(PlutusScript PlutusScriptV1 -&gt; Script)
-&gt; PlutusScript PlutusScriptV1 -&gt; Script
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">WitCtx WitCtxMint -&gt; PlutusScript PlutusScriptV1
forall witctx. WitCtx witctx -&gt; PlutusScript PlutusScriptV1
</span><span class="hs-identifier hs-var">C.examplePlutusScriptAlwaysSucceeds</span></span><span> </span><span class="annot"><span class="annottext">WitCtx WitCtxMint
</span><span class="hs-identifier hs-var">C.WitCtxMint</span></span><span class="hs-special">)</span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#alwaysSucceedPolicyId"><span class="hs-identifier hs-type">alwaysSucceedPolicyId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.PolicyId</span></span><span>
</span><span id="line-442"></span><span id="alwaysSucceedPolicyId"><span class="annot"><span class="annottext">alwaysSucceedPolicyId :: PolicyId
</span><a href="Cardano.Node.Emulator.Generators.html#alwaysSucceedPolicyId"><span class="hs-identifier hs-var hs-var">alwaysSucceedPolicyId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Script PlutusScriptV1 -&gt; PolicyId
forall lang. Script lang -&gt; PolicyId
</span><span class="hs-identifier hs-var">C.scriptPolicyId</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlutusScriptVersion PlutusScriptV1
-&gt; PlutusScript PlutusScriptV1 -&gt; Script PlutusScriptV1
forall lang.
PlutusScriptVersion lang -&gt; PlutusScript lang -&gt; Script lang
</span><span class="hs-identifier hs-var">C.PlutusScript</span></span><span> </span><span class="annot"><span class="annottext">PlutusScriptVersion PlutusScriptV1
</span><span class="hs-identifier hs-var">C.PlutusScriptV1</span></span><span> </span><span class="annot"><span class="annottext">(PlutusScript PlutusScriptV1 -&gt; Script PlutusScriptV1)
-&gt; PlutusScript PlutusScriptV1 -&gt; Script PlutusScriptV1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">WitCtx WitCtxMint -&gt; PlutusScript PlutusScriptV1
forall witctx. WitCtx witctx -&gt; PlutusScript PlutusScriptV1
</span><span class="hs-identifier hs-var">C.examplePlutusScriptAlwaysSucceeds</span></span><span> </span><span class="annot"><span class="annottext">WitCtx WitCtxMint
</span><span class="hs-identifier hs-var">C.WitCtxMint</span></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#someTokenValue"><span class="hs-identifier hs-type">someTokenValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.AssetName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/integer-gmp-1.0.3.0/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Value</span></span><span>
</span><span id="line-445"></span><span id="someTokenValue"><span class="annot"><span class="annottext">someTokenValue :: AssetName -&gt; Integer -&gt; Value
</span><a href="Cardano.Node.Emulator.Generators.html#someTokenValue"><span class="hs-identifier hs-var hs-var">someTokenValue</span></a></span></span><span> </span><span id="local-6989586621679392114"><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679392114"><span class="hs-identifier hs-var">an</span></a></span></span><span> </span><span id="local-6989586621679392113"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679392113"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(AssetId, Quantity)] -&gt; Value
</span><span class="hs-identifier hs-var">C.valueFromList</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PolicyId -&gt; AssetName -&gt; AssetId
</span><span class="hs-identifier hs-var">C.AssetId</span></span><span> </span><span class="annot"><span class="annottext">PolicyId
</span><a href="Cardano.Node.Emulator.Generators.html#alwaysSucceedPolicyId"><span class="hs-identifier hs-var">alwaysSucceedPolicyId</span></a></span><span> </span><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679392114"><span class="hs-identifier hs-var">an</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Quantity
</span><span class="hs-identifier hs-var">C.Quantity</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679392113"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-446"></span><span>
</span><span id="line-447"></span><span class="hs-comment">-- | Catch cardano error and fail wi it</span><span>
</span><span id="line-448"></span><span id="local-6989586621679392544"><span id="local-6989586621679392545"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#failOnCardanoError"><span class="hs-identifier hs-type">failOnCardanoError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadFail</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392545"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.ToCardanoError</span></span><span> </span><span class="annot"><a href="#local-6989586621679392544"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392545"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392544"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-449"></span><span id="failOnCardanoError"><span class="annot"><span class="annottext">failOnCardanoError :: Either ToCardanoError a -&gt; m a
</span><a href="Cardano.Node.Emulator.Generators.html#failOnCardanoError"><span class="hs-identifier hs-var hs-var">failOnCardanoError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ToCardanoError -&gt; m a)
-&gt; (a -&gt; m a) -&gt; Either ToCardanoError a -&gt; m a
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; m a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m a)
-&gt; (ToCardanoError -&gt; String) -&gt; ToCardanoError -&gt; m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ToCardanoError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-450"></span></pre></body></html>