<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes        #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds            #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DataKinds                  #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable         #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE DerivingVia                #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts           #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances          #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE GADTs                      #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE ImportQualifiedPost        #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses      #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE NumericUnderscores         #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings          #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms            #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE PolyKinds                  #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE QuantifiedConstraints      #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes                 #-}</span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables        #-}</span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell            #-}</span><span>
</span><span id="line-20"></span><span class="hs-pragma">{-# LANGUAGE TupleSections              #-}</span><span>
</span><span id="line-21"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications           #-}</span><span>
</span><span id="line-22"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies               #-}</span><span>
</span><span id="line-23"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators              #-}</span><span>
</span><span id="line-24"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances       #-}</span><span>
</span><span id="line-25"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns               #-}</span><span>
</span><span id="line-26"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-redundant-constraints -fno-warn-name-shadowing -Wno-orphans #-}</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Plutus.Contract.Test.ContractModel.Interface</span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Contract models</span></span><span>
</span><span id="line-31"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-32"></span><span>      </span><span class="annot"><span class="hs-comment">-- $contractModel</span></span><span>
</span><span id="line-33"></span><span>      </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractModel"><span class="hs-identifier">ContractModel</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Actions"><span class="hs-identifier">Actions</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#SomeContractInstanceKey"><span class="hs-identifier">SomeContractInstanceKey</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.HasSymbolics</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Model state</span></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.ModelState</span></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.contractState</span></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#currentSlot"><span class="hs-identifier">currentSlot</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.balanceChanges</span></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#balanceChange"><span class="hs-identifier">balanceChange</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.minted</span></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.lockedValue</span></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.symIsZero</span></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.GetModelState</span></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.viewModelState</span></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#viewContractState"><span class="hs-identifier">viewContractState</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.SymToken</span></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.SymValueLike</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.TokenLike</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#invSymValue"><span class="hs-identifier">invSymValue</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.toValue</span></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** The Spec monad</span></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><span class="hs-comment">-- $specMonad</span></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.Spec</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#wait"><span class="hs-identifier">wait</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#waitUntil"><span class="hs-identifier">waitUntil</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.mint</span></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.burn</span></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#deposit"><span class="hs-identifier">deposit</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#withdraw"><span class="hs-identifier">withdraw</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#transfer"><span class="hs-identifier">transfer</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.createToken</span></span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.createTxOut</span></span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.createTxIn</span></span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.createSymbolic</span></span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.assertSpec</span></span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#SpecificationEmulatorTrace"><span class="hs-identifier">SpecificationEmulatorTrace</span></a></span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#registerToken"><span class="hs-identifier">registerToken</span></a></span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#registerTxOut"><span class="hs-identifier">registerTxOut</span></a></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#registerTxIn"><span class="hs-identifier">registerTxIn</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#registerSymbolic"><span class="hs-identifier">registerSymbolic</span></a></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#delay"><span class="hs-identifier">delay</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#fromSlotNo"><span class="hs-identifier">fromSlotNo</span></a></span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#toSlotNo"><span class="hs-identifier">toSlotNo</span></a></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Test scenarios</span></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><span class="hs-comment">-- $dynamicLogic</span></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#DL"><span class="hs-identifier">DL</span></a></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#action"><span class="hs-identifier">action</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#waitUntilDL"><span class="hs-identifier">waitUntilDL</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.observe</span></span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.anyAction</span></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.anyActions</span></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.anyActions_</span></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCD.forAllQ</span></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCD.elementsQ</span></span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCD.chooseQ</span></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Failures</span></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><span class="hs-comment">-- $dynamicLogic_errors</span></span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCD.assert</span></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#assertModel"><span class="hs-identifier">assertModel</span></a></span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.stopping</span></span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.weight</span></span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.getSize</span></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.monitor</span></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Properties</span></span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Wallet contract handles</span></span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><span class="hs-comment">-- $walletHandles</span></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#SchemaConstraints"><span class="hs-identifier">CMI.SchemaConstraints</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#StartContract"><span class="hs-identifier">StartContract</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#HandleFun"><span class="hs-identifier">HandleFun</span></a></span><span>
</span><span id="line-111"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Model properties</span></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#propSanityCheckModel"><span class="hs-identifier">propSanityCheckModel</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#propSanityCheckAssertions"><span class="hs-identifier">propSanityCheckAssertions</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#propSanityCheckReactive"><span class="hs-identifier">propSanityCheckReactive</span></a></span><span>
</span><span id="line-115"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Coverage checking options</span></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><span class="hs-identifier">Coverage</span></span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#CoverageOptions"><span class="hs-identifier">CMI.CoverageOptions</span></a></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#defaultCoverageOptions"><span class="hs-identifier">CMI.defaultCoverageOptions</span></a></span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#endpointCoverageReq"><span class="hs-identifier">CMI.endpointCoverageReq</span></a></span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#checkCoverage"><span class="hs-identifier">CMI.checkCoverage</span></a></span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#coverageIndex"><span class="hs-identifier">CMI.coverageIndex</span></a></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#quickCheckWithCoverage"><span class="hs-identifier">CMI.quickCheckWithCoverage</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#quickCheckWithCoverageAndResult"><span class="hs-identifier">CMI.quickCheckWithCoverageAndResult</span></a></span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Emulator properties</span></span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#propRunActions_"><span class="hs-identifier">propRunActions_</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#propRunActions"><span class="hs-identifier">propRunActions</span></a></span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#propRunActionsWithOptions"><span class="hs-identifier">propRunActionsWithOptions</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#defaultCheckOptionsContractModel"><span class="hs-identifier">CMI.defaultCheckOptionsContractModel</span></a></span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#checkThreatModel"><span class="hs-identifier">CMI.checkThreatModel</span></a></span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#checkThreatModelWithOptions"><span class="hs-identifier">CMI.checkThreatModelWithOptions</span></a></span><span>
</span><span id="line-131"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** DL properties</span></span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QCCM.forAllDL</span></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Standard properties</span></span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-136"></span><span>    </span><span class="annot"><span class="hs-comment">-- $noLockedFunds</span></span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#NoLockedFundsProof"><span class="hs-identifier">NoLockedFundsProof</span></a></span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#NoLockedFundsProof"><span class="hs-identifier">CMI.NoLockedFundsProof</span></a></span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#nlfpMainStrategy"><span class="hs-identifier">CMI.nlfpMainStrategy</span></a></span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#nlfpWalletStrategy"><span class="hs-identifier">CMI.nlfpWalletStrategy</span></a></span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#nlfpOverhead"><span class="hs-identifier">CMI.nlfpOverhead</span></a></span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#nlfpErrorMargin"><span class="hs-identifier">CMI.nlfpErrorMargin</span></a></span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#defaultNLFP"><span class="hs-identifier">CMI.defaultNLFP</span></a></span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#checkNoLockedFundsProof"><span class="hs-identifier">CMI.checkNoLockedFundsProof</span></a></span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#checkNoLockedFundsProofFast"><span class="hs-identifier">CMI.checkNoLockedFundsProofFast</span></a></span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#NoLockedFundsProofLight"><span class="hs-identifier">NoLockedFundsProofLight</span></a></span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#NoLockedFundsProofLight"><span class="hs-identifier">CMI.NoLockedFundsProofLight</span></a></span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#nlfplMainStrategy"><span class="hs-identifier">CMI.nlfplMainStrategy</span></a></span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#checkNoLockedFundsProofLight"><span class="hs-identifier">CMI.checkNoLockedFundsProofLight</span></a></span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#checkNoLockedFundsProofWithOptions"><span class="hs-identifier">CMI.checkNoLockedFundsProofWithOptions</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#checkNoLockedFundsProofFastWithOptions"><span class="hs-identifier">CMI.checkNoLockedFundsProofFastWithOptions</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><span class="hs-comment">-- $checkNoPartiality</span></span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#Whitelist"><span class="hs-identifier">CMI.Whitelist</span></a></span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#whitelistOk"><span class="hs-identifier">CMI.whitelistOk</span></a></span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#mkWhitelist"><span class="hs-identifier">CMI.mkWhitelist</span></a></span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#errorPrefixes"><span class="hs-identifier">CMI.errorPrefixes</span></a></span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#defaultWhitelist"><span class="hs-identifier">CMI.defaultWhitelist</span></a></span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#checkErrorWhitelist"><span class="hs-identifier">checkErrorWhitelist</span></a></span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#checkErrorWhitelistWithOptions"><span class="hs-identifier">checkErrorWhitelistWithOptions</span></a></span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-comment">-- To make GHC understand coercibility</span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#WithInstances"><span class="hs-identifier">CMI.WithInstances</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrappedState"><span class="hs-identifier">WrappedState</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#checkDoubleSatisfaction"><span class="hs-identifier">checkDoubleSatisfaction</span></a></span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#checkDoubleSatisfactionWithOptions"><span class="hs-identifier">checkDoubleSatisfactionWithOptions</span></a></span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Generic</span></a></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Utils</span></span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#fromAssetId"><span class="hs-identifier">fromAssetId</span></a></span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#toAssetId"><span class="hs-identifier">toAssetId</span></a></span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Freer.Reader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ask</span></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Freer.Writer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Writer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runWriter</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">tell</span></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Row</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Row</span></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Trace.Effects.RunContract</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">walletInstanceTag</span></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Trace.Emulator.Types</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ContractHandle</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ContractInstanceTag</span></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PlutusTx.AssocMap</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">AssocMap</span></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span>
</span><span id="line-180"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Cont</span></span><span>
</span><span id="line-181"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Freer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Eff</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">raise</span></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Coerce</span></a></span><span>
</span><span id="line-183"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Data</span></a></span><span>
</span><span id="line-184"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">to</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Api</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CardanoAPI</span></span><span>
</span><span id="line-187"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Slot</span></span><span>
</span><span id="line-188"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Contract</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Contract</span></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Contract.Test</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">not</span></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Script.Utils.Ada</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ada</span></span><span>
</span><span id="line-191"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Script.Utils.Value</span></span><span>
</span><span id="line-192"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Trace.Emulator</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Trace</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">BaseEmulatorEffects</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">waitNSlots</span></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PlutusTx.Builtins</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Builtins</span></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.QuickCheck</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ShrinkState</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">checkCoverage</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getSize</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.&amp;&amp;.)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.||.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.QuickCheck</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">QC</span></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html"><span class="hs-identifier">Plutus.Contract.Test.ContractModel.Internal</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CMI</span></span><span>
</span><span id="line-200"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Contract.Test.Coverage</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Coverage</span></span><span>
</span><span id="line-201"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.QuickCheck.ContractModel</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">QCCM</span></span><span>
</span><span id="line-202"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.QuickCheck.ContractModel.ThreatModel.DoubleSatisfaction</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">QCCM</span></span><span>
</span><span id="line-203"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.QuickCheck.DynamicLogic</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">QCD</span></span><span>
</span><span id="line-204"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.QuickCheck.StateModel</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">QCSM</span></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-comment">-- | A function returning the `ContractHandle` corresponding to a `ContractInstanceKey`. A</span><span>
</span><span id="line-207"></span><span class="hs-comment">--   `HandleFun` is provided to the `perform` function to enable calling contract endpoints with</span><span>
</span><span id="line-208"></span><span class="hs-comment">--   `Plutus.Trace.Emulator.callEndpoint`.</span><span>
</span><span id="line-209"></span><span class="hs-keyword">type</span><span> </span><span id="HandleFun"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#HandleFun"><span class="hs-identifier hs-var">HandleFun</span></a></span></span><span> </span><span id="local-6989586621679426500"><span class="annot"><a href="#local-6989586621679426500"><span class="hs-identifier hs-type">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679426499"><span class="annot"><a href="#local-6989586621679426499"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621679426498"><span class="annot"><a href="#local-6989586621679426498"><span class="hs-identifier hs-type">schema</span></a></span></span><span> </span><span id="local-6989586621679426497"><span class="annot"><a href="#local-6989586621679426497"><span class="hs-identifier hs-type">err</span></a></span></span><span> </span><span id="local-6989586621679426496"><span class="annot"><a href="#local-6989586621679426496"><span class="hs-identifier hs-type">params</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426499"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426498"><span class="hs-identifier hs-type">schema</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426497"><span class="hs-identifier hs-type">err</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426496"><span class="hs-identifier hs-type">params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>                        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractInstanceKey"><span class="hs-identifier hs-type">ContractInstanceKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426500"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426499"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426498"><span class="hs-identifier hs-type">schema</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426497"><span class="hs-identifier hs-type">err</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426496"><span class="hs-identifier hs-type">params</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractHandle</span></span><span> </span><span class="annot"><a href="#local-6989586621679426499"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426498"><span class="hs-identifier hs-type">schema</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426497"><span class="hs-identifier hs-type">err</span></a></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="hs-keyword">data</span><span> </span><span id="StartContract"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#StartContract"><span class="hs-identifier hs-var">StartContract</span></a></span></span><span> </span><span id="local-6989586621679426495"><span class="annot"><a href="#local-6989586621679426495"><span class="hs-identifier hs-type">state</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-213"></span><span>  </span><span id="local-6989586621679426490"><span id="local-6989586621679426491"><span id="local-6989586621679426492"><span id="local-6989586621679426493"><span id="local-6989586621679426494"><span id="StartContract"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#StartContract"><span class="hs-identifier hs-var">StartContract</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#SchemaConstraints"><span class="hs-identifier hs-type">CMI.SchemaConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426494"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426493"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426492"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426491"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractInstanceKey"><span class="hs-identifier hs-type">ContractInstanceKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426490"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426494"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426493"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426492"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426491"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679426491"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#StartContract"><span class="hs-identifier hs-type">StartContract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426490"><span class="hs-identifier hs-type">state</span></a></span></span></span></span></span></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-keyword">type</span><span> </span><span id="SpecificationEmulatorTrace"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#SpecificationEmulatorTrace"><span class="hs-identifier hs-var">SpecificationEmulatorTrace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Writer</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#SomethingWithSymbolicRep"><span class="hs-identifier hs-type">SomethingWithSymbolicRep</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BaseEmulatorEffects</span></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-keyword">data</span><span> </span><span id="SomethingWithSymbolicRep"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#SomethingWithSymbolicRep"><span class="hs-identifier hs-var">SomethingWithSymbolicRep</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-218"></span><span>  </span><span id="local-6989586621679426488"><span id="WithSymbolicRep"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#WithSymbolicRep"><span class="hs-identifier hs-var">WithSymbolicRep</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.HasSymbolicRep</span></span><span> </span><span class="annot"><a href="#local-6989586621679426488"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679426488"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#SomethingWithSymbolicRep"><span class="hs-identifier hs-type">SomethingWithSymbolicRep</span></a></span></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-comment">-- | A `ContractModel` instance captures everything that is needed to generate and run tests of a</span><span>
</span><span id="line-221"></span><span class="hs-comment">--   contract or set of contracts. It specifies among other things</span><span>
</span><span id="line-222"></span><span class="hs-comment">--</span><span>
</span><span id="line-223"></span><span class="hs-comment">--  * what operations are supported by the contract (`Action`),</span><span>
</span><span id="line-224"></span><span class="hs-comment">--  * when they are valid (`precondition`),</span><span>
</span><span id="line-225"></span><span class="hs-comment">--  * how to generate random actions (`arbitraryAction`),</span><span>
</span><span id="line-226"></span><span class="hs-comment">--  * how the operations affect the state (`nextState`), and</span><span>
</span><span id="line-227"></span><span class="hs-comment">--  * how to run the operations in the emulator (`perform`)</span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span>
</span><span id="line-230"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span>
</span><span id="line-231"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.HasSymbolics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCSM.HasVariables</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCSM.HasVariables</span></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span>
</span><span id="line-236"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Generic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span>
</span><span id="line-237"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679426486"><span class="annot"><a href="#local-6989586621679426486"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621679426485"><span class="annot"><a href="#local-6989586621679426485"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679426484"><span class="annot"><a href="#local-6989586621679426484"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679426483"><span class="annot"><a href="#local-6989586621679426483"><span class="hs-identifier hs-type">p</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractInstanceKey"><span class="hs-identifier hs-type">ContractInstanceKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426486"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426485"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426484"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426483"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679426482"><span class="annot"><a href="#local-6989586621679426482"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621679426481"><span class="annot"><a href="#local-6989586621679426481"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679426480"><span class="annot"><a href="#local-6989586621679426480"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679426479"><span class="annot"><a href="#local-6989586621679426479"><span class="hs-identifier hs-type">p</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractInstanceKey"><span class="hs-identifier hs-type">ContractInstanceKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426482"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426481"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426480"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426479"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="ContractModel"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractModel"><span class="hs-identifier hs-var">ContractModel</span></a></span></span><span> </span><span id="local-6989586621679427001"><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-comment">-- | The type of actions that are supported by the contract. An action usually represents a single</span><span>
</span><span id="line-242"></span><span>    </span><span class="hs-comment">--   `Plutus.Trace.Emulator.callEndpoint` or a transfer of tokens, but it can be anything</span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-comment">--   that can be interpreted in the `EmulatorTrace` monad.</span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-keyword">data</span><span> </span><span id="Action"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Action"><span class="hs-identifier hs-var">Action</span></a></span></span><span> </span><span id="local-6989586621679427001"><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span>    </span><span class="hs-comment">-- | To be able to call a contract endpoint from a wallet a `ContractHandle` is required. These</span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-comment">--   are managed by the test framework and all the user needs to do is provide this contract</span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-comment">--   instance key type representing the different contract instances that a test needs to work</span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-comment">--   with, and when creating a property (see `propRunActions_`) provide a list of contract</span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-comment">--   instance keys together with their wallets and contracts (a `ContractInstanceSpec`).</span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-comment">--   Contract instance keys are indexed by the observable state, schema, and error type of the</span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-comment">--   contract and should be defined as a GADT. For example, a handle type for a contract with</span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-comment">--   one seller and multiple buyers could look like this.</span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-comment">--   &gt;  data ContractInstanceKey MyModel w s e where</span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-comment">--   &gt;      Buyer  :: Wallet -&gt; ContractInstanceKey MyModel MyObsState MySchema MyError MyParams</span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-comment">--   &gt;      Seller :: ContractInstanceKey MyModel MyObsState MySchema MyError MyParams</span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-keyword">data</span><span> </span><span id="ContractInstanceKey"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractInstanceKey"><span class="hs-identifier hs-var">ContractInstanceKey</span></a></span></span><span> </span><span id="local-6989586621679427001"><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Row</span></span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-comment">-- | Get the wallet that the contract running at a specific `ContractInstanceKey` should run</span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-comment">-- in</span><span>
</span><span id="line-262"></span><span>    </span><span id="local-6989586621679426985"><span id="local-6989586621679426986"><span id="local-6989586621679426987"><span id="local-6989586621679426988"><span id="instanceWallet"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#instanceWallet"><span class="hs-identifier hs-type">instanceWallet</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractInstanceKey"><span class="hs-identifier hs-type">ContractInstanceKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426988"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426987"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426986"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426985"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Wallet</span></span></span></span></span></span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-comment">-- | The 'ContractInstanceTag' of an instance key for a wallet. Defaults to 'walletInstanceTag'.</span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-comment">--   You must override this if you have multiple instances per wallet.</span><span>
</span><span id="line-266"></span><span>    </span><span id="instanceTag"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#instanceTag"><span class="hs-identifier hs-type">instanceTag</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679426882"><span class="annot"><a href="#local-6989586621679426882"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621679426881"><span class="annot"><a href="#local-6989586621679426881"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679426880"><span class="annot"><a href="#local-6989586621679426880"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679426879"><span class="annot"><a href="#local-6989586621679426879"><span class="hs-identifier hs-type">p</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#SchemaConstraints"><span class="hs-identifier hs-type">CMI.SchemaConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426882"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426881"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426880"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractInstanceKey"><span class="hs-identifier hs-type">ContractInstanceKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426882"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426881"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426880"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426879"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ContractInstanceTag</span></span><span>
</span><span id="line-267"></span><span>    </span><span id="local-6989586621679426476"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#instanceTag"><span class="hs-identifier hs-var hs-var">instanceTag</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; ContractInstanceTag
</span><span class="hs-identifier hs-var">walletInstanceTag</span></span><span> </span><span class="annot"><span class="annottext">(Wallet -&gt; ContractInstanceTag)
-&gt; (ContractInstanceKey state w s e p -&gt; Wallet)
-&gt; ContractInstanceKey state w s e p
-&gt; ContractInstanceTag
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceKey state w s e p -&gt; Wallet
forall state w (s :: Row *) e p.
ContractModel state =&gt;
ContractInstanceKey state w s e p -&gt; Wallet
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#instanceWallet"><span class="hs-identifier hs-var">instanceWallet</span></a></span></span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span>    </span><span class="hs-comment">-- | Given the current model state, provide a QuickCheck generator for a random next action.</span><span>
</span><span id="line-270"></span><span>    </span><span class="hs-comment">--   This is used in the `Arbitrary` instance for `Actions`s as well as by `anyAction` and</span><span>
</span><span id="line-271"></span><span>    </span><span class="hs-comment">--   `anyActions`.</span><span>
</span><span id="line-272"></span><span>    </span><span id="arbitraryAction"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#arbitraryAction"><span class="hs-identifier hs-type">arbitraryAction</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.ModelState</span></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span>    </span><span class="hs-comment">-- | The name of an Action, used to report statistics.</span><span>
</span><span id="line-275"></span><span>    </span><span id="actionName"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#actionName"><span class="hs-identifier hs-type">actionName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-276"></span><span>    </span><span id="local-6989586621679426472"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#actionName"><span class="hs-identifier hs-var hs-var">actionName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. [a] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String)
-&gt; (Action state -&gt; [String]) -&gt; Action state -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">words</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; [String])
-&gt; (Action state -&gt; String) -&gt; Action state -&gt; [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Action state -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span>    </span><span class="hs-comment">-- | The probability that we will generate a `WaitUntil` in a given state</span><span>
</span><span id="line-279"></span><span>    </span><span id="waitProbability"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#waitProbability"><span class="hs-identifier hs-type">waitProbability</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.ModelState</span></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-280"></span><span>    </span><span id="local-6989586621679426467"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#waitProbability"><span class="hs-identifier hs-var hs-var">waitProbability</span></a></span><span> </span><span class="annot"><span class="annottext">ModelState state
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.1</span></span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span>    </span><span class="hs-comment">-- | Control the distribution of how long `WaitUntil` waits</span></span><span>
</span><span id="line-283"></span><span>    </span><span id="arbitraryWaitInterval"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#arbitraryWaitInterval"><span class="hs-identifier hs-type">arbitraryWaitInterval</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.ModelState</span></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Slot</span></span><span>
</span><span id="line-284"></span><span>    </span><span id="local-6989586621679426465"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#arbitraryWaitInterval"><span class="hs-identifier hs-var hs-var">arbitraryWaitInterval</span></a></span><span> </span><span id="local-6989586621679426464"><span class="annot"><span class="annottext">ModelState state
</span><a href="#local-6989586621679426464"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Slot
</span><span class="hs-identifier hs-var">Slot</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Slot) -&gt; Gen Integer -&gt; Gen Slot
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer, Integer) -&gt; Gen Integer
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><span class="hs-identifier hs-var">choose</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">max</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Integer] -&gt; Integer
forall a. [a] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679426458"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679426458"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679426458"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Word64 -&gt; Integer -&gt; Word64
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">^</span></a></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679426458"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679426455"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-286"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">CardanoAPI.SlotNo</span></span><span> </span><span id="local-6989586621679426455"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679426455"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelState state
</span><a href="#local-6989586621679426464"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ModelState state
-&gt; Getting SlotNo (ModelState state) SlotNo -&gt; SlotNo
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting SlotNo (ModelState state) SlotNo
forall state. Getter (ModelState state) SlotNo
</span><span class="hs-identifier hs-var">QCCM.currentSlot</span></span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span>    </span><span class="hs-comment">-- | The initial state, before any actions have been performed.</span></span><span>
</span><span id="line-289"></span><span>    </span><span id="initialState"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#initialState"><span class="hs-identifier hs-type">initialState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-comment">-- | The initial handles</span><span>
</span><span id="line-292"></span><span>    </span><span id="initialInstances"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#initialInstances"><span class="hs-identifier hs-type">initialInstances</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#StartContract"><span class="hs-identifier hs-type">StartContract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-293"></span><span>    </span><span id="local-6989586621679426449"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#initialInstances"><span class="hs-identifier hs-var hs-var">initialInstances</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span>    </span><span class="hs-comment">-- | The `precondition` function decides if a given action is valid in a given state. Typically</span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-comment">--   actions generated by `arbitraryAction` will satisfy the precondition, but if they don't</span><span>
</span><span id="line-297"></span><span>    </span><span class="hs-comment">--   they will be discarded and another action will be generated. More importantly, the</span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-comment">--   preconditions are used when shrinking (see `shrinkAction`) to ensure that shrunk test cases</span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-comment">--   still make sense.</span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-301"></span><span>    </span><span class="hs-comment">--   If an explicit `action` in a `DL` scenario violates the precondition an error is raised.</span><span>
</span><span id="line-302"></span><span>    </span><span id="precondition"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#precondition"><span class="hs-identifier hs-type">precondition</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.ModelState</span></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-303"></span><span>    </span><span id="local-6989586621679426447"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#precondition"><span class="hs-identifier hs-var hs-var">precondition</span></a></span><span> </span><span class="annot"><span class="annottext">ModelState state
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Action state
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-comment">-- | `nextReactiveState` is run every time the model `wait`s for a slot to be reached. This</span><span>
</span><span id="line-306"></span><span>    </span><span class="hs-comment">--   can be used to model reactive components of off-chain code.</span></span><span>
</span><span id="line-307"></span><span>    </span><span id="nextReactiveState"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#nextReactiveState"><span class="hs-identifier hs-type">nextReactiveState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Slot</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.Spec</span></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>    </span><span id="local-6989586621679426445"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#nextReactiveState"><span class="hs-identifier hs-var hs-var">nextReactiveState</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Spec state ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-comment">-- | This is where the model logic is defined. Given an action, `nextState` specifies the</span><span>
</span><span id="line-311"></span><span>    </span><span class="hs-comment">--   effects running that action has on the model state. It runs in the `QCCM.Spec` monad, which is a</span><span>
</span><span id="line-312"></span><span>    </span><span class="hs-comment">--   state monad over the `QCCM.ModelState`.</span></span><span>
</span><span id="line-313"></span><span>    </span><span id="nextState"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#nextState"><span class="hs-identifier hs-type">nextState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.Spec</span></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span>    </span><span class="hs-comment">-- | Start new contract instances</span><span>
</span><span id="line-316"></span><span>    </span><span id="startInstances"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#startInstances"><span class="hs-identifier hs-type">startInstances</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.ModelState</span></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span>
</span><span id="line-317"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span>
</span><span id="line-318"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#StartContract"><span class="hs-identifier hs-type">StartContract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-319"></span><span>    </span><span id="local-6989586621679426442"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#startInstances"><span class="hs-identifier hs-var hs-var">startInstances</span></a></span><span> </span><span class="annot"><span class="annottext">ModelState state
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Action state
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span>    </span><span class="hs-comment">-- | Map a `ContractInstanceKey` `k` to the `Contract` that is started when we start</span><span>
</span><span id="line-322"></span><span>    </span><span class="hs-comment">-- `k` in a given `QCCM.ModelState` with a given semantics of `SymToken`s</span></span><span>
</span><span id="line-323"></span><span>    </span><span id="local-6989586621679426860"><span id="local-6989586621679426861"><span id="local-6989586621679426862"><span id="local-6989586621679426863"><span id="instanceContract"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#instanceContract"><span class="hs-identifier hs-type">instanceContract</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679426440"><span class="annot"><a href="#local-6989586621679426440"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.HasSymbolicRep</span></span><span> </span><span class="annot"><a href="#local-6989586621679426440"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.Symbolic</span></span><span> </span><span class="annot"><a href="#local-6989586621679426440"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679426440"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractInstanceKey"><span class="hs-identifier hs-type">ContractInstanceKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426863"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426862"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426861"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426860"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-325"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679426860"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-326"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Contract</span></span><span> </span><span class="annot"><a href="#local-6989586621679426863"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426862"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426861"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span>    </span><span class="hs-comment">-- | While `nextState` models the behaviour of the actions, `perform` contains the code for</span><span>
</span><span id="line-329"></span><span>    </span><span class="hs-comment">--   running the actions in the emulator (see &quot;Plutus.Trace.Emulator&quot;). It gets access to the</span><span>
</span><span id="line-330"></span><span>    </span><span class="hs-comment">--   wallet contract handles, the current model state, and the action to be performed.</span><span>
</span><span id="line-331"></span><span>    </span><span id="perform"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#perform"><span class="hs-identifier hs-type">perform</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#HandleFun"><span class="hs-identifier hs-type">HandleFun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span>  </span><span class="hs-comment">-- ^ Function from `ContractInstanceKey` to `ContractHandle`</span><span>
</span><span id="line-332"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679426438"><span class="annot"><a href="#local-6989586621679426438"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.HasSymbolicRep</span></span><span> </span><span class="annot"><a href="#local-6989586621679426438"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.Symbolic</span></span><span> </span><span class="annot"><a href="#local-6989586621679426438"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679426438"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>                </span><span class="hs-comment">-- ^ Map from symbolic things (that may appear in actions or the state)</span><span>
</span><span id="line-334"></span><span>                </span><span class="hs-comment">-- to actual things that appear at runtime</span><span>
</span><span id="line-335"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.ModelState</span></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-comment">-- ^ The model state before peforming the action</span><span>
</span><span id="line-336"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span>     </span><span class="hs-comment">-- ^ The action to perform</span><span>
</span><span id="line-337"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#SpecificationEmulatorTrace"><span class="hs-identifier hs-type">SpecificationEmulatorTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span>    </span><span class="hs-comment">-- | When a test involving random sequences of actions fails, the framework tries to find a</span><span>
</span><span id="line-340"></span><span>    </span><span class="hs-comment">--   minimal failing test case by shrinking the original failure. Action sequences are shrunk by</span><span>
</span><span id="line-341"></span><span>    </span><span class="hs-comment">--   removing individual actions, or by replacing an action by one of the (simpler) actions</span><span>
</span><span id="line-342"></span><span>    </span><span class="hs-comment">--   returned by `shrinkAction`.</span><span>
</span><span id="line-343"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-344"></span><span>    </span><span class="hs-comment">--   See `Test.QuickCheck.shrink` for more information on shrinking.</span><span>
</span><span id="line-345"></span><span>    </span><span id="shrinkAction"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#shrinkAction"><span class="hs-identifier hs-type">shrinkAction</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.ModelState</span></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-346"></span><span>    </span><span id="local-6989586621679426436"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#shrinkAction"><span class="hs-identifier hs-var hs-var">shrinkAction</span></a></span><span> </span><span class="annot"><span class="annottext">ModelState state
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Action state
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span>    </span><span class="hs-comment">-- | The `monitoring` function allows you to collect statistics of your testing using QuickCheck</span><span>
</span><span id="line-349"></span><span>    </span><span class="hs-comment">--   functions like `Test.QuickCheck.label`, `Test.QuickCheck.collect`,</span><span>
</span><span id="line-350"></span><span>    </span><span class="hs-comment">--   `Test.QuickCheck.classify`, and `Test.QuickCheck.tabulate`. This function is called by</span><span>
</span><span id="line-351"></span><span>    </span><span class="hs-comment">--   `propRunActions` (and friends) for any actions in the given `Actions`.</span><span>
</span><span id="line-352"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-353"></span><span>    </span><span class="hs-comment">--   Statistics on which actions are executed are always collected.</span></span><span>
</span><span id="line-354"></span><span>    </span><span id="monitoring"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#monitoring"><span class="hs-identifier hs-type">monitoring</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">QCCM.ModelState</span></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.ModelState</span></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ Model state before and after the action</span><span>
</span><span id="line-355"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span>                          </span><span class="hs-comment">-- ^ The action that was performed</span><span>
</span><span id="line-356"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span>
</span><span id="line-357"></span><span>    </span><span id="local-6989586621679426434"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#monitoring"><span class="hs-identifier hs-var hs-var">monitoring</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelState state, ModelState state)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Action state
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Property -&gt; Property
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span>    </span><span class="hs-comment">-- | In some scenarios it's useful to have actions that are never generated randomly, but only</span><span>
</span><span id="line-360"></span><span>    </span><span class="hs-comment">--   used explicitly in `DL` scenario `action`s. To avoid these actions matching an `anyAction`</span><span>
</span><span id="line-361"></span><span>    </span><span class="hs-comment">--   when shrinking, they can be marked `restricted`.</span></span><span>
</span><span id="line-362"></span><span>    </span><span id="restricted"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#restricted"><span class="hs-identifier hs-type">restricted</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679427001"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-363"></span><span>    </span><span id="local-6989586621679426431"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#restricted"><span class="hs-identifier hs-var hs-var">restricted</span></a></span><span> </span><span class="annot"><span class="annottext">Action state
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span></span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span id="local-6989586621679426429"><span id="local-6989586621679426430"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="WrappedState"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrappedState"><span class="hs-identifier hs-var">WrappedState</span></a></span></span><span> </span><span id="local-6989586621679426869"><span class="annot"><a href="#local-6989586621679426869"><span class="hs-identifier hs-type">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="WrapState"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrapState"><span class="hs-identifier hs-var">WrapState</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unwrapState"><span class="annot"><span class="annottext">WrappedState state -&gt; state
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#unwrapState"><span class="hs-identifier hs-var hs-var">unwrapState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679426869"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-366"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679426412"><span id="local-6989586621679426414"><span id="local-6989586621679426416"><span id="local-6989586621679426418"><span id="local-6989586621679426420"><span id="local-6989586621679426422"><span id="local-6989586621679426424"><span class="annot"><span class="annottext">Eq (WrappedState state)
Eq (WrappedState state)
-&gt; (WrappedState state -&gt; WrappedState state -&gt; Ordering)
-&gt; (WrappedState state -&gt; WrappedState state -&gt; Bool)
-&gt; (WrappedState state -&gt; WrappedState state -&gt; Bool)
-&gt; (WrappedState state -&gt; WrappedState state -&gt; Bool)
-&gt; (WrappedState state -&gt; WrappedState state -&gt; Bool)
-&gt; (WrappedState state -&gt; WrappedState state -&gt; WrappedState state)
-&gt; (WrappedState state -&gt; WrappedState state -&gt; WrappedState state)
-&gt; Ord (WrappedState state)
WrappedState state -&gt; WrappedState state -&gt; Bool
WrappedState state -&gt; WrappedState state -&gt; Ordering
WrappedState state -&gt; WrappedState state -&gt; WrappedState state
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall state. Ord state =&gt; Eq (WrappedState state)
forall state.
Ord state =&gt;
WrappedState state -&gt; WrappedState state -&gt; Bool
forall state.
Ord state =&gt;
WrappedState state -&gt; WrappedState state -&gt; Ordering
forall state.
Ord state =&gt;
WrappedState state -&gt; WrappedState state -&gt; WrappedState state
min :: WrappedState state -&gt; WrappedState state -&gt; WrappedState state
$cmin :: forall state.
Ord state =&gt;
WrappedState state -&gt; WrappedState state -&gt; WrappedState state
max :: WrappedState state -&gt; WrappedState state -&gt; WrappedState state
$cmax :: forall state.
Ord state =&gt;
WrappedState state -&gt; WrappedState state -&gt; WrappedState state
&gt;= :: WrappedState state -&gt; WrappedState state -&gt; Bool
$c&gt;= :: forall state.
Ord state =&gt;
WrappedState state -&gt; WrappedState state -&gt; Bool
&gt; :: WrappedState state -&gt; WrappedState state -&gt; Bool
$c&gt; :: forall state.
Ord state =&gt;
WrappedState state -&gt; WrappedState state -&gt; Bool
&lt;= :: WrappedState state -&gt; WrappedState state -&gt; Bool
$c&lt;= :: forall state.
Ord state =&gt;
WrappedState state -&gt; WrappedState state -&gt; Bool
&lt; :: WrappedState state -&gt; WrappedState state -&gt; Bool
$c&lt; :: forall state.
Ord state =&gt;
WrappedState state -&gt; WrappedState state -&gt; Bool
compare :: WrappedState state -&gt; WrappedState state -&gt; Ordering
$ccompare :: forall state.
Ord state =&gt;
WrappedState state -&gt; WrappedState state -&gt; Ordering
$cp1Ord :: forall state. Ord state =&gt; Eq (WrappedState state)
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679426407"><span id="local-6989586621679426409"><span class="annot"><span class="annottext">WrappedState state -&gt; WrappedState state -&gt; Bool
(WrappedState state -&gt; WrappedState state -&gt; Bool)
-&gt; (WrappedState state -&gt; WrappedState state -&gt; Bool)
-&gt; Eq (WrappedState state)
forall state.
Eq state =&gt;
WrappedState state -&gt; WrappedState state -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: WrappedState state -&gt; WrappedState state -&gt; Bool
$c/= :: forall state.
Eq state =&gt;
WrappedState state -&gt; WrappedState state -&gt; Bool
== :: WrappedState state -&gt; WrappedState state -&gt; Bool
$c== :: forall state.
Eq state =&gt;
WrappedState state -&gt; WrappedState state -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. WrappedState state -&gt; Rep (WrappedState state) x)
-&gt; (forall x. Rep (WrappedState state) x -&gt; WrappedState state)
-&gt; Generic (WrappedState state)
forall x. Rep (WrappedState state) x -&gt; WrappedState state
forall x. WrappedState state -&gt; Rep (WrappedState state) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall state x. Rep (WrappedState state) x -&gt; WrappedState state
forall state x. WrappedState state -&gt; Rep (WrappedState state) x
$cto :: forall state x. Rep (WrappedState state) x -&gt; WrappedState state
$cfrom :: forall state x. WrappedState state -&gt; Rep (WrappedState state) x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679426397"><span id="local-6989586621679426399"><span id="local-6989586621679426401"><span class="annot"><span class="annottext">Int -&gt; WrappedState state -&gt; ShowS
[WrappedState state] -&gt; ShowS
WrappedState state -&gt; String
(Int -&gt; WrappedState state -&gt; ShowS)
-&gt; (WrappedState state -&gt; String)
-&gt; ([WrappedState state] -&gt; ShowS)
-&gt; Show (WrappedState state)
forall state. Show state =&gt; Int -&gt; WrappedState state -&gt; ShowS
forall state. Show state =&gt; [WrappedState state] -&gt; ShowS
forall state. Show state =&gt; WrappedState state -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [WrappedState state] -&gt; ShowS
$cshowList :: forall state. Show state =&gt; [WrappedState state] -&gt; ShowS
show :: WrappedState state -&gt; String
$cshow :: forall state. Show state =&gt; WrappedState state -&gt; String
showsPrec :: Int -&gt; WrappedState state -&gt; ShowS
$cshowsPrec :: forall state. Show state =&gt; Int -&gt; WrappedState state -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span id="local-6989586621679426387"><span id="local-6989586621679426389"><span id="local-6989586621679426391"><span id="local-6989586621679426392"><span id="local-6989586621679426393"><span id="local-6989586621679426394"><span id="local-6989586621679426395"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractInstanceKey"><span class="hs-identifier hs-type">ContractInstanceKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426395"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426394"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426393"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426392"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426391"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#ContractInstanceKey"><span class="hs-identifier hs-type">CMI.ContractInstanceKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrappedState"><span class="hs-identifier hs-type">WrappedState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426395"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679426394"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426393"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426392"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426391"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-370"></span><span id="local-6989586621679426381"><span id="local-6989586621679426383"><span id="local-6989586621679426385"><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679426376"><span id="local-6989586621679426377"><span id="local-6989586621679426378"><span id="local-6989586621679426379"><span id="local-6989586621679426380"><span class="annot"><a href="#local-6989586621679426376"><span class="hs-keyword hs-type hs-type hs-type hs-type hs-type">newtype</span></a></span></span></span></span></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractInstanceKey"><span class="hs-identifier hs-type">ContractInstanceKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426380"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426379"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426378"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426377"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426376"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#ContractInstanceKey"><span class="hs-identifier hs-type">CMI.ContractInstanceKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrappedState"><span class="hs-identifier hs-type">WrappedState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426380"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679426379"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426378"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426377"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426376"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-371"></span><span>
</span><span id="line-372"></span><span class="hs-comment">-- TODO: This instance and the duplicated StartContract above is one of many good indications that going</span><span>
</span><span id="line-373"></span><span class="hs-comment">-- via this indirection is fugly and smelly. Instead of running in `WithInstances (WrappedState state)` we</span><span>
</span><span id="line-374"></span><span class="hs-comment">-- should perhaps ditch this particular indirection and just run in `WithInstances state`. Now, you</span><span>
</span><span id="line-375"></span><span class="hs-comment">-- can't just naively implement that - you would need to remove the `ContractInstanceModel` class and</span><span>
</span><span id="line-376"></span><span class="hs-comment">-- move all the derived machinery from internal to here to make it work. Painful but doable...</span><span>
</span><span id="line-377"></span><span id="local-6989586621679426375"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractModel"><span class="hs-identifier hs-type">ContractModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426375"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#ContractInstanceModel"><span class="hs-identifier hs-type">CMI.ContractInstanceModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrappedState"><span class="hs-identifier hs-type">WrappedState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426375"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-378"></span><span>  </span><span class="hs-keyword">newtype</span><span> </span><span id="ContractInstanceKey"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#ContractInstanceKey"><span class="hs-identifier hs-var">ContractInstanceKey</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrappedState"><span class="hs-identifier hs-type">WrappedState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426375"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679426890"><span class="annot"><a href="#local-6989586621679426890"><span class="hs-identifier hs-type hs-type">w</span></a></span></span><span> </span><span id="local-6989586621679426889"><span class="annot"><a href="#local-6989586621679426889"><span class="hs-identifier hs-type hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679426888"><span class="annot"><a href="#local-6989586621679426888"><span class="hs-identifier hs-type hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679426887"><span class="annot"><a href="#local-6989586621679426887"><span class="hs-identifier hs-type hs-type">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-379"></span><span>            </span><span id="WrapContractInstanceKey"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrapContractInstanceKey"><span class="hs-identifier hs-var">WrapContractInstanceKey</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unwrapContractInstanceKey"><span class="annot"><span class="annottext">ContractInstanceKey (WrappedState state) w s e p
-&gt; ContractInstanceKey state w s e p
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#unwrapContractInstanceKey"><span class="hs-identifier hs-var hs-var">unwrapContractInstanceKey</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractInstanceKey"><span class="hs-identifier hs-type">ContractInstanceKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426375"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426890"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426889"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426888"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426887"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-380"></span><span>  </span><span id="local-6989586621679426363"><span class="annot"><span class="annottext">instanceWallet :: ContractInstanceKey (WrappedState state) w s e p -&gt; Wallet
</span><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#instanceWallet"><span class="hs-identifier hs-var hs-var hs-var hs-var">instanceWallet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractInstanceKey state w s e p -&gt; Wallet
forall state w (s :: Row *) e p.
ContractModel state =&gt;
ContractInstanceKey state w s e p -&gt; Wallet
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#instanceWallet"><span class="hs-identifier hs-var">instanceWallet</span></a></span><span> </span><span class="annot"><span class="annottext">(ContractInstanceKey state w s e p -&gt; Wallet)
-&gt; (ContractInstanceKey (WrappedState state) w s e p
    -&gt; ContractInstanceKey state w s e p)
-&gt; ContractInstanceKey (WrappedState state) w s e p
-&gt; Wallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceKey (WrappedState state) w s e p
-&gt; ContractInstanceKey state w s e p
forall state w (s :: Row *) e p.
ContractInstanceKey (WrappedState state) w s e p
-&gt; ContractInstanceKey state w s e p
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#unwrapContractInstanceKey"><span class="hs-identifier hs-var hs-var">unwrapContractInstanceKey</span></a></span><span>
</span><span id="line-381"></span><span>  </span><span id="local-6989586621679426361"><span class="annot"><span class="annottext">instanceTag :: ContractInstanceKey (WrappedState state) w s e p
-&gt; ContractInstanceTag
</span><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#instanceTag"><span class="hs-identifier hs-var hs-var hs-var hs-var">instanceTag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractInstanceKey state w s e p -&gt; ContractInstanceTag
forall state w (s :: Row *) e p.
(ContractModel state, SchemaConstraints w s e) =&gt;
ContractInstanceKey state w s e p -&gt; ContractInstanceTag
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#instanceTag"><span class="hs-identifier hs-var">instanceTag</span></a></span><span> </span><span class="annot"><span class="annottext">(ContractInstanceKey state w s e p -&gt; ContractInstanceTag)
-&gt; (ContractInstanceKey (WrappedState state) w s e p
    -&gt; ContractInstanceKey state w s e p)
-&gt; ContractInstanceKey (WrappedState state) w s e p
-&gt; ContractInstanceTag
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceKey (WrappedState state) w s e p
-&gt; ContractInstanceKey state w s e p
forall state w (s :: Row *) e p.
ContractInstanceKey (WrappedState state) w s e p
-&gt; ContractInstanceKey state w s e p
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#unwrapContractInstanceKey"><span class="hs-identifier hs-var hs-var">unwrapContractInstanceKey</span></a></span><span>
</span><span id="line-382"></span><span>  </span><span id="local-6989586621679426359"><span class="annot"><span class="annottext">initialInstances :: [StartContract (WrappedState state)]
</span><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#initialInstances"><span class="hs-identifier hs-var hs-var hs-var hs-var">initialInstances</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StartContract state -&gt; StartContract (WrappedState state))
-&gt; [StartContract state] -&gt; [StartContract (WrappedState state)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">StartContract state -&gt; StartContract (WrappedState state)
forall state.
StartContract state -&gt; StartContract (WrappedState state)
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#wrapStartContract"><span class="hs-identifier hs-var">wrapStartContract</span></a></span><span> </span><span class="annot"><span class="annottext">([StartContract state] -&gt; [StartContract (WrappedState state)])
-&gt; [StartContract state] -&gt; [StartContract (WrappedState state)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ContractModel state =&gt; [StartContract state]
forall state. ContractModel state =&gt; [StartContract state]
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#initialInstances"><span class="hs-identifier hs-var">initialInstances</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679426375"><span class="hs-identifier hs-type">state</span></a></span><span>
</span><span id="line-383"></span><span>  </span><span id="local-6989586621679426356"><span class="annot"><span class="annottext">startInstances :: ModelState (WrappedState state)
-&gt; Action (WrappedState state)
-&gt; [StartContract (WrappedState state)]
</span><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#startInstances"><span class="hs-identifier hs-var hs-var hs-var hs-var">startInstances</span></a></span></span><span> </span><span id="local-6989586621679426354"><span class="annot"><span class="annottext">ModelState (WrappedState state)
</span><a href="#local-6989586621679426354"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679426353"><span class="annot"><span class="annottext">Action (WrappedState state)
</span><a href="#local-6989586621679426353"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StartContract state -&gt; StartContract (WrappedState state))
-&gt; [StartContract state] -&gt; [StartContract (WrappedState state)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">StartContract state -&gt; StartContract (WrappedState state)
forall state.
StartContract state -&gt; StartContract (WrappedState state)
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#wrapStartContract"><span class="hs-identifier hs-var">wrapStartContract</span></a></span><span> </span><span class="annot"><span class="annottext">([StartContract state] -&gt; [StartContract (WrappedState state)])
-&gt; [StartContract state] -&gt; [StartContract (WrappedState state)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ModelState state -&gt; Action state -&gt; [StartContract state]
forall state.
ContractModel state =&gt;
ModelState state -&gt; Action state -&gt; [StartContract state]
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#startInstances"><span class="hs-identifier hs-var">startInstances</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WrappedState state -&gt; state)
-&gt; ModelState (WrappedState state) -&gt; ModelState state
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">WrappedState state -&gt; state
forall state. WrappedState state -&gt; state
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#unwrapState"><span class="hs-identifier hs-var hs-var">unwrapState</span></a></span><span> </span><span class="annot"><span class="annottext">ModelState (WrappedState state)
</span><a href="#local-6989586621679426354"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Action (WrappedState state) -&gt; Action state
forall state. Action (WrappedState state) -&gt; Action state
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#unwrapAction"><span class="hs-identifier hs-var hs-var">unwrapAction</span></a></span><span> </span><span class="annot"><span class="annottext">Action (WrappedState state)
</span><a href="#local-6989586621679426353"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>  </span><span id="local-6989586621679426351"><span class="annot"><span class="annottext">instanceContract :: (forall t. HasSymbolicRep t =&gt; Symbolic t -&gt; t)
-&gt; ContractInstanceKey (WrappedState state) w s e p
-&gt; p
-&gt; Contract w s e ()
</span><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#instanceContract"><span class="hs-identifier hs-var hs-var hs-var hs-var">instanceContract</span></a></span></span><span> </span><span id="local-6989586621679426349"><span class="annot"><span class="annottext">forall t. HasSymbolicRep t =&gt; Symbolic t -&gt; t
</span><a href="#local-6989586621679426349"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679426348"><span class="annot"><span class="annottext">ContractInstanceKey (WrappedState state) w s e p
</span><a href="#local-6989586621679426348"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679426347"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679426347"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall t. HasSymbolicRep t =&gt; Symbolic t -&gt; t)
-&gt; ContractInstanceKey state w s e p -&gt; p -&gt; Contract w s e ()
forall state w (s :: Row *) e p.
ContractModel state =&gt;
(forall t. HasSymbolicRep t =&gt; Symbolic t -&gt; t)
-&gt; ContractInstanceKey state w s e p -&gt; p -&gt; Contract w s e ()
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#instanceContract"><span class="hs-identifier hs-var">instanceContract</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. HasSymbolicRep t =&gt; Symbolic t -&gt; t
</span><a href="#local-6989586621679426349"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContractInstanceKey (WrappedState state) w s e p
-&gt; ContractInstanceKey state w s e p
forall state w (s :: Row *) e p.
ContractInstanceKey (WrappedState state) w s e p
-&gt; ContractInstanceKey state w s e p
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#unwrapContractInstanceKey"><span class="hs-identifier hs-var hs-var">unwrapContractInstanceKey</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceKey (WrappedState state) w s e p
</span><a href="#local-6989586621679426348"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679426347"><span class="hs-identifier hs-var">p</span></a></span></span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span id="local-6989586621679426876"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#wrapStartContract"><span class="hs-identifier hs-type">wrapStartContract</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#StartContract"><span class="hs-identifier hs-type">StartContract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426876"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#StartContract"><span class="hs-identifier hs-type">CMI.StartContract</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrappedState"><span class="hs-identifier hs-type">WrappedState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426876"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-387"></span><span id="wrapStartContract"><span class="annot"><span class="annottext">wrapStartContract :: StartContract state -&gt; StartContract (WrappedState state)
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#wrapStartContract"><span class="hs-identifier hs-var hs-var">wrapStartContract</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#StartContract"><span class="hs-identifier hs-type">StartContract</span></a></span><span> </span><span id="local-6989586621679426346"><span class="annot"><span class="annottext">ContractInstanceKey state w s e p
</span><a href="#local-6989586621679426346"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679426345"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679426345"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractInstanceKey (WrappedState state) w s e p
-&gt; p -&gt; StartContract (WrappedState state)
forall w (s :: Row *) e p state.
(SchemaConstraints w s e, Typeable p) =&gt;
ContractInstanceKey state w s e p -&gt; p -&gt; StartContract state
</span><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#StartContract"><span class="hs-identifier hs-var">CMI.StartContract</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContractInstanceKey state w s e p
-&gt; ContractInstanceKey (WrappedState state) w s e p
forall state w (s :: Row *) e p.
ContractInstanceKey state w s e p
-&gt; ContractInstanceKey (WrappedState state) w s e p
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrapContractInstanceKey"><span class="hs-identifier hs-var">WrapContractInstanceKey</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceKey state w s e p
</span><a href="#local-6989586621679426346"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679426345"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span id="local-6989586621679426339"><span id="local-6989586621679426341"><span id="local-6989586621679426343"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426343"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">QCCM.Action</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrappedState"><span class="hs-identifier hs-type">WrappedState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426343"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-390"></span><span id="local-6989586621679426333"><span id="local-6989586621679426335"><span id="local-6989586621679426337"><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679426332"><span class="annot"><a href="#local-6989586621679426332"><span class="hs-keyword hs-type">newtype</span></a></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426332"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">QCCM.Action</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrappedState"><span class="hs-identifier hs-type">WrappedState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426332"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-391"></span><span id="local-6989586621679426331"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Generic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">QCCM.Action</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrappedState"><span class="hs-identifier hs-type">WrappedState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426331"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span id="local-6989586621679426328"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractModel"><span class="hs-identifier hs-type">ContractModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426328"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.ContractModel</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrappedState"><span class="hs-identifier hs-type">WrappedState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426328"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-394"></span><span>  </span><span class="hs-keyword">newtype</span><span> </span><span id="Action"><span class="annot"><span class="hs-identifier hs-var">Action</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrappedState"><span class="hs-identifier hs-type">WrappedState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426328"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="WrapAction"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrapAction"><span class="hs-identifier hs-var">WrapAction</span></a></span></span><span class="hs-special">{</span><span> </span><span id="unwrapAction"><span class="annot"><span class="annottext">Action (WrappedState state) -&gt; Action state
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#unwrapAction"><span class="hs-identifier hs-var hs-var">unwrapAction</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426328"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-395"></span><span>  </span><span id="local-6989586621679426310"><span class="annot"><span class="annottext">arbitraryAction :: ModelState (WrappedState state)
-&gt; Gen (Action (WrappedState state))
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">arbitraryAction</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Action state -&gt; Action (WrappedState state))
-&gt; Gen (Action state) -&gt; Gen (Action (WrappedState state))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Action state -&gt; Action (WrappedState state)
forall state. Action state -&gt; Action (WrappedState state)
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrapAction"><span class="hs-identifier hs-var">WrapAction</span></a></span><span> </span><span class="annot"><span class="annottext">(Gen (Action state) -&gt; Gen (Action (WrappedState state)))
-&gt; (ModelState (WrappedState state) -&gt; Gen (Action state))
-&gt; ModelState (WrappedState state)
-&gt; Gen (Action (WrappedState state))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ModelState state -&gt; Gen (Action state)
forall state.
ContractModel state =&gt;
ModelState state -&gt; Gen (Action state)
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#arbitraryAction"><span class="hs-identifier hs-var">arbitraryAction</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelState state -&gt; Gen (Action state))
-&gt; (ModelState (WrappedState state) -&gt; ModelState state)
-&gt; ModelState (WrappedState state)
-&gt; Gen (Action state)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(WrappedState state -&gt; state)
-&gt; ModelState (WrappedState state) -&gt; ModelState state
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">WrappedState state -&gt; state
forall state. WrappedState state -&gt; state
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#unwrapState"><span class="hs-identifier hs-var hs-var">unwrapState</span></a></span><span>
</span><span id="line-396"></span><span>  </span><span id="local-6989586621679426308"><span class="annot"><span class="annottext">actionName :: Action (WrappedState state) -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">actionName</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Action state -&gt; String
forall state. ContractModel state =&gt; Action state -&gt; String
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#actionName"><span class="hs-identifier hs-var">actionName</span></a></span><span> </span><span class="annot"><span class="annottext">(Action state -&gt; String)
-&gt; (Action (WrappedState state) -&gt; Action state)
-&gt; Action (WrappedState state)
-&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Action (WrappedState state) -&gt; Action state
forall state. Action (WrappedState state) -&gt; Action state
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#unwrapAction"><span class="hs-identifier hs-var hs-var">unwrapAction</span></a></span><span>
</span><span id="line-397"></span><span>  </span><span id="local-6989586621679426306"><span class="annot"><span class="annottext">waitProbability :: ModelState (WrappedState state) -&gt; Double
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">waitProbability</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelState state -&gt; Double
forall state. ContractModel state =&gt; ModelState state -&gt; Double
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#waitProbability"><span class="hs-identifier hs-var">waitProbability</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelState state -&gt; Double)
-&gt; (ModelState (WrappedState state) -&gt; ModelState state)
-&gt; ModelState (WrappedState state)
-&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(WrappedState state -&gt; state)
-&gt; ModelState (WrappedState state) -&gt; ModelState state
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">WrappedState state -&gt; state
forall state. WrappedState state -&gt; state
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#unwrapState"><span class="hs-identifier hs-var hs-var">unwrapState</span></a></span><span>
</span><span id="line-398"></span><span>  </span><span id="local-6989586621679426304"><span class="annot"><span class="annottext">arbitraryWaitInterval :: ModelState (WrappedState state) -&gt; Gen SlotNo
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">arbitraryWaitInterval</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Slot -&gt; SlotNo) -&gt; Gen Slot -&gt; Gen SlotNo
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; SlotNo
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#toSlotNo"><span class="hs-identifier hs-var">toSlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">(Gen Slot -&gt; Gen SlotNo)
-&gt; (ModelState (WrappedState state) -&gt; Gen Slot)
-&gt; ModelState (WrappedState state)
-&gt; Gen SlotNo
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ModelState state -&gt; Gen Slot
forall state. ContractModel state =&gt; ModelState state -&gt; Gen Slot
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#arbitraryWaitInterval"><span class="hs-identifier hs-var">arbitraryWaitInterval</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelState state -&gt; Gen Slot)
-&gt; (ModelState (WrappedState state) -&gt; ModelState state)
-&gt; ModelState (WrappedState state)
-&gt; Gen Slot
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(WrappedState state -&gt; state)
-&gt; ModelState (WrappedState state) -&gt; ModelState state
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">WrappedState state -&gt; state
forall state. WrappedState state -&gt; state
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#unwrapState"><span class="hs-identifier hs-var hs-var">unwrapState</span></a></span><span>
</span><span id="line-399"></span><span>  </span><span id="local-6989586621679426302"><span class="annot"><span class="annottext">initialState :: WrappedState state
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">initialState</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">state -&gt; WrappedState state
forall state. state -&gt; WrappedState state
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrapState"><span class="hs-identifier hs-var">WrapState</span></a></span><span> </span><span class="annot"><span class="annottext">state
forall state. ContractModel state =&gt; state
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#initialState"><span class="hs-identifier hs-var">initialState</span></a></span><span>
</span><span id="line-400"></span><span>  </span><span id="local-6989586621679426300"><span class="annot"><span class="annottext">precondition :: ModelState (WrappedState state)
-&gt; Action (WrappedState state) -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">precondition</span></span></span><span> </span><span id="local-6989586621679426298"><span class="annot"><span class="annottext">ModelState (WrappedState state)
</span><a href="#local-6989586621679426298"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679426297"><span class="annot"><span class="annottext">Action (WrappedState state)
</span><a href="#local-6989586621679426297"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelState state -&gt; Action state -&gt; Bool
forall state.
ContractModel state =&gt;
ModelState state -&gt; Action state -&gt; Bool
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#precondition"><span class="hs-identifier hs-var">precondition</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WrappedState state -&gt; state)
-&gt; ModelState (WrappedState state) -&gt; ModelState state
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">WrappedState state -&gt; state
forall state. WrappedState state -&gt; state
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#unwrapState"><span class="hs-identifier hs-var hs-var">unwrapState</span></a></span><span> </span><span class="annot"><span class="annottext">ModelState (WrappedState state)
</span><a href="#local-6989586621679426298"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Action (WrappedState state) -&gt; Action state
forall state. Action (WrappedState state) -&gt; Action state
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#unwrapAction"><span class="hs-identifier hs-var hs-var">unwrapAction</span></a></span><span> </span><span class="annot"><span class="annottext">Action (WrappedState state)
</span><a href="#local-6989586621679426297"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>  </span><span id="local-6989586621679426296"><span class="annot"><span class="annottext">nextReactiveState :: SlotNo -&gt; Spec (WrappedState state) ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">nextReactiveState</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Spec state () -&gt; Spec (WrappedState state) ()
forall s s' a. Coercible s s' =&gt; Spec s a -&gt; Spec s' a
</span><span class="hs-identifier hs-var">QCCM.coerceSpec</span></span><span> </span><span class="annot"><span class="annottext">(Spec state () -&gt; Spec (WrappedState state) ())
-&gt; (SlotNo -&gt; Spec state ())
-&gt; SlotNo
-&gt; Spec (WrappedState state) ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ContractModel state =&gt; Slot -&gt; Spec state ()
forall state. ContractModel state =&gt; Slot -&gt; Spec state ()
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#nextReactiveState"><span class="hs-identifier hs-var">nextReactiveState</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679426328"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="annot"><span class="annottext">(Slot -&gt; Spec state ())
-&gt; (SlotNo -&gt; Slot) -&gt; SlotNo -&gt; Spec state ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; Slot
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#fromSlotNo"><span class="hs-identifier hs-var">fromSlotNo</span></a></span><span>
</span><span id="line-402"></span><span>  </span><span id="local-6989586621679426293"><span class="annot"><span class="annottext">nextState :: Action (WrappedState state) -&gt; Spec (WrappedState state) ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">nextState</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Spec state () -&gt; Spec (WrappedState state) ()
forall s s' a. Coercible s s' =&gt; Spec s a -&gt; Spec s' a
</span><span class="hs-identifier hs-var">QCCM.coerceSpec</span></span><span> </span><span class="annot"><span class="annottext">(Spec state () -&gt; Spec (WrappedState state) ())
-&gt; (Action (WrappedState state) -&gt; Spec state ())
-&gt; Action (WrappedState state)
-&gt; Spec (WrappedState state) ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Action state -&gt; Spec state ()
forall state. ContractModel state =&gt; Action state -&gt; Spec state ()
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#nextState"><span class="hs-identifier hs-var">nextState</span></a></span><span> </span><span class="annot"><span class="annottext">(Action state -&gt; Spec state ())
-&gt; (Action (WrappedState state) -&gt; Action state)
-&gt; Action (WrappedState state)
-&gt; Spec state ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Action (WrappedState state) -&gt; Action state
forall state. Action (WrappedState state) -&gt; Action state
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#unwrapAction"><span class="hs-identifier hs-var hs-var">unwrapAction</span></a></span><span>
</span><span id="line-403"></span><span>  </span><span id="local-6989586621679426291"><span class="annot"><span class="annottext">shrinkAction :: ModelState (WrappedState state)
-&gt; Action (WrappedState state) -&gt; [Action (WrappedState state)]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">shrinkAction</span></span></span><span> </span><span id="local-6989586621679426289"><span class="annot"><span class="annottext">ModelState (WrappedState state)
</span><a href="#local-6989586621679426289"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679426288"><span class="annot"><span class="annottext">Action (WrappedState state)
</span><a href="#local-6989586621679426288"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Action state -&gt; Action (WrappedState state)
forall state. Action state -&gt; Action (WrappedState state)
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrapAction"><span class="hs-identifier hs-var">WrapAction</span></a></span><span> </span><span class="annot"><span class="annottext">(Action state -&gt; Action (WrappedState state))
-&gt; [Action state] -&gt; [Action (WrappedState state)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ModelState state -&gt; Action state -&gt; [Action state]
forall state.
ContractModel state =&gt;
ModelState state -&gt; Action state -&gt; [Action state]
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#shrinkAction"><span class="hs-identifier hs-var">shrinkAction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WrappedState state -&gt; state)
-&gt; ModelState (WrappedState state) -&gt; ModelState state
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">WrappedState state -&gt; state
forall state. WrappedState state -&gt; state
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#unwrapState"><span class="hs-identifier hs-var hs-var">unwrapState</span></a></span><span> </span><span class="annot"><span class="annottext">ModelState (WrappedState state)
</span><a href="#local-6989586621679426289"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Action (WrappedState state) -&gt; Action state
forall state. Action (WrappedState state) -&gt; Action state
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#unwrapAction"><span class="hs-identifier hs-var hs-var">unwrapAction</span></a></span><span> </span><span class="annot"><span class="annottext">Action (WrappedState state)
</span><a href="#local-6989586621679426288"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>  </span><span id="local-6989586621679426287"><span class="annot"><span class="annottext">restricted :: Action (WrappedState state) -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">restricted</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Action state -&gt; Bool
forall state. ContractModel state =&gt; Action state -&gt; Bool
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#restricted"><span class="hs-identifier hs-var">restricted</span></a></span><span> </span><span class="annot"><span class="annottext">(Action state -&gt; Bool)
-&gt; (Action (WrappedState state) -&gt; Action state)
-&gt; Action (WrappedState state)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Action (WrappedState state) -&gt; Action state
forall state. Action (WrappedState state) -&gt; Action state
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#unwrapAction"><span class="hs-identifier hs-var hs-var">unwrapAction</span></a></span></span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span id="local-6989586621679426285"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractModel"><span class="hs-identifier hs-type">ContractModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426285"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.RunModel</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrappedState"><span class="hs-identifier hs-type">WrappedState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426285"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#SpecificationEmulatorTrace"><span class="hs-identifier hs-type">CMI.SpecificationEmulatorTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrappedState"><span class="hs-identifier hs-type">WrappedState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426285"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-407"></span><span>  </span><span id="local-6989586621679426279"><span class="annot"><span class="annottext">perform :: ModelState (WrappedState state)
-&gt; Action (WrappedState state)
-&gt; (forall t. HasSymbolicRep t =&gt; Symbolic t -&gt; t)
-&gt; RunMonad (SpecificationEmulatorTrace (WrappedState state)) ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">perform</span></span></span><span> </span><span id="local-6989586621679426277"><span class="annot"><span class="annottext">ModelState (WrappedState state)
</span><a href="#local-6989586621679426277"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679426276"><span class="annot"><span class="annottext">Action (WrappedState state)
</span><a href="#local-6989586621679426276"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679426275"><span class="annot"><span class="annottext">forall t. HasSymbolicRep t =&gt; Symbolic t -&gt; t
</span><a href="#local-6989586621679426275"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-408"></span><span>    </span><span id="local-6989586621679426274"><span class="annot"><span class="annottext">Handles (WrappedState state)
</span><a href="#local-6989586621679426274"><span class="hs-identifier hs-var">handles</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff
  (Reader (Handles (WrappedState state)) : BaseEmulatorEffects)
  (Handles (WrappedState state))
-&gt; RunMonad
     (SpecificationEmulatorTrace (WrappedState state))
     (Handles (WrappedState state))
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Eff
   (Reader (Handles (WrappedState state)) : BaseEmulatorEffects)
   (Handles (WrappedState state))
 -&gt; RunMonad
      (SpecificationEmulatorTrace (WrappedState state))
      (Handles (WrappedState state)))
-&gt; Eff
     (Reader (Handles (WrappedState state)) : BaseEmulatorEffects)
     (Handles (WrappedState state))
-&gt; RunMonad
     (SpecificationEmulatorTrace (WrappedState state))
     (Handles (WrappedState state))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (Handles (WrappedState state))) effs =&gt;
Eff effs (Handles (WrappedState state))
forall r (effs :: [* -&gt; *]). Member (Reader r) effs =&gt; Eff effs r
</span><span class="hs-identifier hs-var">ask</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#Handles"><span class="hs-identifier hs-type">CMI.Handles</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrappedState"><span class="hs-identifier hs-type">WrappedState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426285"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679426272"><span class="hs-identifier hs-type">lookup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#HandleFun"><span class="hs-identifier hs-type">HandleFun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426285"><span class="hs-identifier hs-type">state</span></a></span><span>
</span><span id="line-410"></span><span>        </span><span id="local-6989586621679426272"><span class="annot"><span class="annottext">lookup :: ContractInstanceKey state w schema err params
-&gt; ContractHandle w schema err
</span><a href="#local-6989586621679426272"><span class="hs-identifier hs-var hs-var">lookup</span></a></span></span><span> </span><span id="local-6989586621679426271"><span class="annot"><span class="annottext">ContractInstanceKey state w schema err params
</span><a href="#local-6989586621679426271"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-411"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ContractInstanceKey (WrappedState state) w schema err params
-&gt; Handles (WrappedState state)
-&gt; Maybe (WalletContractHandle w schema err)
forall i1 j1 k1 l1 (i2 :: i1) (j2 :: j1) (k2 :: k1) (l2 :: l1)
       (key :: i1 -&gt; j1 -&gt; k1 -&gt; l1 -&gt; *) (val :: i1 -&gt; j1 -&gt; k1 -&gt; *).
(Typeable i2, Typeable j2, Typeable k2, Typeable l2, Typeable key,
 Typeable val, Eq (key i2 j2 k2 l2)) =&gt;
key i2 j2 k2 l2 -&gt; IMap key val -&gt; Maybe (val i2 j2 k2)
</span><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#imLookup"><span class="hs-identifier hs-var">CMI.imLookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContractInstanceKey state w schema err params
-&gt; ContractInstanceKey (WrappedState state) w schema err params
forall state w (s :: Row *) e p.
ContractInstanceKey state w s e p
-&gt; ContractInstanceKey (WrappedState state) w s e p
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrapContractInstanceKey"><span class="hs-identifier hs-var">WrapContractInstanceKey</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceKey state w schema err params
</span><a href="#local-6989586621679426271"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Handles (WrappedState state)
</span><a href="#local-6989586621679426274"><span class="hs-identifier hs-var">handles</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-412"></span><span>            </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#WalletContractHandle"><span class="hs-identifier hs-type">CMI.WalletContractHandle</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679426268"><span class="annot"><span class="annottext">ContractHandle w schema err
</span><a href="#local-6989586621679426268"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ContractHandle w schema err
</span><a href="#local-6989586621679426268"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-413"></span><span>            </span><span class="annot"><span class="annottext">Maybe (WalletContractHandle w schema err)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ContractHandle w schema err
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ContractHandle w schema err)
-&gt; String -&gt; ContractHandle w schema err
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;contractHandle: No handle for &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceKey state w schema err params -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceKey state w schema err params
</span><a href="#local-6989586621679426271"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-414"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679426266"><span class="annot"><span class="annottext">[(String, SomethingWithSymbolicRep)]
</span><a href="#local-6989586621679426266"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff
  (Reader (Handles (WrappedState state)) : BaseEmulatorEffects)
  ((), [(String, SomethingWithSymbolicRep)])
-&gt; RunMonad
     (SpecificationEmulatorTrace (WrappedState state))
     ((), [(String, SomethingWithSymbolicRep)])
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Eff
   (Reader (Handles (WrappedState state)) : BaseEmulatorEffects)
   ((), [(String, SomethingWithSymbolicRep)])
 -&gt; RunMonad
      (SpecificationEmulatorTrace (WrappedState state))
      ((), [(String, SomethingWithSymbolicRep)]))
-&gt; Eff
     (Reader (Handles (WrappedState state)) : BaseEmulatorEffects)
     ((), [(String, SomethingWithSymbolicRep)])
-&gt; RunMonad
     (SpecificationEmulatorTrace (WrappedState state))
     ((), [(String, SomethingWithSymbolicRep)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Eff BaseEmulatorEffects ((), [(String, SomethingWithSymbolicRep)])
-&gt; Eff
     (Reader (Handles (WrappedState state)) : BaseEmulatorEffects)
     ((), [(String, SomethingWithSymbolicRep)])
forall (effs :: [* -&gt; *]) a (e :: * -&gt; *).
Eff effs a -&gt; Eff (e : effs) a
</span><span class="hs-identifier hs-var">raise</span></span><span> </span><span class="annot"><span class="annottext">(Eff BaseEmulatorEffects ((), [(String, SomethingWithSymbolicRep)])
 -&gt; Eff
      (Reader (Handles (WrappedState state)) : BaseEmulatorEffects)
      ((), [(String, SomethingWithSymbolicRep)]))
-&gt; Eff
     BaseEmulatorEffects ((), [(String, SomethingWithSymbolicRep)])
-&gt; Eff
     (Reader (Handles (WrappedState state)) : BaseEmulatorEffects)
     ((), [(String, SomethingWithSymbolicRep)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  (Writer [(String, SomethingWithSymbolicRep)] : BaseEmulatorEffects)
  ()
-&gt; Eff
     BaseEmulatorEffects ((), [(String, SomethingWithSymbolicRep)])
forall w (effs :: [* -&gt; *]) a.
Monoid w =&gt;
Eff (Writer w : effs) a -&gt; Eff effs (a, w)
</span><span class="hs-identifier hs-var">runWriter</span></span><span> </span><span class="annot"><span class="annottext">(Eff
   (Writer [(String, SomethingWithSymbolicRep)] : BaseEmulatorEffects)
   ()
 -&gt; Eff
      BaseEmulatorEffects ((), [(String, SomethingWithSymbolicRep)]))
-&gt; Eff
     (Writer [(String, SomethingWithSymbolicRep)] : BaseEmulatorEffects)
     ()
-&gt; Eff
     BaseEmulatorEffects ((), [(String, SomethingWithSymbolicRep)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">HandleFun state
-&gt; (forall t. HasSymbolicRep t =&gt; Symbolic t -&gt; t)
-&gt; ModelState state
-&gt; Action state
-&gt; Eff
     (Writer [(String, SomethingWithSymbolicRep)] : BaseEmulatorEffects)
     ()
forall state.
ContractModel state =&gt;
HandleFun state
-&gt; (forall t. HasSymbolicRep t =&gt; Symbolic t -&gt; t)
-&gt; ModelState state
-&gt; Action state
-&gt; Eff
     (Writer [(String, SomethingWithSymbolicRep)] : BaseEmulatorEffects)
     ()
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#perform"><span class="hs-identifier hs-var">perform</span></a></span><span> </span><span class="annot"><span class="annottext">HandleFun state
</span><a href="#local-6989586621679426272"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. HasSymbolicRep t =&gt; Symbolic t -&gt; t
</span><a href="#local-6989586621679426275"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WrappedState state -&gt; state)
-&gt; ModelState (WrappedState state) -&gt; ModelState state
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">WrappedState state -&gt; state
forall state. WrappedState state -&gt; state
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#unwrapState"><span class="hs-identifier hs-var hs-var">unwrapState</span></a></span><span> </span><span class="annot"><span class="annottext">ModelState (WrappedState state)
</span><a href="#local-6989586621679426277"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Action (WrappedState state) -&gt; Action state
forall state. Action (WrappedState state) -&gt; Action state
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#unwrapAction"><span class="hs-identifier hs-var hs-var">unwrapAction</span></a></span><span> </span><span class="annot"><span class="annottext">Action (WrappedState state)
</span><a href="#local-6989586621679426276"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>    </span><span class="annot"><span class="annottext">[RunMonad (SpecificationEmulatorTrace (WrappedState state)) ()]
-&gt; RunMonad (SpecificationEmulatorTrace (WrappedState state)) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">sequence_</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
-&gt; t
-&gt; RunMonad (SpecificationEmulatorTrace (WrappedState state)) ()
forall (m :: * -&gt; *) t.
(Monad m, HasSymbolicRep t) =&gt;
String -&gt; t -&gt; RunMonad m ()
</span><span class="hs-identifier hs-var">QCCM.registerSymbolic</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679426263"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679426262"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679426263"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679426263"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#WithSymbolicRep"><span class="hs-identifier hs-type">WithSymbolicRep</span></a></span><span> </span><span id="local-6989586621679426262"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679426262"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(String, SomethingWithSymbolicRep)]
</span><a href="#local-6989586621679426266"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-416"></span><span>  </span><span id="local-6989586621679426261"><span class="annot"><span class="annottext">monitoring :: (ModelState (WrappedState state), ModelState (WrappedState state))
-&gt; Action (WrappedState state)
-&gt; (forall t. HasSymbolicRep t =&gt; Symbolic t -&gt; t)
-&gt; SymIndex
-&gt; Property
-&gt; Property
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">monitoring</span></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679426259"><span class="annot"><span class="annottext">ModelState (WrappedState state)
</span><a href="#local-6989586621679426259"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679426258"><span class="annot"><span class="annottext">ModelState (WrappedState state)
</span><a href="#local-6989586621679426258"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679426257"><span class="annot"><span class="annottext">Action (WrappedState state)
</span><a href="#local-6989586621679426257"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">forall t. HasSymbolicRep t =&gt; Symbolic t -&gt; t
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SymIndex
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ModelState state, ModelState state)
-&gt; Action state -&gt; Property -&gt; Property
forall state.
ContractModel state =&gt;
(ModelState state, ModelState state)
-&gt; Action state -&gt; Property -&gt; Property
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#monitoring"><span class="hs-identifier hs-var">monitoring</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WrappedState state -&gt; state)
-&gt; ModelState (WrappedState state) -&gt; ModelState state
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">WrappedState state -&gt; state
forall state. WrappedState state -&gt; state
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#unwrapState"><span class="hs-identifier hs-var hs-var">unwrapState</span></a></span><span> </span><span class="annot"><span class="annottext">ModelState (WrappedState state)
</span><a href="#local-6989586621679426259"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(WrappedState state -&gt; state)
-&gt; ModelState (WrappedState state) -&gt; ModelState state
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">WrappedState state -&gt; state
forall state. WrappedState state -&gt; state
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#unwrapState"><span class="hs-identifier hs-var hs-var">unwrapState</span></a></span><span> </span><span class="annot"><span class="annottext">ModelState (WrappedState state)
</span><a href="#local-6989586621679426258"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>                                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Action (WrappedState state) -&gt; Action state
forall state. Action (WrappedState state) -&gt; Action state
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#unwrapAction"><span class="hs-identifier hs-var hs-var">unwrapAction</span></a></span><span> </span><span class="annot"><span class="annottext">Action (WrappedState state)
</span><a href="#local-6989586621679426257"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#toAssetId"><span class="hs-identifier hs-type">toAssetId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AssetClass</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAPI.AssetId</span></span><span>
</span><span id="line-420"></span><span id="toAssetId"><span class="annot"><span class="annottext">toAssetId :: AssetClass -&gt; AssetId
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#toAssetId"><span class="hs-identifier hs-var hs-var">toAssetId</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AssetClass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679426255"><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621679426255"><span class="hs-identifier hs-var">sym</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679426254"><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679426254"><span class="hs-identifier hs-var">tok</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621679426255"><span class="hs-identifier hs-var">sym</span></a></span><span> </span><span class="annot"><span class="annottext">CurrencySymbol -&gt; CurrencySymbol -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">CurrencySymbol
</span><span class="hs-identifier hs-var">Ada.adaSymbol</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679426254"><span class="hs-identifier hs-var">tok</span></a></span><span> </span><span class="annot"><span class="annottext">TokenName -&gt; TokenName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">TokenName
</span><span class="hs-identifier hs-var">Ada.adaToken</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AssetId
</span><span class="hs-identifier hs-var">CardanoAPI.AdaAssetId</span></span><span>
</span><span id="line-422"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PolicyId -&gt; AssetName -&gt; AssetId
</span><span class="hs-identifier hs-var">CardanoAPI.AssetId</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CurrencySymbol -&gt; PolicyId
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#toPolicyId"><span class="hs-identifier hs-var">toPolicyId</span></a></span><span> </span><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621679426255"><span class="hs-identifier hs-var">sym</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TokenName -&gt; AssetName
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#toAssetName"><span class="hs-identifier hs-var">toAssetName</span></a></span><span> </span><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679426254"><span class="hs-identifier hs-var">tok</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#toPolicyId"><span class="hs-identifier hs-type">toPolicyId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CurrencySymbol</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAPI.PolicyId</span></span><span>
</span><span id="line-425"></span><span id="toPolicyId"><span class="annot"><span class="annottext">toPolicyId :: CurrencySymbol -&gt; PolicyId
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#toPolicyId"><span class="hs-identifier hs-var hs-var">toPolicyId</span></a></span></span><span> </span><span id="local-6989586621679426247"><span class="annot"><span class="annottext">sym :: CurrencySymbol
</span><a href="#local-6989586621679426247"><span class="hs-identifier hs-var">sym</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CurrencySymbol</span></span><span> </span><span id="local-6989586621679426245"><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="#local-6989586621679426245"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679426244"><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621679426244"><span class="hs-identifier hs-var">hash</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">AsType ScriptHash -&gt; ByteString -&gt; Maybe ScriptHash
forall a.
SerialiseAsRawBytes a =&gt;
AsType a -&gt; ByteString -&gt; Maybe a
</span><span class="hs-identifier hs-var">CardanoAPI.deserialiseFromRawBytes</span></span><span> </span><span class="annot"><span class="annottext">AsType ScriptHash
</span><span class="hs-identifier hs-var">CardanoAPI.AsScriptHash</span></span><span>
</span><span id="line-427"></span><span>                                                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BuiltinByteString -&gt; ByteString
forall arep a. FromBuiltin arep a =&gt; arep -&gt; a
</span><span class="hs-identifier hs-var">Builtins.fromBuiltin</span></span><span> </span><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="#local-6989586621679426245"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScriptHash -&gt; PolicyId
</span><span class="hs-identifier hs-var">CardanoAPI.PolicyId</span></span><span> </span><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621679426244"><span class="hs-identifier hs-var">hash</span></a></span><span>
</span><span id="line-428"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; PolicyId
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; PolicyId) -&gt; String -&gt; PolicyId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Bad policy id: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">CurrencySymbol -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621679426247"><span class="hs-identifier hs-var">sym</span></a></span><span>
</span><span id="line-429"></span><span>
</span><span id="line-430"></span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#toAssetName"><span class="hs-identifier hs-type">toAssetName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TokenName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAPI.AssetName</span></span><span>
</span><span id="line-431"></span><span id="toAssetName"><span class="annot"><span class="annottext">toAssetName :: TokenName -&gt; AssetName
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#toAssetName"><span class="hs-identifier hs-var hs-var">toAssetName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TokenName</span></span><span> </span><span id="local-6989586621679426238"><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="#local-6989586621679426238"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; AssetName
</span><span class="hs-identifier hs-var">CardanoAPI.AssetName</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; AssetName) -&gt; ByteString -&gt; AssetName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinByteString -&gt; ByteString
forall arep a. FromBuiltin arep a =&gt; arep -&gt; a
</span><span class="hs-identifier hs-var">Builtins.fromBuiltin</span></span><span> </span><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="#local-6989586621679426238"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-432"></span><span>
</span><span id="line-433"></span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#fromAssetId"><span class="hs-identifier hs-type">fromAssetId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAPI.AssetId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AssetClass</span></span><span>
</span><span id="line-434"></span><span id="fromAssetId"><span class="annot"><span class="annottext">fromAssetId :: AssetId -&gt; AssetClass
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#fromAssetId"><span class="hs-identifier hs-var hs-var">fromAssetId</span></a></span></span><span> </span><span class="annot"><span class="annottext">AssetId
</span><span class="hs-identifier hs-var">CardanoAPI.AdaAssetId</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CurrencySymbol, TokenName) -&gt; AssetClass
</span><span class="hs-identifier hs-var">AssetClass</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CurrencySymbol
</span><span class="hs-identifier hs-var">Ada.adaSymbol</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenName
</span><span class="hs-identifier hs-var">Ada.adaToken</span></span><span class="hs-special">)</span><span>
</span><span id="line-435"></span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#fromAssetId"><span class="hs-identifier hs-var">fromAssetId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CardanoAPI.AssetId</span></span><span> </span><span id="local-6989586621679426236"><span class="annot"><span class="annottext">PolicyId
</span><a href="#local-6989586621679426236"><span class="hs-identifier hs-var">policy</span></a></span></span><span> </span><span id="local-6989586621679426235"><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679426235"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CurrencySymbol, TokenName) -&gt; AssetClass
</span><span class="hs-identifier hs-var">AssetClass</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PolicyId -&gt; CurrencySymbol
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#fromPolicyId"><span class="hs-identifier hs-var">fromPolicyId</span></a></span><span> </span><span class="annot"><span class="annottext">PolicyId
</span><a href="#local-6989586621679426236"><span class="hs-identifier hs-var">policy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AssetName -&gt; TokenName
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#fromAssetName"><span class="hs-identifier hs-var">fromAssetName</span></a></span><span> </span><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679426235"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>
</span><span id="line-437"></span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#fromPolicyId"><span class="hs-identifier hs-type">fromPolicyId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAPI.PolicyId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CurrencySymbol</span></span><span>
</span><span id="line-438"></span><span id="fromPolicyId"><span class="annot"><span class="annottext">fromPolicyId :: PolicyId -&gt; CurrencySymbol
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#fromPolicyId"><span class="hs-identifier hs-var hs-var">fromPolicyId</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CardanoAPI.PolicyId</span></span><span> </span><span id="local-6989586621679426232"><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621679426232"><span class="hs-identifier hs-var">hash</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BuiltinByteString -&gt; CurrencySymbol
</span><span class="hs-identifier hs-var">CurrencySymbol</span></span><span> </span><span class="annot"><span class="annottext">(BuiltinByteString -&gt; CurrencySymbol)
-&gt; (ByteString -&gt; BuiltinByteString)
-&gt; ByteString
-&gt; CurrencySymbol
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; BuiltinByteString
forall a arep. ToBuiltin a arep =&gt; a -&gt; arep
</span><span class="hs-identifier hs-var">Builtins.toBuiltin</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; CurrencySymbol) -&gt; ByteString -&gt; CurrencySymbol
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptHash -&gt; ByteString
forall a. SerialiseAsRawBytes a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">CardanoAPI.serialiseToRawBytes</span></span><span> </span><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621679426232"><span class="hs-identifier hs-var">hash</span></a></span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#fromAssetName"><span class="hs-identifier hs-type">fromAssetName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAPI.AssetName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TokenName</span></span><span>
</span><span id="line-441"></span><span id="fromAssetName"><span class="annot"><span class="annottext">fromAssetName :: AssetName -&gt; TokenName
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#fromAssetName"><span class="hs-identifier hs-var hs-var">fromAssetName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CardanoAPI.AssetName</span></span><span> </span><span id="local-6989586621679426229"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679426229"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BuiltinByteString -&gt; TokenName
</span><span class="hs-identifier hs-var">TokenName</span></span><span> </span><span class="annot"><span class="annottext">(BuiltinByteString -&gt; TokenName) -&gt; BuiltinByteString -&gt; TokenName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; BuiltinByteString
forall a arep. ToBuiltin a arep =&gt; a -&gt; arep
</span><span class="hs-identifier hs-var">Builtins.toBuiltin</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679426229"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-442"></span><span>
</span><span id="line-443"></span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#fromSlotNo"><span class="hs-identifier hs-type">fromSlotNo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAPI.SlotNo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Slot</span></span><span>
</span><span id="line-444"></span><span id="fromSlotNo"><span class="annot"><span class="annottext">fromSlotNo :: SlotNo -&gt; Slot
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#fromSlotNo"><span class="hs-identifier hs-var hs-var">fromSlotNo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CardanoAPI.SlotNo</span></span><span> </span><span id="local-6989586621679426228"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679426228"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Slot
</span><span class="hs-identifier hs-var">Slot</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Slot) -&gt; Integer -&gt; Slot
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679426228"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-445"></span><span>
</span><span id="line-446"></span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#toSlotNo"><span class="hs-identifier hs-type">toSlotNo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Slot</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAPI.SlotNo</span></span><span>
</span><span id="line-447"></span><span id="toSlotNo"><span class="annot"><span class="annottext">toSlotNo :: Slot -&gt; SlotNo
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#toSlotNo"><span class="hs-identifier hs-var hs-var">toSlotNo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Slot</span></span><span> </span><span id="local-6989586621679426227"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679426227"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; SlotNo
</span><span class="hs-identifier hs-var">CardanoAPI.SlotNo</span></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; SlotNo) -&gt; Word64 -&gt; SlotNo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679426227"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-448"></span><span>
</span><span id="line-449"></span><span class="hs-keyword">type</span><span> </span><span id="RunsIn"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#RunsIn"><span class="hs-identifier hs-var">RunsIn</span></a></span></span><span> </span><span id="local-6989586621679426226"><span class="annot"><a href="#local-6989586621679426226"><span class="hs-identifier hs-type">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#WithInstances"><span class="hs-identifier hs-type">CMI.WithInstances</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrappedState"><span class="hs-identifier hs-type">WrappedState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426226"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>
</span><span id="line-451"></span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#wait"><span class="hs-identifier hs-type">wait</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679426225"><span class="annot"><a href="#local-6989586621679426225"><span class="hs-identifier hs-type">state</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractModel"><span class="hs-identifier hs-type">ContractModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426225"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/integer-gmp-1.0.3.0/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.Spec</span></span><span> </span><span class="annot"><a href="#local-6989586621679426225"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span id="wait"><span class="annot"><span class="annottext">wait :: Integer -&gt; Spec state ()
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#wait"><span class="hs-identifier hs-var hs-var">wait</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Spec (RunsIn state) () -&gt; Spec state ()
forall s s' a. Coercible s s' =&gt; Spec s a -&gt; Spec s' a
</span><span class="hs-identifier hs-var">QCCM.coerceSpec</span></span><span> </span><span class="annot"><span class="annottext">(Spec (RunsIn state) () -&gt; Spec state ())
-&gt; (Integer -&gt; Spec (RunsIn state) ()) -&gt; Integer -&gt; Spec state ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ContractModel (RunsIn state) =&gt; Integer -&gt; Spec (RunsIn state) ()
forall state. ContractModel state =&gt; Integer -&gt; Spec state ()
</span><span class="hs-identifier hs-var">QCCM.wait</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#RunsIn"><span class="hs-identifier hs-type">RunsIn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426225"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#waitUntil"><span class="hs-identifier hs-type">waitUntil</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679426223"><span class="annot"><a href="#local-6989586621679426223"><span class="hs-identifier hs-type">state</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractModel"><span class="hs-identifier hs-type">ContractModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426223"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Slot</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.Spec</span></span><span> </span><span class="annot"><a href="#local-6989586621679426223"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span id="waitUntil"><span class="annot"><span class="annottext">waitUntil :: Slot -&gt; Spec state ()
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#waitUntil"><span class="hs-identifier hs-var hs-var">waitUntil</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Spec (RunsIn state) () -&gt; Spec state ()
forall s s' a. Coercible s s' =&gt; Spec s a -&gt; Spec s' a
</span><span class="hs-identifier hs-var">QCCM.coerceSpec</span></span><span> </span><span class="annot"><span class="annottext">(Spec (RunsIn state) () -&gt; Spec state ())
-&gt; (Slot -&gt; Spec (RunsIn state) ()) -&gt; Slot -&gt; Spec state ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ContractModel (RunsIn state) =&gt; SlotNo -&gt; Spec (RunsIn state) ()
forall state. ContractModel state =&gt; SlotNo -&gt; Spec state ()
</span><span class="hs-identifier hs-var">QCCM.waitUntil</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#RunsIn"><span class="hs-identifier hs-type">RunsIn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426223"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SlotNo -&gt; Spec (RunsIn state) ())
-&gt; (Slot -&gt; SlotNo) -&gt; Slot -&gt; Spec (RunsIn state) ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; SlotNo
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#toSlotNo"><span class="hs-identifier hs-var">toSlotNo</span></a></span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span class="hs-comment">-- | Add tokens to the `balanceChange` of a wallet. The added tokens are subtracted from the</span><span>
</span><span id="line-458"></span><span class="hs-comment">--   `lockedValue` of tokens held by contracts.</span><span>
</span><span id="line-459"></span><span id="local-6989586621679426220"><span id="local-6989586621679426221"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#deposit"><span class="hs-identifier hs-type">deposit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.SymValueLike</span></span><span> </span><span class="annot"><a href="#local-6989586621679426221"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Wallet</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679426221"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.Spec</span></span><span> </span><span class="annot"><a href="#local-6989586621679426220"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-460"></span><span id="deposit"><span class="annot"><span class="annottext">deposit :: Wallet -&gt; v -&gt; Spec state ()
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#deposit"><span class="hs-identifier hs-var hs-var">deposit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddressInEra Era -&gt; v -&gt; Spec state ()
forall v state.
SymValueLike v =&gt;
AddressInEra Era -&gt; v -&gt; Spec state ()
</span><span class="hs-identifier hs-var">QCCM.deposit</span></span><span> </span><span class="annot"><span class="annottext">(AddressInEra Era -&gt; v -&gt; Spec state ())
-&gt; (Wallet -&gt; AddressInEra Era) -&gt; Wallet -&gt; v -&gt; Spec state ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; AddressInEra Era
</span><a href="Plutus.Contract.Test.ContractModel.Internal.html#walletAddress"><span class="hs-identifier hs-var">CMI.walletAddress</span></a></span><span>
</span><span id="line-461"></span><span>
</span><span id="line-462"></span><span class="hs-comment">-- | Withdraw tokens from a wallet. The withdrawn tokens are added to the `lockedValue` of tokens</span><span>
</span><span id="line-463"></span><span class="hs-comment">--   held by contracts.</span><span>
</span><span id="line-464"></span><span id="local-6989586621679426216"><span id="local-6989586621679426217"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#withdraw"><span class="hs-identifier hs-type">withdraw</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.SymValueLike</span></span><span> </span><span class="annot"><a href="#local-6989586621679426217"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Wallet</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679426217"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.Spec</span></span><span> </span><span class="annot"><a href="#local-6989586621679426216"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-465"></span><span id="withdraw"><span class="annot"><span class="annottext">withdraw :: Wallet -&gt; v -&gt; Spec state ()
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#withdraw"><span class="hs-identifier hs-var hs-var">withdraw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddressInEra Era -&gt; v -&gt; Spec state ()
forall v state.
SymValueLike v =&gt;
AddressInEra Era -&gt; v -&gt; Spec state ()
</span><span class="hs-identifier hs-var">QCCM.withdraw</span></span><span> </span><span class="annot"><span class="annottext">(AddressInEra Era -&gt; v -&gt; Spec state ())
-&gt; (Wallet -&gt; AddressInEra Era) -&gt; Wallet -&gt; v -&gt; Spec state ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; AddressInEra Era
</span><a href="Plutus.Contract.Test.ContractModel.Internal.html#walletAddress"><span class="hs-identifier hs-var">CMI.walletAddress</span></a></span><span>
</span><span id="line-466"></span><span>
</span><span id="line-467"></span><span class="hs-comment">-- | Transfer tokens between wallets, updating their `balances`.</span><span>
</span><span id="line-468"></span><span id="local-6989586621679426213"><span id="local-6989586621679426214"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#transfer"><span class="hs-identifier hs-type">transfer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.SymValueLike</span></span><span> </span><span class="annot"><a href="#local-6989586621679426214"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-469"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Wallet</span></span><span>  </span><span class="hs-comment">-- ^ Transfer from this wallet</span><span>
</span><span id="line-470"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Wallet</span></span><span>  </span><span class="hs-comment">-- ^ to this wallet</span><span>
</span><span id="line-471"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679426214"><span class="hs-identifier hs-type">v</span></a></span><span>   </span><span class="hs-comment">-- ^ this many tokens</span><span>
</span><span id="line-472"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.Spec</span></span><span> </span><span class="annot"><a href="#local-6989586621679426213"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-473"></span><span id="transfer"><span class="annot"><span class="annottext">transfer :: Wallet -&gt; Wallet -&gt; v -&gt; Spec state ()
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#transfer"><span class="hs-identifier hs-var hs-var">transfer</span></a></span></span><span> </span><span id="local-6989586621679426212"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621679426212"><span class="hs-identifier hs-var">w1</span></a></span></span><span> </span><span id="local-6989586621679426211"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621679426211"><span class="hs-identifier hs-var">w2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddressInEra Era -&gt; AddressInEra Era -&gt; v -&gt; Spec state ()
forall v state.
SymValueLike v =&gt;
AddressInEra Era -&gt; AddressInEra Era -&gt; v -&gt; Spec state ()
</span><span class="hs-identifier hs-var">QCCM.transfer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; AddressInEra Era
</span><a href="Plutus.Contract.Test.ContractModel.Internal.html#walletAddress"><span class="hs-identifier hs-var">CMI.walletAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621679426212"><span class="hs-identifier hs-var">w1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; AddressInEra Era
</span><a href="Plutus.Contract.Test.ContractModel.Internal.html#walletAddress"><span class="hs-identifier hs-var">CMI.walletAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621679426211"><span class="hs-identifier hs-var">w2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>
</span><span id="line-475"></span><span class="hs-comment">-- | Register the real token corresponding to a symbolic token created</span><span>
</span><span id="line-476"></span><span class="hs-comment">-- in `createToken`.</span><span>
</span><span id="line-477"></span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#registerToken"><span class="hs-identifier hs-type">registerToken</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAPI.AssetId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#SpecificationEmulatorTrace"><span class="hs-identifier hs-type">SpecificationEmulatorTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span id="registerToken"><span class="annot"><span class="annottext">registerToken :: String
-&gt; AssetId
-&gt; Eff
     (Writer [(String, SomethingWithSymbolicRep)] : BaseEmulatorEffects)
     ()
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#registerToken"><span class="hs-identifier hs-var hs-var">registerToken</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; AssetId
-&gt; Eff
     (Writer [(String, SomethingWithSymbolicRep)] : BaseEmulatorEffects)
     ()
forall t.
HasSymbolicRep t =&gt;
String
-&gt; t
-&gt; Eff
     (Writer [(String, SomethingWithSymbolicRep)] : BaseEmulatorEffects)
     ()
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#registerSymbolic"><span class="hs-identifier hs-var">registerSymbolic</span></a></span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span class="hs-comment">-- | Register the real TxOut corresponding to a symbolic TxOut created</span><span>
</span><span id="line-481"></span><span class="hs-comment">-- in `createTxOut`.</span><span>
</span><span id="line-482"></span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#registerTxOut"><span class="hs-identifier hs-type">registerTxOut</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAPI.TxOut</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAPI.CtxUTxO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.Era</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#SpecificationEmulatorTrace"><span class="hs-identifier hs-type">SpecificationEmulatorTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-483"></span><span id="registerTxOut"><span class="annot"><span class="annottext">registerTxOut :: String
-&gt; TxOut CtxUTxO Era
-&gt; Eff
     (Writer [(String, SomethingWithSymbolicRep)] : BaseEmulatorEffects)
     ()
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#registerTxOut"><span class="hs-identifier hs-var hs-var">registerTxOut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; TxOut CtxUTxO Era
-&gt; Eff
     (Writer [(String, SomethingWithSymbolicRep)] : BaseEmulatorEffects)
     ()
forall t.
HasSymbolicRep t =&gt;
String
-&gt; t
-&gt; Eff
     (Writer [(String, SomethingWithSymbolicRep)] : BaseEmulatorEffects)
     ()
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#registerSymbolic"><span class="hs-identifier hs-var">registerSymbolic</span></a></span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span class="hs-comment">-- | Register the real TxIn corresponding to a symbolic TxIn created</span><span>
</span><span id="line-486"></span><span class="hs-comment">-- in `createTxIn`.</span><span>
</span><span id="line-487"></span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#registerTxIn"><span class="hs-identifier hs-type">registerTxIn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAPI.TxIn</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#SpecificationEmulatorTrace"><span class="hs-identifier hs-type">SpecificationEmulatorTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span id="registerTxIn"><span class="annot"><span class="annottext">registerTxIn :: String
-&gt; TxIn
-&gt; Eff
     (Writer [(String, SomethingWithSymbolicRep)] : BaseEmulatorEffects)
     ()
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#registerTxIn"><span class="hs-identifier hs-var hs-var">registerTxIn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; TxIn
-&gt; Eff
     (Writer [(String, SomethingWithSymbolicRep)] : BaseEmulatorEffects)
     ()
forall t.
HasSymbolicRep t =&gt;
String
-&gt; t
-&gt; Eff
     (Writer [(String, SomethingWithSymbolicRep)] : BaseEmulatorEffects)
     ()
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#registerSymbolic"><span class="hs-identifier hs-var">registerSymbolic</span></a></span><span>
</span><span id="line-489"></span><span>
</span><span id="line-490"></span><span id="local-6989586621679426744"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#registerSymbolic"><span class="hs-identifier hs-type">registerSymbolic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.HasSymbolicRep</span></span><span> </span><span class="annot"><a href="#local-6989586621679426744"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679426744"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#SpecificationEmulatorTrace"><span class="hs-identifier hs-type">SpecificationEmulatorTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-491"></span><span id="registerSymbolic"><span class="annot"><span class="annottext">registerSymbolic :: String
-&gt; t
-&gt; Eff
     (Writer [(String, SomethingWithSymbolicRep)] : BaseEmulatorEffects)
     ()
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#registerSymbolic"><span class="hs-identifier hs-var hs-var">registerSymbolic</span></a></span></span><span> </span><span id="local-6989586621679426209"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679426209"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679426208"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679426208"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(String, SomethingWithSymbolicRep)]
-&gt; Eff
     (Writer [(String, SomethingWithSymbolicRep)] : BaseEmulatorEffects)
     ()
forall w (effs :: [* -&gt; *]).
Member (Writer w) effs =&gt;
w -&gt; Eff effs ()
</span><span class="hs-identifier hs-var">tell</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679426209"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">t -&gt; SomethingWithSymbolicRep
forall t. HasSymbolicRep t =&gt; t -&gt; SomethingWithSymbolicRep
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#WithSymbolicRep"><span class="hs-identifier hs-var">WithSymbolicRep</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679426208"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-492"></span><span>
</span><span id="line-493"></span><span class="hs-comment">-- | `delay n` delays emulator execution by `n` slots</span><span>
</span><span id="line-494"></span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#delay"><span class="hs-identifier hs-type">delay</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/integer-gmp-1.0.3.0/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#SpecificationEmulatorTrace"><span class="hs-identifier hs-type">SpecificationEmulatorTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-495"></span><span id="delay"><span class="annot"><span class="annottext">delay :: Integer
-&gt; Eff
     (Writer [(String, SomethingWithSymbolicRep)] : BaseEmulatorEffects)
     ()
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#delay"><span class="hs-identifier hs-var hs-var">delay</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Eff
  (Writer [(String, SomethingWithSymbolicRep)] : BaseEmulatorEffects)
  Slot
-&gt; Eff
     (Writer [(String, SomethingWithSymbolicRep)] : BaseEmulatorEffects)
     ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff
   (Writer [(String, SomethingWithSymbolicRep)] : BaseEmulatorEffects)
   Slot
 -&gt; Eff
      (Writer [(String, SomethingWithSymbolicRep)] : BaseEmulatorEffects)
      ())
-&gt; (Integer
    -&gt; Eff
         (Writer [(String, SomethingWithSymbolicRep)] : BaseEmulatorEffects)
         Slot)
-&gt; Integer
-&gt; Eff
     (Writer [(String, SomethingWithSymbolicRep)] : BaseEmulatorEffects)
     ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
-&gt; Eff
     (Writer [(String, SomethingWithSymbolicRep)] : BaseEmulatorEffects)
     Slot
forall (effs :: [* -&gt; *]).
Member Waiting effs =&gt;
Natural -&gt; Eff effs Slot
</span><span class="hs-identifier hs-var">Trace.waitNSlots</span></span><span> </span><span class="annot"><span class="annottext">(Natural
 -&gt; Eff
      (Writer [(String, SomethingWithSymbolicRep)] : BaseEmulatorEffects)
      Slot)
-&gt; (Integer -&gt; Natural)
-&gt; Integer
-&gt; Eff
     (Writer [(String, SomethingWithSymbolicRep)] : BaseEmulatorEffects)
     Slot
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Natural
forall a. Num a =&gt; Integer -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromInteger</span></a></span><span>
</span><span id="line-496"></span><span>
</span><span id="line-497"></span><span class="hs-comment">-- TODO: more evidence that we should torch WithInstances and fuse it with WrappedState</span><span>
</span><span id="line-498"></span><span class="hs-keyword">type</span><span> </span><span id="DL"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#DL"><span class="hs-identifier hs-var">DL</span></a></span></span><span> </span><span id="local-6989586621679426206"><span class="annot"><a href="#local-6989586621679426206"><span class="hs-identifier hs-type">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.DL</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#WithInstances"><span class="hs-identifier hs-type">CMI.WithInstances</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrappedState"><span class="hs-identifier hs-type">WrappedState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426206"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span>
</span><span id="line-500"></span><span id="local-6989586621679426205"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#action"><span class="hs-identifier hs-type">action</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractModel"><span class="hs-identifier hs-type">ContractModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426205"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426205"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#DL"><span class="hs-identifier hs-type">DL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426205"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-501"></span><span id="action"><span class="annot"><span class="annottext">action :: Action state -&gt; DL state ()
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#action"><span class="hs-identifier hs-var hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Action (WithInstances (WrappedState state)) -&gt; DL state ()
forall state a. ActionLike state a =&gt; a -&gt; DL state ()
</span><span class="hs-identifier hs-var">QCCM.action</span></span><span> </span><span class="annot"><span class="annottext">(Action (WithInstances (WrappedState state)) -&gt; DL state ())
-&gt; (Action state -&gt; Action (WithInstances (WrappedState state)))
-&gt; Action state
-&gt; DL state ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Action (WrappedState state)
-&gt; Action (WithInstances (WrappedState state))
forall s. Action s -&gt; Action (WithInstances s)
</span><a href="Plutus.Contract.Test.ContractModel.Internal.html#UnderlyingAction"><span class="hs-identifier hs-var">CMI.UnderlyingAction</span></a></span><span> </span><span class="annot"><span class="annottext">(Action (WrappedState state)
 -&gt; Action (WithInstances (WrappedState state)))
-&gt; (Action state -&gt; Action (WrappedState state))
-&gt; Action state
-&gt; Action (WithInstances (WrappedState state))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Action state -&gt; Action (WrappedState state)
forall state. Action state -&gt; Action (WrappedState state)
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrapAction"><span class="hs-identifier hs-var">WrapAction</span></a></span><span>
</span><span id="line-502"></span><span>
</span><span id="line-503"></span><span id="local-6989586621679426202"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#waitUntilDL"><span class="hs-identifier hs-type">waitUntilDL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractModel"><span class="hs-identifier hs-type">ContractModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426202"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Slot</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#DL"><span class="hs-identifier hs-type">DL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426202"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-504"></span><span id="waitUntilDL"><span class="annot"><span class="annottext">waitUntilDL :: Slot -&gt; DL state ()
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#waitUntilDL"><span class="hs-identifier hs-var hs-var">waitUntilDL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; DL state ()
forall state. ContractModel state =&gt; SlotNo -&gt; DL state ()
</span><span class="hs-identifier hs-var">QCCM.waitUntilDL</span></span><span> </span><span class="annot"><span class="annottext">(SlotNo -&gt; DL state ()) -&gt; (Slot -&gt; SlotNo) -&gt; Slot -&gt; DL state ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; SlotNo
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#toSlotNo"><span class="hs-identifier hs-var">toSlotNo</span></a></span><span>
</span><span id="line-505"></span><span>
</span><span id="line-506"></span><span id="local-6989586621679426200"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#assertModel"><span class="hs-identifier hs-type">assertModel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">QCCM.ModelState</span></span><span> </span><span class="annot"><a href="#local-6989586621679426200"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#DL"><span class="hs-identifier hs-type">DL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426200"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-507"></span><span id="assertModel"><span class="annot"><span class="annottext">assertModel :: String -&gt; (ModelState state -&gt; Bool) -&gt; DL state ()
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#assertModel"><span class="hs-identifier hs-var hs-var">assertModel</span></a></span></span><span> </span><span id="local-6989586621679426199"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679426199"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679426198"><span class="annot"><span class="annottext">ModelState state -&gt; Bool
</span><a href="#local-6989586621679426198"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (ModelState (WithInstances (WrappedState state)) -&gt; Bool)
-&gt; DL state ()
forall state. String -&gt; (ModelState state -&gt; Bool) -&gt; DL state ()
</span><span class="hs-identifier hs-var">QCCM.assertModel</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679426199"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModelState state -&gt; Bool
</span><a href="#local-6989586621679426198"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelState state -&gt; Bool)
-&gt; (ModelState (WithInstances (WrappedState state))
    -&gt; ModelState state)
-&gt; ModelState (WithInstances (WrappedState state))
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(WithInstances (WrappedState state) -&gt; state)
-&gt; ModelState (WithInstances (WrappedState state))
-&gt; ModelState state
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">WithInstances (WrappedState state) -&gt; state
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">coerce</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>
</span><span id="line-509"></span><span class="hs-keyword">type</span><span> </span><span id="Actions"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Actions"><span class="hs-identifier hs-var">Actions</span></a></span></span><span> </span><span id="local-6989586621679426196"><span class="annot"><a href="#local-6989586621679426196"><span class="hs-identifier hs-type">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.Actions</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#WithInstances"><span class="hs-identifier hs-type">CMI.WithInstances</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrappedState"><span class="hs-identifier hs-type">WrappedState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426196"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span>
</span><span id="line-511"></span><span class="hs-comment">-- | Run a `Actions` in the emulator and check that the model and the emulator agree on the final</span><span>
</span><span id="line-512"></span><span class="hs-comment">--   wallet balance changes. Equivalent to</span><span>
</span><span id="line-513"></span><span class="hs-comment">--</span><span>
</span><span id="line-514"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-515"></span><span class="hs-comment">-- propRunActions_ hs actions = `propRunActions` hs (`const` `$` `pure` `True`) actions</span><span>
</span><span id="line-516"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-517"></span><span id="local-6989586621679426195"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#propRunActions_"><span class="hs-identifier hs-type">propRunActions_</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-518"></span><span>    </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractModel"><span class="hs-identifier hs-type">ContractModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426195"><span class="hs-identifier hs-type">state</span></a></span><span>
</span><span id="line-519"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Actions"><span class="hs-identifier hs-type">Actions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426195"><span class="hs-identifier hs-type">state</span></a></span><span>                 </span><span class="hs-comment">-- ^ The actions to run</span><span>
</span><span id="line-520"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span></span><span>
</span><span id="line-521"></span><span id="propRunActions_"><span class="annot"><span class="annottext">propRunActions_ :: Actions state -&gt; Property
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#propRunActions_"><span class="hs-identifier hs-var hs-var">propRunActions_</span></a></span></span><span> </span><span id="local-6989586621679426194"><span class="annot"><span class="annottext">Actions state
</span><a href="#local-6989586621679426194"><span class="hs-identifier hs-var">actions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-522"></span><span>    </span><span class="annot"><span class="annottext">(ModelState state -&gt; TracePredicate) -&gt; Actions state -&gt; Property
forall state.
ContractModel state =&gt;
(ModelState state -&gt; TracePredicate) -&gt; Actions state -&gt; Property
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#propRunActions"><span class="hs-identifier hs-var">propRunActions</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="annot"><span class="annottext">ModelState state
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TracePredicate
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Actions state
</span><a href="#local-6989586621679426194"><span class="hs-identifier hs-var">actions</span></a></span><span>
</span><span id="line-523"></span><span>
</span><span id="line-524"></span><span class="hs-comment">-- | Run a `Actions` in the emulator and check that the model and the emulator agree on the final</span><span>
</span><span id="line-525"></span><span class="hs-comment">--   wallet balance changes, and that the given `TracePredicate` holds at the end. Equivalent to:</span><span>
</span><span id="line-526"></span><span class="hs-comment">--</span><span>
</span><span id="line-527"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-528"></span><span class="hs-comment">-- propRunActions = `propRunActionsWithOptions` `defaultCheckOptionsContractModel` `defaultCoverageOptions`</span><span>
</span><span id="line-529"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-530"></span><span id="local-6989586621679426715"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#propRunActions"><span class="hs-identifier hs-type">propRunActions</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-531"></span><span>    </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractModel"><span class="hs-identifier hs-type">ContractModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426715"><span class="hs-identifier hs-type">state</span></a></span><span>
</span><span id="line-532"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">QCCM.ModelState</span></span><span> </span><span class="annot"><a href="#local-6989586621679426715"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TracePredicate</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Predicate to check at the end</span><span>
</span><span id="line-533"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Actions"><span class="hs-identifier hs-type">Actions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426715"><span class="hs-identifier hs-type">state</span></a></span><span>                         </span><span class="hs-comment">-- ^ The actions to run</span><span>
</span><span id="line-534"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span></span><span>
</span><span id="line-535"></span><span id="propRunActions"><span class="annot"><span class="annottext">propRunActions :: (ModelState state -&gt; TracePredicate) -&gt; Actions state -&gt; Property
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#propRunActions"><span class="hs-identifier hs-var hs-var">propRunActions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CheckOptions
-&gt; CoverageOptions
-&gt; (ModelState state -&gt; TracePredicate)
-&gt; Actions state
-&gt; Property
forall state.
ContractModel state =&gt;
CheckOptions
-&gt; CoverageOptions
-&gt; (ModelState state -&gt; TracePredicate)
-&gt; Actions state
-&gt; Property
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#propRunActionsWithOptions"><span class="hs-identifier hs-var">propRunActionsWithOptions</span></a></span><span> </span><span class="annot"><span class="annottext">CheckOptions
</span><a href="Plutus.Contract.Test.ContractModel.Internal.html#defaultCheckOptionsContractModel"><span class="hs-identifier hs-var">CMI.defaultCheckOptionsContractModel</span></a></span><span> </span><span class="annot"><span class="annottext">CoverageOptions
</span><a href="Plutus.Contract.Test.ContractModel.Internal.html#defaultCoverageOptions"><span class="hs-identifier hs-var">CMI.defaultCoverageOptions</span></a></span><span>
</span><span id="line-536"></span><span>
</span><span id="line-537"></span><span class="hs-comment">-- | Run a `Actions` in the emulator and check that the model and the emulator agree on the final</span><span>
</span><span id="line-538"></span><span class="hs-comment">--   wallet balance changes, that no off-chain contract instance crashed, and that the given</span><span>
</span><span id="line-539"></span><span class="hs-comment">--   `TracePredicate` holds at the end. The predicate has access to the final model state.</span><span>
</span><span id="line-540"></span><span class="hs-comment">--</span><span>
</span><span id="line-541"></span><span class="hs-comment">--   The `Actions` argument can be generated by a `forAllDL` from a `DL` scenario, or using the</span><span>
</span><span id="line-542"></span><span class="hs-comment">--   `Arbitrary` instance for actions which generates random actions using `arbitraryAction`:</span><span>
</span><span id="line-543"></span><span class="hs-comment">--</span><span>
</span><span id="line-544"></span><span class="hs-comment">-- &gt;&gt;&gt; quickCheck $ propRunActions_ handles</span><span>
</span><span id="line-545"></span><span class="hs-comment">-- +++ OK, passed 100 tests</span><span>
</span><span id="line-546"></span><span class="hs-comment">-- &gt;&gt;&gt; quickCheck $ forAllDL dl $ propRunActions_ handles</span><span>
</span><span id="line-547"></span><span class="hs-comment">-- +++ OK, passed 100 tests</span><span>
</span><span id="line-548"></span><span class="hs-comment">--</span><span>
</span><span id="line-549"></span><span class="hs-comment">--   The options argument can be used to configure the emulator--setting initial wallet balances,</span><span>
</span><span id="line-550"></span><span class="hs-comment">--   the maximum number of slots to run for, and the log level for the emulator trace printed on</span><span>
</span><span id="line-551"></span><span class="hs-comment">--   failing tests:</span><span>
</span><span id="line-552"></span><span class="hs-comment">--</span><span>
</span><span id="line-553"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-554"></span><span class="hs-comment">-- options :: `Map` `Wallet` `Value` -&gt; `Slot` -&gt; `Control.Monad.Freer.Extras.Log.LogLevel` -&gt; `CheckOptions`</span><span>
</span><span id="line-555"></span><span class="hs-comment">-- options dist slot logLevel =</span><span>
</span><span id="line-556"></span><span class="hs-comment">--     `defaultCheckOptions` `&amp;` `emulatorConfig` . `Plutus.Trace.Emulator.initialChainState` `.~` `Left` dist</span><span>
</span><span id="line-557"></span><span class="hs-comment">--                           `&amp;` `minLogLevel`                        `.~` logLevel</span><span>
</span><span id="line-558"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-559"></span><span class="hs-comment">--</span><span>
</span><span id="line-560"></span><span id="local-6989586621679426709"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#propRunActionsWithOptions"><span class="hs-identifier hs-type">propRunActionsWithOptions</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-561"></span><span>    </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractModel"><span class="hs-identifier hs-type">ContractModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426709"><span class="hs-identifier hs-type">state</span></a></span><span>
</span><span id="line-562"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CheckOptions</span></span><span>                               </span><span class="hs-comment">-- ^ Emulator options</span><span>
</span><span id="line-563"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#CoverageOptions"><span class="hs-identifier hs-type">CMI.CoverageOptions</span></a></span><span>                        </span><span class="hs-comment">-- ^ Coverage options</span><span>
</span><span id="line-564"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">QCCM.ModelState</span></span><span> </span><span class="annot"><a href="#local-6989586621679426709"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TracePredicate</span></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ Predicate to check at the end</span><span>
</span><span id="line-565"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Actions"><span class="hs-identifier hs-type">Actions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426709"><span class="hs-identifier hs-type">state</span></a></span><span>                              </span><span class="hs-comment">-- ^ The actions to run</span><span>
</span><span id="line-566"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span></span><span>
</span><span id="line-567"></span><span id="propRunActionsWithOptions"><span class="annot"><span class="annottext">propRunActionsWithOptions :: CheckOptions
-&gt; CoverageOptions
-&gt; (ModelState state -&gt; TracePredicate)
-&gt; Actions state
-&gt; Property
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#propRunActionsWithOptions"><span class="hs-identifier hs-var hs-var">propRunActionsWithOptions</span></a></span></span><span> </span><span id="local-6989586621679426193"><span class="annot"><span class="annottext">CheckOptions
</span><a href="#local-6989586621679426193"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679426192"><span class="annot"><span class="annottext">CoverageOptions
</span><a href="#local-6989586621679426192"><span class="hs-identifier hs-var">copts</span></a></span></span><span> </span><span id="local-6989586621679426191"><span class="annot"><span class="annottext">ModelState state -&gt; TracePredicate
</span><a href="#local-6989586621679426191"><span class="hs-identifier hs-var">predicate</span></a></span></span><span> </span><span id="local-6989586621679426190"><span class="annot"><span class="annottext">Actions state
</span><a href="#local-6989586621679426190"><span class="hs-identifier hs-var">actions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-568"></span><span>  </span><span class="annot"><span class="annottext">CheckOptions
-&gt; CoverageOptions
-&gt; (ModelState (WithInstances (WrappedState state))
    -&gt; TracePredicate)
-&gt; (ProtocolParameters
    -&gt; ContractModelResult (WithInstances (WrappedState state))
    -&gt; Property)
-&gt; Actions state
-&gt; Property
forall state.
CheckableContractModel state =&gt;
CheckOptions
-&gt; CoverageOptions
-&gt; (ModelState (WithInstances state) -&gt; TracePredicate)
-&gt; (ProtocolParameters
    -&gt; ContractModelResult (WithInstances state) -&gt; Property)
-&gt; Actions (WithInstances state)
-&gt; Property
</span><a href="Plutus.Contract.Test.ContractModel.Internal.html#propRunActionsWithOptions"><span class="hs-identifier hs-var">CMI.propRunActionsWithOptions</span></a></span><span> </span><span class="annot"><span class="annottext">CheckOptions
</span><a href="#local-6989586621679426193"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">CoverageOptions
</span><a href="#local-6989586621679426192"><span class="hs-identifier hs-var">copts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModelState state -&gt; TracePredicate
</span><a href="#local-6989586621679426191"><span class="hs-identifier hs-var">predicate</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelState state -&gt; TracePredicate)
-&gt; (ModelState (WithInstances (WrappedState state))
    -&gt; ModelState state)
-&gt; ModelState (WithInstances (WrappedState state))
-&gt; TracePredicate
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(WithInstances (WrappedState state) -&gt; state)
-&gt; ModelState (WithInstances (WrappedState state))
-&gt; ModelState state
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">WithInstances (WrappedState state) -&gt; state
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">coerce</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ProtocolParameters
-&gt; ContractModelResult (WithInstances (WrappedState state))
-&gt; Property
forall state.
ProtocolParameters -&gt; ContractModelResult state -&gt; Property
</span><a href="Plutus.Contract.Test.ContractModel.Internal.html#balanceChangePredicate"><span class="hs-identifier hs-var">CMI.balanceChangePredicate</span></a></span><span> </span><span class="annot"><span class="annottext">Actions state
</span><a href="#local-6989586621679426190"><span class="hs-identifier hs-var">actions</span></a></span><span>
</span><span id="line-569"></span><span>
</span><span id="line-570"></span><span class="hs-comment">-- | Sanity check a `ContractModel`. Ensures that wallet balances are not always unchanged.</span><span>
</span><span id="line-571"></span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#propSanityCheckModel"><span class="hs-identifier hs-type">propSanityCheckModel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679426187"><span class="annot"><a href="#local-6989586621679426187"><span class="hs-identifier hs-type">state</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractModel"><span class="hs-identifier hs-type">ContractModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426187"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span>
</span><span id="line-572"></span><span id="propSanityCheckModel"><span class="annot"><span class="annottext">propSanityCheckModel :: Property
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#propSanityCheckModel"><span class="hs-identifier hs-var hs-var">propSanityCheckModel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-573"></span><span>  </span><span class="annot"><span class="annottext">(Actions (WithInstances (WrappedState state)) -&gt; Bool) -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">QC.expectFailure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModelState (WithInstances (WrappedState state)) -&gt; Bool
forall state. ModelState state -&gt; Bool
</span><a href="#local-6989586621679426185"><span class="hs-identifier hs-var">noBalanceChanges</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelState (WithInstances (WrappedState state)) -&gt; Bool)
-&gt; (Actions (WithInstances (WrappedState state))
    -&gt; ModelState (WithInstances (WrappedState state)))
-&gt; Actions (WithInstances (WrappedState state))
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ContractModel (WithInstances (WrappedState state)) =&gt;
Actions (WithInstances (WrappedState state))
-&gt; ModelState (WithInstances (WrappedState state))
forall state.
ContractModel state =&gt;
Actions state -&gt; ModelState state
</span><span class="hs-identifier hs-var">QCCM.stateAfter</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#WithInstances"><span class="hs-identifier hs-type">CMI.WithInstances</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrappedState"><span class="hs-identifier hs-type">WrappedState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426187"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-574"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-575"></span><span>    </span><span id="local-6989586621679426185"><span class="annot"><span class="annottext">noBalanceChanges :: ModelState state -&gt; Bool
</span><a href="#local-6989586621679426185"><span class="hs-identifier hs-var hs-var">noBalanceChanges</span></a></span></span><span> </span><span id="local-6989586621679426183"><span class="annot"><span class="annottext">ModelState state
</span><a href="#local-6989586621679426183"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SymValue -&gt; Bool) -&gt; Map (AddressInEra Era) SymValue -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="annot"><span class="annottext">SymValue -&gt; Bool
</span><span class="hs-identifier hs-var">QCCM.symIsZero</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModelState state
</span><a href="#local-6989586621679426183"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ModelState state
-&gt; Getting
     (Map (AddressInEra Era) SymValue)
     (ModelState state)
     (Map (AddressInEra Era) SymValue)
-&gt; Map (AddressInEra Era) SymValue
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map (AddressInEra Era) SymValue)
  (ModelState state)
  (Map (AddressInEra Era) SymValue)
forall state.
Getter (ModelState state) (Map (AddressInEra Era) SymValue)
</span><span class="hs-identifier hs-var">QCCM.balanceChanges</span></span><span class="hs-special">)</span><span>
</span><span id="line-576"></span><span>
</span><span id="line-577"></span><span class="hs-comment">-- | Sanity check a `ContractModel`. Ensures that all assertions in</span><span>
</span><span id="line-578"></span><span class="hs-comment">-- the property generation succeed.</span><span>
</span><span id="line-579"></span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#propSanityCheckAssertions"><span class="hs-identifier hs-type">propSanityCheckAssertions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679426181"><span class="annot"><a href="#local-6989586621679426181"><span class="hs-identifier hs-type">state</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractModel"><span class="hs-identifier hs-type">ContractModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426181"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Actions"><span class="hs-identifier hs-type">Actions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426181"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span>
</span><span id="line-580"></span><span id="propSanityCheckAssertions"><span class="annot"><span class="annottext">propSanityCheckAssertions :: Actions state -&gt; Property
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#propSanityCheckAssertions"><span class="hs-identifier hs-var hs-var">propSanityCheckAssertions</span></a></span></span><span> </span><span id="local-6989586621679426180"><span class="annot"><span class="annottext">Actions state
</span><a href="#local-6989586621679426180"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelState (WithInstances (WrappedState state)) -&gt; Property
forall state. ModelState state -&gt; Property
</span><span class="hs-identifier hs-var">QCCM.asserts</span></span><span> </span><span class="annot"><span class="annottext">(ModelState (WithInstances (WrappedState state)) -&gt; Property)
-&gt; ModelState (WithInstances (WrappedState state)) -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Actions state -&gt; ModelState (WithInstances (WrappedState state))
forall state.
ContractModel state =&gt;
Actions state -&gt; ModelState state
</span><span class="hs-identifier hs-var">QCCM.stateAfter</span></span><span> </span><span class="annot"><span class="annottext">Actions state
</span><a href="#local-6989586621679426180"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-581"></span><span>
</span><span id="line-582"></span><span class="hs-comment">-- | Sanity check a `ContractModel`. Ensures that `nextReactiveState` is idempotent.</span><span>
</span><span id="line-583"></span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#propSanityCheckReactive"><span class="hs-identifier hs-type">propSanityCheckReactive</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679426178"><span class="annot"><a href="#local-6989586621679426178"><span class="hs-identifier hs-type">state</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractModel"><span class="hs-identifier hs-type">ContractModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426178"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426178"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Actions"><span class="hs-identifier hs-type">Actions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426178"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Positive</span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/integer-gmp-1.0.3.0/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Positive</span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/integer-gmp-1.0.3.0/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span>
</span><span id="line-584"></span><span id="propSanityCheckReactive"><span class="annot"><span class="annottext">propSanityCheckReactive :: Actions state -&gt; Positive Integer -&gt; Positive Integer -&gt; Property
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#propSanityCheckReactive"><span class="hs-identifier hs-var hs-var">propSanityCheckReactive</span></a></span></span><span> </span><span id="local-6989586621679426177"><span class="annot"><span class="annottext">Actions state
</span><a href="#local-6989586621679426177"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Positive</span></span><span> </span><span id="local-6989586621679426175"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679426175"><span class="hs-identifier hs-var">sl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Positive</span></span><span> </span><span id="local-6989586621679426174"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679426174"><span class="hs-identifier hs-var">sl'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-585"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679426173"><span class="annot"><span class="annottext">s0 :: ModelState (WithInstances (WrappedState state))
</span><a href="#local-6989586621679426173"><span class="hs-identifier hs-var hs-var">s0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Actions state -&gt; ModelState (WithInstances (WrappedState state))
forall state.
ContractModel state =&gt;
Actions state -&gt; ModelState state
</span><span class="hs-identifier hs-var">QCCM.stateAfter</span></span><span> </span><span class="annot"><span class="annottext">Actions state
</span><a href="#local-6989586621679426177"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-586"></span><span>        </span><span id="local-6989586621679426172"><span class="annot"><span class="annottext">sl1 :: SlotNo
</span><a href="#local-6989586621679426172"><span class="hs-identifier hs-var hs-var">sl1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelState (WithInstances (WrappedState state))
</span><a href="#local-6989586621679426173"><span class="hs-identifier hs-var">s0</span></a></span><span> </span><span class="annot"><span class="annottext">ModelState (WithInstances (WrappedState state))
-&gt; Getting
     SlotNo (ModelState (WithInstances (WrappedState state))) SlotNo
-&gt; SlotNo
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  SlotNo (ModelState (WithInstances (WrappedState state))) SlotNo
forall state. Getter (ModelState state) SlotNo
</span><span class="hs-identifier hs-var">QCCM.currentSlot</span></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; SlotNo -&gt; SlotNo
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; SlotNo
</span><span class="hs-identifier hs-var">CardanoAPI.SlotNo</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679426175"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-587"></span><span>        </span><span id="local-6989586621679426170"><span class="annot"><span class="annottext">sl2 :: SlotNo
</span><a href="#local-6989586621679426170"><span class="hs-identifier hs-var hs-var">sl2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679426172"><span class="hs-identifier hs-var">sl1</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; SlotNo -&gt; SlotNo
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; SlotNo
</span><span class="hs-identifier hs-var">CardanoAPI.SlotNo</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679426174"><span class="hs-identifier hs-var">sl'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-588"></span><span>        </span><span id="local-6989586621679426169"><span class="annot"><span class="annottext">s1 :: ModelState (WithInstances (WrappedState state))
</span><a href="#local-6989586621679426169"><span class="hs-identifier hs-var hs-var">s1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Spec (WithInstances (WrappedState state)) ()
-&gt; Var SymIndex
-&gt; ModelState (WithInstances (WrappedState state))
-&gt; ModelState (WithInstances (WrappedState state))
forall state.
Spec state ()
-&gt; Var SymIndex -&gt; ModelState state -&gt; ModelState state
</span><span class="hs-identifier hs-var">QCCM.runSpec</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Spec state () -&gt; Spec (WithInstances (WrappedState state)) ()
forall s s' a. Coercible s s' =&gt; Spec s a -&gt; Spec s' a
</span><span class="hs-identifier hs-var">QCCM.coerceSpec</span></span><span> </span><span class="annot"><span class="annottext">(Spec state () -&gt; Spec (WithInstances (WrappedState state)) ())
-&gt; Spec state () -&gt; Spec (WithInstances (WrappedState state)) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Spec state ()
forall state. ContractModel state =&gt; Slot -&gt; Spec state ()
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#nextReactiveState"><span class="hs-identifier hs-var">nextReactiveState</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679426178"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SlotNo -&gt; Slot
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#fromSlotNo"><span class="hs-identifier hs-var">fromSlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679426172"><span class="hs-identifier hs-var">sl1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Spec state () -&gt; Spec state () -&gt; Spec state ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Spec state ()
forall state. ContractModel state =&gt; Slot -&gt; Spec state ()
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#nextReactiveState"><span class="hs-identifier hs-var">nextReactiveState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SlotNo -&gt; Slot
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#fromSlotNo"><span class="hs-identifier hs-var">fromSlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679426170"><span class="hs-identifier hs-var">sl2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Var SymIndex
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unreachable&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ModelState (WithInstances (WrappedState state))
</span><a href="#local-6989586621679426173"><span class="hs-identifier hs-var">s0</span></a></span><span>
</span><span id="line-589"></span><span>        </span><span id="local-6989586621679426167"><span class="annot"><span class="annottext">s2 :: ModelState (WithInstances (WrappedState state))
</span><a href="#local-6989586621679426167"><span class="hs-identifier hs-var hs-var">s2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Spec (WithInstances (WrappedState state)) ()
-&gt; Var SymIndex
-&gt; ModelState (WithInstances (WrappedState state))
-&gt; ModelState (WithInstances (WrappedState state))
forall state.
Spec state ()
-&gt; Var SymIndex -&gt; ModelState state -&gt; ModelState state
</span><span class="hs-identifier hs-var">QCCM.runSpec</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Spec state () -&gt; Spec (WithInstances (WrappedState state)) ()
forall s s' a. Coercible s s' =&gt; Spec s a -&gt; Spec s' a
</span><span class="hs-identifier hs-var">QCCM.coerceSpec</span></span><span> </span><span class="annot"><span class="annottext">(Spec state () -&gt; Spec (WithInstances (WrappedState state)) ())
-&gt; Spec state () -&gt; Spec (WithInstances (WrappedState state)) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Spec state ()
forall state. ContractModel state =&gt; Slot -&gt; Spec state ()
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#nextReactiveState"><span class="hs-identifier hs-var">nextReactiveState</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679426178"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SlotNo -&gt; Slot
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#fromSlotNo"><span class="hs-identifier hs-var">fromSlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679426170"><span class="hs-identifier hs-var">sl2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Var SymIndex
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unreachable&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ModelState (WithInstances (WrappedState state))
</span><a href="#local-6989586621679426173"><span class="hs-identifier hs-var">s0</span></a></span><span>
</span><span id="line-590"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String -&gt; Property -&gt; Property
forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Balance changes not idempotent&quot;</span></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModelState (WithInstances (WrappedState state))
</span><a href="#local-6989586621679426169"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">ModelState (WithInstances (WrappedState state))
-&gt; Getting
     (Map (AddressInEra Era) SymValue)
     (ModelState (WithInstances (WrappedState state)))
     (Map (AddressInEra Era) SymValue)
-&gt; Map (AddressInEra Era) SymValue
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map (AddressInEra Era) SymValue)
  (ModelState (WithInstances (WrappedState state)))
  (Map (AddressInEra Era) SymValue)
forall state.
Getter (ModelState state) (Map (AddressInEra Era) SymValue)
</span><span class="hs-identifier hs-var">QCCM.balanceChanges</span></span><span> </span><span class="annot"><span class="annottext">Map (AddressInEra Era) SymValue
-&gt; Map (AddressInEra Era) SymValue -&gt; Property
forall a. (Eq a, Show a) =&gt; a -&gt; a -&gt; Property
</span><span class="hs-operator hs-var">===</span></span><span> </span><span class="annot"><span class="annottext">ModelState (WithInstances (WrappedState state))
</span><a href="#local-6989586621679426167"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="annot"><span class="annottext">ModelState (WithInstances (WrappedState state))
-&gt; Getting
     (Map (AddressInEra Era) SymValue)
     (ModelState (WithInstances (WrappedState state)))
     (Map (AddressInEra Era) SymValue)
-&gt; Map (AddressInEra Era) SymValue
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map (AddressInEra Era) SymValue)
  (ModelState (WithInstances (WrappedState state)))
  (Map (AddressInEra Era) SymValue)
forall state.
Getter (ModelState state) (Map (AddressInEra Era) SymValue)
</span><span class="hs-identifier hs-var">QCCM.balanceChanges</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Property -&gt; Property -&gt; Property
forall prop1 prop2.
(Testable prop1, Testable prop2) =&gt;
prop1 -&gt; prop2 -&gt; Property
</span><span class="hs-operator hs-var">QC..&amp;&amp;.</span></span><span>
</span><span id="line-591"></span><span>       </span><span class="annot"><span class="annottext">String -&gt; Property -&gt; Property
forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Contract state changes not idempotent&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModelState (WithInstances (WrappedState state))
</span><a href="#local-6989586621679426169"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">ModelState (WithInstances (WrappedState state))
-&gt; Getting
     (WithInstances (WrappedState state))
     (ModelState (WithInstances (WrappedState state)))
     (WithInstances (WrappedState state))
-&gt; WithInstances (WrappedState state)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (WithInstances (WrappedState state))
  (ModelState (WithInstances (WrappedState state)))
  (WithInstances (WrappedState state))
forall state1 state2.
Lens (ModelState state1) (ModelState state2) state1 state2
</span><span class="hs-identifier hs-var">QCCM.contractState</span></span><span>  </span><span class="annot"><span class="annottext">WithInstances (WrappedState state)
-&gt; WithInstances (WrappedState state) -&gt; Property
forall a. (Eq a, Show a) =&gt; a -&gt; a -&gt; Property
</span><span class="hs-operator hs-var">===</span></span><span> </span><span class="annot"><span class="annottext">ModelState (WithInstances (WrappedState state))
</span><a href="#local-6989586621679426167"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="annot"><span class="annottext">ModelState (WithInstances (WrappedState state))
-&gt; Getting
     (WithInstances (WrappedState state))
     (ModelState (WithInstances (WrappedState state)))
     (WithInstances (WrappedState state))
-&gt; WithInstances (WrappedState state)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (WithInstances (WrappedState state))
  (ModelState (WithInstances (WrappedState state)))
  (WithInstances (WrappedState state))
forall state1 state2.
Lens (ModelState state1) (ModelState state2) state1 state2
</span><span class="hs-identifier hs-var">QCCM.contractState</span></span><span class="hs-special">)</span><span>
</span><span id="line-592"></span><span>
</span><span id="line-593"></span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#fromValue"><span class="hs-identifier hs-type">fromValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAPI.Value</span></span><span>
</span><span id="line-594"></span><span id="fromValue"><span class="annot"><span class="annottext">fromValue :: Value -&gt; Value
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#fromValue"><span class="hs-identifier hs-var hs-var">fromValue</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span id="local-6989586621679426162"><span class="annot"><span class="annottext">Map CurrencySymbol (Map TokenName Integer)
</span><a href="#local-6989586621679426162"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(AssetId, Quantity)] -&gt; Value
</span><span class="hs-identifier hs-var">CardanoAPI.valueFromList</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AssetClass -&gt; AssetId
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#toAssetId"><span class="hs-identifier hs-var">toAssetId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CurrencySymbol, TokenName) -&gt; AssetClass
</span><span class="hs-identifier hs-var">AssetClass</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621679426160"><span class="hs-identifier hs-var">cls</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679426159"><span class="hs-identifier hs-var">sym</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Quantity
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679426158"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-595"></span><span>                                               </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679426160"><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621679426160"><span class="hs-identifier hs-var">cls</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679426157"><span class="annot"><span class="annottext">Map TokenName Integer
</span><a href="#local-6989586621679426157"><span class="hs-identifier hs-var">toks</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map CurrencySymbol (Map TokenName Integer)
-&gt; [(CurrencySymbol, Map TokenName Integer)]
forall k v. Map k v -&gt; [(k, v)]
</span><span class="hs-identifier hs-var">AssocMap.toList</span></span><span> </span><span class="annot"><span class="annottext">Map CurrencySymbol (Map TokenName Integer)
</span><a href="#local-6989586621679426162"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-596"></span><span>                                               </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679426159"><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679426159"><span class="hs-identifier hs-var">sym</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679426158"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679426158"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map TokenName Integer -&gt; [(TokenName, Integer)]
forall k v. Map k v -&gt; [(k, v)]
</span><span class="hs-identifier hs-var">AssocMap.toList</span></span><span> </span><span class="annot"><span class="annottext">Map TokenName Integer
</span><a href="#local-6989586621679426157"><span class="hs-identifier hs-var">toks</span></a></span><span>
</span><span id="line-597"></span><span>                                               </span><span class="hs-special">]</span><span>
</span><span id="line-598"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.SymValueLike</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-599"></span><span>  </span><span id="local-6989586621679426153"><span class="annot"><span class="annottext">toSymValue :: Value -&gt; SymValue
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toSymValue</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; SymValue
forall v. SymValueLike v =&gt; v -&gt; SymValue
</span><span class="hs-identifier hs-var">QCCM.toSymValue</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; SymValue) -&gt; (Value -&gt; Value) -&gt; Value -&gt; SymValue
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#fromValue"><span class="hs-identifier hs-var">fromValue</span></a></span><span>
</span><span id="line-600"></span><span>
</span><span id="line-601"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.TokenLike</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">AssetClass</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-602"></span><span>  </span><span id="local-6989586621679426148"><span class="annot"><span class="annottext">symAssetIdValueOf :: SymValue -&gt; AssetClass -&gt; Quantity
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">symAssetIdValueOf</span></span></span><span> </span><span id="local-6989586621679426146"><span class="annot"><span class="annottext">SymValue
</span><a href="#local-6989586621679426146"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SymValue -&gt; AssetId -&gt; Quantity
forall t. TokenLike t =&gt; SymValue -&gt; t -&gt; Quantity
</span><span class="hs-identifier hs-var">QCCM.symAssetIdValueOf</span></span><span> </span><span class="annot"><span class="annottext">SymValue
</span><a href="#local-6989586621679426146"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">(AssetId -&gt; Quantity)
-&gt; (AssetClass -&gt; AssetId) -&gt; AssetClass -&gt; Quantity
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">AssetClass -&gt; AssetId
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#toAssetId"><span class="hs-identifier hs-var">toAssetId</span></a></span><span>
</span><span id="line-603"></span><span>  </span><span id="local-6989586621679426145"><span class="annot"><span class="annottext">symAssetIdValue :: AssetClass -&gt; Quantity -&gt; SymValue
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">symAssetIdValue</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AssetId -&gt; Quantity -&gt; SymValue
forall t. TokenLike t =&gt; t -&gt; Quantity -&gt; SymValue
</span><span class="hs-identifier hs-var">QCCM.symAssetIdValue</span></span><span> </span><span class="annot"><span class="annottext">(AssetId -&gt; Quantity -&gt; SymValue)
-&gt; (AssetClass -&gt; AssetId) -&gt; AssetClass -&gt; Quantity -&gt; SymValue
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">AssetClass -&gt; AssetId
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#toAssetId"><span class="hs-identifier hs-var">toAssetId</span></a></span><span>
</span><span id="line-604"></span><span>
</span><span id="line-605"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.SymValueLike</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ada.Ada</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-606"></span><span>  </span><span id="local-6989586621679426142"><span class="annot"><span class="annottext">toSymValue :: Ada -&gt; SymValue
</span><a href="#local-6989586621679426142"><span class="hs-identifier hs-var hs-var hs-var hs-var">toSymValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; SymValue
forall v. SymValueLike v =&gt; v -&gt; SymValue
</span><span class="hs-identifier hs-var">QCCM.toSymValue</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; SymValue) -&gt; (Ada -&gt; Value) -&gt; Ada -&gt; SymValue
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ada -&gt; Value
</span><span class="hs-identifier hs-var">Ada.toValue</span></span><span>
</span><span id="line-607"></span><span>
</span><span id="line-608"></span><span class="hs-keyword">type</span><span> </span><span id="NoLockedFundsProof"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#NoLockedFundsProof"><span class="hs-identifier hs-var">NoLockedFundsProof</span></a></span></span><span> </span><span id="local-6989586621679426140"><span class="annot"><a href="#local-6989586621679426140"><span class="hs-identifier hs-type">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#NoLockedFundsProof"><span class="hs-identifier hs-type">CMI.NoLockedFundsProof</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrappedState"><span class="hs-identifier hs-type">WrappedState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426140"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-609"></span><span class="hs-keyword">type</span><span> </span><span id="NoLockedFundsProofLight"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#NoLockedFundsProofLight"><span class="hs-identifier hs-var">NoLockedFundsProofLight</span></a></span></span><span> </span><span id="local-6989586621679426138"><span class="annot"><a href="#local-6989586621679426138"><span class="hs-identifier hs-type">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#NoLockedFundsProofLight"><span class="hs-identifier hs-type">CMI.NoLockedFundsProofLight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#WrappedState"><span class="hs-identifier hs-type">WrappedState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426138"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-610"></span><span>
</span><span id="line-611"></span><span class="hs-comment">-- | Get a component of the model state.</span><span>
</span><span id="line-612"></span><span id="local-6989586621679426655"><span id="local-6989586621679426656"><span id="local-6989586621679426657"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#askModelState"><span class="hs-identifier hs-type">askModelState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Coercible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">QCCM.StateType</span></span><span> </span><span class="annot"><a href="#local-6989586621679426657"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679426656"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.GetModelState</span></span><span> </span><span class="annot"><a href="#local-6989586621679426657"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">QCCM.ModelState</span></span><span> </span><span class="annot"><a href="#local-6989586621679426656"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679426655"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679426657"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426655"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-613"></span><span id="askModelState"><span class="annot"><span class="annottext">askModelState :: (ModelState state -&gt; a) -&gt; m a
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#askModelState"><span class="hs-identifier hs-var hs-var">askModelState</span></a></span></span><span> </span><span id="local-6989586621679426135"><span class="annot"><span class="annottext">ModelState state -&gt; a
</span><a href="#local-6989586621679426135"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModelState state -&gt; a
</span><a href="#local-6989586621679426135"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelState state -&gt; a)
-&gt; (ModelState (StateType m) -&gt; ModelState state)
-&gt; ModelState (StateType m)
-&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(StateType m -&gt; state)
-&gt; ModelState (StateType m) -&gt; ModelState state
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">StateType m -&gt; state
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">coerce</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ModelState (StateType m) -&gt; a)
-&gt; m (ModelState (StateType m)) -&gt; m a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">m (ModelState (StateType m))
forall (m :: * -&gt; *).
GetModelState m =&gt;
m (ModelState (StateType m))
</span><span class="hs-identifier hs-var">QCCM.getModelState</span></span><span>
</span><span id="line-614"></span><span>
</span><span id="line-615"></span><span class="hs-comment">-- | Get a component of the contract state using a lens.</span><span>
</span><span id="line-616"></span><span id="local-6989586621679426131"><span id="local-6989586621679426132"><span id="local-6989586621679426133"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#viewContractState"><span class="hs-identifier hs-type">viewContractState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Coercible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">QCCM.StateType</span></span><span> </span><span class="annot"><a href="#local-6989586621679426133"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679426132"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.GetModelState</span></span><span> </span><span class="annot"><a href="#local-6989586621679426133"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Getting</span></span><span> </span><span class="annot"><a href="#local-6989586621679426131"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426132"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426131"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679426133"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426131"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-617"></span><span id="viewContractState"><span class="annot"><span class="annottext">viewContractState :: Getting a state a -&gt; m a
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#viewContractState"><span class="hs-identifier hs-var hs-var">viewContractState</span></a></span></span><span> </span><span id="local-6989586621679426130"><span class="annot"><span class="annottext">Getting a state a
</span><a href="#local-6989586621679426130"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ModelState state -&gt; a) -&gt; m a
forall (m :: * -&gt; *) state a.
(Coercible (StateType m) state, GetModelState m) =&gt;
(ModelState state -&gt; a) -&gt; m a
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#askModelState"><span class="hs-identifier hs-var">askModelState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting a (ModelState state) a -&gt; ModelState state -&gt; a
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">(Getting a (ModelState state) a -&gt; ModelState state -&gt; a)
-&gt; Getting a (ModelState state) a -&gt; ModelState state -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(state -&gt; Const a state)
-&gt; ModelState state -&gt; Const a (ModelState state)
forall state1 state2.
Lens (ModelState state1) (ModelState state2) state1 state2
</span><span class="hs-identifier hs-var">QCCM.contractState</span></span><span> </span><span class="annot"><span class="annottext">((state -&gt; Const a state)
 -&gt; ModelState state -&gt; Const a (ModelState state))
-&gt; Getting a state a -&gt; Getting a (ModelState state) a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting a state a
</span><a href="#local-6989586621679426130"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-618"></span><span>
</span><span id="line-619"></span><span id="local-6989586621679426128"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#currentSlot"><span class="hs-identifier hs-type">currentSlot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Getter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">QCCM.ModelState</span></span><span> </span><span class="annot"><a href="#local-6989586621679426128"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Slot</span></span></span><span>
</span><span id="line-620"></span><span id="currentSlot"><span class="annot"><span class="annottext">currentSlot :: (Slot -&gt; f Slot) -&gt; ModelState state -&gt; f (ModelState state)
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#currentSlot"><span class="hs-identifier hs-var hs-var">currentSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SlotNo -&gt; f SlotNo) -&gt; ModelState state -&gt; f (ModelState state)
forall state. Getter (ModelState state) SlotNo
</span><span class="hs-identifier hs-var">QCCM.currentSlot</span></span><span> </span><span class="annot"><span class="annottext">((SlotNo -&gt; f SlotNo) -&gt; ModelState state -&gt; f (ModelState state))
-&gt; ((Slot -&gt; f Slot) -&gt; SlotNo -&gt; f SlotNo)
-&gt; (Slot -&gt; f Slot)
-&gt; ModelState state
-&gt; f (ModelState state)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(SlotNo -&gt; Slot) -&gt; (Slot -&gt; f Slot) -&gt; SlotNo -&gt; f SlotNo
forall (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s a.
(Profunctor p, Contravariant f) =&gt;
(s -&gt; a) -&gt; Optic' p f s a
</span><span class="hs-identifier hs-var">to</span></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; Slot
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#fromSlotNo"><span class="hs-identifier hs-var">fromSlotNo</span></a></span><span>
</span><span id="line-621"></span><span>
</span><span id="line-622"></span><span id="local-6989586621679426126"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#balanceChange"><span class="hs-identifier hs-type">balanceChange</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Wallet</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Getter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">QCCM.ModelState</span></span><span> </span><span class="annot"><a href="#local-6989586621679426126"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.SymValue</span></span></span><span>
</span><span id="line-623"></span><span id="balanceChange"><span class="annot"><span class="annottext">balanceChange :: Wallet -&gt; Getter (ModelState state) SymValue
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#balanceChange"><span class="hs-identifier hs-var hs-var">balanceChange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddressInEra Era
-&gt; (SymValue -&gt; f SymValue)
-&gt; ModelState state
-&gt; f (ModelState state)
forall state.
Ord (AddressInEra Era) =&gt;
AddressInEra Era -&gt; Getter (ModelState state) SymValue
</span><span class="hs-identifier hs-var">QCCM.balanceChange</span></span><span> </span><span class="annot"><span class="annottext">(AddressInEra Era
 -&gt; (SymValue -&gt; f SymValue)
 -&gt; ModelState state
 -&gt; f (ModelState state))
-&gt; (Wallet -&gt; AddressInEra Era)
-&gt; Wallet
-&gt; (SymValue -&gt; f SymValue)
-&gt; ModelState state
-&gt; f (ModelState state)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; AddressInEra Era
</span><a href="Plutus.Contract.Test.ContractModel.Internal.html#walletAddress"><span class="hs-identifier hs-var">CMI.walletAddress</span></a></span><span>
</span><span id="line-624"></span><span>
</span><span id="line-625"></span><span class="hs-comment">-- | Check that running a contract model does not result in validation</span><span>
</span><span id="line-626"></span><span class="hs-comment">-- failures that are not accepted by the whitelist.</span><span>
</span><span id="line-627"></span><span id="local-6989586621679426124"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#checkErrorWhitelist"><span class="hs-identifier hs-type">checkErrorWhitelist</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractModel"><span class="hs-identifier hs-type">ContractModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426124"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-628"></span><span>                    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#Whitelist"><span class="hs-identifier hs-type">CMI.Whitelist</span></a></span><span>
</span><span id="line-629"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Actions"><span class="hs-identifier hs-type">Actions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426124"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-630"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span></span><span>
</span><span id="line-631"></span><span id="checkErrorWhitelist"><span class="annot"><span class="annottext">checkErrorWhitelist :: Whitelist -&gt; Actions m -&gt; Property
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#checkErrorWhitelist"><span class="hs-identifier hs-var hs-var">checkErrorWhitelist</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CheckOptions
-&gt; CoverageOptions -&gt; Whitelist -&gt; Actions m -&gt; Property
forall m.
ContractModel m =&gt;
CheckOptions
-&gt; CoverageOptions -&gt; Whitelist -&gt; Actions m -&gt; Property
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#checkErrorWhitelistWithOptions"><span class="hs-identifier hs-var">checkErrorWhitelistWithOptions</span></a></span><span> </span><span class="annot"><span class="annottext">CheckOptions
</span><a href="Plutus.Contract.Test.ContractModel.Internal.html#defaultCheckOptionsContractModel"><span class="hs-identifier hs-var">CMI.defaultCheckOptionsContractModel</span></a></span><span> </span><span class="annot"><span class="annottext">CoverageOptions
</span><a href="Plutus.Contract.Test.ContractModel.Internal.html#defaultCoverageOptions"><span class="hs-identifier hs-var">CMI.defaultCoverageOptions</span></a></span><span>
</span><span id="line-632"></span><span>
</span><span id="line-633"></span><span class="hs-comment">-- | Check that running a contract model does not result in validation</span><span>
</span><span id="line-634"></span><span class="hs-comment">-- failures that are not accepted by the whitelist.</span><span>
</span><span id="line-635"></span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#checkErrorWhitelistWithOptions"><span class="hs-identifier hs-type">checkErrorWhitelistWithOptions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679426635"><span class="annot"><a href="#local-6989586621679426635"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractModel"><span class="hs-identifier hs-type">ContractModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426635"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-636"></span><span>                               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CheckOptions</span></span><span>
</span><span id="line-637"></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#CoverageOptions"><span class="hs-identifier hs-type">CMI.CoverageOptions</span></a></span><span>
</span><span id="line-638"></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#Whitelist"><span class="hs-identifier hs-type">CMI.Whitelist</span></a></span><span>
</span><span id="line-639"></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Actions"><span class="hs-identifier hs-type">Actions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426635"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-640"></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span>
</span><span id="line-641"></span><span id="checkErrorWhitelistWithOptions"><span class="annot"><span class="annottext">checkErrorWhitelistWithOptions :: CheckOptions
-&gt; CoverageOptions -&gt; Whitelist -&gt; Actions m -&gt; Property
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#checkErrorWhitelistWithOptions"><span class="hs-identifier hs-var hs-var">checkErrorWhitelistWithOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CheckOptions
-&gt; CoverageOptions -&gt; Whitelist -&gt; Actions m -&gt; Property
forall m.
CheckableContractModel m =&gt;
CheckOptions
-&gt; CoverageOptions
-&gt; Whitelist
-&gt; Actions (WithInstances m)
-&gt; Property
</span><a href="Plutus.Contract.Test.ContractModel.Internal.html#checkErrorWhitelistWithOptions"><span class="hs-identifier hs-var">CMI.checkErrorWhitelistWithOptions</span></a></span><span>
</span><span id="line-642"></span><span>
</span><span id="line-643"></span><span class="hs-comment">-- | Perform a light-weight check to find egregious double satisfaction</span><span>
</span><span id="line-644"></span><span class="hs-comment">-- vulnerabilities in contracts.</span><span>
</span><span id="line-645"></span><span class="hs-comment">--</span><span>
</span><span id="line-646"></span><span class="hs-comment">-- A counterexample to this property consists of three transactions.</span><span>
</span><span id="line-647"></span><span class="hs-comment">-- * The first transaction is a valid transaction from the trace generated by the contract model.</span><span>
</span><span id="line-648"></span><span class="hs-comment">-- * The second transaction, generated by redirecting</span><span>
</span><span id="line-649"></span><span class="hs-comment">--   a non-datum pubkey output from a non-signer to a signer in the first transaction,</span><span>
</span><span id="line-650"></span><span class="hs-comment">--   fails to validate. This demonstrates that funds can't simply be stolen.</span><span>
</span><span id="line-651"></span><span class="hs-comment">-- * The third transaction goes through and manages to steal funds by altering the first transaction.</span><span>
</span><span id="line-652"></span><span class="hs-comment">--   It is generated by adding another script input (with the same value as the non-signer non-stealable</span><span>
</span><span id="line-653"></span><span class="hs-comment">--   pubkey output) and adding a datum to the non-signer non-stealable pubkey output, and giving the</span><span>
</span><span id="line-654"></span><span class="hs-comment">--   extra value from the new script input to a signer.</span><span>
</span><span id="line-655"></span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#checkDoubleSatisfaction"><span class="hs-identifier hs-type">checkDoubleSatisfaction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679426122"><span class="annot"><a href="#local-6989586621679426122"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractModel"><span class="hs-identifier hs-type">ContractModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426122"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-656"></span><span>                        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Actions"><span class="hs-identifier hs-type">Actions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426122"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-657"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span>
</span><span id="line-658"></span><span id="checkDoubleSatisfaction"><span class="annot"><span class="annottext">checkDoubleSatisfaction :: Actions m -&gt; Property
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#checkDoubleSatisfaction"><span class="hs-identifier hs-var hs-var">checkDoubleSatisfaction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CheckOptions -&gt; CoverageOptions -&gt; Actions m -&gt; Property
forall m.
ContractModel m =&gt;
CheckOptions -&gt; CoverageOptions -&gt; Actions m -&gt; Property
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#checkDoubleSatisfactionWithOptions"><span class="hs-identifier hs-var">checkDoubleSatisfactionWithOptions</span></a></span><span> </span><span class="annot"><span class="annottext">CheckOptions
</span><a href="Plutus.Contract.Test.ContractModel.Internal.html#defaultCheckOptionsContractModel"><span class="hs-identifier hs-var">CMI.defaultCheckOptionsContractModel</span></a></span><span>
</span><span id="line-659"></span><span>                                                             </span><span class="annot"><span class="annottext">CoverageOptions
</span><a href="Plutus.Contract.Test.ContractModel.Internal.html#defaultCoverageOptions"><span class="hs-identifier hs-var">CMI.defaultCoverageOptions</span></a></span><span>
</span><span id="line-660"></span><span>
</span><span id="line-661"></span><span class="hs-comment">-- | Perform a light-weight check to find egregious double satisfaction</span><span>
</span><span id="line-662"></span><span class="hs-comment">-- vulnerabilities in contracts, with options.</span><span>
</span><span id="line-663"></span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#checkDoubleSatisfactionWithOptions"><span class="hs-identifier hs-type">checkDoubleSatisfactionWithOptions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679426631"><span class="annot"><a href="#local-6989586621679426631"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractModel"><span class="hs-identifier hs-type">ContractModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426631"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-664"></span><span>                                   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CheckOptions</span></span><span>
</span><span id="line-665"></span><span>                                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.html#CoverageOptions"><span class="hs-identifier hs-type">CMI.CoverageOptions</span></a></span><span>
</span><span id="line-666"></span><span>                                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Actions"><span class="hs-identifier hs-type">Actions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426631"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-667"></span><span>                                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span>
</span><span id="line-668"></span><span id="checkDoubleSatisfactionWithOptions"><span class="annot"><span class="annottext">checkDoubleSatisfactionWithOptions :: CheckOptions -&gt; CoverageOptions -&gt; Actions m -&gt; Property
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#checkDoubleSatisfactionWithOptions"><span class="hs-identifier hs-var hs-var">checkDoubleSatisfactionWithOptions</span></a></span></span><span> </span><span id="local-6989586621679426121"><span class="annot"><span class="annottext">CheckOptions
</span><a href="#local-6989586621679426121"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679426120"><span class="annot"><span class="annottext">CoverageOptions
</span><a href="#local-6989586621679426120"><span class="hs-identifier hs-var">covopts</span></a></span></span><span> </span><span id="local-6989586621679426119"><span class="annot"><span class="annottext">Actions m
</span><a href="#local-6989586621679426119"><span class="hs-identifier hs-var">acts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-669"></span><span>  </span><span class="annot"><span class="annottext">CheckOptions
-&gt; CoverageOptions -&gt; ThreatModel () -&gt; Actions m -&gt; Property
forall state a.
CheckableContractModel state =&gt;
CheckOptions
-&gt; CoverageOptions
-&gt; ThreatModel a
-&gt; Actions (WithInstances state)
-&gt; Property
</span><a href="Plutus.Contract.Test.ContractModel.Internal.html#checkThreatModelWithOptions"><span class="hs-identifier hs-var">CMI.checkThreatModelWithOptions</span></a></span><span> </span><span class="annot"><span class="annottext">CheckOptions
</span><a href="#local-6989586621679426121"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">CoverageOptions
</span><a href="#local-6989586621679426120"><span class="hs-identifier hs-var">covopts</span></a></span><span> </span><span class="annot"><span class="annottext">ThreatModel ()
</span><span class="hs-identifier hs-var">QCCM.doubleSatisfaction</span></span><span> </span><span class="annot"><span class="annottext">Actions m
</span><a href="#local-6989586621679426119"><span class="hs-identifier hs-var">acts</span></a></span><span>
</span><span id="line-670"></span><span>
</span><span id="line-671"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.HasSymbolics</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Wallet</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-672"></span><span>  </span><span id="local-6989586621679426115"><span class="annot"><span class="annottext">getAllSymbolics :: Wallet -&gt; SymCollectionIndex
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">getAllSymbolics</span></span></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SymCollectionIndex
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-673"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.HasSymbolics</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-674"></span><span>  </span><span id="local-6989586621679426112"><span class="annot"><span class="annottext">getAllSymbolics :: Value -&gt; SymCollectionIndex
</span><a href="#local-6989586621679426112"><span class="hs-identifier hs-var hs-var hs-var hs-var">getAllSymbolics</span></a></span></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SymCollectionIndex
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-675"></span><span>
</span><span id="line-676"></span><span class="hs-keyword">data</span><span> </span><span id="SomeContractInstanceKey"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#SomeContractInstanceKey"><span class="hs-identifier hs-var">SomeContractInstanceKey</span></a></span></span><span> </span><span id="local-6989586621679426111"><span class="annot"><a href="#local-6989586621679426111"><span class="hs-identifier hs-type">state</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-677"></span><span>  </span><span id="local-6989586621679426106"><span id="local-6989586621679426107"><span id="local-6989586621679426108"><span id="local-6989586621679426109"><span id="local-6989586621679426110"><span id="Key"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Key"><span class="hs-identifier hs-var">Key</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#SchemaConstraints"><span class="hs-identifier hs-type">CMI.SchemaConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426110"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426109"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426108"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426107"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-678"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractInstanceKey"><span class="hs-identifier hs-type">ContractInstanceKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426106"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426110"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426109"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426108"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426107"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-679"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#SomeContractInstanceKey"><span class="hs-identifier hs-type">SomeContractInstanceKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426106"><span class="hs-identifier hs-type">state</span></a></span></span></span></span></span></span><span>
</span><span id="line-680"></span><span>
</span><span id="line-681"></span><span id="local-6989586621679426104"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679426101"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractModel"><span class="hs-identifier hs-type">ContractModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426104"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#SomeContractInstanceKey"><span class="hs-identifier hs-type">SomeContractInstanceKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426104"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-682"></span><span>  </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span> </span><span id="local-6989586621679426100"><span class="annot"><span class="annottext">ContractInstanceKey state w s e p
</span><a href="#local-6989586621679426100"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679426099"><span class="annot"><span class="annottext">== :: SomeContractInstanceKey state
-&gt; SomeContractInstanceKey state -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></a></span></span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span> </span><span id="local-6989586621679426098"><span class="annot"><span class="annottext">ContractInstanceKey state w s e p
</span><a href="#local-6989586621679426098"><span class="hs-identifier hs-var">k'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractInstanceKey state w s e p
-&gt; Maybe (ContractInstanceKey state w s e p)
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceKey state w s e p
</span><a href="#local-6989586621679426100"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (ContractInstanceKey state w s e p)
-&gt; Maybe (ContractInstanceKey state w s e p) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceKey state w s e p
-&gt; Maybe (ContractInstanceKey state w s e p)
forall a b. (Typeable a, Typeable b) =&gt; a -&gt; Maybe b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">cast</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceKey state w s e p
</span><a href="#local-6989586621679426098"><span class="hs-identifier hs-var">k'</span></a></span></span><span>
</span><span id="line-683"></span><span>
</span><span id="line-684"></span><span id="local-6989586621679426096"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679426091"><span id="local-6989586621679426093"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#ContractModel"><span class="hs-identifier hs-type">ContractModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426096"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#SomeContractInstanceKey"><span class="hs-identifier hs-type">SomeContractInstanceKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679426096"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-685"></span><span>  </span><span id="local-6989586621679426090"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; SomeContractInstanceKey state -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></a></span></span><span> </span><span id="local-6989586621679426088"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679426088"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span> </span><span id="local-6989586621679426087"><span class="annot"><span class="annottext">ContractInstanceKey state w s e p
</span><a href="#local-6989586621679426087"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ContractInstanceKey state w s e p -&gt; ShowS
forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">showsPrec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679426088"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceKey state w s e p
</span><a href="#local-6989586621679426087"><span class="hs-identifier hs-var">k</span></a></span></span><span>
</span><span id="line-686"></span><span>
</span><span id="line-687"></span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Interface.html#invSymValue"><span class="hs-identifier hs-type">invSymValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.SymValue</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.SymValue</span></span><span>
</span><span id="line-688"></span><span id="invSymValue"><span class="annot"><span class="annottext">invSymValue :: SymValue -&gt; SymValue
</span><a href="Plutus.Contract.Test.ContractModel.Interface.html#invSymValue"><span class="hs-identifier hs-var hs-var">invSymValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SymValue -&gt; SymValue
</span><span class="hs-identifier hs-var">QCCM.inv</span></span><span>
</span><span id="line-689"></span><span>
</span><span id="line-690"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCCM.HasSymbolics</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builtins.BuiltinByteString</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-691"></span><span>  </span><span id="local-6989586621679426084"><span class="annot"><span class="annottext">getAllSymbolics :: BuiltinByteString -&gt; SymCollectionIndex
</span><a href="#local-6989586621679426084"><span class="hs-identifier hs-var hs-var hs-var hs-var">getAllSymbolics</span></a></span></span><span> </span><span class="annot"><span class="annottext">BuiltinByteString
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SymCollectionIndex
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-692"></span><span id="local-6989586621679426082"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">via</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCSM.HasNoVariables</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builtins.BuiltinByteString</span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QCSM.HasVariables</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builtins.BuiltinByteString</span></span></span><span>
</span><span id="line-693"></span></pre></body></html>