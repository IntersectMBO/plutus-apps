<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds         #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass    #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric     #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DerivingVia       #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts  #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE GADTs             #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase        #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns    #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE StrictData        #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell   #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications  #-}</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-comment">{-| This module exports data types for logging, events and configuration
-}</span><span>
</span><span id="line-19"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.Node.Socket.Emulator.Types</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Api</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NetworkId</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Value</span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Chain.Slotting</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">EpochSlots</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Block</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CL</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Era</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CL</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Shelley.API</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">extractTx</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unsafeMakeValidated</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Node.Emulator.API</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">EmulatorLogs</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">EmulatorMsg</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">EmulatorState</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">emptyEmulatorStateWithInitialDist</span></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>                                  </span><span class="annot"><span class="hs-identifier">esChainState</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Node.Emulator.Internal.Node.Chain</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">EC</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Node.Emulator.Internal.Node.Params</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">testnet</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Node.Emulator.Internal.Node.TimeSlot</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SlotConfig</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Codec.Serialise</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">DeserialiseFailure</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Codec.Serialise</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CBOR</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Concurrent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">MVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">modifyMVar_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">readMVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Concurrent.STM</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">makeLenses</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">view</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator">(&amp;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.~)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(^.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">forever</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Class.MonadST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadST</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Class.MonadTimer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadDelay</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">threadDelay</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MonadTimer</span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad.IO.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">MonadIO</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">liftIO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.Hash</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SHA256</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">hash</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">FromJSON</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ToJSON</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson.Extras</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">JSON</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteArray</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BA</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BSL</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Short</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Coerce</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier">coerce</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Default</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Default</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">def</span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">toList</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Functor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">void</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator">(&lt;&amp;&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">listToMaybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromList</span></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Time.Clock</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">UTCTime</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Time.Format.ISO8601</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Time.Units</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Millisecond</span></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Time.Units.Extra</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Void</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Void</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Block</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">CardanoTx</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">OnChainTx</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Address</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CardanoAddress</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.CardanoWallet</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Test</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">testNetworkMagic</span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Network.TypedProtocol.Codec</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Codec</span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Byron.Ledger</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Byron</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Cardano.Block</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CardanoBlock</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">CodecConfig</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Cardano.Block</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">OC</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.HardFork.Combinator.AcrossEras</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">OneEraHash</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Ledger.SupportsMempool</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ApplyTxErr</span></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Network.NodeToClient</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ClientCodecs</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">cChainSyncCodec</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">cTxSubmissionCodec</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">clientCodecs</span></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Node.NetworkProtocolVersion</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">BlockNodeToClientVersion</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">supportedNodeToClientVersions</span></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Protocol.Praos.Header</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Praos</span></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Shelley.Eras</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">StandardCrypto</span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.Shelley.Ledger</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Shelley</span></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ouroboros.Network.Block</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Point</span></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ouroboros.Network.Block</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ouroboros</span></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ouroboros.Network.Mux</span></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ouroboros.Network.NodeToClient</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NodeToClientVersion</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">NodeToClientVersionData</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ouroboros.Network.Protocol.ChainSync.Type</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ChainSync</span></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ouroboros.Network.Protocol.LocalTxSubmission.Type</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TxSubmission</span></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ouroboros.Network.Util.ShowProxy</span></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prettyprinter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Pretty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">pretty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">viaShow</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">vsep</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;+&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prettyprinter.Extras</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PrettyShow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PrettyShow</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Servant.Client</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">BaseUrl</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">BaseUrl</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">baseUrlPort</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Scheme</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Http</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-keyword">type</span><span> </span><span id="Tip"><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#Tip"><span class="hs-identifier hs-var">Tip</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ouroboros.Tip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CardanoBlock</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-keyword">type</span><span> </span><span id="TxPool"><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#TxPool"><span class="hs-identifier hs-var">TxPool</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span class="hs-special">]</span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span id="local-6989586621679329721"><span id="local-6989586621679329722"></span></span><span class="hs-keyword">data</span><span> </span><span id="SocketEmulatorState"><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#SocketEmulatorState"><span class="hs-identifier hs-var">SocketEmulatorState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SocketEmulatorState"><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#SocketEmulatorState"><span class="hs-identifier hs-var">SocketEmulatorState</span></a></span></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_emulatorState"><span class="annot"><span class="annottext">SocketEmulatorState -&gt; EmulatorState
</span><a href="Cardano.Node.Socket.Emulator.Types.html#_emulatorState"><span class="hs-identifier hs-var hs-var">_emulatorState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EmulatorState</span></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_channel"><span class="annot"><span class="annottext">SocketEmulatorState -&gt; TChan Block
</span><a href="Cardano.Node.Socket.Emulator.Types.html#_channel"><span class="hs-identifier hs-var hs-var">_channel</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TChan</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Block</span></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_tip"><span class="annot"><span class="annottext">SocketEmulatorState -&gt; Tip
</span><a href="Cardano.Node.Socket.Emulator.Types.html#_tip"><span class="hs-identifier hs-var hs-var">_tip</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#Tip"><span class="hs-identifier hs-type">Tip</span></a></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. SocketEmulatorState -&gt; Rep SocketEmulatorState x)
-&gt; (forall x. Rep SocketEmulatorState x -&gt; SocketEmulatorState)
-&gt; Generic SocketEmulatorState
forall x. Rep SocketEmulatorState x -&gt; SocketEmulatorState
forall x. SocketEmulatorState -&gt; Rep SocketEmulatorState x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep SocketEmulatorState x -&gt; SocketEmulatorState
$cfrom :: forall x. SocketEmulatorState -&gt; Rep SocketEmulatorState x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span id="tip"><span id="emulatorState"><span id="channel"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">SocketEmulatorState</span></span></span></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679329706"><span id="local-6989586621679329709"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#SocketEmulatorState"><span class="hs-identifier hs-type">SocketEmulatorState</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-comment">-- Skip showing the full chain</span><span>
</span><span id="line-100"></span><span>    </span><span id="local-6989586621679329704"><span class="annot"><span class="annottext">show :: SocketEmulatorState -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#SocketEmulatorState"><span class="hs-identifier hs-type">SocketEmulatorState</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679329702"><span class="annot"><span class="annottext">EmulatorState
_emulatorState :: EmulatorState
_emulatorState :: SocketEmulatorState -&gt; EmulatorState
</span><a href="#local-6989586621679329702"><span class="hs-identifier hs-var hs-var">_emulatorState</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679329701"><span class="annot"><span class="annottext">Tip
_tip :: Tip
_tip :: SocketEmulatorState -&gt; Tip
</span><a href="#local-6989586621679329701"><span class="hs-identifier hs-var hs-var">_tip</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-101"></span><span>        </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SocketEmulatorState { &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EmulatorState -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">EmulatorState
</span><a href="#local-6989586621679329702"><span class="hs-identifier hs-var">_emulatorState</span></a></span><span>
</span><span id="line-102"></span><span>                        </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Tip -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Tip
</span><a href="#local-6989586621679329701"><span class="hs-identifier hs-var">_tip</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; }&quot;</span></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">-- | Node server configuration</span><span>
</span><span id="line-105"></span><span id="local-6989586621679329699"><span id="local-6989586621679329700"></span></span><span class="hs-keyword">data</span><span> </span><span id="NodeServerConfig"><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#NodeServerConfig"><span class="hs-identifier hs-var">NodeServerConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-106"></span><span>    </span><span id="NodeServerConfig"><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#NodeServerConfig"><span class="hs-identifier hs-var">NodeServerConfig</span></a></span></span><span>
</span><span id="line-107"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="nscBaseUrl"><span class="annot"><span class="annottext">NodeServerConfig -&gt; BaseUrl
</span><a href="Cardano.Node.Socket.Emulator.Types.html#nscBaseUrl"><span class="hs-identifier hs-var hs-var">nscBaseUrl</span></a></span></span><span>                    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BaseUrl</span></span><span>
</span><span id="line-108"></span><span>        </span><span class="hs-comment">-- ^ base url of the service</span><span>
</span><span id="line-109"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="nscInitialTxWallets"><span class="annot"><span class="annottext">NodeServerConfig -&gt; [WalletNumber]
</span><a href="Cardano.Node.Socket.Emulator.Types.html#nscInitialTxWallets"><span class="hs-identifier hs-var hs-var">nscInitialTxWallets</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">WalletNumber</span></span><span class="hs-special">]</span><span>
</span><span id="line-110"></span><span>        </span><span class="hs-comment">-- ^ The wallets that receive money from the initial transaction.</span><span>
</span><span id="line-111"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="nscSocketPath"><span class="annot"><span class="annottext">NodeServerConfig -&gt; String
</span><a href="Cardano.Node.Socket.Emulator.Types.html#nscSocketPath"><span class="hs-identifier hs-var hs-var">nscSocketPath</span></a></span></span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-112"></span><span>        </span><span class="hs-comment">-- ^ Path to the socket used to communicate with the server.</span><span>
</span><span id="line-113"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="nscKeptBlocks"><span class="annot"><span class="annottext">NodeServerConfig -&gt; Integer
</span><a href="Cardano.Node.Socket.Emulator.Types.html#nscKeptBlocks"><span class="hs-identifier hs-var hs-var">nscKeptBlocks</span></a></span></span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/integer-gmp-1.0.3.0/src"><span class="hs-identifier hs-type">Integer</span></a></span><span>
</span><span id="line-114"></span><span>        </span><span class="hs-comment">-- ^ The number of blocks to keep for replaying to newly connected clients</span><span>
</span><span id="line-115"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="nscSlotConfig"><span class="annot"><span class="annottext">NodeServerConfig -&gt; SlotConfig
</span><a href="Cardano.Node.Socket.Emulator.Types.html#nscSlotConfig"><span class="hs-identifier hs-var hs-var">nscSlotConfig</span></a></span></span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotConfig</span></span><span>
</span><span id="line-116"></span><span>        </span><span class="hs-comment">-- ^ Beginning of slot 0.</span><span>
</span><span id="line-117"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="nscNetworkId"><span class="annot"><span class="annottext">NodeServerConfig -&gt; NetworkId
</span><a href="Cardano.Node.Socket.Emulator.Types.html#nscNetworkId"><span class="hs-identifier hs-var hs-var">nscNetworkId</span></a></span></span><span>                  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NetworkId</span></span><span>
</span><span id="line-118"></span><span>        </span><span class="hs-comment">-- ^ NetworkId that's used with the CardanoAPI.</span><span>
</span><span id="line-119"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="nscProtocolParametersJsonPath"><span class="annot"><span class="annottext">NodeServerConfig -&gt; Maybe String
</span><a href="Cardano.Node.Socket.Emulator.Types.html#nscProtocolParametersJsonPath"><span class="hs-identifier hs-var hs-var">nscProtocolParametersJsonPath</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-120"></span><span>        </span><span class="hs-comment">-- ^ Path to a JSON file containing the protocol parameters</span><span>
</span><span id="line-121"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679329684"><span id="local-6989586621679329686"><span id="local-6989586621679329688"><span class="annot"><span class="annottext">Int -&gt; NodeServerConfig -&gt; ShowS
[NodeServerConfig] -&gt; ShowS
NodeServerConfig -&gt; String
(Int -&gt; NodeServerConfig -&gt; ShowS)
-&gt; (NodeServerConfig -&gt; String)
-&gt; ([NodeServerConfig] -&gt; ShowS)
-&gt; Show NodeServerConfig
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [NodeServerConfig] -&gt; ShowS
$cshowList :: [NodeServerConfig] -&gt; ShowS
show :: NodeServerConfig -&gt; String
$cshow :: NodeServerConfig -&gt; String
showsPrec :: Int -&gt; NodeServerConfig -&gt; ShowS
$cshowsPrec :: Int -&gt; NodeServerConfig -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679329680"><span id="local-6989586621679329682"><span class="annot"><span class="annottext">NodeServerConfig -&gt; NodeServerConfig -&gt; Bool
(NodeServerConfig -&gt; NodeServerConfig -&gt; Bool)
-&gt; (NodeServerConfig -&gt; NodeServerConfig -&gt; Bool)
-&gt; Eq NodeServerConfig
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: NodeServerConfig -&gt; NodeServerConfig -&gt; Bool
$c/= :: NodeServerConfig -&gt; NodeServerConfig -&gt; Bool
== :: NodeServerConfig -&gt; NodeServerConfig -&gt; Bool
$c== :: NodeServerConfig -&gt; NodeServerConfig -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. NodeServerConfig -&gt; Rep NodeServerConfig x)
-&gt; (forall x. Rep NodeServerConfig x -&gt; NodeServerConfig)
-&gt; Generic NodeServerConfig
forall x. Rep NodeServerConfig x -&gt; NodeServerConfig
forall x. NodeServerConfig -&gt; Rep NodeServerConfig x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep NodeServerConfig x -&gt; NodeServerConfig
$cfrom :: forall x. NodeServerConfig -&gt; Rep NodeServerConfig x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679329673"><span id="local-6989586621679329675"><span class="annot"><span class="annottext">Value -&gt; Parser [NodeServerConfig]
Value -&gt; Parser NodeServerConfig
(Value -&gt; Parser NodeServerConfig)
-&gt; (Value -&gt; Parser [NodeServerConfig])
-&gt; FromJSON NodeServerConfig
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [NodeServerConfig]
$cparseJSONList :: Value -&gt; Parser [NodeServerConfig]
parseJSON :: Value -&gt; Parser NodeServerConfig
$cparseJSON :: Value -&gt; Parser NodeServerConfig
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679329664"><span id="local-6989586621679329666"><span id="local-6989586621679329668"><span id="local-6989586621679329670"><span class="annot"><span class="annottext">[NodeServerConfig] -&gt; Value
[NodeServerConfig] -&gt; Encoding
NodeServerConfig -&gt; Value
NodeServerConfig -&gt; Encoding
(NodeServerConfig -&gt; Value)
-&gt; (NodeServerConfig -&gt; Encoding)
-&gt; ([NodeServerConfig] -&gt; Value)
-&gt; ([NodeServerConfig] -&gt; Encoding)
-&gt; ToJSON NodeServerConfig
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [NodeServerConfig] -&gt; Encoding
$ctoEncodingList :: [NodeServerConfig] -&gt; Encoding
toJSONList :: [NodeServerConfig] -&gt; Value
$ctoJSONList :: [NodeServerConfig] -&gt; Value
toEncoding :: NodeServerConfig -&gt; Encoding
$ctoEncoding :: NodeServerConfig -&gt; Encoding
toJSON :: NodeServerConfig -&gt; Value
$ctoJSON :: NodeServerConfig -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#defaultNodeServerConfig"><span class="hs-identifier hs-type">defaultNodeServerConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#NodeServerConfig"><span class="hs-identifier hs-type">NodeServerConfig</span></a></span><span>
</span><span id="line-126"></span><span id="defaultNodeServerConfig"><span class="annot"><span class="annottext">defaultNodeServerConfig :: NodeServerConfig
</span><a href="Cardano.Node.Socket.Emulator.Types.html#defaultNodeServerConfig"><span class="hs-identifier hs-var hs-var">defaultNodeServerConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><span class="annottext">NodeServerConfig :: BaseUrl
-&gt; [WalletNumber]
-&gt; String
-&gt; Integer
-&gt; SlotConfig
-&gt; NetworkId
-&gt; Maybe String
-&gt; NodeServerConfig
</span><a href="Cardano.Node.Socket.Emulator.Types.html#NodeServerConfig"><span class="hs-identifier hs-type">NodeServerConfig</span></a></span><span>
</span><span id="line-128"></span><span>      </span><span class="hs-comment">-- See Note [pab-ports] in 'test/full/Plutus/PAB/CliSpec.hs'.</span><span>
</span><span id="line-129"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">nscBaseUrl :: BaseUrl
</span><a href="Cardano.Node.Socket.Emulator.Types.html#nscBaseUrl"><span class="hs-identifier hs-var">nscBaseUrl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scheme -&gt; String -&gt; Int -&gt; String -&gt; BaseUrl
</span><span class="hs-identifier hs-var">BaseUrl</span></span><span> </span><span class="annot"><span class="annottext">Scheme
</span><span class="hs-identifier hs-var">Http</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;localhost&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9082</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-130"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nscInitialTxWallets :: [WalletNumber]
</span><a href="Cardano.Node.Socket.Emulator.Types.html#nscInitialTxWallets"><span class="hs-identifier hs-var">nscInitialTxWallets</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-131"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; WalletNumber
</span><span class="hs-identifier hs-var">WalletNumber</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span>
</span><span id="line-132"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; WalletNumber
</span><span class="hs-identifier hs-var">WalletNumber</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span>
</span><span id="line-133"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; WalletNumber
</span><span class="hs-identifier hs-var">WalletNumber</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span>
</span><span id="line-134"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; WalletNumber
</span><span class="hs-identifier hs-var">WalletNumber</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">4</span></span><span>
</span><span id="line-135"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; WalletNumber
</span><span class="hs-identifier hs-var">WalletNumber</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span>
</span><span id="line-136"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; WalletNumber
</span><span class="hs-identifier hs-var">WalletNumber</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">6</span></span><span>
</span><span id="line-137"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; WalletNumber
</span><span class="hs-identifier hs-var">WalletNumber</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">7</span></span><span>
</span><span id="line-138"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; WalletNumber
</span><span class="hs-identifier hs-var">WalletNumber</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">8</span></span><span>
</span><span id="line-139"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; WalletNumber
</span><span class="hs-identifier hs-var">WalletNumber</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">9</span></span><span>
</span><span id="line-140"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; WalletNumber
</span><span class="hs-identifier hs-var">WalletNumber</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10</span></span><span>
</span><span id="line-141"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-142"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nscSocketPath :: String
</span><a href="Cardano.Node.Socket.Emulator.Types.html#nscSocketPath"><span class="hs-identifier hs-var">nscSocketPath</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/tmp/node-server.sock&quot;</span></span><span>
</span><span id="line-143"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nscKeptBlocks :: Integer
</span><a href="Cardano.Node.Socket.Emulator.Types.html#nscKeptBlocks"><span class="hs-identifier hs-var">nscKeptBlocks</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">100</span></span><span>
</span><span id="line-144"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nscSlotConfig :: SlotConfig
</span><a href="Cardano.Node.Socket.Emulator.Types.html#nscSlotConfig"><span class="hs-identifier hs-var">nscSlotConfig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SlotConfig
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-145"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nscNetworkId :: NetworkId
</span><a href="Cardano.Node.Socket.Emulator.Types.html#nscNetworkId"><span class="hs-identifier hs-var">nscNetworkId</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><span class="hs-identifier hs-var">testnet</span></span><span>
</span><span id="line-146"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nscProtocolParametersJsonPath :: Maybe String
</span><a href="Cardano.Node.Socket.Emulator.Types.html#nscProtocolParametersJsonPath"><span class="hs-identifier hs-var">nscProtocolParametersJsonPath</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-147"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#NodeServerConfig"><span class="hs-identifier hs-type">NodeServerConfig</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-150"></span><span>  </span><span id="local-6989586621679329658"><span class="annot"><span class="annottext">def :: NodeServerConfig
</span><a href="#local-6989586621679329658"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeServerConfig
</span><a href="Cardano.Node.Socket.Emulator.Types.html#defaultNodeServerConfig"><span class="hs-identifier hs-var">defaultNodeServerConfig</span></a></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679329655"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#NodeServerConfig"><span class="hs-identifier hs-type">NodeServerConfig</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-153"></span><span>  </span><span id="local-6989586621679329653"><span class="annot"><span class="annottext">pretty :: NodeServerConfig -&gt; Doc ann
</span><a href="#local-6989586621679329653"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#NodeServerConfig"><span class="hs-identifier hs-type">NodeServerConfig</span></a></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679329652"><span class="annot"><span class="annottext">BaseUrl
nscBaseUrl :: BaseUrl
nscBaseUrl :: NodeServerConfig -&gt; BaseUrl
</span><a href="#local-6989586621679329652"><span class="hs-identifier hs-var hs-var">nscBaseUrl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679329651"><span class="annot"><span class="annottext">String
nscSocketPath :: String
nscSocketPath :: NodeServerConfig -&gt; String
</span><a href="#local-6989586621679329651"><span class="hs-identifier hs-var hs-var">nscSocketPath</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679329650"><span class="annot"><span class="annottext">NetworkId
nscNetworkId :: NetworkId
nscNetworkId :: NodeServerConfig -&gt; NetworkId
</span><a href="#local-6989586621679329650"><span class="hs-identifier hs-var hs-var">nscNetworkId</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679329649"><span class="annot"><span class="annottext">Integer
nscKeptBlocks :: Integer
nscKeptBlocks :: NodeServerConfig -&gt; Integer
</span><a href="#local-6989586621679329649"><span class="hs-identifier hs-var hs-var">nscKeptBlocks</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-154"></span><span>    </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">vsep</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Socket:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679329651"><span class="hs-identifier hs-var">nscSocketPath</span></a></span><span>
</span><span id="line-155"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Network Id:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">NetworkId -&gt; Doc ann
forall a ann. Show a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">viaShow</span></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679329650"><span class="hs-identifier hs-var">nscNetworkId</span></a></span><span>
</span><span id="line-156"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Port:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc ann
forall a ann. Show a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">viaShow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseUrl -&gt; Int
</span><span class="hs-identifier hs-var hs-var">baseUrlPort</span></span><span> </span><span class="annot"><span class="annottext">BaseUrl
</span><a href="#local-6989586621679329652"><span class="hs-identifier hs-var">nscBaseUrl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Security Param:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679329649"><span class="hs-identifier hs-var">nscKeptBlocks</span></a></span><span>
</span><span id="line-158"></span><span>         </span><span class="hs-special">]</span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-comment">-- | Application State</span><span>
</span><span id="line-161"></span><span class="hs-keyword">data</span><span> </span><span id="AppState"><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#AppState"><span class="hs-identifier hs-var">AppState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-162"></span><span>    </span><span id="AppState"><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#AppState"><span class="hs-identifier hs-var">AppState</span></a></span></span><span>
</span><span id="line-163"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="_socketEmulatorState"><span class="annot"><span class="annottext">AppState -&gt; SocketEmulatorState
</span><a href="Cardano.Node.Socket.Emulator.Types.html#_socketEmulatorState"><span class="hs-identifier hs-var hs-var">_socketEmulatorState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#SocketEmulatorState"><span class="hs-identifier hs-type">SocketEmulatorState</span></a></span><span> </span><span class="hs-comment">-- ^ blockchain state</span><span>
</span><span id="line-164"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_emulatorLogs"><span class="annot"><span class="annottext">AppState -&gt; EmulatorLogs
</span><a href="Cardano.Node.Socket.Emulator.Types.html#_emulatorLogs"><span class="hs-identifier hs-var hs-var">_emulatorLogs</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EmulatorLogs</span></span><span> </span><span class="hs-comment">-- ^ history of all log messages</span><span>
</span><span id="line-165"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679329640"><span id="local-6989586621679329642"><span id="local-6989586621679329644"><span class="annot"><span class="annottext">Int -&gt; AppState -&gt; ShowS
[AppState] -&gt; ShowS
AppState -&gt; String
(Int -&gt; AppState -&gt; ShowS)
-&gt; (AppState -&gt; String) -&gt; ([AppState] -&gt; ShowS) -&gt; Show AppState
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [AppState] -&gt; ShowS
$cshowList :: [AppState] -&gt; ShowS
show :: AppState -&gt; String
$cshow :: AppState -&gt; String
showsPrec :: Int -&gt; AppState -&gt; ShowS
$cshowsPrec :: Int -&gt; AppState -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span id="socketEmulatorState"><span id="emulatorLogs"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">AppState</span></span></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span id="local-6989586621679329937"><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#fromEmulatorChainState"><span class="hs-identifier hs-type">fromEmulatorChainState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679329937"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EmulatorState</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679329937"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#SocketEmulatorState"><span class="hs-identifier hs-type">SocketEmulatorState</span></a></span></span><span>
</span><span id="line-171"></span><span id="fromEmulatorChainState"><span class="annot"><span class="annottext">fromEmulatorChainState :: EmulatorState -&gt; m SocketEmulatorState
</span><a href="Cardano.Node.Socket.Emulator.Types.html#fromEmulatorChainState"><span class="hs-identifier hs-var hs-var">fromEmulatorChainState</span></a></span></span><span> </span><span id="local-6989586621679329636"><span class="annot"><span class="annottext">EmulatorState
</span><a href="#local-6989586621679329636"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-172"></span><span>    </span><span id="local-6989586621679329635"><span class="annot"><span class="annottext">TChan Block
</span><a href="#local-6989586621679329635"><span class="hs-identifier hs-var">ch</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (TChan Block) -&gt; m (TChan Block)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (TChan Block) -&gt; m (TChan Block))
-&gt; IO (TChan Block) -&gt; m (TChan Block)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">STM (TChan Block) -&gt; IO (TChan Block)
forall a. STM a -&gt; IO a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">atomically</span></a></span><span> </span><span class="annot"><span class="annottext">STM (TChan Block)
forall a. STM (TChan a)
</span><span class="hs-identifier hs-var">newTChan</span></span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679329632"><span class="annot"><span class="annottext">chainNewestFirst :: [Block]
</span><a href="#local-6989586621679329632"><span class="hs-identifier hs-var hs-var">chainNewestFirst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Getting [Block] EmulatorState [Block] -&gt; EmulatorState -&gt; [Block]
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ChainState -&gt; Const [Block] ChainState)
-&gt; EmulatorState -&gt; Const [Block] EmulatorState
Lens' EmulatorState ChainState
</span><span class="hs-identifier hs-var">esChainState</span></span><span> </span><span class="annot"><span class="annottext">((ChainState -&gt; Const [Block] ChainState)
 -&gt; EmulatorState -&gt; Const [Block] EmulatorState)
-&gt; (([Block] -&gt; Const [Block] [Block])
    -&gt; ChainState -&gt; Const [Block] ChainState)
-&gt; Getting [Block] EmulatorState [Block]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([Block] -&gt; Const [Block] [Block])
-&gt; ChainState -&gt; Const [Block] ChainState
Lens' ChainState [Block]
</span><span class="hs-identifier hs-var">EC.chainNewestFirst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EmulatorState
</span><a href="#local-6989586621679329636"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679329629"><span class="annot"><span class="annottext">currentSlot :: Slot
</span><a href="#local-6989586621679329629"><span class="hs-identifier hs-var hs-var">currentSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Getting Slot EmulatorState Slot -&gt; EmulatorState -&gt; Slot
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ChainState -&gt; Const Slot ChainState)
-&gt; EmulatorState -&gt; Const Slot EmulatorState
Lens' EmulatorState ChainState
</span><span class="hs-identifier hs-var">esChainState</span></span><span> </span><span class="annot"><span class="annottext">((ChainState -&gt; Const Slot ChainState)
 -&gt; EmulatorState -&gt; Const Slot EmulatorState)
-&gt; ((Slot -&gt; Const Slot Slot)
    -&gt; ChainState -&gt; Const Slot ChainState)
-&gt; Getting Slot EmulatorState Slot
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Slot -&gt; Const Slot Slot) -&gt; ChainState -&gt; Const Slot ChainState
Lens' ChainState Slot
</span><span class="hs-identifier hs-var">EC.chainCurrentSlot</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EmulatorState
</span><a href="#local-6989586621679329636"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-175"></span><span>    </span><span class="annot"><span class="annottext">m () -&gt; m ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; m ()) -&gt; IO () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-176"></span><span>        </span><span class="annot"><span class="annottext">(Block -&gt; IO ()) -&gt; [Block] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STM () -&gt; IO ()
forall a. STM a -&gt; IO a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM () -&gt; IO ()) -&gt; (Block -&gt; STM ()) -&gt; Block -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TChan Block -&gt; Block -&gt; STM ()
forall a. TChan a -&gt; a -&gt; STM ()
</span><span class="hs-identifier hs-var">writeTChan</span></span><span> </span><span class="annot"><span class="annottext">TChan Block
</span><a href="#local-6989586621679329635"><span class="hs-identifier hs-var">ch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Block]
</span><a href="#local-6989586621679329632"><span class="hs-identifier hs-var">chainNewestFirst</span></a></span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><span class="annottext">SocketEmulatorState -&gt; m SocketEmulatorState
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(SocketEmulatorState -&gt; m SocketEmulatorState)
-&gt; SocketEmulatorState -&gt; m SocketEmulatorState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SocketEmulatorState :: EmulatorState -&gt; TChan Block -&gt; Tip -&gt; SocketEmulatorState
</span><a href="Cardano.Node.Socket.Emulator.Types.html#SocketEmulatorState"><span class="hs-identifier hs-type">SocketEmulatorState</span></a></span><span>
</span><span id="line-178"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_channel :: TChan Block
</span><a href="Cardano.Node.Socket.Emulator.Types.html#_channel"><span class="hs-identifier hs-var">_channel</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TChan Block
</span><a href="#local-6989586621679329635"><span class="hs-identifier hs-var">ch</span></a></span><span>
</span><span id="line-179"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_emulatorState :: EmulatorState
</span><a href="Cardano.Node.Socket.Emulator.Types.html#_emulatorState"><span class="hs-identifier hs-var">_emulatorState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EmulatorState
</span><a href="#local-6989586621679329636"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-180"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tip :: Tip
</span><a href="Cardano.Node.Socket.Emulator.Types.html#_tip"><span class="hs-identifier hs-var">_tip</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Block] -&gt; Maybe Block
forall a. [a] -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">listToMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">[Block]
</span><a href="#local-6989586621679329632"><span class="hs-identifier hs-var">chainNewestFirst</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-181"></span><span>                              </span><span class="annot"><span class="annottext">Maybe Block
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Tip
forall b. Tip b
</span><span class="hs-identifier hs-var">Ouroboros.TipGenesis</span></span><span>
</span><span id="line-182"></span><span>                              </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679329624"><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679329624"><span class="hs-identifier hs-var">block</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SlotNo
-&gt; HeaderHash (CardanoBlock StandardCrypto) -&gt; BlockNo -&gt; Tip
forall b. SlotNo -&gt; HeaderHash b -&gt; BlockNo -&gt; Tip b
</span><span class="hs-identifier hs-var">Ouroboros.Tip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Slot -&gt; SlotNo
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679329629"><span class="hs-identifier hs-var">currentSlot</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockId
-&gt; OneEraHash (ByronBlock : CardanoShelleyEras StandardCrypto)
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">coerce</span></a></span><span> </span><span class="annot"><span class="annottext">(BlockId
 -&gt; OneEraHash (ByronBlock : CardanoShelleyEras StandardCrypto))
-&gt; BlockId
-&gt; OneEraHash (ByronBlock : CardanoShelleyEras StandardCrypto)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Block -&gt; BlockId
</span><a href="Cardano.Node.Socket.Emulator.Types.html#blockId"><span class="hs-identifier hs-var">blockId</span></a></span><span> </span><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679329624"><span class="hs-identifier hs-var">block</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Slot -&gt; BlockNo
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679329629"><span class="hs-identifier hs-var">currentSlot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-comment">-- | 'ChainState' with initial values</span><span>
</span><span id="line-186"></span><span id="local-6989586621679329621"><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#initialChainState"><span class="hs-identifier hs-type">initialChainState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679329621"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAddress</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679329621"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#SocketEmulatorState"><span class="hs-identifier hs-type">SocketEmulatorState</span></a></span></span><span>
</span><span id="line-187"></span><span id="initialChainState"><span class="annot"><span class="annottext">initialChainState :: Map CardanoAddress Value -&gt; m SocketEmulatorState
</span><a href="Cardano.Node.Socket.Emulator.Types.html#initialChainState"><span class="hs-identifier hs-var hs-var">initialChainState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EmulatorState -&gt; m SocketEmulatorState
forall (m :: * -&gt; *).
MonadIO m =&gt;
EmulatorState -&gt; m SocketEmulatorState
</span><a href="Cardano.Node.Socket.Emulator.Types.html#fromEmulatorChainState"><span class="hs-identifier hs-var">fromEmulatorChainState</span></a></span><span> </span><span class="annot"><span class="annottext">(EmulatorState -&gt; m SocketEmulatorState)
-&gt; (Map CardanoAddress Value -&gt; EmulatorState)
-&gt; Map CardanoAddress Value
-&gt; m SocketEmulatorState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Map CardanoAddress Value -&gt; EmulatorState
</span><span class="hs-identifier hs-var">emptyEmulatorStateWithInitialDist</span></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span id="local-6989586621679329619"><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#getChannel"><span class="hs-identifier hs-type">getChannel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679329619"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MVar</span></a></span><span> </span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#AppState"><span class="hs-identifier hs-type">AppState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679329619"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TChan</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Block</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-190"></span><span id="getChannel"><span class="annot"><span class="annottext">getChannel :: MVar AppState -&gt; m (TChan Block)
</span><a href="Cardano.Node.Socket.Emulator.Types.html#getChannel"><span class="hs-identifier hs-var hs-var">getChannel</span></a></span></span><span> </span><span id="local-6989586621679329617"><span class="annot"><span class="annottext">MVar AppState
</span><a href="#local-6989586621679329617"><span class="hs-identifier hs-var">mv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO AppState -&gt; m AppState
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MVar AppState -&gt; IO AppState
forall a. MVar a -&gt; IO a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">readMVar</span></a></span><span> </span><span class="annot"><span class="annottext">MVar AppState
</span><a href="#local-6989586621679329617"><span class="hs-identifier hs-var">mv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m AppState -&gt; (AppState -&gt; TChan Block) -&gt; m (TChan Block)
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&amp;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (TChan Block) AppState (TChan Block)
-&gt; AppState -&gt; TChan Block
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SocketEmulatorState -&gt; Const (TChan Block) SocketEmulatorState)
-&gt; AppState -&gt; Const (TChan Block) AppState
Lens' AppState SocketEmulatorState
</span><a href="Cardano.Node.Socket.Emulator.Types.html#socketEmulatorState"><span class="hs-identifier hs-var">socketEmulatorState</span></a></span><span> </span><span class="annot"><span class="annottext">((SocketEmulatorState -&gt; Const (TChan Block) SocketEmulatorState)
 -&gt; AppState -&gt; Const (TChan Block) AppState)
-&gt; ((TChan Block -&gt; Const (TChan Block) (TChan Block))
    -&gt; SocketEmulatorState -&gt; Const (TChan Block) SocketEmulatorState)
-&gt; Getting (TChan Block) AppState (TChan Block)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(TChan Block -&gt; Const (TChan Block) (TChan Block))
-&gt; SocketEmulatorState -&gt; Const (TChan Block) SocketEmulatorState
Lens' SocketEmulatorState (TChan Block)
</span><a href="Cardano.Node.Socket.Emulator.Types.html#channel"><span class="hs-identifier hs-var">channel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-comment">-- Get the current tip.</span><span>
</span><span id="line-193"></span><span id="local-6989586621679329616"><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#getTip"><span class="hs-identifier hs-type">getTip</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679329616"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MVar</span></a></span><span> </span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#AppState"><span class="hs-identifier hs-type">AppState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679329616"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#Tip"><span class="hs-identifier hs-type">Tip</span></a></span></span><span>
</span><span id="line-194"></span><span id="getTip"><span class="annot"><span class="annottext">getTip :: MVar AppState -&gt; m Tip
</span><a href="Cardano.Node.Socket.Emulator.Types.html#getTip"><span class="hs-identifier hs-var hs-var">getTip</span></a></span></span><span> </span><span id="local-6989586621679329614"><span class="annot"><span class="annottext">MVar AppState
</span><a href="#local-6989586621679329614"><span class="hs-identifier hs-var">mv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO AppState -&gt; m AppState
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MVar AppState -&gt; IO AppState
forall a. MVar a -&gt; IO a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">readMVar</span></a></span><span> </span><span class="annot"><span class="annottext">MVar AppState
</span><a href="#local-6989586621679329614"><span class="hs-identifier hs-var">mv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m AppState -&gt; (AppState -&gt; Tip) -&gt; m Tip
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&amp;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Getting Tip AppState Tip -&gt; AppState -&gt; Tip
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SocketEmulatorState -&gt; Const Tip SocketEmulatorState)
-&gt; AppState -&gt; Const Tip AppState
Lens' AppState SocketEmulatorState
</span><a href="Cardano.Node.Socket.Emulator.Types.html#socketEmulatorState"><span class="hs-identifier hs-var">socketEmulatorState</span></a></span><span> </span><span class="annot"><span class="annottext">((SocketEmulatorState -&gt; Const Tip SocketEmulatorState)
 -&gt; AppState -&gt; Const Tip AppState)
-&gt; ((Tip -&gt; Const Tip Tip)
    -&gt; SocketEmulatorState -&gt; Const Tip SocketEmulatorState)
-&gt; Getting Tip AppState Tip
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Tip -&gt; Const Tip Tip)
-&gt; SocketEmulatorState -&gt; Const Tip SocketEmulatorState
Lens' SocketEmulatorState Tip
</span><a href="Cardano.Node.Socket.Emulator.Types.html#tip"><span class="hs-identifier hs-var">tip</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-comment">-- Set the new tip</span><span>
</span><span id="line-197"></span><span id="local-6989586621679329613"><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#setTip"><span class="hs-identifier hs-type">setTip</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679329613"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MVar</span></a></span><span> </span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#AppState"><span class="hs-identifier hs-type">AppState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Block</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679329613"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-198"></span><span id="setTip"><span class="annot"><span class="annottext">setTip :: MVar AppState -&gt; Block -&gt; m ()
</span><a href="Cardano.Node.Socket.Emulator.Types.html#setTip"><span class="hs-identifier hs-var hs-var">setTip</span></a></span></span><span> </span><span id="local-6989586621679329611"><span class="annot"><span class="annottext">MVar AppState
</span><a href="#local-6989586621679329611"><span class="hs-identifier hs-var">mv</span></a></span></span><span> </span><span id="local-6989586621679329610"><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679329610"><span class="hs-identifier hs-var">block</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; m ()) -&gt; IO () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MVar AppState -&gt; (AppState -&gt; IO AppState) -&gt; IO ()
forall a. MVar a -&gt; (a -&gt; IO a) -&gt; IO ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">modifyMVar_</span></a></span><span> </span><span class="annot"><span class="annottext">MVar AppState
</span><a href="#local-6989586621679329611"><span class="hs-identifier hs-var">mv</span></a></span><span> </span><span class="annot"><span class="annottext">((AppState -&gt; IO AppState) -&gt; IO ())
-&gt; (AppState -&gt; IO AppState) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679329609"><span class="annot"><span class="annottext">AppState
</span><a href="#local-6989586621679329609"><span class="hs-identifier hs-var">oldState</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679329608"><span class="annot"><span class="annottext">slot :: Slot
</span><a href="#local-6989586621679329608"><span class="hs-identifier hs-var hs-var">slot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AppState
</span><a href="#local-6989586621679329609"><span class="hs-identifier hs-var">oldState</span></a></span><span> </span><span class="annot"><span class="annottext">AppState -&gt; Getting Slot AppState Slot -&gt; Slot
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">(SocketEmulatorState -&gt; Const Slot SocketEmulatorState)
-&gt; AppState -&gt; Const Slot AppState
Lens' AppState SocketEmulatorState
</span><a href="Cardano.Node.Socket.Emulator.Types.html#socketEmulatorState"><span class="hs-identifier hs-var">socketEmulatorState</span></a></span><span> </span><span class="annot"><span class="annottext">((SocketEmulatorState -&gt; Const Slot SocketEmulatorState)
 -&gt; AppState -&gt; Const Slot AppState)
-&gt; ((Slot -&gt; Const Slot Slot)
    -&gt; SocketEmulatorState -&gt; Const Slot SocketEmulatorState)
-&gt; Getting Slot AppState Slot
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(EmulatorState -&gt; Const Slot EmulatorState)
-&gt; SocketEmulatorState -&gt; Const Slot SocketEmulatorState
Lens' SocketEmulatorState EmulatorState
</span><a href="Cardano.Node.Socket.Emulator.Types.html#emulatorState"><span class="hs-identifier hs-var">emulatorState</span></a></span><span> </span><span class="annot"><span class="annottext">((EmulatorState -&gt; Const Slot EmulatorState)
 -&gt; SocketEmulatorState -&gt; Const Slot SocketEmulatorState)
-&gt; Getting Slot EmulatorState Slot
-&gt; (Slot -&gt; Const Slot Slot)
-&gt; SocketEmulatorState
-&gt; Const Slot SocketEmulatorState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainState -&gt; Const Slot ChainState)
-&gt; EmulatorState -&gt; Const Slot EmulatorState
Lens' EmulatorState ChainState
</span><span class="hs-identifier hs-var">esChainState</span></span><span> </span><span class="annot"><span class="annottext">((ChainState -&gt; Const Slot ChainState)
 -&gt; EmulatorState -&gt; Const Slot EmulatorState)
-&gt; ((Slot -&gt; Const Slot Slot)
    -&gt; ChainState -&gt; Const Slot ChainState)
-&gt; Getting Slot EmulatorState Slot
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Slot -&gt; Const Slot Slot) -&gt; ChainState -&gt; Const Slot ChainState
Lens' ChainState Slot
</span><span class="hs-identifier hs-var">EC.chainCurrentSlot</span></span><span>
</span><span id="line-200"></span><span>  </span><span class="annot"><span class="annottext">AppState -&gt; IO AppState
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(AppState -&gt; IO AppState) -&gt; AppState -&gt; IO AppState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AppState
</span><a href="#local-6989586621679329609"><span class="hs-identifier hs-var">oldState</span></a></span><span> </span><span class="annot"><span class="annottext">AppState -&gt; (AppState -&gt; AppState) -&gt; AppState
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(SocketEmulatorState -&gt; Identity SocketEmulatorState)
-&gt; AppState -&gt; Identity AppState
Lens' AppState SocketEmulatorState
</span><a href="Cardano.Node.Socket.Emulator.Types.html#socketEmulatorState"><span class="hs-identifier hs-var">socketEmulatorState</span></a></span><span> </span><span class="annot"><span class="annottext">((SocketEmulatorState -&gt; Identity SocketEmulatorState)
 -&gt; AppState -&gt; Identity AppState)
-&gt; ((Tip -&gt; Identity Tip)
    -&gt; SocketEmulatorState -&gt; Identity SocketEmulatorState)
-&gt; (Tip -&gt; Identity Tip)
-&gt; AppState
-&gt; Identity AppState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Tip -&gt; Identity Tip)
-&gt; SocketEmulatorState -&gt; Identity SocketEmulatorState
Lens' SocketEmulatorState Tip
</span><a href="Cardano.Node.Socket.Emulator.Types.html#tip"><span class="hs-identifier hs-var">tip</span></a></span><span> </span><span class="annot"><span class="annottext">((Tip -&gt; Identity Tip) -&gt; AppState -&gt; Identity AppState)
-&gt; Tip -&gt; AppState -&gt; AppState
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">SlotNo
-&gt; HeaderHash (CardanoBlock StandardCrypto) -&gt; BlockNo -&gt; Tip
forall b. SlotNo -&gt; HeaderHash b -&gt; BlockNo -&gt; Tip b
</span><span class="hs-identifier hs-var">Ouroboros.Tip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Slot -&gt; SlotNo
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679329608"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockId
-&gt; OneEraHash (ByronBlock : CardanoShelleyEras StandardCrypto)
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">coerce</span></a></span><span> </span><span class="annot"><span class="annottext">(BlockId
 -&gt; OneEraHash (ByronBlock : CardanoShelleyEras StandardCrypto))
-&gt; BlockId
-&gt; OneEraHash (ByronBlock : CardanoShelleyEras StandardCrypto)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Block -&gt; BlockId
</span><a href="Cardano.Node.Socket.Emulator.Types.html#blockId"><span class="hs-identifier hs-var">blockId</span></a></span><span> </span><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679329610"><span class="hs-identifier hs-var">block</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Slot -&gt; BlockNo
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679329608"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-comment">-- Logging ------------------------------------------------------------------------------------------------------------</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-comment">-- | Top-level logging data type for structural logging</span><span>
</span><span id="line-205"></span><span class="hs-comment">-- inside the CNSE server.</span><span>
</span><span id="line-206"></span><span id="local-6989586621679329606"><span id="local-6989586621679329607"></span></span><span class="hs-keyword">data</span><span> </span><span id="CNSEServerLogMsg"><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#CNSEServerLogMsg"><span class="hs-identifier hs-var">CNSEServerLogMsg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-207"></span><span>    </span><span id="StartingSlotCoordination"><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#StartingSlotCoordination"><span class="hs-identifier hs-var">StartingSlotCoordination</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Millisecond</span></span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="StartingCNSEServer"><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#StartingCNSEServer"><span class="hs-identifier hs-var">StartingCNSEServer</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="ProcessingEmulatorMsg"><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#ProcessingEmulatorMsg"><span class="hs-identifier hs-var">ProcessingEmulatorMsg</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EmulatorMsg</span></span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. CNSEServerLogMsg -&gt; Rep CNSEServerLogMsg x)
-&gt; (forall x. Rep CNSEServerLogMsg x -&gt; CNSEServerLogMsg)
-&gt; Generic CNSEServerLogMsg
forall x. Rep CNSEServerLogMsg x -&gt; CNSEServerLogMsg
forall x. CNSEServerLogMsg -&gt; Rep CNSEServerLogMsg x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep CNSEServerLogMsg x -&gt; CNSEServerLogMsg
$cfrom :: forall x. CNSEServerLogMsg -&gt; Rep CNSEServerLogMsg x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679329595"><span id="local-6989586621679329597"><span id="local-6989586621679329599"><span class="annot"><span class="annottext">Int -&gt; CNSEServerLogMsg -&gt; ShowS
[CNSEServerLogMsg] -&gt; ShowS
CNSEServerLogMsg -&gt; String
(Int -&gt; CNSEServerLogMsg -&gt; ShowS)
-&gt; (CNSEServerLogMsg -&gt; String)
-&gt; ([CNSEServerLogMsg] -&gt; ShowS)
-&gt; Show CNSEServerLogMsg
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [CNSEServerLogMsg] -&gt; ShowS
$cshowList :: [CNSEServerLogMsg] -&gt; ShowS
show :: CNSEServerLogMsg -&gt; String
$cshow :: CNSEServerLogMsg -&gt; String
showsPrec :: Int -&gt; CNSEServerLogMsg -&gt; ShowS
$cshowsPrec :: Int -&gt; CNSEServerLogMsg -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679329587"><span id="local-6989586621679329589"><span id="local-6989586621679329591"><span id="local-6989586621679329593"><span class="annot"><span class="annottext">[CNSEServerLogMsg] -&gt; Value
[CNSEServerLogMsg] -&gt; Encoding
CNSEServerLogMsg -&gt; Value
CNSEServerLogMsg -&gt; Encoding
(CNSEServerLogMsg -&gt; Value)
-&gt; (CNSEServerLogMsg -&gt; Encoding)
-&gt; ([CNSEServerLogMsg] -&gt; Value)
-&gt; ([CNSEServerLogMsg] -&gt; Encoding)
-&gt; ToJSON CNSEServerLogMsg
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [CNSEServerLogMsg] -&gt; Encoding
$ctoEncodingList :: [CNSEServerLogMsg] -&gt; Encoding
toJSONList :: [CNSEServerLogMsg] -&gt; Value
$ctoJSONList :: [CNSEServerLogMsg] -&gt; Value
toEncoding :: CNSEServerLogMsg -&gt; Encoding
$ctoEncoding :: CNSEServerLogMsg -&gt; Encoding
toJSON :: CNSEServerLogMsg -&gt; Value
$ctoJSON :: CNSEServerLogMsg -&gt; Value
</span><a href="#local-6989586621679329587"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></a></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679329583"><span id="local-6989586621679329585"><span class="annot"><span class="annottext">Value -&gt; Parser [CNSEServerLogMsg]
Value -&gt; Parser CNSEServerLogMsg
(Value -&gt; Parser CNSEServerLogMsg)
-&gt; (Value -&gt; Parser [CNSEServerLogMsg])
-&gt; FromJSON CNSEServerLogMsg
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [CNSEServerLogMsg]
$cparseJSONList :: Value -&gt; Parser [CNSEServerLogMsg]
parseJSON :: Value -&gt; Parser CNSEServerLogMsg
$cparseJSON :: Value -&gt; Parser CNSEServerLogMsg
</span><a href="#local-6989586621679329583"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679329580"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#CNSEServerLogMsg"><span class="hs-identifier hs-type">CNSEServerLogMsg</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621679329579"><span class="annot"><span class="annottext">pretty :: CNSEServerLogMsg -&gt; Doc ann
</span><a href="#local-6989586621679329579"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-214"></span><span>        </span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#StartingSlotCoordination"><span class="hs-identifier hs-type">StartingSlotCoordination</span></a></span><span> </span><span id="local-6989586621679329578"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679329578"><span class="hs-identifier hs-var">initialSlotTime</span></a></span></span><span> </span><span id="local-6989586621679329577"><span class="annot"><span class="annottext">Millisecond
</span><a href="#local-6989586621679329577"><span class="hs-identifier hs-var">slotLength</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-215"></span><span>            </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Starting slot coordination thread.&quot;</span></span><span>
</span><span id="line-216"></span><span>            </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Initial slot time:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTCTime -&gt; String
forall t. ISO8601 t =&gt; t -&gt; String
</span><span class="hs-identifier hs-var">F.iso8601Show</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679329578"><span class="hs-identifier hs-var">initialSlotTime</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>            </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Slot length:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Millisecond -&gt; Doc ann
forall a ann. Show a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">viaShow</span></span><span> </span><span class="annot"><span class="annottext">Millisecond
</span><a href="#local-6989586621679329577"><span class="hs-identifier hs-var">slotLength</span></a></span><span>
</span><span id="line-218"></span><span>        </span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#StartingCNSEServer"><span class="hs-identifier hs-type">StartingCNSEServer</span></a></span><span> </span><span id="local-6989586621679329575"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679329575"><span class="hs-identifier hs-var">p</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Starting Cardano Node Emulator on port&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679329575"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-219"></span><span>        </span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#ProcessingEmulatorMsg"><span class="hs-identifier hs-type">ProcessingEmulatorMsg</span></a></span><span> </span><span id="local-6989586621679329574"><span class="annot"><span class="annottext">EmulatorMsg
</span><a href="#local-6989586621679329574"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Processing emulator event:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">EmulatorMsg -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">EmulatorMsg
</span><a href="#local-6989586621679329574"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-comment">-- | The node protocols require a block header type.</span><span>
</span><span id="line-222"></span><span id="local-6989586621679329572"><span id="local-6989586621679329573"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="BlockId"><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#BlockId"><span class="hs-identifier hs-var">BlockId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BlockId"><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#BlockId"><span class="hs-identifier hs-var">BlockId</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="getBlockId"><span class="annot"><span class="annottext">BlockId -&gt; ShortByteString
</span><a href="Cardano.Node.Socket.Emulator.Types.html#getBlockId"><span class="hs-identifier hs-var hs-var">getBlockId</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ShortByteString</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679329566"><span id="local-6989586621679329568"><span class="annot"><span class="annottext">BlockId -&gt; BlockId -&gt; Bool
(BlockId -&gt; BlockId -&gt; Bool)
-&gt; (BlockId -&gt; BlockId -&gt; Bool) -&gt; Eq BlockId
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: BlockId -&gt; BlockId -&gt; Bool
$c/= :: BlockId -&gt; BlockId -&gt; Bool
== :: BlockId -&gt; BlockId -&gt; Bool
$c== :: BlockId -&gt; BlockId -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679329551"><span id="local-6989586621679329553"><span id="local-6989586621679329555"><span id="local-6989586621679329557"><span id="local-6989586621679329559"><span id="local-6989586621679329561"><span id="local-6989586621679329563"><span class="annot"><span class="annottext">Eq BlockId
Eq BlockId
-&gt; (BlockId -&gt; BlockId -&gt; Ordering)
-&gt; (BlockId -&gt; BlockId -&gt; Bool)
-&gt; (BlockId -&gt; BlockId -&gt; Bool)
-&gt; (BlockId -&gt; BlockId -&gt; Bool)
-&gt; (BlockId -&gt; BlockId -&gt; Bool)
-&gt; (BlockId -&gt; BlockId -&gt; BlockId)
-&gt; (BlockId -&gt; BlockId -&gt; BlockId)
-&gt; Ord BlockId
BlockId -&gt; BlockId -&gt; Bool
BlockId -&gt; BlockId -&gt; Ordering
BlockId -&gt; BlockId -&gt; BlockId
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: BlockId -&gt; BlockId -&gt; BlockId
$cmin :: BlockId -&gt; BlockId -&gt; BlockId
max :: BlockId -&gt; BlockId -&gt; BlockId
$cmax :: BlockId -&gt; BlockId -&gt; BlockId
&gt;= :: BlockId -&gt; BlockId -&gt; Bool
$c&gt;= :: BlockId -&gt; BlockId -&gt; Bool
&gt; :: BlockId -&gt; BlockId -&gt; Bool
$c&gt; :: BlockId -&gt; BlockId -&gt; Bool
&lt;= :: BlockId -&gt; BlockId -&gt; Bool
$c&lt;= :: BlockId -&gt; BlockId -&gt; Bool
&lt; :: BlockId -&gt; BlockId -&gt; Bool
$c&lt; :: BlockId -&gt; BlockId -&gt; Bool
compare :: BlockId -&gt; BlockId -&gt; Ordering
$ccompare :: BlockId -&gt; BlockId -&gt; Ordering
$cp1Ord :: Eq BlockId
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. BlockId -&gt; Rep BlockId x)
-&gt; (forall x. Rep BlockId x -&gt; BlockId) -&gt; Generic BlockId
forall x. Rep BlockId x -&gt; BlockId
forall x. BlockId -&gt; Rep BlockId x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep BlockId x -&gt; BlockId
$cfrom :: forall x. BlockId -&gt; Rep BlockId x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679329540"><span id="local-6989586621679329542"><span id="local-6989586621679329544"><span id="local-6989586621679329546"><span class="annot"><span class="annottext">Decoder s BlockId
Decoder s [BlockId]
[BlockId] -&gt; Encoding
BlockId -&gt; Encoding
(BlockId -&gt; Encoding)
-&gt; (forall s. Decoder s BlockId)
-&gt; ([BlockId] -&gt; Encoding)
-&gt; (forall s. Decoder s [BlockId])
-&gt; Serialise BlockId
forall s. Decoder s [BlockId]
forall s. Decoder s BlockId
forall a.
(a -&gt; Encoding)
-&gt; (forall s. Decoder s a)
-&gt; ([a] -&gt; Encoding)
-&gt; (forall s. Decoder s [a])
-&gt; Serialise a
decodeList :: Decoder s [BlockId]
$cdecodeList :: forall s. Decoder s [BlockId]
encodeList :: [BlockId] -&gt; Encoding
$cencodeList :: [BlockId] -&gt; Encoding
decode :: Decoder s BlockId
$cdecode :: forall s. Decoder s BlockId
encode :: BlockId -&gt; Encoding
$cencode :: BlockId -&gt; Encoding
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">CBOR.Serialise</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679329535"><span id="local-6989586621679329537"><span class="annot"><span class="annottext">[BlockId] -&gt; Doc ann
BlockId -&gt; Doc ann
(forall ann. BlockId -&gt; Doc ann)
-&gt; (forall ann. [BlockId] -&gt; Doc ann) -&gt; Pretty BlockId
forall ann. [BlockId] -&gt; Doc ann
forall ann. BlockId -&gt; Doc ann
forall a.
(forall ann. a -&gt; Doc ann)
-&gt; (forall ann. [a] -&gt; Doc ann) -&gt; Pretty a
prettyList :: [BlockId] -&gt; Doc ann
$cprettyList :: forall ann. [BlockId] -&gt; Doc ann
pretty :: BlockId -&gt; Doc ann
$cpretty :: forall ann. BlockId -&gt; Doc ann
</span><a href="#local-6989586621679329535"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Pretty</span></a></span></span></span><span> </span><span class="hs-keyword">via</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PrettyShow</span></span><span> </span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679329530"><span id="local-6989586621679329533"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-228"></span><span>    </span><span id="local-6989586621679329529"><span class="annot"><span class="annottext">show :: BlockId -&gt; String
</span><a href="#local-6989586621679329529"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">Text.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; String) -&gt; (BlockId -&gt; Text) -&gt; BlockId -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">JSON.encodeByteString</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; (BlockId -&gt; ByteString) -&gt; BlockId -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ShortByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.fromShort</span></span><span> </span><span class="annot"><span class="annottext">(ShortByteString -&gt; ByteString)
-&gt; (BlockId -&gt; ShortByteString) -&gt; BlockId -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">BlockId -&gt; ShortByteString
</span><a href="Cardano.Node.Socket.Emulator.Types.html#getBlockId"><span class="hs-identifier hs-var hs-var">getBlockId</span></a></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-comment">-- | A hash of the block's contents.</span><span>
</span><span id="line-231"></span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#blockId"><span class="hs-identifier hs-type">blockId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Block</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#BlockId"><span class="hs-identifier hs-type">BlockId</span></a></span><span>
</span><span id="line-232"></span><span id="blockId"><span class="annot"><span class="annottext">blockId :: Block -&gt; BlockId
</span><a href="Cardano.Node.Socket.Emulator.Types.html#blockId"><span class="hs-identifier hs-var hs-var">blockId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShortByteString -&gt; BlockId
</span><a href="Cardano.Node.Socket.Emulator.Types.html#BlockId"><span class="hs-identifier hs-var">BlockId</span></a></span><span>
</span><span id="line-233"></span><span>        </span><span class="annot"><span class="annottext">(ShortByteString -&gt; BlockId)
-&gt; (Block -&gt; ShortByteString) -&gt; Block -&gt; BlockId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ShortByteString
</span><span class="hs-identifier hs-var">BS.toShort</span></span><span>
</span><span id="line-234"></span><span>        </span><span class="annot"><span class="annottext">(ByteString -&gt; ShortByteString)
-&gt; (Block -&gt; ByteString) -&gt; Block -&gt; ShortByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Digest SHA256 -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">BA.convert</span></span><span>
</span><span id="line-235"></span><span>        </span><span class="annot"><span class="annottext">(Digest SHA256 -&gt; ByteString)
-&gt; (Block -&gt; Digest SHA256) -&gt; Block -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteArrayAccess ByteString, HashAlgorithm SHA256) =&gt;
ByteString -&gt; Digest SHA256
forall ba a.
(ByteArrayAccess ba, HashAlgorithm a) =&gt;
ba -&gt; Digest a
</span><span class="hs-identifier hs-var">hash</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">SHA256</span></span><span>
</span><span id="line-236"></span><span>        </span><span class="annot"><span class="annottext">(ByteString -&gt; Digest SHA256)
-&gt; (Block -&gt; ByteString) -&gt; Block -&gt; Digest SHA256
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BSL.toStrict</span></span><span>
</span><span id="line-237"></span><span>        </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (Block -&gt; ByteString) -&gt; Block -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Block -&gt; ByteString
forall a. Serialise a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">CBOR.serialise</span></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="hs-comment">-- | Protocol versions</span><span>
</span><span id="line-240"></span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#nodeToClientVersion"><span class="hs-identifier hs-type">nodeToClientVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NodeToClientVersion</span></span><span>
</span><span id="line-241"></span><span id="nodeToClientVersion"><span class="annot"><span class="annottext">nodeToClientVersion :: NodeToClientVersion
</span><a href="Cardano.Node.Socket.Emulator.Types.html#nodeToClientVersion"><span class="hs-identifier hs-var hs-var">nodeToClientVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeToClientVersion
</span><span class="hs-identifier hs-var">NodeToClientV_13</span></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-comment">-- | A temporary definition of the protocol version. This will be moved as an</span><span>
</span><span id="line-244"></span><span class="hs-comment">-- argument to the client connection function in a future PR (the network magic</span><span>
</span><span id="line-245"></span><span class="hs-comment">-- number matches the one in the test net created by scripts)</span><span>
</span><span id="line-246"></span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#nodeToClientVersionData"><span class="hs-identifier hs-type">nodeToClientVersionData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NodeToClientVersionData</span></span><span>
</span><span id="line-247"></span><span id="nodeToClientVersionData"><span class="annot"><span class="annottext">nodeToClientVersionData :: NodeToClientVersionData
</span><a href="Cardano.Node.Socket.Emulator.Types.html#nodeToClientVersionData"><span class="hs-identifier hs-var hs-var">nodeToClientVersionData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NodeToClientVersionData :: NetworkMagic -&gt; NodeToClientVersionData
</span><span class="hs-identifier hs-type">NodeToClientVersionData</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">networkMagic :: NetworkMagic
</span><span class="hs-identifier hs-var">networkMagic</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NetworkMagic
</span><span class="hs-identifier hs-var">testNetworkMagic</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="hs-comment">-- | A protocol client that will never leave the initial state.</span><span>
</span><span id="line-250"></span><span id="local-6989586621679329515"><span id="local-6989586621679329516"><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#doNothingInitiatorProtocol"><span class="hs-identifier hs-type">doNothingInitiatorProtocol</span></a></span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadTimer</span></span><span> </span><span class="annot"><a href="#local-6989586621679329516"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RunMiniProtocol</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">InitiatorMode</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BSL.ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679329516"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679329515"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Void</span></a></span></span></span><span>
</span><span id="line-252"></span><span id="doNothingInitiatorProtocol"><span class="annot"><span class="annottext">doNothingInitiatorProtocol :: RunMiniProtocol 'InitiatorMode ByteString m a Void
</span><a href="Cardano.Node.Socket.Emulator.Types.html#doNothingInitiatorProtocol"><span class="hs-identifier hs-var hs-var">doNothingInitiatorProtocol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-253"></span><span>    </span><span class="annot"><span class="annottext">MuxPeer ByteString m a
-&gt; RunMiniProtocol 'InitiatorMode ByteString m a Void
forall bytes (m :: * -&gt; *) a.
MuxPeer bytes m a -&gt; RunMiniProtocol 'InitiatorMode bytes m a Void
</span><span class="hs-identifier hs-var">InitiatorProtocolOnly</span></span><span> </span><span class="annot"><span class="annottext">(MuxPeer ByteString m a
 -&gt; RunMiniProtocol 'InitiatorMode ByteString m a Void)
-&gt; MuxPeer ByteString m a
-&gt; RunMiniProtocol 'InitiatorMode ByteString m a Void
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Channel m ByteString -&gt; m (a, Maybe ByteString))
-&gt; MuxPeer ByteString m a
forall (m :: * -&gt; *) bytes a.
(Channel m bytes -&gt; m (a, Maybe bytes)) -&gt; MuxPeer bytes m a
</span><span class="hs-identifier hs-var">MuxPeerRaw</span></span><span> </span><span class="annot"><span class="annottext">((Channel m ByteString -&gt; m (a, Maybe ByteString))
 -&gt; MuxPeer ByteString m a)
-&gt; (Channel m ByteString -&gt; m (a, Maybe ByteString))
-&gt; MuxPeer ByteString m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-254"></span><span>    </span><span class="annot"><span class="annottext">m (a, Maybe ByteString)
-&gt; Channel m ByteString -&gt; m (a, Maybe ByteString)
forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">(m (a, Maybe ByteString)
 -&gt; Channel m ByteString -&gt; m (a, Maybe ByteString))
-&gt; m (a, Maybe ByteString)
-&gt; Channel m ByteString
-&gt; m (a, Maybe ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">m () -&gt; m (a, Maybe ByteString)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">forever</span></a></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m (a, Maybe ByteString))
-&gt; m () -&gt; m (a, Maybe ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DiffTime -&gt; m ()
forall (m :: * -&gt; *). MonadDelay m =&gt; DiffTime -&gt; m ()
</span><span class="hs-identifier hs-var">threadDelay</span></span><span> </span><span class="annot"><span class="annottext">DiffTime
</span><span class="hs-number">1e6</span></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span id="local-6989586621679329509"><span id="local-6989586621679329510"><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#doNothingResponderProtocol"><span class="hs-identifier hs-type">doNothingResponderProtocol</span></a></span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadTimer</span></span><span> </span><span class="annot"><a href="#local-6989586621679329510"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RunMiniProtocol</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">ResponderMode</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BSL.ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679329510"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Void</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679329509"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-258"></span><span id="doNothingResponderProtocol"><span class="annot"><span class="annottext">doNothingResponderProtocol :: RunMiniProtocol 'ResponderMode ByteString m Void a
</span><a href="Cardano.Node.Socket.Emulator.Types.html#doNothingResponderProtocol"><span class="hs-identifier hs-var hs-var">doNothingResponderProtocol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-259"></span><span>  </span><span class="annot"><span class="annottext">MuxPeer ByteString m a
-&gt; RunMiniProtocol 'ResponderMode ByteString m Void a
forall bytes (m :: * -&gt; *) b.
MuxPeer bytes m b -&gt; RunMiniProtocol 'ResponderMode bytes m Void b
</span><span class="hs-identifier hs-var">ResponderProtocolOnly</span></span><span> </span><span class="annot"><span class="annottext">(MuxPeer ByteString m a
 -&gt; RunMiniProtocol 'ResponderMode ByteString m Void a)
-&gt; MuxPeer ByteString m a
-&gt; RunMiniProtocol 'ResponderMode ByteString m Void a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Channel m ByteString -&gt; m (a, Maybe ByteString))
-&gt; MuxPeer ByteString m a
forall (m :: * -&gt; *) bytes a.
(Channel m bytes -&gt; m (a, Maybe bytes)) -&gt; MuxPeer bytes m a
</span><span class="hs-identifier hs-var">MuxPeerRaw</span></span><span> </span><span class="annot"><span class="annottext">((Channel m ByteString -&gt; m (a, Maybe ByteString))
 -&gt; MuxPeer ByteString m a)
-&gt; (Channel m ByteString -&gt; m (a, Maybe ByteString))
-&gt; MuxPeer ByteString m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-260"></span><span>  </span><span class="annot"><span class="annottext">m (a, Maybe ByteString)
-&gt; Channel m ByteString -&gt; m (a, Maybe ByteString)
forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">(m (a, Maybe ByteString)
 -&gt; Channel m ByteString -&gt; m (a, Maybe ByteString))
-&gt; m (a, Maybe ByteString)
-&gt; Channel m ByteString
-&gt; m (a, Maybe ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">m () -&gt; m (a, Maybe ByteString)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">forever</span></a></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m (a, Maybe ByteString))
-&gt; m () -&gt; m (a, Maybe ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DiffTime -&gt; m ()
forall (m :: * -&gt; *). MonadDelay m =&gt; DiffTime -&gt; m ()
</span><span class="hs-identifier hs-var">threadDelay</span></span><span> </span><span class="annot"><span class="annottext">DiffTime
</span><span class="hs-number">1e6</span></span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-comment">-- | Boilerplate codecs used for protocol serialisation.</span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-comment">-- | The number of epochSlots is specific to each blockchain instance. This value</span><span>
</span><span id="line-265"></span><span class="hs-comment">-- is what the cardano main and testnet uses. Only applies to the Byron era.</span><span>
</span><span id="line-266"></span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#epochSlots"><span class="hs-identifier hs-type">epochSlots</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EpochSlots</span></span><span>
</span><span id="line-267"></span><span id="epochSlots"><span class="annot"><span class="annottext">epochSlots :: EpochSlots
</span><a href="Cardano.Node.Socket.Emulator.Types.html#epochSlots"><span class="hs-identifier hs-var hs-var">epochSlots</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; EpochSlots
</span><span class="hs-identifier hs-var">EpochSlots</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">21600</span></span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#codecVersion"><span class="hs-identifier hs-type">codecVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BlockNodeToClientVersion</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CardanoBlock</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span id="codecVersion"><span class="annot"><span class="annottext">codecVersion :: BlockNodeToClientVersion (CardanoBlock StandardCrypto)
</span><a href="Cardano.Node.Socket.Emulator.Types.html#codecVersion"><span class="hs-identifier hs-var hs-var">codecVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map
  NodeToClientVersion
  (HardForkNodeToClientVersion
     (ByronBlock : CardanoShelleyEras StandardCrypto))
</span><a href="#local-6989586621679329503"><span class="hs-identifier hs-var">versionMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map
  NodeToClientVersion
  (HardForkNodeToClientVersion
     (ByronBlock : CardanoShelleyEras StandardCrypto))
-&gt; NodeToClientVersion
-&gt; HardForkNodeToClientVersion
     (ByronBlock : CardanoShelleyEras StandardCrypto)
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">Map.!</span></span><span> </span><span class="annot"><span class="annottext">NodeToClientVersion
</span><a href="Cardano.Node.Socket.Emulator.Types.html#nodeToClientVersion"><span class="hs-identifier hs-var">nodeToClientVersion</span></a></span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-272"></span><span>    </span><span id="local-6989586621679329503"><span class="annot"><span class="annottext">versionMap :: Map
  NodeToClientVersion
  (BlockNodeToClientVersion (CardanoBlock StandardCrypto))
</span><a href="#local-6989586621679329503"><span class="hs-identifier hs-var hs-var">versionMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-273"></span><span>      </span><span class="annot"><span class="annottext">Proxy (CardanoBlock StandardCrypto)
-&gt; Map
     NodeToClientVersion
     (BlockNodeToClientVersion (CardanoBlock StandardCrypto))
forall blk.
SupportedNetworkProtocolVersion blk =&gt;
Proxy blk -&gt; Map NodeToClientVersion (BlockNodeToClientVersion blk)
</span><span class="hs-identifier hs-var">supportedNodeToClientVersions</span></span><span>
</span><span id="line-274"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (CardanoBlock StandardCrypto)
forall k (t :: k). Proxy t
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CardanoBlock</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#codecConfig"><span class="hs-identifier hs-type">codecConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodecConfig</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CardanoBlock</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span id="codecConfig"><span class="annot"><span class="annottext">codecConfig :: CodecConfig (CardanoBlock StandardCrypto)
</span><a href="Cardano.Node.Socket.Emulator.Types.html#codecConfig"><span class="hs-identifier hs-var hs-var">codecConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-278"></span><span>  </span><span class="annot"><span class="annottext">CodecConfig ByronBlock
-&gt; CodecConfig
     (ShelleyBlock (TPraos StandardCrypto) (ShelleyEra StandardCrypto))
-&gt; CodecConfig
     (ShelleyBlock (TPraos StandardCrypto) (AllegraEra StandardCrypto))
-&gt; CodecConfig
     (ShelleyBlock (TPraos StandardCrypto) (MaryEra StandardCrypto))
-&gt; CodecConfig
     (ShelleyBlock (TPraos StandardCrypto) (AlonzoEra StandardCrypto))
-&gt; CodecConfig
     (ShelleyBlock (Praos StandardCrypto) (BabbageEra StandardCrypto))
-&gt; CodecConfig (CardanoBlock StandardCrypto)
forall c.
CodecConfig ByronBlock
-&gt; CodecConfig (ShelleyBlock (TPraos c) (ShelleyEra c))
-&gt; CodecConfig (ShelleyBlock (TPraos c) (AllegraEra c))
-&gt; CodecConfig (ShelleyBlock (TPraos c) (MaryEra c))
-&gt; CodecConfig (ShelleyBlock (TPraos c) (AlonzoEra c))
-&gt; CodecConfig (ShelleyBlock (Praos c) (BabbageEra c))
-&gt; CardanoCodecConfig c
</span><span class="hs-identifier hs-var">CardanoCodecConfig</span></span><span>
</span><span id="line-279"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EpochSlots -&gt; CodecConfig ByronBlock
</span><span class="hs-identifier hs-var">Byron.ByronCodecConfig</span></span><span> </span><span class="annot"><span class="annottext">EpochSlots
</span><a href="Cardano.Node.Socket.Emulator.Types.html#epochSlots"><span class="hs-identifier hs-var">epochSlots</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>    </span><span class="annot"><span class="annottext">CodecConfig
  (ShelleyBlock (TPraos StandardCrypto) (ShelleyEra StandardCrypto))
forall proto era. CodecConfig (ShelleyBlock proto era)
</span><span class="hs-identifier hs-var">Shelley.ShelleyCodecConfig</span></span><span>
</span><span id="line-281"></span><span>    </span><span class="annot"><span class="annottext">CodecConfig
  (ShelleyBlock (TPraos StandardCrypto) (AllegraEra StandardCrypto))
forall proto era. CodecConfig (ShelleyBlock proto era)
</span><span class="hs-identifier hs-var">Shelley.ShelleyCodecConfig</span></span><span>
</span><span id="line-282"></span><span>    </span><span class="annot"><span class="annottext">CodecConfig
  (ShelleyBlock (TPraos StandardCrypto) (MaryEra StandardCrypto))
forall proto era. CodecConfig (ShelleyBlock proto era)
</span><span class="hs-identifier hs-var">Shelley.ShelleyCodecConfig</span></span><span>
</span><span id="line-283"></span><span>    </span><span class="annot"><span class="annottext">CodecConfig
  (ShelleyBlock (TPraos StandardCrypto) (AlonzoEra StandardCrypto))
forall proto era. CodecConfig (ShelleyBlock proto era)
</span><span class="hs-identifier hs-var">Shelley.ShelleyCodecConfig</span></span><span>
</span><span id="line-284"></span><span>    </span><span class="annot"><span class="annottext">CodecConfig
  (ShelleyBlock (Praos StandardCrypto) (BabbageEra StandardCrypto))
forall proto era. CodecConfig (ShelleyBlock proto era)
</span><span class="hs-identifier hs-var">Shelley.ShelleyCodecConfig</span></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#nodeToClientCodecs"><span class="hs-identifier hs-type">nodeToClientCodecs</span></a></span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679329806"><span class="annot"><a href="#local-6989586621679329806"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadST</span></span><span> </span><span class="annot"><a href="#local-6989586621679329806"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-288"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ClientCodecs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CardanoBlock</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679329806"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-289"></span><span id="nodeToClientCodecs"><span class="annot"><span class="annottext">nodeToClientCodecs :: ClientCodecs (CardanoBlock StandardCrypto) m
</span><a href="Cardano.Node.Socket.Emulator.Types.html#nodeToClientCodecs"><span class="hs-identifier hs-var hs-var">nodeToClientCodecs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-290"></span><span>  </span><span class="annot"><span class="annottext">CodecConfig (CardanoBlock StandardCrypto)
-&gt; BlockNodeToClientVersion (CardanoBlock StandardCrypto)
-&gt; NodeToClientVersion
-&gt; ClientCodecs (CardanoBlock StandardCrypto) m
forall (m :: * -&gt; *) blk.
(MonadST m, SerialiseNodeToClientConstraints blk,
 ShowQuery (BlockQuery blk), StandardHash blk,
 Serialise (HeaderHash blk)) =&gt;
CodecConfig blk
-&gt; BlockNodeToClientVersion blk
-&gt; NodeToClientVersion
-&gt; ClientCodecs blk m
</span><span class="hs-identifier hs-var">clientCodecs</span></span><span> </span><span class="annot"><span class="annottext">CodecConfig (CardanoBlock StandardCrypto)
</span><a href="Cardano.Node.Socket.Emulator.Types.html#codecConfig"><span class="hs-identifier hs-var">codecConfig</span></a></span><span> </span><span class="annot"><span class="annottext">BlockNodeToClientVersion (CardanoBlock StandardCrypto)
</span><a href="Cardano.Node.Socket.Emulator.Types.html#codecVersion"><span class="hs-identifier hs-var">codecVersion</span></a></span><span> </span><span class="annot"><span class="annottext">NodeToClientVersion
</span><a href="Cardano.Node.Socket.Emulator.Types.html#nodeToClientVersion"><span class="hs-identifier hs-var">nodeToClientVersion</span></a></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="hs-comment">-- | These codecs are currently used in the mock nodes and will</span><span>
</span><span id="line-293"></span><span class="hs-comment">--   probably soon get removed as the mock nodes are phased out.</span><span>
</span><span id="line-294"></span><span id="local-6989586621679329495"><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#chainSyncCodec"><span class="hs-identifier hs-type">chainSyncCodec</span></a></span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679329495"><span class="hs-identifier hs-type">block</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoBlock</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Codec</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ChainSync.ChainSync</span></span><span> </span><span class="annot"><a href="#local-6989586621679329495"><span class="hs-identifier hs-type">block</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><a href="#local-6989586621679329495"><span class="hs-identifier hs-type">block</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#Tip"><span class="hs-identifier hs-type">Tip</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">DeserialiseFailure</span></span><span>
</span><span id="line-298"></span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BSL.ByteString</span></span></span><span>
</span><span id="line-299"></span><span id="chainSyncCodec"><span class="annot"><span class="annottext">chainSyncCodec :: Codec
  (ChainSync block (Point block) Tip)
  DeserialiseFailure
  IO
  ByteString
</span><a href="Cardano.Node.Socket.Emulator.Types.html#chainSyncCodec"><span class="hs-identifier hs-var hs-var">chainSyncCodec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Codecs'
  (CardanoBlock StandardCrypto)
  (CardanoBlock StandardCrypto)
  DeserialiseFailure
  IO
  ByteString
  ByteString
  ByteString
  ByteString
-&gt; Codec
     (ChainSync
        (CardanoBlock StandardCrypto)
        (Point (CardanoBlock StandardCrypto))
        Tip)
     DeserialiseFailure
     IO
     ByteString
forall blk serialisedBlk e (m :: * -&gt; *) bCS bTX bSQ bTM.
Codecs' blk serialisedBlk e m bCS bTX bSQ bTM
-&gt; Codec (ChainSync serialisedBlk (Point blk) (Tip blk)) e m bCS
</span><span class="hs-identifier hs-var hs-var">cChainSyncCodec</span></span><span> </span><span class="annot"><span class="annottext">Codecs'
  (CardanoBlock StandardCrypto)
  (CardanoBlock StandardCrypto)
  DeserialiseFailure
  IO
  ByteString
  ByteString
  ByteString
  ByteString
forall (m :: * -&gt; *).
MonadST m =&gt;
ClientCodecs (CardanoBlock StandardCrypto) m
</span><a href="Cardano.Node.Socket.Emulator.Types.html#nodeToClientCodecs"><span class="hs-identifier hs-var">nodeToClientCodecs</span></a></span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span id="local-6989586621679329493"><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#txSubmissionCodec"><span class="hs-identifier hs-type">txSubmissionCodec</span></a></span><span>
</span><span id="line-302"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679329493"><span class="hs-identifier hs-type">block</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoBlock</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Codec</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxSubmission.LocalTxSubmission</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Shelley.GenTx</span></span><span> </span><span class="annot"><a href="#local-6989586621679329493"><span class="hs-identifier hs-type">block</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ApplyTxErr</span></span><span> </span><span class="annot"><a href="#local-6989586621679329493"><span class="hs-identifier hs-type">block</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">DeserialiseFailure</span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BSL.ByteString</span></span></span><span>
</span><span id="line-305"></span><span id="txSubmissionCodec"><span class="annot"><span class="annottext">txSubmissionCodec :: Codec
  (LocalTxSubmission (GenTx block) (ApplyTxErr block))
  DeserialiseFailure
  IO
  ByteString
</span><a href="Cardano.Node.Socket.Emulator.Types.html#txSubmissionCodec"><span class="hs-identifier hs-var hs-var">txSubmissionCodec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Codecs'
  (CardanoBlock StandardCrypto)
  (CardanoBlock StandardCrypto)
  DeserialiseFailure
  IO
  ByteString
  ByteString
  ByteString
  ByteString
-&gt; Codec
     (LocalTxSubmission
        (GenTx (CardanoBlock StandardCrypto))
        (ApplyTxErr (CardanoBlock StandardCrypto)))
     DeserialiseFailure
     IO
     ByteString
forall blk serialisedBlk e (m :: * -&gt; *) bCS bTX bSQ bTM.
Codecs' blk serialisedBlk e m bCS bTX bSQ bTM
-&gt; Codec (LocalTxSubmission (GenTx blk) (ApplyTxErr blk)) e m bTX
</span><span class="hs-identifier hs-var hs-var">cTxSubmissionCodec</span></span><span> </span><span class="annot"><span class="annottext">Codecs'
  (CardanoBlock StandardCrypto)
  (CardanoBlock StandardCrypto)
  DeserialiseFailure
  IO
  ByteString
  ByteString
  ByteString
  ByteString
forall (m :: * -&gt; *).
MonadST m =&gt;
ClientCodecs (CardanoBlock StandardCrypto) m
</span><a href="Cardano.Node.Socket.Emulator.Types.html#nodeToClientCodecs"><span class="hs-identifier hs-var">nodeToClientCodecs</span></a></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#toCardanoBlock"><span class="hs-identifier hs-type">toCardanoBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Praos.Header</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Block</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoBlock</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span>
</span><span id="line-308"></span><span id="toCardanoBlock"><span class="annot"><span class="annottext">toCardanoBlock :: Header StandardCrypto -&gt; Block -&gt; CardanoBlock StandardCrypto
</span><a href="Cardano.Node.Socket.Emulator.Types.html#toCardanoBlock"><span class="hs-identifier hs-var hs-var">toCardanoBlock</span></a></span></span><span> </span><span id="local-6989586621679329490"><span class="annot"><span class="annottext">Header StandardCrypto
</span><a href="#local-6989586621679329490"><span class="hs-identifier hs-var">header</span></a></span></span><span> </span><span id="local-6989586621679329489"><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679329489"><span class="hs-identifier hs-var">block</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShelleyBlock (Praos StandardCrypto) (BabbageEra StandardCrypto)
-&gt; CardanoBlock StandardCrypto
forall c. ShelleyBlock (Praos c) (BabbageEra c) -&gt; CardanoBlock c
</span><span class="hs-identifier hs-var">OC.BlockBabbage</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Block
  (ShelleyProtocolHeader (Praos StandardCrypto))
  (BabbageEra StandardCrypto)
-&gt; ShelleyBlock (Praos StandardCrypto) (BabbageEra StandardCrypto)
forall proto era.
ShelleyCompatible proto era =&gt;
Block (ShelleyProtocolHeader proto) era -&gt; ShelleyBlock proto era
</span><span class="hs-identifier hs-var">Shelley.mkShelleyBlock</span></span><span> </span><span class="annot"><span class="annottext">(Block
   (ShelleyProtocolHeader (Praos StandardCrypto))
   (BabbageEra StandardCrypto)
 -&gt; ShelleyBlock (Praos StandardCrypto) (BabbageEra StandardCrypto))
-&gt; Block
     (ShelleyProtocolHeader (Praos StandardCrypto))
     (BabbageEra StandardCrypto)
-&gt; ShelleyBlock (Praos StandardCrypto) (BabbageEra StandardCrypto)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Header StandardCrypto
-&gt; TxSeq (BabbageEra StandardCrypto)
-&gt; Block (Header StandardCrypto) (BabbageEra StandardCrypto)
forall era h.
(Era era, ToCBORGroup (TxSeq era), ToCBOR h) =&gt;
h -&gt; TxSeq era -&gt; Block h era
</span><span class="hs-identifier hs-var">CL.Block</span></span><span> </span><span class="annot"><span class="annottext">Header StandardCrypto
</span><a href="#local-6989586621679329490"><span class="hs-identifier hs-var">header</span></a></span><span> </span><span class="annot"><span class="annottext">(TxSeq (BabbageEra StandardCrypto)
 -&gt; Block (Header StandardCrypto) (BabbageEra StandardCrypto))
-&gt; TxSeq (BabbageEra StandardCrypto)
-&gt; Block (Header StandardCrypto) (BabbageEra StandardCrypto)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">StrictSeq (Tx (BabbageEra StandardCrypto))
-&gt; TxSeq (BabbageEra StandardCrypto)
forall era. SupportsSegWit era =&gt; StrictSeq (Tx era) -&gt; TxSeq era
</span><span class="hs-identifier hs-var">CL.toTxSeq</span></span><span> </span><span class="annot"><span class="annottext">(StrictSeq (Tx (BabbageEra StandardCrypto))
 -&gt; TxSeq (BabbageEra StandardCrypto))
-&gt; StrictSeq (Tx (BabbageEra StandardCrypto))
-&gt; TxSeq (BabbageEra StandardCrypto)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[ValidatedTx (BabbageEra StandardCrypto)]
-&gt; StrictSeq (ValidatedTx (BabbageEra StandardCrypto))
forall a. [a] -&gt; StrictSeq a
</span><span class="hs-identifier hs-var">fromList</span></span><span> </span><span class="annot"><span class="annottext">([ValidatedTx (BabbageEra StandardCrypto)]
 -&gt; StrictSeq (ValidatedTx (BabbageEra StandardCrypto)))
-&gt; [ValidatedTx (BabbageEra StandardCrypto)]
-&gt; StrictSeq (ValidatedTx (BabbageEra StandardCrypto))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Validated (ValidatedTx (BabbageEra StandardCrypto))
-&gt; ValidatedTx (BabbageEra StandardCrypto)
forall tx. Validated tx -&gt; tx
</span><span class="hs-identifier hs-var">extractTx</span></span><span> </span><span class="annot"><span class="annottext">(Validated (ValidatedTx (BabbageEra StandardCrypto))
 -&gt; ValidatedTx (BabbageEra StandardCrypto))
-&gt; (OnChainTx
    -&gt; Validated (ValidatedTx (BabbageEra StandardCrypto)))
-&gt; OnChainTx
-&gt; ValidatedTx (BabbageEra StandardCrypto)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">OnChainTx -&gt; Validated (ValidatedTx (BabbageEra StandardCrypto))
OnChainTx -&gt; Validated (Tx (BabbageEra StandardCrypto))
</span><span class="hs-identifier hs-var hs-var">getOnChainTx</span></span><span> </span><span class="annot"><span class="annottext">(OnChainTx -&gt; ValidatedTx (BabbageEra StandardCrypto))
-&gt; Block -&gt; [ValidatedTx (BabbageEra StandardCrypto)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679329489"><span class="hs-identifier hs-var">block</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#fromCardanoBlock"><span class="hs-identifier hs-type">fromCardanoBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoBlock</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StandardCrypto</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Block</span></span><span>
</span><span id="line-311"></span><span id="fromCardanoBlock"><span class="annot"><span class="annottext">fromCardanoBlock :: CardanoBlock StandardCrypto -&gt; Block
</span><a href="Cardano.Node.Socket.Emulator.Types.html#fromCardanoBlock"><span class="hs-identifier hs-var hs-var">fromCardanoBlock</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OC.BlockBabbage</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Shelley.ShelleyBlock</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CL.Block</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679329480"><span class="annot"><a href="#local-6989586621679329480"><span class="hs-identifier hs-var">txSeq</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShelleyHash (ProtoCrypto (Praos StandardCrypto))
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ValidatedTx (BabbageEra StandardCrypto) -&gt; OnChainTx)
-&gt; [ValidatedTx (BabbageEra StandardCrypto)] -&gt; Block
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Validated (ValidatedTx (BabbageEra StandardCrypto)) -&gt; OnChainTx
Validated (Tx (BabbageEra StandardCrypto)) -&gt; OnChainTx
</span><span class="hs-identifier hs-var">OnChainTx</span></span><span> </span><span class="annot"><span class="annottext">(Validated (ValidatedTx (BabbageEra StandardCrypto)) -&gt; OnChainTx)
-&gt; (ValidatedTx (BabbageEra StandardCrypto)
    -&gt; Validated (ValidatedTx (BabbageEra StandardCrypto)))
-&gt; ValidatedTx (BabbageEra StandardCrypto)
-&gt; OnChainTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ValidatedTx (BabbageEra StandardCrypto)
-&gt; Validated (ValidatedTx (BabbageEra StandardCrypto))
forall tx. tx -&gt; Validated tx
</span><span class="hs-identifier hs-var">unsafeMakeValidated</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ValidatedTx (BabbageEra StandardCrypto)] -&gt; Block)
-&gt; (StrictSeq (ValidatedTx (BabbageEra StandardCrypto))
    -&gt; [ValidatedTx (BabbageEra StandardCrypto)])
-&gt; StrictSeq (ValidatedTx (BabbageEra StandardCrypto))
-&gt; Block
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">StrictSeq (ValidatedTx (BabbageEra StandardCrypto))
-&gt; [ValidatedTx (BabbageEra StandardCrypto)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">(StrictSeq (ValidatedTx (BabbageEra StandardCrypto)) -&gt; Block)
-&gt; StrictSeq (ValidatedTx (BabbageEra StandardCrypto)) -&gt; Block
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxSeq (BabbageEra StandardCrypto)
-&gt; StrictSeq (Tx (BabbageEra StandardCrypto))
forall era. SupportsSegWit era =&gt; TxSeq era -&gt; StrictSeq (Tx era)
</span><span class="hs-identifier hs-var">CL.fromTxSeq</span></span><span> </span><span class="annot"><span class="annottext">TxSeq (BabbageEra StandardCrypto)
</span><a href="#local-6989586621679329480"><span class="hs-identifier hs-var">txSeq</span></a></span><span>
</span><span id="line-312"></span><span class="annot"><a href="Cardano.Node.Socket.Emulator.Types.html#fromCardanoBlock"><span class="hs-identifier hs-var">fromCardanoBlock</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoBlock StandardCrypto
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-313"></span></pre></body></html>