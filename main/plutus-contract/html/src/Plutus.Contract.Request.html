<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes   #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds       #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DataKinds             #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass        #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric         #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies    #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts      #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances     #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE GADTs                 #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns        #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings     #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes            #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables   #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications      #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies          #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators         #-}</span><span>
</span><span id="line-18"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Plutus.Contract.Request</span><span class="hs-special">(</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><span class="hs-comment">-- * PAB requests</span></span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Waiting</span></span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Plutus.Contract.Request.html#awaitSlot"><span class="hs-identifier">awaitSlot</span></a></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#isSlot"><span class="hs-identifier">isSlot</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#currentSlot"><span class="hs-identifier">currentSlot</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#currentPABSlot"><span class="hs-identifier">currentPABSlot</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#currentNodeClientSlot"><span class="hs-identifier">currentNodeClientSlot</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#currentChainIndexSlot"><span class="hs-identifier">currentChainIndexSlot</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#waitNSlots"><span class="hs-identifier">waitNSlots</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#awaitTime"><span class="hs-identifier">awaitTime</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#isTime"><span class="hs-identifier">isTime</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#currentTime"><span class="hs-identifier">currentTime</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#currentNodeClientTimeRange"><span class="hs-identifier">currentNodeClientTimeRange</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#waitNMilliSeconds"><span class="hs-identifier">waitNMilliSeconds</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Chain index queries</span></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#datumFromHash"><span class="hs-identifier">datumFromHash</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#datumsAt"><span class="hs-identifier">datumsAt</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#validatorFromHash"><span class="hs-identifier">validatorFromHash</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#mintingPolicyFromHash"><span class="hs-identifier">mintingPolicyFromHash</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#stakeValidatorFromHash"><span class="hs-identifier">stakeValidatorFromHash</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#redeemerFromHash"><span class="hs-identifier">redeemerFromHash</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#txOutFromRef"><span class="hs-identifier">txOutFromRef</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#txFromTxId"><span class="hs-identifier">txFromTxId</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#findReferenceValidatorScripByHash"><span class="hs-identifier">findReferenceValidatorScripByHash</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#unspentTxOutFromRef"><span class="hs-identifier">unspentTxOutFromRef</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#utxoRefMembership"><span class="hs-identifier">utxoRefMembership</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#utxoRefsAt"><span class="hs-identifier">utxoRefsAt</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#utxoRefsWithCurrency"><span class="hs-identifier">utxoRefsWithCurrency</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#utxosAt"><span class="hs-identifier">utxosAt</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#utxosTxOutTxFromTx"><span class="hs-identifier">utxosTxOutTxFromTx</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#utxosTxOutTxAt"><span class="hs-identifier">utxosTxOutTxAt</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#txsFromTxIds"><span class="hs-identifier">txsFromTxIds</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#txoRefsAt"><span class="hs-identifier">txoRefsAt</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#txsAt"><span class="hs-identifier">txsAt</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#getTip"><span class="hs-identifier">getTip</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">collectQueryResponse</span></span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Waiting for changes to the UTXO set</span></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#fundsAtAddressGt"><span class="hs-identifier">fundsAtAddressGt</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#fundsAtAddressGeq"><span class="hs-identifier">fundsAtAddressGeq</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#fundsAtAddressCondition"><span class="hs-identifier">fundsAtAddressCondition</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#watchAddressUntilSlot"><span class="hs-identifier">watchAddressUntilSlot</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#watchAddressUntilTime"><span class="hs-identifier">watchAddressUntilTime</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#awaitUtxoSpent"><span class="hs-identifier">awaitUtxoSpent</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#utxoIsSpent"><span class="hs-identifier">utxoIsSpent</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#awaitUtxoProduced"><span class="hs-identifier">awaitUtxoProduced</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#utxoIsProduced"><span class="hs-identifier">utxoIsProduced</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Tx and tx output confirmation</span></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">RollbackState</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxStatus</span></span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#awaitTxStatusChange"><span class="hs-identifier">awaitTxStatusChange</span></a></span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#awaitTxConfirmed"><span class="hs-identifier">awaitTxConfirmed</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#isTxConfirmed"><span class="hs-identifier">isTxConfirmed</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxOutStatus</span></span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#awaitTxOutStatusChange"><span class="hs-identifier">awaitTxOutStatusChange</span></a></span><span>
</span><span id="line-73"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Contract instances</span></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#ownInstanceId"><span class="hs-identifier">ownInstanceId</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Exposing endpoints</span></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#HasEndpoint"><span class="hs-identifier">HasEndpoint</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Wallet.Types.html#EndpointDescription"><span class="hs-identifier">EndpointDescription</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#Endpoint"><span class="hs-identifier">Endpoint</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#endpoint"><span class="hs-identifier">endpoint</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#handleEndpoint"><span class="hs-identifier">handleEndpoint</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#endpointWithMeta"><span class="hs-identifier">endpointWithMeta</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#endpointDescription"><span class="hs-identifier">endpointDescription</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#endpointReq"><span class="hs-identifier">endpointReq</span></a></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#endpointResp"><span class="hs-identifier">endpointResp</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Wallet information</span></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#ownPaymentPubKeyHash"><span class="hs-identifier">ownPaymentPubKeyHash</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#ownPaymentPubKeyHashes"><span class="hs-identifier">ownPaymentPubKeyHashes</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#ownFirstPaymentPubKeyHash"><span class="hs-identifier">ownFirstPaymentPubKeyHash</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#ownAddresses"><span class="hs-identifier">ownAddresses</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#ownAddress"><span class="hs-identifier">ownAddress</span></a></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#ownUtxos"><span class="hs-identifier">ownUtxos</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#getUnspentOutput"><span class="hs-identifier">getUnspentOutput</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Submitting transactions</span></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#adjustUnbalancedTx"><span class="hs-identifier">adjustUnbalancedTx</span></a></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#submitUnbalancedTx"><span class="hs-identifier">submitUnbalancedTx</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#submitBalancedTx"><span class="hs-identifier">submitBalancedTx</span></a></span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#balanceTx"><span class="hs-identifier">balanceTx</span></a></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#submitTx"><span class="hs-identifier">submitTx</span></a></span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#submitTxConstraints"><span class="hs-identifier">submitTxConstraints</span></a></span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#submitTxConstraintsSpending"><span class="hs-identifier">submitTxConstraintsSpending</span></a></span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#submitTxConstraintsWith"><span class="hs-identifier">submitTxConstraintsWith</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#submitTxConfirmed"><span class="hs-identifier">submitTxConfirmed</span></a></span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#mkTxConstraints"><span class="hs-identifier">mkTxConstraints</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#yieldUnbalancedTx"><span class="hs-identifier">yieldUnbalancedTx</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Parameters</span></span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#getParams"><span class="hs-identifier">getParams</span></a></span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Etc.</span></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#ContractRow"><span class="hs-identifier">ContractRow</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier">pabReq</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#MkTxLog"><span class="hs-identifier">MkTxLog</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Api</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-114"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Node.Emulator.Internal.Node.Params</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Params</span></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Prism'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_Just</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">only</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">preview</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">review</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">to</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">view</span></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Freer.Error</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">E</span></span><span>
</span><span id="line-117"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.State.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">StateT</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">evalStateT</span></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">FromJSON</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ToJSON</span></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">JSON</span></span><span>
</span><span id="line-120"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson.Types</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">JSON</span></span><span>
</span><span id="line-121"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Bifunctor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Bifunctor</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Default</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Default</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">def</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">fold</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">find</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">NonEmpty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span>
</span><span id="line-127"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-129"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">catMaybes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">isJust</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">mapMaybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Proxy</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Row</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">AllUniqueLabels</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">HasType</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">KnownSymbol</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">type</span><span> </span><span class="annot"><span class="hs-operator">(.==)</span></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-133"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Text.Extras.html"><span class="hs-identifier">Data.Text.Extras</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Text.Extras.html#tshow"><span class="hs-identifier">tshow</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Void</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Void</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Natural</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Natural</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.TypeLits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier">Symbol</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">symbolVal</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CardanoAddress</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">DiffMilliSeconds</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">POSIXTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PaymentPubKeyHash</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PaymentPubKeyHash</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Slot</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxOutRef</span></span><span class="hs-special">,</span><span>
</span><span id="line-139"></span><span>               </span><span class="annot"><span class="hs-identifier">ValidatorHash</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ValidatorHash</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">cardanoPubKeyHash</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">decoratedTxOutReferenceScript</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromMilliSeconds</span></span><span class="hs-special">,</span><span>
</span><span id="line-140"></span><span>               </span><span class="annot"><span class="hs-identifier">getScriptHash</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">scriptHash</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">txOutRefId</span></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Tx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CardanoTx</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">DecoratedTxOut</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Versioned</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">decoratedTxOutValue</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getCardanoTxId</span></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Tx.CardanoAPI</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toCardanoTxIn</span></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Tx.Constraints</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">TxConstraints</span></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Tx.Constraints.OffChain</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ScriptLookups</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">UnbalancedTx</span></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Tx.Constraints.OffChain</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Constraints</span></span><span>
</span><span id="line-146"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Typed.Scripts</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Any</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TypedValidator</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ValidatorTypes</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">DatumType</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">RedeemerType</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Value.CardanoAPI</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">valueGeq</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">valueLeq</span></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.ChainIndex</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ChainIndexTx</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Page</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">nextPageQuery</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">pageItems</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PageQuery</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">txOutRefs</span></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.ChainIndex.Api</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IsUtxoResponse</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">QueryResponse</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxosResponse</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">UtxosResponse</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">collectQueryResponse</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">paget</span></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.ChainIndex.Types</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">RollbackState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Unknown</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Tip</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxOutStatus</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxStatus</span></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html"><span class="hs-identifier">Plutus.Contract.Effects</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Effects.html#ActiveEndpoint"><span class="hs-identifier">ActiveEndpoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Effects.html#ActiveEndpoint"><span class="hs-identifier">ActiveEndpoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#aeDescription"><span class="hs-identifier">aeDescription</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#aeMetadata"><span class="hs-identifier">aeMetadata</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-152"></span><span>                                </span><span class="annot"><a href="Plutus.Contract.Effects.html#PABReq"><span class="hs-identifier">PABReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Effects.html#AdjustUnbalancedTxReq"><span class="hs-identifier">AdjustUnbalancedTxReq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#AwaitSlotReq"><span class="hs-identifier">AwaitSlotReq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#AwaitTimeReq"><span class="hs-identifier">AwaitTimeReq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#AwaitTxOutStatusChangeReq"><span class="hs-identifier">AwaitTxOutStatusChangeReq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#AwaitTxStatusChangeReq"><span class="hs-identifier">AwaitTxStatusChangeReq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#AwaitUtxoProducedReq"><span class="hs-identifier">AwaitUtxoProducedReq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#AwaitUtxoSpentReq"><span class="hs-identifier">AwaitUtxoSpentReq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#BalanceTxReq"><span class="hs-identifier">BalanceTxReq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#ChainIndexQueryReq"><span class="hs-identifier">ChainIndexQueryReq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#CurrentChainIndexSlotReq"><span class="hs-identifier">CurrentChainIndexSlotReq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#CurrentNodeClientSlotReq"><span class="hs-identifier">CurrentNodeClientSlotReq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#CurrentNodeClientTimeRangeReq"><span class="hs-identifier">CurrentNodeClientTimeRangeReq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#CurrentTimeReq"><span class="hs-identifier">CurrentTimeReq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#ExposeEndpointReq"><span class="hs-identifier">ExposeEndpointReq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#GetParamsReq"><span class="hs-identifier">GetParamsReq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#OwnAddressesReq"><span class="hs-identifier">OwnAddressesReq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#OwnContractInstanceIdReq"><span class="hs-identifier">OwnContractInstanceIdReq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#WriteBalancedTxReq"><span class="hs-identifier">WriteBalancedTxReq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#YieldUnbalancedTxReq"><span class="hs-identifier">YieldUnbalancedTxReq</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-153"></span><span>                                </span><span class="annot"><a href="Plutus.Contract.Effects.html#PABResp"><span class="hs-identifier">PABResp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Effects.html#ExposeEndpointResp"><span class="hs-identifier">ExposeEndpointResp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html"><span class="hs-identifier">Plutus.Contract.Effects</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">E</span></span><span>
</span><span id="line-155"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html"><span class="hs-identifier">Plutus.Contract.Error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier">AsContractError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Error.html#_ChainIndexContractError"><span class="hs-identifier">_ChainIndexContractError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#_ConstraintResolutionContractError"><span class="hs-identifier">_ConstraintResolutionContractError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#_EndpointDecodeContractError"><span class="hs-identifier">_EndpointDecodeContractError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#_OtherContractError"><span class="hs-identifier">_OtherContractError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#_ResumableContractError"><span class="hs-identifier">_ResumableContractError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#_ToCardanoConvertContractError"><span class="hs-identifier">_ToCardanoConvertContractError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#_WalletContractError"><span class="hs-identifier">_WalletContractError</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-156"></span><span>                              </span><span class="annot"><a href="Plutus.Contract.Error.html#ContractError"><span class="hs-identifier">ContractError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Error.html#OtherContractError"><span class="hs-identifier">OtherContractError</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#_ContractError"><span class="hs-identifier">_ContractError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.Contract.Logging.html"><span class="hs-identifier">Plutus.Contract.Logging</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Logging.html#logDebug"><span class="hs-identifier">logDebug</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.Contract.Resumable.html"><span class="hs-identifier">Plutus.Contract.Resumable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Resumable.html#prompt"><span class="hs-identifier">prompt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.Contract.Schema.html"><span class="hs-identifier">Plutus.Contract.Schema</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Schema.html#Input"><span class="hs-identifier">Input</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Schema.html#Output"><span class="hs-identifier">Output</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html"><span class="hs-identifier">Plutus.Contract.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier">Contract</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier">Contract</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#MatchingError"><span class="hs-identifier">MatchingError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Error.html#WrongVariantError"><span class="hs-identifier">WrongVariantError</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Promise"><span class="hs-identifier">Promise</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Types.html#Promise"><span class="hs-identifier">Promise</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#mapError"><span class="hs-identifier">mapError</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-161"></span><span>                              </span><span class="annot"><a href="Plutus.Contract.Types.html#runError"><span class="hs-identifier">runError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">throwError</span></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.Contract.Util.html"><span class="hs-identifier">Plutus.Contract.Util</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Util.html#loopM"><span class="hs-identifier">loopM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.V1.Ledger.Api</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Datum</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">DatumHash</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MintingPolicy</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MintingPolicyHash</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Redeemer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">RedeemerHash</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">StakeValidator</span></span><span class="hs-special">,</span><span>
</span><span id="line-164"></span><span>                             </span><span class="annot"><span class="hs-identifier">StakeValidatorHash</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxId</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Validator</span></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.V1.Ledger.Value</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">AssetClass</span></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PlutusTx</span></span><span> </span><span class="hs-keyword">qualified</span><span>
</span><span id="line-167"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Wallet.Emulator.Error.html"><span class="hs-identifier">Wallet.Emulator.Error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Wallet.Emulator.Error.html#WalletAPIError"><span class="hs-identifier">WalletAPIError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Wallet.Emulator.Error.html#NoPaymentPubKeyHashError"><span class="hs-identifier">NoPaymentPubKeyHashError</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Wallet.Types.html"><span class="hs-identifier">Wallet.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Wallet.Types.html#ContractInstanceId"><span class="hs-identifier">ContractInstanceId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Wallet.Types.html#EndpointDescription"><span class="hs-identifier">EndpointDescription</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Wallet.Types.html#EndpointDescription"><span class="hs-identifier">EndpointDescription</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-169"></span><span>                     </span><span class="annot"><a href="Wallet.Types.html#EndpointValue"><span class="hs-identifier">EndpointValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Wallet.Types.html#EndpointValue"><span class="hs-identifier">EndpointValue</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Wallet.Types.html#unEndpointValue"><span class="hs-identifier">unEndpointValue</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-comment">-- | Constraints on the contract schema, ensuring that the labels of the schema</span><span>
</span><span id="line-172"></span><span class="hs-comment">--   are unique.</span><span>
</span><span id="line-173"></span><span class="hs-keyword">type</span><span> </span><span id="ContractRow"><span class="annot"><a href="Plutus.Contract.Request.html#ContractRow"><span class="hs-identifier hs-var">ContractRow</span></a></span></span><span> </span><span id="local-6989586621680561284"><span class="annot"><a href="#local-6989586621680561284"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AllUniqueLabels</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Schema.html#Input"><span class="hs-identifier hs-type">Input</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561284"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AllUniqueLabels</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Schema.html#Output"><span class="hs-identifier hs-type">Output</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561284"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-comment">{- Send a 'PABReq' and return the appropriate 'PABResp'
-}</span><span>
</span><span id="line-180"></span><span class="annot"><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-type">pabReq</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680562002"><span class="annot"><a href="#local-6989586621680562002"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680562001"><span class="annot"><a href="#local-6989586621680562001"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680562004"><span class="annot"><a href="#local-6989586621680562004"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621680562003"><span class="annot"><a href="#local-6989586621680562003"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680562004"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#PABReq"><span class="hs-identifier hs-type">PABReq</span></a></span><span> </span><span class="hs-comment">-- ^ The request to send</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prism'</span></span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#PABResp"><span class="hs-identifier hs-type">PABResp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680562003"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ Prism for the response</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680562002"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680562001"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680562004"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680562003"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-187"></span><span id="pabReq"><span class="annot"><span class="annottext">pabReq :: PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var hs-var">pabReq</span></a></span></span><span> </span><span id="local-6989586621680561283"><span class="annot"><span class="annottext">PABReq
</span><a href="#local-6989586621680561283"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span id="local-6989586621680561282"><span class="annot"><span class="annottext">Prism' PABResp a
</span><a href="#local-6989586621680561282"><span class="hs-identifier hs-var">prism</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Eff (ContractEffs w e) a -&gt; Contract w s e a
forall w (s :: Row *) e a.
Eff (ContractEffs w e) a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-var">Contract</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff (ContractEffs w e) a -&gt; Contract w s e a)
-&gt; Eff (ContractEffs w e) a -&gt; Contract w s e a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-188"></span><span>  </span><span id="local-6989586621680561281"><span class="annot"><span class="annottext">PABResp
</span><a href="#local-6989586621680561281"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PABReq -&gt; Eff (ContractEffs w e) PABResp
forall i o (effs :: [* -&gt; *]).
Member (Resumable i o) effs =&gt;
o -&gt; Eff effs i
</span><a href="Plutus.Contract.Resumable.html#prompt"><span class="hs-identifier hs-var">prompt</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.Contract.Effects.html#PABResp"><span class="hs-identifier hs-type">PABResp</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.Contract.Effects.html#PABReq"><span class="hs-identifier hs-type">PABReq</span></a></span><span> </span><span class="annot"><span class="annottext">PABReq
</span><a href="#local-6989586621680561283"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Getting (First a) PABResp a -&gt; PABResp -&gt; Maybe a
forall s (m :: * -&gt; *) a.
MonadReader s m =&gt;
Getting (First a) s a -&gt; m (Maybe a)
</span><span class="hs-identifier hs-var">preview</span></span><span> </span><span class="annot"><span class="annottext">Getting (First a) PABResp a
Prism' PABResp a
</span><a href="#local-6989586621680561282"><span class="hs-identifier hs-var">prism</span></a></span><span> </span><span class="annot"><span class="annottext">PABResp
</span><a href="#local-6989586621680561281"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-190"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680561280"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680561280"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Eff (ContractEffs w e) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680561280"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-192"></span><span>        </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]) a.
Member (Error e) effs =&gt;
e -&gt; Eff effs a
forall e (effs :: [* -&gt; *]) a.
Member (Error e) effs =&gt;
e -&gt; Eff effs a
</span><span class="hs-identifier hs-var">E.throwError</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680562004"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-193"></span><span>            </span><span class="annot"><span class="annottext">(e -&gt; Eff (ContractEffs w e) a) -&gt; e -&gt; Eff (ContractEffs w e) a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AReview e MatchingError -&gt; MatchingError -&gt; e
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview e MatchingError
forall r. AsContractError r =&gt; Prism' r MatchingError
</span><a href="Plutus.Contract.Error.html#_ResumableContractError"><span class="hs-identifier hs-var">_ResumableContractError</span></a></span><span>
</span><span id="line-194"></span><span>            </span><span class="annot"><span class="annottext">(MatchingError -&gt; e) -&gt; MatchingError -&gt; e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; MatchingError
</span><a href="Plutus.Contract.Error.html#WrongVariantError"><span class="hs-identifier hs-var">WrongVariantError</span></a></span><span>
</span><span id="line-195"></span><span>            </span><span class="annot"><span class="annottext">(Text -&gt; MatchingError) -&gt; Text -&gt; MatchingError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;unexpected answer: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PABResp -&gt; Text
forall a. Show a =&gt; a -&gt; Text
</span><a href="Data.Text.Extras.html#tshow"><span class="hs-identifier hs-var">tshow</span></a></span><span> </span><span class="annot"><span class="annottext">PABResp
</span><a href="#local-6989586621680561281"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-comment">-- | Adjust the unbalanced tx</span><span>
</span><span id="line-198"></span><span class="annot"><a href="Plutus.Contract.Request.html#adjustUnbalancedTx"><span class="hs-identifier hs-type">adjustUnbalancedTx</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561278"><span class="annot"><a href="#local-6989586621680561278"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561277"><span class="annot"><a href="#local-6989586621680561277"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561276"><span class="annot"><a href="#local-6989586621680561276"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561276"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UnbalancedTx</span></span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561278"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561277"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561276"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UnbalancedTx</span></span><span>
</span><span id="line-204"></span><span id="adjustUnbalancedTx"><span class="annot"><span class="annottext">adjustUnbalancedTx :: UnbalancedTx -&gt; Contract w s e UnbalancedTx
</span><a href="Plutus.Contract.Request.html#adjustUnbalancedTx"><span class="hs-identifier hs-var hs-var">adjustUnbalancedTx</span></a></span></span><span> </span><span id="local-6989586621680561275"><span class="annot"><span class="annottext">UnbalancedTx
</span><a href="#local-6989586621680561275"><span class="hs-identifier hs-var">utx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PABReq
-&gt; Prism' PABResp UnbalancedTx -&gt; Contract w s e UnbalancedTx
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnbalancedTx -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#AdjustUnbalancedTxReq"><span class="hs-identifier hs-var">AdjustUnbalancedTxReq</span></a></span><span> </span><span class="annot"><span class="annottext">UnbalancedTx
</span><a href="#local-6989586621680561275"><span class="hs-identifier hs-var">utx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prism' PABResp UnbalancedTx
</span><a href="Plutus.Contract.Effects.html#_AdjustUnbalancedTxResp"><span class="hs-identifier hs-var">E._AdjustUnbalancedTxResp</span></a></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-comment">-- | Wait until the slot</span><span>
</span><span id="line-207"></span><span class="annot"><a href="Plutus.Contract.Request.html#awaitSlot"><span class="hs-identifier hs-type">awaitSlot</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561984"><span class="annot"><a href="#local-6989586621680561984"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561983"><span class="annot"><a href="#local-6989586621680561983"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561985"><span class="annot"><a href="#local-6989586621680561985"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561985"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Slot</span></span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561984"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561983"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561985"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Slot</span></span><span>
</span><span id="line-213"></span><span id="awaitSlot"><span class="annot"><span class="annottext">awaitSlot :: Slot -&gt; Contract w s e Slot
</span><a href="Plutus.Contract.Request.html#awaitSlot"><span class="hs-identifier hs-var hs-var">awaitSlot</span></a></span></span><span> </span><span id="local-6989586621680561273"><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680561273"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PABReq -&gt; Prism' PABResp Slot -&gt; Contract w s e Slot
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Slot -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#AwaitSlotReq"><span class="hs-identifier hs-var">AwaitSlotReq</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680561273"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prism' PABResp Slot
</span><a href="Plutus.Contract.Effects.html#_AwaitSlotResp"><span class="hs-identifier hs-var">E._AwaitSlotResp</span></a></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-comment">-- | Wait until the slot</span><span>
</span><span id="line-216"></span><span class="annot"><a href="Plutus.Contract.Request.html#isSlot"><span class="hs-identifier hs-type">isSlot</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561271"><span class="annot"><a href="#local-6989586621680561271"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561270"><span class="annot"><a href="#local-6989586621680561270"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561269"><span class="annot"><a href="#local-6989586621680561269"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561269"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Slot</span></span><span>
</span><span id="line-221"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Promise"><span class="hs-identifier hs-type">Promise</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561271"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561270"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561269"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Slot</span></span><span>
</span><span id="line-222"></span><span id="isSlot"><span class="annot"><span class="annottext">isSlot :: Slot -&gt; Promise w s e Slot
</span><a href="Plutus.Contract.Request.html#isSlot"><span class="hs-identifier hs-var hs-var">isSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Contract w s e Slot -&gt; Promise w s e Slot
forall w (s :: Row *) e a. Contract w s e a -&gt; Promise w s e a
</span><a href="Plutus.Contract.Types.html#Promise"><span class="hs-identifier hs-var">Promise</span></a></span><span> </span><span class="annot"><span class="annottext">(Contract w s e Slot -&gt; Promise w s e Slot)
-&gt; (Slot -&gt; Contract w s e Slot) -&gt; Slot -&gt; Promise w s e Slot
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Contract w s e Slot
forall w (s :: Row *) e.
AsContractError e =&gt;
Slot -&gt; Contract w s e Slot
</span><a href="Plutus.Contract.Request.html#awaitSlot"><span class="hs-identifier hs-var">awaitSlot</span></a></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">-- | Get the current slot number</span><span>
</span><span id="line-225"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">currentSlot</span><span> </span><span class="hs-pragma">&quot;Use currentNodeClientSlot instead&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-226"></span><span class="annot"><a href="Plutus.Contract.Request.html#currentSlot"><span class="hs-identifier hs-type">currentSlot</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561267"><span class="annot"><a href="#local-6989586621680561267"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561266"><span class="annot"><a href="#local-6989586621680561266"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561265"><span class="annot"><a href="#local-6989586621680561265"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561265"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561267"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561266"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561265"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Slot</span></span><span>
</span><span id="line-231"></span><span id="currentSlot"><span class="annot"><span class="annottext">currentSlot :: Contract w s e Slot
</span><a href="Plutus.Contract.Request.html#currentSlot"><span class="hs-identifier hs-var hs-var">currentSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Contract w s e Slot
forall w (s :: Row *) e. AsContractError e =&gt; Contract w s e Slot
</span><a href="Plutus.Contract.Request.html#currentPABSlot"><span class="hs-identifier hs-var">currentPABSlot</span></a></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">currentPABSlot</span><span> </span><span class="hs-pragma">&quot;Use currentNodeClientSlot instead&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- | Get the current slot number of PAB</span><span>
</span><span id="line-235"></span><span class="annot"><a href="Plutus.Contract.Request.html#currentPABSlot"><span class="hs-identifier hs-type">currentPABSlot</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561978"><span class="annot"><a href="#local-6989586621680561978"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561977"><span class="annot"><a href="#local-6989586621680561977"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561979"><span class="annot"><a href="#local-6989586621680561979"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-237"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561979"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561978"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561977"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561979"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Slot</span></span><span>
</span><span id="line-240"></span><span id="currentPABSlot"><span class="annot"><span class="annottext">currentPABSlot :: Contract w s e Slot
</span><a href="Plutus.Contract.Request.html#currentPABSlot"><span class="hs-identifier hs-var hs-var">currentPABSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PABReq -&gt; Prism' PABResp Slot -&gt; Contract w s e Slot
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="annot"><span class="annottext">PABReq
</span><a href="Plutus.Contract.Effects.html#CurrentNodeClientSlotReq"><span class="hs-identifier hs-var">CurrentNodeClientSlotReq</span></a></span><span> </span><span class="annot"><span class="annottext">Prism' PABResp Slot
</span><a href="Plutus.Contract.Effects.html#_CurrentNodeClientSlotResp"><span class="hs-identifier hs-var">E._CurrentNodeClientSlotResp</span></a></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-comment">-- | Get the current slot number of the node client (the local or remote node) that the application</span><span>
</span><span id="line-243"></span><span class="hs-comment">-- is connected to.</span><span>
</span><span id="line-244"></span><span class="annot"><a href="Plutus.Contract.Request.html#currentNodeClientSlot"><span class="hs-identifier hs-type">currentNodeClientSlot</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561263"><span class="annot"><a href="#local-6989586621680561263"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561262"><span class="annot"><a href="#local-6989586621680561262"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561261"><span class="annot"><a href="#local-6989586621680561261"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-246"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561261"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561263"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561262"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561261"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Slot</span></span><span>
</span><span id="line-249"></span><span id="currentNodeClientSlot"><span class="annot"><span class="annottext">currentNodeClientSlot :: Contract w s e Slot
</span><a href="Plutus.Contract.Request.html#currentNodeClientSlot"><span class="hs-identifier hs-var hs-var">currentNodeClientSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PABReq -&gt; Prism' PABResp Slot -&gt; Contract w s e Slot
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="annot"><span class="annottext">PABReq
</span><a href="Plutus.Contract.Effects.html#CurrentNodeClientSlotReq"><span class="hs-identifier hs-var">CurrentNodeClientSlotReq</span></a></span><span> </span><span class="annot"><span class="annottext">Prism' PABResp Slot
</span><a href="Plutus.Contract.Effects.html#_CurrentNodeClientSlotResp"><span class="hs-identifier hs-var">E._CurrentNodeClientSlotResp</span></a></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-comment">-- | Get the current node slot number querying slot number from plutus chain index to be aligned with slot at local running node</span><span>
</span><span id="line-252"></span><span class="annot"><a href="Plutus.Contract.Request.html#currentChainIndexSlot"><span class="hs-identifier hs-type">currentChainIndexSlot</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561260"><span class="annot"><a href="#local-6989586621680561260"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561259"><span class="annot"><a href="#local-6989586621680561259"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561258"><span class="annot"><a href="#local-6989586621680561258"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561258"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561260"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561259"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561258"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Slot</span></span><span>
</span><span id="line-257"></span><span id="currentChainIndexSlot"><span class="annot"><span class="annottext">currentChainIndexSlot :: Contract w s e Slot
</span><a href="Plutus.Contract.Request.html#currentChainIndexSlot"><span class="hs-identifier hs-var hs-var">currentChainIndexSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PABReq -&gt; Prism' PABResp Slot -&gt; Contract w s e Slot
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="annot"><span class="annottext">PABReq
</span><a href="Plutus.Contract.Effects.html#CurrentChainIndexSlotReq"><span class="hs-identifier hs-var">CurrentChainIndexSlotReq</span></a></span><span> </span><span class="annot"><span class="annottext">Prism' PABResp Slot
</span><a href="Plutus.Contract.Effects.html#_CurrentChainIndexSlotResp"><span class="hs-identifier hs-var">E._CurrentChainIndexSlotResp</span></a></span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="hs-comment">-- | Wait for a number of slots to pass</span><span>
</span><span id="line-260"></span><span class="annot"><a href="Plutus.Contract.Request.html#waitNSlots"><span class="hs-identifier hs-type">waitNSlots</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561256"><span class="annot"><a href="#local-6989586621680561256"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561255"><span class="annot"><a href="#local-6989586621680561255"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561254"><span class="annot"><a href="#local-6989586621680561254"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561254"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Natural</span></a></span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561256"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561255"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561254"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Slot</span></span><span>
</span><span id="line-266"></span><span id="waitNSlots"><span class="annot"><span class="annottext">waitNSlots :: Natural -&gt; Contract w s e Slot
</span><a href="Plutus.Contract.Request.html#waitNSlots"><span class="hs-identifier hs-var hs-var">waitNSlots</span></a></span></span><span> </span><span id="local-6989586621680561253"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621680561253"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-267"></span><span>  </span><span id="local-6989586621680561252"><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680561252"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Contract w s e Slot
forall w (s :: Row *) e. AsContractError e =&gt; Contract w s e Slot
</span><a href="Plutus.Contract.Request.html#currentSlot"><span class="hs-identifier hs-var">currentSlot</span></a></span><span>
</span><span id="line-268"></span><span>  </span><span class="annot"><span class="annottext">Slot -&gt; Contract w s e Slot
forall w (s :: Row *) e.
AsContractError e =&gt;
Slot -&gt; Contract w s e Slot
</span><a href="Plutus.Contract.Request.html#awaitSlot"><span class="hs-identifier hs-var">awaitSlot</span></a></span><span> </span><span class="annot"><span class="annottext">(Slot -&gt; Contract w s e Slot) -&gt; Slot -&gt; Contract w s e Slot
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680561252"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Slot -&gt; Slot
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Slot
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621680561253"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="hs-comment">-- | Wait until the slot where the given time falls into and return latest time</span><span>
</span><span id="line-271"></span><span class="hs-comment">-- we know has passed.</span><span>
</span><span id="line-272"></span><span class="hs-comment">--</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- Example: if starting time is 0 and slot length is 3s, then `awaitTime 4`</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- waits until slot 2 and returns the value `POSIXTime 5`.</span><span>
</span><span id="line-275"></span><span class="annot"><a href="Plutus.Contract.Request.html#awaitTime"><span class="hs-identifier hs-type">awaitTime</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-276"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561953"><span class="annot"><a href="#local-6989586621680561953"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561952"><span class="annot"><a href="#local-6989586621680561952"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561954"><span class="annot"><a href="#local-6989586621680561954"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561954"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-278"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">POSIXTime</span></span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561953"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561952"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561954"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">POSIXTime</span></span><span>
</span><span id="line-281"></span><span id="awaitTime"><span class="annot"><span class="annottext">awaitTime :: POSIXTime -&gt; Contract w s e POSIXTime
</span><a href="Plutus.Contract.Request.html#awaitTime"><span class="hs-identifier hs-var hs-var">awaitTime</span></a></span></span><span> </span><span id="local-6989586621680561250"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621680561250"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PABReq -&gt; Prism' PABResp POSIXTime -&gt; Contract w s e POSIXTime
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">POSIXTime -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#AwaitTimeReq"><span class="hs-identifier hs-var">AwaitTimeReq</span></a></span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621680561250"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prism' PABResp POSIXTime
</span><a href="Plutus.Contract.Effects.html#_AwaitTimeResp"><span class="hs-identifier hs-var">E._AwaitTimeResp</span></a></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-comment">-- | Wait until the slot where the given time falls into and return latest time</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- we know has passed.</span><span>
</span><span id="line-285"></span><span class="annot"><a href="Plutus.Contract.Request.html#isTime"><span class="hs-identifier hs-type">isTime</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-286"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561248"><span class="annot"><a href="#local-6989586621680561248"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561247"><span class="annot"><a href="#local-6989586621680561247"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561246"><span class="annot"><a href="#local-6989586621680561246"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-287"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561246"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-288"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">POSIXTime</span></span><span>
</span><span id="line-290"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Promise"><span class="hs-identifier hs-type">Promise</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561248"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561247"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561246"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">POSIXTime</span></span><span>
</span><span id="line-291"></span><span id="isTime"><span class="annot"><span class="annottext">isTime :: POSIXTime -&gt; Promise w s e POSIXTime
</span><a href="Plutus.Contract.Request.html#isTime"><span class="hs-identifier hs-var hs-var">isTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Contract w s e POSIXTime -&gt; Promise w s e POSIXTime
forall w (s :: Row *) e a. Contract w s e a -&gt; Promise w s e a
</span><a href="Plutus.Contract.Types.html#Promise"><span class="hs-identifier hs-var">Promise</span></a></span><span> </span><span class="annot"><span class="annottext">(Contract w s e POSIXTime -&gt; Promise w s e POSIXTime)
-&gt; (POSIXTime -&gt; Contract w s e POSIXTime)
-&gt; POSIXTime
-&gt; Promise w s e POSIXTime
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; Contract w s e POSIXTime
forall w (s :: Row *) e.
AsContractError e =&gt;
POSIXTime -&gt; Contract w s e POSIXTime
</span><a href="Plutus.Contract.Request.html#awaitTime"><span class="hs-identifier hs-var">awaitTime</span></a></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">currentTime</span><span> </span><span class="hs-pragma">&quot;Use currentNodeClientTimeRange instead&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- | Get the latest time of the current slot.</span><span>
</span><span id="line-295"></span><span class="hs-comment">--</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- Example: if slot length is 3s and current slot is 2, then `currentTime`</span><span>
</span><span id="line-297"></span><span class="hs-comment">-- returns the value `POSIXTime 5`</span><span>
</span><span id="line-298"></span><span class="annot"><a href="Plutus.Contract.Request.html#currentTime"><span class="hs-identifier hs-type">currentTime</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561940"><span class="annot"><a href="#local-6989586621680561940"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561939"><span class="annot"><a href="#local-6989586621680561939"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561941"><span class="annot"><a href="#local-6989586621680561941"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561941"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-301"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561940"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561939"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561941"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">POSIXTime</span></span><span>
</span><span id="line-303"></span><span id="currentTime"><span class="annot"><span class="annottext">currentTime :: Contract w s e POSIXTime
</span><a href="Plutus.Contract.Request.html#currentTime"><span class="hs-identifier hs-var hs-var">currentTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PABReq -&gt; Prism' PABResp POSIXTime -&gt; Contract w s e POSIXTime
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="annot"><span class="annottext">PABReq
</span><a href="Plutus.Contract.Effects.html#CurrentTimeReq"><span class="hs-identifier hs-var">CurrentTimeReq</span></a></span><span> </span><span class="annot"><span class="annottext">Prism' PABResp POSIXTime
</span><a href="Plutus.Contract.Effects.html#_CurrentTimeResp"><span class="hs-identifier hs-var">E._CurrentTimeResp</span></a></span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="hs-comment">-- | Get the 'POSIXTime' range of the current slot.</span><span>
</span><span id="line-306"></span><span class="hs-comment">--</span><span>
</span><span id="line-307"></span><span class="hs-comment">-- Example: if slot length is 3s and current slot is 2, then `currentTimeRange`</span><span>
</span><span id="line-308"></span><span class="hs-comment">-- returns the time interval @[3, 5[@.</span><span>
</span><span id="line-309"></span><span class="annot"><a href="Plutus.Contract.Request.html#currentNodeClientTimeRange"><span class="hs-identifier hs-type">currentNodeClientTimeRange</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561244"><span class="annot"><a href="#local-6989586621680561244"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561243"><span class="annot"><a href="#local-6989586621680561243"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561242"><span class="annot"><a href="#local-6989586621680561242"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-311"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561242"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-312"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561244"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561243"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561242"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">POSIXTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">POSIXTime</span></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span id="currentNodeClientTimeRange"><span class="annot"><span class="annottext">currentNodeClientTimeRange :: Contract w s e (POSIXTime, POSIXTime)
</span><a href="Plutus.Contract.Request.html#currentNodeClientTimeRange"><span class="hs-identifier hs-var hs-var">currentNodeClientTimeRange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PABReq
-&gt; Prism' PABResp (POSIXTime, POSIXTime)
-&gt; Contract w s e (POSIXTime, POSIXTime)
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="annot"><span class="annottext">PABReq
</span><a href="Plutus.Contract.Effects.html#CurrentNodeClientTimeRangeReq"><span class="hs-identifier hs-var">CurrentNodeClientTimeRangeReq</span></a></span><span> </span><span class="annot"><span class="annottext">Prism' PABResp (POSIXTime, POSIXTime)
</span><a href="Plutus.Contract.Effects.html#_CurrentNodeClientTimeRangeResp"><span class="hs-identifier hs-var">E._CurrentNodeClientTimeRangeResp</span></a></span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="hs-comment">-- | Wait for a number of milliseconds starting at the ending time of the current</span><span>
</span><span id="line-317"></span><span class="hs-comment">-- slot, and return the latest time we know has passed.</span><span>
</span><span id="line-318"></span><span class="hs-comment">--</span><span>
</span><span id="line-319"></span><span class="hs-comment">-- Example: if starting time is 0, slot length is 3000ms and current slot is 0, then</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- `waitNMilliSeconds 0` returns the value `POSIXTime 2000` and `waitNMilliSeconds 1000`</span><span>
</span><span id="line-321"></span><span class="hs-comment">-- returns the value `POSIXTime 5`.</span><span>
</span><span id="line-322"></span><span class="annot"><a href="Plutus.Contract.Request.html#waitNMilliSeconds"><span class="hs-identifier hs-type">waitNMilliSeconds</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-323"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561240"><span class="annot"><a href="#local-6989586621680561240"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561239"><span class="annot"><a href="#local-6989586621680561239"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561238"><span class="annot"><a href="#local-6989586621680561238"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-324"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561238"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-325"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiffMilliSeconds</span></span><span>
</span><span id="line-327"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561240"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561239"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561238"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">POSIXTime</span></span><span>
</span><span id="line-328"></span><span id="waitNMilliSeconds"><span class="annot"><span class="annottext">waitNMilliSeconds :: DiffMilliSeconds -&gt; Contract w s e POSIXTime
</span><a href="Plutus.Contract.Request.html#waitNMilliSeconds"><span class="hs-identifier hs-var hs-var">waitNMilliSeconds</span></a></span></span><span> </span><span id="local-6989586621680561237"><span class="annot"><span class="annottext">DiffMilliSeconds
</span><a href="#local-6989586621680561237"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-329"></span><span>  </span><span id="local-6989586621680561236"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621680561236"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Contract w s e POSIXTime
forall w (s :: Row *) e.
AsContractError e =&gt;
Contract w s e POSIXTime
</span><a href="Plutus.Contract.Request.html#currentTime"><span class="hs-identifier hs-var">currentTime</span></a></span><span>
</span><span id="line-330"></span><span>  </span><span class="annot"><span class="annottext">POSIXTime -&gt; Contract w s e POSIXTime
forall w (s :: Row *) e.
AsContractError e =&gt;
POSIXTime -&gt; Contract w s e POSIXTime
</span><a href="Plutus.Contract.Request.html#awaitTime"><span class="hs-identifier hs-var">awaitTime</span></a></span><span> </span><span class="annot"><span class="annottext">(POSIXTime -&gt; Contract w s e POSIXTime)
-&gt; POSIXTime -&gt; Contract w s e POSIXTime
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621680561236"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; POSIXTime -&gt; POSIXTime
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">DiffMilliSeconds -&gt; POSIXTime
</span><span class="hs-identifier hs-var">fromMilliSeconds</span></span><span> </span><span class="annot"><span class="annottext">DiffMilliSeconds
</span><a href="#local-6989586621680561237"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span class="hs-comment">-- | Get the configured parameter set.</span><span>
</span><span id="line-333"></span><span class="annot"><a href="Plutus.Contract.Request.html#getParams"><span class="hs-identifier hs-type">getParams</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-334"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561492"><span class="annot"><a href="#local-6989586621680561492"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561491"><span class="annot"><a href="#local-6989586621680561491"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561493"><span class="annot"><a href="#local-6989586621680561493"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-335"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561493"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-336"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561492"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561491"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561493"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Params</span></span><span>
</span><span id="line-338"></span><span id="getParams"><span class="annot"><span class="annottext">getParams :: Contract w s e Params
</span><a href="Plutus.Contract.Request.html#getParams"><span class="hs-identifier hs-var hs-var">getParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PABReq -&gt; Prism' PABResp Params -&gt; Contract w s e Params
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="annot"><span class="annottext">PABReq
</span><a href="Plutus.Contract.Effects.html#GetParamsReq"><span class="hs-identifier hs-var">GetParamsReq</span></a></span><span> </span><span class="annot"><span class="annottext">Prism' PABResp Params
</span><a href="Plutus.Contract.Effects.html#_GetParamsResp"><span class="hs-identifier hs-var">E._GetParamsResp</span></a></span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span class="annot"><a href="Plutus.Contract.Request.html#datumFromHash"><span class="hs-identifier hs-type">datumFromHash</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-341"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561234"><span class="annot"><a href="#local-6989586621680561234"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561233"><span class="annot"><a href="#local-6989586621680561233"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561232"><span class="annot"><a href="#local-6989586621680561232"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-342"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561232"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-343"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DatumHash</span></span><span>
</span><span id="line-345"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561234"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561233"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561232"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Datum</span></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span id="datumFromHash"><span class="annot"><span class="annottext">datumFromHash :: DatumHash -&gt; Contract w s e (Maybe Datum)
</span><a href="Plutus.Contract.Request.html#datumFromHash"><span class="hs-identifier hs-var hs-var">datumFromHash</span></a></span></span><span> </span><span id="local-6989586621680561231"><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621680561231"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-347"></span><span>  </span><span id="local-6989586621680561230"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561230"><span class="hs-identifier hs-var">cir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PABReq
-&gt; Prism' PABResp ChainIndexResponse
-&gt; Contract w s e ChainIndexResponse
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainIndexQuery -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#ChainIndexQueryReq"><span class="hs-identifier hs-var">ChainIndexQueryReq</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexQuery -&gt; PABReq) -&gt; ChainIndexQuery -&gt; PABReq
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash -&gt; ChainIndexQuery
</span><a href="Plutus.Contract.Effects.html#DatumFromHash"><span class="hs-identifier hs-var">E.DatumFromHash</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621680561231"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prism' PABResp ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#_ChainIndexQueryResp"><span class="hs-identifier hs-var">E._ChainIndexQueryResp</span></a></span><span>
</span><span id="line-348"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561230"><span class="hs-identifier hs-var">cir</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-349"></span><span>    </span><span class="annot"><a href="Plutus.Contract.Effects.html#DatumHashResponse"><span class="hs-identifier hs-type">E.DatumHashResponse</span></a></span><span> </span><span id="local-6989586621680561226"><span class="annot"><span class="annottext">Maybe Datum
</span><a href="#local-6989586621680561226"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Datum -&gt; Contract w s e (Maybe Datum)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Datum
</span><a href="#local-6989586621680561226"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-350"></span><span>    </span><span id="local-6989586621680561225"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561225"><span class="hs-identifier hs-var">r</span></a></span></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e -&gt; Contract w s e (Maybe Datum)
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; Contract w s e (Maybe Datum))
-&gt; e -&gt; Contract w s e (Maybe Datum)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
-&gt; (Text, ChainIndexResponse) -&gt; e
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
forall r. AsContractError r =&gt; Prism' r (Text, ChainIndexResponse)
</span><a href="Plutus.Contract.Error.html#_ChainIndexContractError"><span class="hs-identifier hs-var">_ChainIndexContractError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;DatumHashResponse&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561225"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span class="hs-comment">-- | Get all the datums at an address w.r.t. a page query TxOutRef</span><span>
</span><span id="line-355"></span><span class="annot"><a href="Plutus.Contract.Request.html#queryDatumsAt"><span class="hs-identifier hs-type">queryDatumsAt</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-356"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561905"><span class="annot"><a href="#local-6989586621680561905"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561904"><span class="annot"><a href="#local-6989586621680561904"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561906"><span class="annot"><a href="#local-6989586621680561906"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-357"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561906"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-358"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAddress</span></span><span>
</span><span id="line-360"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PageQuery</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutRef</span></span><span>
</span><span id="line-361"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561905"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561904"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561906"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">QueryResponse</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Datum</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span id="queryDatumsAt"><span class="annot"><span class="annottext">queryDatumsAt :: CardanoAddress
-&gt; PageQuery TxOutRef -&gt; Contract w s e (QueryResponse [Datum])
</span><a href="Plutus.Contract.Request.html#queryDatumsAt"><span class="hs-identifier hs-var hs-var">queryDatumsAt</span></a></span></span><span> </span><span id="local-6989586621680561223"><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680561223"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621680561222"><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680561222"><span class="hs-identifier hs-var">pq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-363"></span><span>  </span><span id="local-6989586621680561221"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561221"><span class="hs-identifier hs-var">cir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PABReq
-&gt; Prism' PABResp ChainIndexResponse
-&gt; Contract w s e ChainIndexResponse
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainIndexQuery -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#ChainIndexQueryReq"><span class="hs-identifier hs-var">ChainIndexQueryReq</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexQuery -&gt; PABReq) -&gt; ChainIndexQuery -&gt; PABReq
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef -&gt; CardanoAddress -&gt; ChainIndexQuery
</span><a href="Plutus.Contract.Effects.html#DatumsAtAddress"><span class="hs-identifier hs-var">E.DatumsAtAddress</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680561222"><span class="hs-identifier hs-var">pq</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680561223"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prism' PABResp ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#_ChainIndexQueryResp"><span class="hs-identifier hs-var">E._ChainIndexQueryResp</span></a></span><span>
</span><span id="line-364"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561221"><span class="hs-identifier hs-var">cir</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-365"></span><span>    </span><span class="annot"><a href="Plutus.Contract.Effects.html#DatumsAtResponse"><span class="hs-identifier hs-type">E.DatumsAtResponse</span></a></span><span> </span><span id="local-6989586621680561218"><span class="annot"><span class="annottext">QueryResponse [Datum]
</span><a href="#local-6989586621680561218"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QueryResponse [Datum] -&gt; Contract w s e (QueryResponse [Datum])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">QueryResponse [Datum]
</span><a href="#local-6989586621680561218"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-366"></span><span>    </span><span id="local-6989586621680561217"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561217"><span class="hs-identifier hs-var">r</span></a></span></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e -&gt; Contract w s e (QueryResponse [Datum])
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; Contract w s e (QueryResponse [Datum]))
-&gt; e -&gt; Contract w s e (QueryResponse [Datum])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
-&gt; (Text, ChainIndexResponse) -&gt; e
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
forall r. AsContractError r =&gt; Prism' r (Text, ChainIndexResponse)
</span><a href="Plutus.Contract.Error.html#_ChainIndexContractError"><span class="hs-identifier hs-var">_ChainIndexContractError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;DatumsAtResponse&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561217"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span class="hs-comment">-- | Get the all datums at an address whether or not the corresponding utxo have been consumed or not.</span><span>
</span><span id="line-370"></span><span class="annot"><a href="Plutus.Contract.Request.html#datumsAt"><span class="hs-identifier hs-type">datumsAt</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-371"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561216"><span class="annot"><a href="#local-6989586621680561216"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561215"><span class="annot"><a href="#local-6989586621680561215"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561214"><span class="annot"><a href="#local-6989586621680561214"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-372"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561214"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-373"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAddress</span></span><span>
</span><span id="line-375"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561216"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561215"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561214"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Datum</span></span><span class="hs-special">]</span><span>
</span><span id="line-376"></span><span id="datumsAt"><span class="annot"><span class="annottext">datumsAt :: CardanoAddress -&gt; Contract w s e [Datum]
</span><a href="Plutus.Contract.Request.html#datumsAt"><span class="hs-identifier hs-var hs-var">datumsAt</span></a></span></span><span> </span><span id="local-6989586621680561213"><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680561213"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-377"></span><span>  </span><span class="annot"><span class="annottext">[[Datum]] -&gt; [Datum]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">([[Datum]] -&gt; [Datum])
-&gt; Contract w s e [[Datum]] -&gt; Contract w s e [Datum]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(PageQuery TxOutRef -&gt; Contract w s e (QueryResponse [Datum]))
-&gt; Contract w s e [[Datum]]
forall (m :: * -&gt; *) a.
Monad m =&gt;
(PageQuery TxOutRef -&gt; m (QueryResponse a)) -&gt; m [a]
</span><span class="hs-identifier hs-var">collectQueryResponse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardanoAddress
-&gt; PageQuery TxOutRef -&gt; Contract w s e (QueryResponse [Datum])
forall w (s :: Row *) e.
AsContractError e =&gt;
CardanoAddress
-&gt; PageQuery TxOutRef -&gt; Contract w s e (QueryResponse [Datum])
</span><a href="Plutus.Contract.Request.html#queryDatumsAt"><span class="hs-identifier hs-var">queryDatumsAt</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680561213"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span class="annot"><a href="Plutus.Contract.Request.html#validatorFromHash"><span class="hs-identifier hs-type">validatorFromHash</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-381"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561210"><span class="annot"><a href="#local-6989586621680561210"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561209"><span class="annot"><a href="#local-6989586621680561209"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561208"><span class="annot"><a href="#local-6989586621680561208"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-382"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561208"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-383"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ValidatorHash</span></span><span>
</span><span id="line-385"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561210"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561209"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561208"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Validator</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-386"></span><span id="validatorFromHash"><span class="annot"><span class="annottext">validatorFromHash :: ValidatorHash -&gt; Contract w s e (Maybe (Versioned Validator))
</span><a href="Plutus.Contract.Request.html#validatorFromHash"><span class="hs-identifier hs-var hs-var">validatorFromHash</span></a></span></span><span> </span><span id="local-6989586621680561207"><span class="annot"><span class="annottext">ValidatorHash
</span><a href="#local-6989586621680561207"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-387"></span><span>  </span><span id="local-6989586621680561206"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561206"><span class="hs-identifier hs-var">cir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PABReq
-&gt; Prism' PABResp ChainIndexResponse
-&gt; Contract w s e ChainIndexResponse
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainIndexQuery -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#ChainIndexQueryReq"><span class="hs-identifier hs-var">ChainIndexQueryReq</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexQuery -&gt; PABReq) -&gt; ChainIndexQuery -&gt; PABReq
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ValidatorHash -&gt; ChainIndexQuery
</span><a href="Plutus.Contract.Effects.html#ValidatorFromHash"><span class="hs-identifier hs-var">E.ValidatorFromHash</span></a></span><span> </span><span class="annot"><span class="annottext">ValidatorHash
</span><a href="#local-6989586621680561207"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prism' PABResp ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#_ChainIndexQueryResp"><span class="hs-identifier hs-var">E._ChainIndexQueryResp</span></a></span><span>
</span><span id="line-388"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561206"><span class="hs-identifier hs-var">cir</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-389"></span><span>    </span><span class="annot"><a href="Plutus.Contract.Effects.html#ValidatorHashResponse"><span class="hs-identifier hs-type">E.ValidatorHashResponse</span></a></span><span> </span><span id="local-6989586621680561203"><span class="annot"><span class="annottext">Maybe (Versioned Validator)
</span><a href="#local-6989586621680561203"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Versioned Validator)
-&gt; Contract w s e (Maybe (Versioned Validator))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Versioned Validator)
</span><a href="#local-6989586621680561203"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-390"></span><span>    </span><span id="local-6989586621680561202"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561202"><span class="hs-identifier hs-var">r</span></a></span></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e -&gt; Contract w s e (Maybe (Versioned Validator))
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; Contract w s e (Maybe (Versioned Validator)))
-&gt; e -&gt; Contract w s e (Maybe (Versioned Validator))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
-&gt; (Text, ChainIndexResponse) -&gt; e
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
forall r. AsContractError r =&gt; Prism' r (Text, ChainIndexResponse)
</span><a href="Plutus.Contract.Error.html#_ChainIndexContractError"><span class="hs-identifier hs-var">_ChainIndexContractError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;ValidatorHashResponse&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561202"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span class="annot"><a href="Plutus.Contract.Request.html#mintingPolicyFromHash"><span class="hs-identifier hs-type">mintingPolicyFromHash</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-393"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561201"><span class="annot"><a href="#local-6989586621680561201"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561200"><span class="annot"><a href="#local-6989586621680561200"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561199"><span class="annot"><a href="#local-6989586621680561199"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-394"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561199"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-395"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MintingPolicyHash</span></span><span>
</span><span id="line-397"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561201"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561200"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561199"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">MintingPolicy</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span id="mintingPolicyFromHash"><span class="annot"><span class="annottext">mintingPolicyFromHash :: MintingPolicyHash
-&gt; Contract w s e (Maybe (Versioned MintingPolicy))
</span><a href="Plutus.Contract.Request.html#mintingPolicyFromHash"><span class="hs-identifier hs-var hs-var">mintingPolicyFromHash</span></a></span></span><span> </span><span id="local-6989586621680561198"><span class="annot"><span class="annottext">MintingPolicyHash
</span><a href="#local-6989586621680561198"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-399"></span><span>  </span><span id="local-6989586621680561197"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561197"><span class="hs-identifier hs-var">cir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PABReq
-&gt; Prism' PABResp ChainIndexResponse
-&gt; Contract w s e ChainIndexResponse
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainIndexQuery -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#ChainIndexQueryReq"><span class="hs-identifier hs-var">ChainIndexQueryReq</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexQuery -&gt; PABReq) -&gt; ChainIndexQuery -&gt; PABReq
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MintingPolicyHash -&gt; ChainIndexQuery
</span><a href="Plutus.Contract.Effects.html#MintingPolicyFromHash"><span class="hs-identifier hs-var">E.MintingPolicyFromHash</span></a></span><span> </span><span class="annot"><span class="annottext">MintingPolicyHash
</span><a href="#local-6989586621680561198"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prism' PABResp ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#_ChainIndexQueryResp"><span class="hs-identifier hs-var">E._ChainIndexQueryResp</span></a></span><span>
</span><span id="line-400"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561197"><span class="hs-identifier hs-var">cir</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-401"></span><span>    </span><span class="annot"><a href="Plutus.Contract.Effects.html#MintingPolicyHashResponse"><span class="hs-identifier hs-type">E.MintingPolicyHashResponse</span></a></span><span> </span><span id="local-6989586621680561194"><span class="annot"><span class="annottext">Maybe (Versioned MintingPolicy)
</span><a href="#local-6989586621680561194"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Versioned MintingPolicy)
-&gt; Contract w s e (Maybe (Versioned MintingPolicy))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Versioned MintingPolicy)
</span><a href="#local-6989586621680561194"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-402"></span><span>    </span><span id="local-6989586621680561193"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561193"><span class="hs-identifier hs-var">r</span></a></span></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e -&gt; Contract w s e (Maybe (Versioned MintingPolicy))
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; Contract w s e (Maybe (Versioned MintingPolicy)))
-&gt; e -&gt; Contract w s e (Maybe (Versioned MintingPolicy))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
-&gt; (Text, ChainIndexResponse) -&gt; e
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
forall r. AsContractError r =&gt; Prism' r (Text, ChainIndexResponse)
</span><a href="Plutus.Contract.Error.html#_ChainIndexContractError"><span class="hs-identifier hs-var">_ChainIndexContractError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;MintingPolicyHashResponse&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561193"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span class="annot"><a href="Plutus.Contract.Request.html#stakeValidatorFromHash"><span class="hs-identifier hs-type">stakeValidatorFromHash</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-405"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561192"><span class="annot"><a href="#local-6989586621680561192"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561191"><span class="annot"><a href="#local-6989586621680561191"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561190"><span class="annot"><a href="#local-6989586621680561190"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-406"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561190"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-407"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StakeValidatorHash</span></span><span>
</span><span id="line-409"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561192"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561191"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561190"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StakeValidator</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span id="stakeValidatorFromHash"><span class="annot"><span class="annottext">stakeValidatorFromHash :: StakeValidatorHash
-&gt; Contract w s e (Maybe (Versioned StakeValidator))
</span><a href="Plutus.Contract.Request.html#stakeValidatorFromHash"><span class="hs-identifier hs-var hs-var">stakeValidatorFromHash</span></a></span></span><span> </span><span id="local-6989586621680561189"><span class="annot"><span class="annottext">StakeValidatorHash
</span><a href="#local-6989586621680561189"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-411"></span><span>  </span><span id="local-6989586621680561188"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561188"><span class="hs-identifier hs-var">cir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PABReq
-&gt; Prism' PABResp ChainIndexResponse
-&gt; Contract w s e ChainIndexResponse
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainIndexQuery -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#ChainIndexQueryReq"><span class="hs-identifier hs-var">ChainIndexQueryReq</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexQuery -&gt; PABReq) -&gt; ChainIndexQuery -&gt; PABReq
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">StakeValidatorHash -&gt; ChainIndexQuery
</span><a href="Plutus.Contract.Effects.html#StakeValidatorFromHash"><span class="hs-identifier hs-var">E.StakeValidatorFromHash</span></a></span><span> </span><span class="annot"><span class="annottext">StakeValidatorHash
</span><a href="#local-6989586621680561189"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prism' PABResp ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#_ChainIndexQueryResp"><span class="hs-identifier hs-var">E._ChainIndexQueryResp</span></a></span><span>
</span><span id="line-412"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561188"><span class="hs-identifier hs-var">cir</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-413"></span><span>    </span><span class="annot"><a href="Plutus.Contract.Effects.html#StakeValidatorHashResponse"><span class="hs-identifier hs-type">E.StakeValidatorHashResponse</span></a></span><span> </span><span id="local-6989586621680561185"><span class="annot"><span class="annottext">Maybe (Versioned StakeValidator)
</span><a href="#local-6989586621680561185"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Versioned StakeValidator)
-&gt; Contract w s e (Maybe (Versioned StakeValidator))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Versioned StakeValidator)
</span><a href="#local-6989586621680561185"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-414"></span><span>    </span><span id="local-6989586621680561184"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561184"><span class="hs-identifier hs-var">r</span></a></span></span><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e -&gt; Contract w s e (Maybe (Versioned StakeValidator))
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; Contract w s e (Maybe (Versioned StakeValidator)))
-&gt; e -&gt; Contract w s e (Maybe (Versioned StakeValidator))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
-&gt; (Text, ChainIndexResponse) -&gt; e
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
forall r. AsContractError r =&gt; Prism' r (Text, ChainIndexResponse)
</span><a href="Plutus.Contract.Error.html#_ChainIndexContractError"><span class="hs-identifier hs-var">_ChainIndexContractError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;StakeValidatorHashResponse&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561184"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span class="annot"><a href="Plutus.Contract.Request.html#redeemerFromHash"><span class="hs-identifier hs-type">redeemerFromHash</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-417"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561183"><span class="annot"><a href="#local-6989586621680561183"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561182"><span class="annot"><a href="#local-6989586621680561182"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561181"><span class="annot"><a href="#local-6989586621680561181"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-418"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561181"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-419"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RedeemerHash</span></span><span>
</span><span id="line-421"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561183"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561182"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561181"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Redeemer</span></span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span id="redeemerFromHash"><span class="annot"><span class="annottext">redeemerFromHash :: RedeemerHash -&gt; Contract w s e (Maybe Redeemer)
</span><a href="Plutus.Contract.Request.html#redeemerFromHash"><span class="hs-identifier hs-var hs-var">redeemerFromHash</span></a></span></span><span> </span><span id="local-6989586621680561180"><span class="annot"><span class="annottext">RedeemerHash
</span><a href="#local-6989586621680561180"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-423"></span><span>  </span><span id="local-6989586621680561179"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561179"><span class="hs-identifier hs-var">cir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PABReq
-&gt; Prism' PABResp ChainIndexResponse
-&gt; Contract w s e ChainIndexResponse
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainIndexQuery -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#ChainIndexQueryReq"><span class="hs-identifier hs-var">ChainIndexQueryReq</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexQuery -&gt; PABReq) -&gt; ChainIndexQuery -&gt; PABReq
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RedeemerHash -&gt; ChainIndexQuery
</span><a href="Plutus.Contract.Effects.html#RedeemerFromHash"><span class="hs-identifier hs-var">E.RedeemerFromHash</span></a></span><span> </span><span class="annot"><span class="annottext">RedeemerHash
</span><a href="#local-6989586621680561180"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prism' PABResp ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#_ChainIndexQueryResp"><span class="hs-identifier hs-var">E._ChainIndexQueryResp</span></a></span><span>
</span><span id="line-424"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561179"><span class="hs-identifier hs-var">cir</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-425"></span><span>    </span><span class="annot"><a href="Plutus.Contract.Effects.html#RedeemerHashResponse"><span class="hs-identifier hs-type">E.RedeemerHashResponse</span></a></span><span> </span><span id="local-6989586621680561176"><span class="annot"><span class="annottext">Maybe Redeemer
</span><a href="#local-6989586621680561176"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Redeemer -&gt; Contract w s e (Maybe Redeemer)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Redeemer
</span><a href="#local-6989586621680561176"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-426"></span><span>    </span><span id="local-6989586621680561175"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561175"><span class="hs-identifier hs-var">r</span></a></span></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e -&gt; Contract w s e (Maybe Redeemer)
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; Contract w s e (Maybe Redeemer))
-&gt; e -&gt; Contract w s e (Maybe Redeemer)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
-&gt; (Text, ChainIndexResponse) -&gt; e
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
forall r. AsContractError r =&gt; Prism' r (Text, ChainIndexResponse)
</span><a href="Plutus.Contract.Error.html#_ChainIndexContractError"><span class="hs-identifier hs-var">_ChainIndexContractError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;RedeemerHashResponse&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561175"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span class="annot"><a href="Plutus.Contract.Request.html#txOutFromRef"><span class="hs-identifier hs-type">txOutFromRef</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-429"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561174"><span class="annot"><a href="#local-6989586621680561174"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561173"><span class="annot"><a href="#local-6989586621680561173"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561172"><span class="annot"><a href="#local-6989586621680561172"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-430"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561172"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-431"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutRef</span></span><span>
</span><span id="line-433"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561174"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561173"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561172"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DecoratedTxOut</span></span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span id="txOutFromRef"><span class="annot"><span class="annottext">txOutFromRef :: TxOutRef -&gt; Contract w s e (Maybe DecoratedTxOut)
</span><a href="Plutus.Contract.Request.html#txOutFromRef"><span class="hs-identifier hs-var hs-var">txOutFromRef</span></a></span></span><span> </span><span id="local-6989586621680561171"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680561171"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-435"></span><span>  </span><span id="local-6989586621680561170"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561170"><span class="hs-identifier hs-var">cir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PABReq
-&gt; Prism' PABResp ChainIndexResponse
-&gt; Contract w s e ChainIndexResponse
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainIndexQuery -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#ChainIndexQueryReq"><span class="hs-identifier hs-var">ChainIndexQueryReq</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexQuery -&gt; PABReq) -&gt; ChainIndexQuery -&gt; PABReq
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; ChainIndexQuery
</span><a href="Plutus.Contract.Effects.html#TxOutFromRef"><span class="hs-identifier hs-var">E.TxOutFromRef</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680561171"><span class="hs-identifier hs-var">ref</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prism' PABResp ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#_ChainIndexQueryResp"><span class="hs-identifier hs-var">E._ChainIndexQueryResp</span></a></span><span>
</span><span id="line-436"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561170"><span class="hs-identifier hs-var">cir</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-437"></span><span>    </span><span class="annot"><a href="Plutus.Contract.Effects.html#TxOutRefResponse"><span class="hs-identifier hs-type">E.TxOutRefResponse</span></a></span><span> </span><span id="local-6989586621680561167"><span class="annot"><span class="annottext">Maybe DecoratedTxOut
</span><a href="#local-6989586621680561167"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe DecoratedTxOut -&gt; Contract w s e (Maybe DecoratedTxOut)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DecoratedTxOut
</span><a href="#local-6989586621680561167"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-438"></span><span>    </span><span id="local-6989586621680561166"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561166"><span class="hs-identifier hs-var">r</span></a></span></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e -&gt; Contract w s e (Maybe DecoratedTxOut)
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; Contract w s e (Maybe DecoratedTxOut))
-&gt; e -&gt; Contract w s e (Maybe DecoratedTxOut)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
-&gt; (Text, ChainIndexResponse) -&gt; e
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
forall r. AsContractError r =&gt; Prism' r (Text, ChainIndexResponse)
</span><a href="Plutus.Contract.Error.html#_ChainIndexContractError"><span class="hs-identifier hs-var">_ChainIndexContractError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;TxOutRefResponse&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561166"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span class="annot"><a href="Plutus.Contract.Request.html#unspentTxOutFromRef"><span class="hs-identifier hs-type">unspentTxOutFromRef</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-441"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561755"><span class="annot"><a href="#local-6989586621680561755"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561754"><span class="annot"><a href="#local-6989586621680561754"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561756"><span class="annot"><a href="#local-6989586621680561756"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-442"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561756"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-443"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutRef</span></span><span>
</span><span id="line-445"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561755"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561754"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561756"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DecoratedTxOut</span></span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span id="unspentTxOutFromRef"><span class="annot"><span class="annottext">unspentTxOutFromRef :: TxOutRef -&gt; Contract w s e (Maybe DecoratedTxOut)
</span><a href="Plutus.Contract.Request.html#unspentTxOutFromRef"><span class="hs-identifier hs-var hs-var">unspentTxOutFromRef</span></a></span></span><span> </span><span id="local-6989586621680561165"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680561165"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-447"></span><span>  </span><span id="local-6989586621680561164"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561164"><span class="hs-identifier hs-var">cir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PABReq
-&gt; Prism' PABResp ChainIndexResponse
-&gt; Contract w s e ChainIndexResponse
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainIndexQuery -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#ChainIndexQueryReq"><span class="hs-identifier hs-var">ChainIndexQueryReq</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexQuery -&gt; PABReq) -&gt; ChainIndexQuery -&gt; PABReq
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; ChainIndexQuery
</span><a href="Plutus.Contract.Effects.html#UnspentTxOutFromRef"><span class="hs-identifier hs-var">E.UnspentTxOutFromRef</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680561165"><span class="hs-identifier hs-var">ref</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prism' PABResp ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#_ChainIndexQueryResp"><span class="hs-identifier hs-var">E._ChainIndexQueryResp</span></a></span><span>
</span><span id="line-448"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561164"><span class="hs-identifier hs-var">cir</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-449"></span><span>    </span><span class="annot"><a href="Plutus.Contract.Effects.html#UnspentTxOutResponse"><span class="hs-identifier hs-type">E.UnspentTxOutResponse</span></a></span><span> </span><span id="local-6989586621680561161"><span class="annot"><span class="annottext">Maybe DecoratedTxOut
</span><a href="#local-6989586621680561161"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe DecoratedTxOut -&gt; Contract w s e (Maybe DecoratedTxOut)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DecoratedTxOut
</span><a href="#local-6989586621680561161"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-450"></span><span>    </span><span id="local-6989586621680561160"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561160"><span class="hs-identifier hs-var">r</span></a></span></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e -&gt; Contract w s e (Maybe DecoratedTxOut)
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; Contract w s e (Maybe DecoratedTxOut))
-&gt; e -&gt; Contract w s e (Maybe DecoratedTxOut)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
-&gt; (Text, ChainIndexResponse) -&gt; e
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
forall r. AsContractError r =&gt; Prism' r (Text, ChainIndexResponse)
</span><a href="Plutus.Contract.Error.html#_ChainIndexContractError"><span class="hs-identifier hs-var">_ChainIndexContractError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;UnspentTxOutResponse&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561160"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span class="annot"><a href="Plutus.Contract.Request.html#txFromTxId"><span class="hs-identifier hs-type">txFromTxId</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-453"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561764"><span class="annot"><a href="#local-6989586621680561764"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561763"><span class="annot"><a href="#local-6989586621680561763"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561765"><span class="annot"><a href="#local-6989586621680561765"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-454"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561765"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-455"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxId</span></span><span>
</span><span id="line-457"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561764"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561763"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561765"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChainIndexTx</span></span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span id="txFromTxId"><span class="annot"><span class="annottext">txFromTxId :: TxId -&gt; Contract w s e (Maybe ChainIndexTx)
</span><a href="Plutus.Contract.Request.html#txFromTxId"><span class="hs-identifier hs-var hs-var">txFromTxId</span></a></span></span><span> </span><span id="local-6989586621680561159"><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621680561159"><span class="hs-identifier hs-var">txid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-459"></span><span>  </span><span id="local-6989586621680561158"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561158"><span class="hs-identifier hs-var">cir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PABReq
-&gt; Prism' PABResp ChainIndexResponse
-&gt; Contract w s e ChainIndexResponse
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainIndexQuery -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#ChainIndexQueryReq"><span class="hs-identifier hs-var">ChainIndexQueryReq</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexQuery -&gt; PABReq) -&gt; ChainIndexQuery -&gt; PABReq
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxId -&gt; ChainIndexQuery
</span><a href="Plutus.Contract.Effects.html#TxFromTxId"><span class="hs-identifier hs-var">E.TxFromTxId</span></a></span><span> </span><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621680561159"><span class="hs-identifier hs-var">txid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prism' PABResp ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#_ChainIndexQueryResp"><span class="hs-identifier hs-var">E._ChainIndexQueryResp</span></a></span><span>
</span><span id="line-460"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561158"><span class="hs-identifier hs-var">cir</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-461"></span><span>    </span><span class="annot"><a href="Plutus.Contract.Effects.html#TxIdResponse"><span class="hs-identifier hs-type">E.TxIdResponse</span></a></span><span> </span><span id="local-6989586621680561155"><span class="annot"><span class="annottext">Maybe ChainIndexTx
</span><a href="#local-6989586621680561155"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ChainIndexTx -&gt; Contract w s e (Maybe ChainIndexTx)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ChainIndexTx
</span><a href="#local-6989586621680561155"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-462"></span><span>    </span><span id="local-6989586621680561154"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561154"><span class="hs-identifier hs-var">r</span></a></span></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e -&gt; Contract w s e (Maybe ChainIndexTx)
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; Contract w s e (Maybe ChainIndexTx))
-&gt; e -&gt; Contract w s e (Maybe ChainIndexTx)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
-&gt; (Text, ChainIndexResponse) -&gt; e
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
forall r. AsContractError r =&gt; Prism' r (Text, ChainIndexResponse)
</span><a href="Plutus.Contract.Error.html#_ChainIndexContractError"><span class="hs-identifier hs-var">_ChainIndexContractError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;TxIdResponse&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561154"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>
</span><span id="line-464"></span><span class="annot"><a href="Plutus.Contract.Request.html#utxoRefMembership"><span class="hs-identifier hs-type">utxoRefMembership</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-465"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561153"><span class="annot"><a href="#local-6989586621680561153"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561152"><span class="annot"><a href="#local-6989586621680561152"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561151"><span class="annot"><a href="#local-6989586621680561151"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-466"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561151"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-467"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutRef</span></span><span>
</span><span id="line-469"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561153"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561152"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561151"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsUtxoResponse</span></span><span>
</span><span id="line-470"></span><span id="utxoRefMembership"><span class="annot"><span class="annottext">utxoRefMembership :: TxOutRef -&gt; Contract w s e IsUtxoResponse
</span><a href="Plutus.Contract.Request.html#utxoRefMembership"><span class="hs-identifier hs-var hs-var">utxoRefMembership</span></a></span></span><span> </span><span id="local-6989586621680561150"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680561150"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-471"></span><span>  </span><span id="local-6989586621680561149"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561149"><span class="hs-identifier hs-var">cir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PABReq
-&gt; Prism' PABResp ChainIndexResponse
-&gt; Contract w s e ChainIndexResponse
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainIndexQuery -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#ChainIndexQueryReq"><span class="hs-identifier hs-var">ChainIndexQueryReq</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexQuery -&gt; PABReq) -&gt; ChainIndexQuery -&gt; PABReq
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; ChainIndexQuery
</span><a href="Plutus.Contract.Effects.html#UtxoSetMembership"><span class="hs-identifier hs-var">E.UtxoSetMembership</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680561150"><span class="hs-identifier hs-var">ref</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prism' PABResp ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#_ChainIndexQueryResp"><span class="hs-identifier hs-var">E._ChainIndexQueryResp</span></a></span><span>
</span><span id="line-472"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561149"><span class="hs-identifier hs-var">cir</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-473"></span><span>    </span><span class="annot"><a href="Plutus.Contract.Effects.html#UtxoSetMembershipResponse"><span class="hs-identifier hs-type">E.UtxoSetMembershipResponse</span></a></span><span> </span><span id="local-6989586621680561146"><span class="annot"><span class="annottext">IsUtxoResponse
</span><a href="#local-6989586621680561146"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IsUtxoResponse -&gt; Contract w s e IsUtxoResponse
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">IsUtxoResponse
</span><a href="#local-6989586621680561146"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-474"></span><span>    </span><span id="local-6989586621680561145"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561145"><span class="hs-identifier hs-var">r</span></a></span></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e -&gt; Contract w s e IsUtxoResponse
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; Contract w s e IsUtxoResponse)
-&gt; e -&gt; Contract w s e IsUtxoResponse
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
-&gt; (Text, ChainIndexResponse) -&gt; e
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
forall r. AsContractError r =&gt; Prism' r (Text, ChainIndexResponse)
</span><a href="Plutus.Contract.Error.html#_ChainIndexContractError"><span class="hs-identifier hs-var">_ChainIndexContractError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;UtxoSetMembershipResponse&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561145"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>
</span><span id="line-476"></span><span class="hs-comment">-- | Get the unspent transaction output references at an address.</span><span>
</span><span id="line-477"></span><span class="annot"><a href="Plutus.Contract.Request.html#utxoRefsAt"><span class="hs-identifier hs-type">utxoRefsAt</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-478"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561144"><span class="annot"><a href="#local-6989586621680561144"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561143"><span class="annot"><a href="#local-6989586621680561143"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561142"><span class="annot"><a href="#local-6989586621680561142"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-479"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561142"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-480"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PageQuery</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutRef</span></span><span>
</span><span id="line-482"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAddress</span></span><span>
</span><span id="line-483"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561144"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561143"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561142"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UtxosResponse</span></span><span>
</span><span id="line-484"></span><span id="utxoRefsAt"><span class="annot"><span class="annottext">utxoRefsAt :: PageQuery TxOutRef
-&gt; CardanoAddress -&gt; Contract w s e UtxosResponse
</span><a href="Plutus.Contract.Request.html#utxoRefsAt"><span class="hs-identifier hs-var hs-var">utxoRefsAt</span></a></span></span><span> </span><span id="local-6989586621680561141"><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680561141"><span class="hs-identifier hs-var">pq</span></a></span></span><span> </span><span id="local-6989586621680561140"><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680561140"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-485"></span><span>  </span><span id="local-6989586621680561139"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561139"><span class="hs-identifier hs-var">cir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PABReq
-&gt; Prism' PABResp ChainIndexResponse
-&gt; Contract w s e ChainIndexResponse
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainIndexQuery -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#ChainIndexQueryReq"><span class="hs-identifier hs-var">ChainIndexQueryReq</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexQuery -&gt; PABReq) -&gt; ChainIndexQuery -&gt; PABReq
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef -&gt; CardanoAddress -&gt; ChainIndexQuery
</span><a href="Plutus.Contract.Effects.html#UtxoSetAtAddress"><span class="hs-identifier hs-var">E.UtxoSetAtAddress</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680561141"><span class="hs-identifier hs-var">pq</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680561140"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prism' PABResp ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#_ChainIndexQueryResp"><span class="hs-identifier hs-var">E._ChainIndexQueryResp</span></a></span><span>
</span><span id="line-486"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561139"><span class="hs-identifier hs-var">cir</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-487"></span><span>    </span><span class="annot"><a href="Plutus.Contract.Effects.html#UtxoSetAtResponse"><span class="hs-identifier hs-type">E.UtxoSetAtResponse</span></a></span><span> </span><span id="local-6989586621680561136"><span class="annot"><span class="annottext">UtxosResponse
</span><a href="#local-6989586621680561136"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UtxosResponse -&gt; Contract w s e UtxosResponse
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">UtxosResponse
</span><a href="#local-6989586621680561136"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-488"></span><span>    </span><span id="local-6989586621680561135"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561135"><span class="hs-identifier hs-var">r</span></a></span></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e -&gt; Contract w s e UtxosResponse
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; Contract w s e UtxosResponse)
-&gt; e -&gt; Contract w s e UtxosResponse
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
-&gt; (Text, ChainIndexResponse) -&gt; e
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
forall r. AsContractError r =&gt; Prism' r (Text, ChainIndexResponse)
</span><a href="Plutus.Contract.Error.html#_ChainIndexContractError"><span class="hs-identifier hs-var">_ChainIndexContractError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;UtxoSetAtResponse&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561135"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span>
</span><span id="line-490"></span><span class="hs-comment">-- | Get the unspent transaction output references with a specific currrency ('AssetClass').</span><span>
</span><span id="line-491"></span><span class="annot"><a href="Plutus.Contract.Request.html#utxoRefsWithCurrency"><span class="hs-identifier hs-type">utxoRefsWithCurrency</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-492"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561134"><span class="annot"><a href="#local-6989586621680561134"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561133"><span class="annot"><a href="#local-6989586621680561133"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561132"><span class="annot"><a href="#local-6989586621680561132"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-493"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561132"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-494"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-495"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PageQuery</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutRef</span></span><span>
</span><span id="line-496"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AssetClass</span></span><span>
</span><span id="line-497"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561134"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561133"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561132"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UtxosResponse</span></span><span>
</span><span id="line-498"></span><span id="utxoRefsWithCurrency"><span class="annot"><span class="annottext">utxoRefsWithCurrency :: PageQuery TxOutRef -&gt; AssetClass -&gt; Contract w s e UtxosResponse
</span><a href="Plutus.Contract.Request.html#utxoRefsWithCurrency"><span class="hs-identifier hs-var hs-var">utxoRefsWithCurrency</span></a></span></span><span> </span><span id="local-6989586621680561131"><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680561131"><span class="hs-identifier hs-var">pq</span></a></span></span><span> </span><span id="local-6989586621680561130"><span class="annot"><span class="annottext">AssetClass
</span><a href="#local-6989586621680561130"><span class="hs-identifier hs-var">assetClass</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-499"></span><span>  </span><span id="local-6989586621680561129"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561129"><span class="hs-identifier hs-var">cir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PABReq
-&gt; Prism' PABResp ChainIndexResponse
-&gt; Contract w s e ChainIndexResponse
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainIndexQuery -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#ChainIndexQueryReq"><span class="hs-identifier hs-var">ChainIndexQueryReq</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexQuery -&gt; PABReq) -&gt; ChainIndexQuery -&gt; PABReq
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef -&gt; AssetClass -&gt; ChainIndexQuery
</span><a href="Plutus.Contract.Effects.html#UtxoSetWithCurrency"><span class="hs-identifier hs-var">E.UtxoSetWithCurrency</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680561131"><span class="hs-identifier hs-var">pq</span></a></span><span> </span><span class="annot"><span class="annottext">AssetClass
</span><a href="#local-6989586621680561130"><span class="hs-identifier hs-var">assetClass</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prism' PABResp ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#_ChainIndexQueryResp"><span class="hs-identifier hs-var">E._ChainIndexQueryResp</span></a></span><span>
</span><span id="line-500"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561129"><span class="hs-identifier hs-var">cir</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-501"></span><span>    </span><span class="annot"><a href="Plutus.Contract.Effects.html#UtxoSetWithCurrencyResponse"><span class="hs-identifier hs-type">E.UtxoSetWithCurrencyResponse</span></a></span><span> </span><span id="local-6989586621680561126"><span class="annot"><span class="annottext">UtxosResponse
</span><a href="#local-6989586621680561126"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UtxosResponse -&gt; Contract w s e UtxosResponse
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">UtxosResponse
</span><a href="#local-6989586621680561126"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-502"></span><span>    </span><span id="local-6989586621680561125"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561125"><span class="hs-identifier hs-var">r</span></a></span></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e -&gt; Contract w s e UtxosResponse
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; Contract w s e UtxosResponse)
-&gt; e -&gt; Contract w s e UtxosResponse
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
-&gt; (Text, ChainIndexResponse) -&gt; e
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
forall r. AsContractError r =&gt; Prism' r (Text, ChainIndexResponse)
</span><a href="Plutus.Contract.Error.html#_ChainIndexContractError"><span class="hs-identifier hs-var">_ChainIndexContractError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;UtxoSetWithCurrencyResponse&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561125"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span class="hs-comment">-- | Get all utxos belonging to the wallet that runs this contract.</span><span>
</span><span id="line-505"></span><span class="annot"><a href="Plutus.Contract.Request.html#ownUtxos"><span class="hs-identifier hs-type">ownUtxos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561836"><span class="annot"><a href="#local-6989586621680561836"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561835"><span class="annot"><a href="#local-6989586621680561835"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561837"><span class="annot"><a href="#local-6989586621680561837"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561837"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561836"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561835"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561837"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutRef</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DecoratedTxOut</span></span><span class="hs-special">)</span><span>
</span><span id="line-506"></span><span id="ownUtxos"><span class="annot"><span class="annottext">ownUtxos :: Contract w s e (Map TxOutRef DecoratedTxOut)
</span><a href="Plutus.Contract.Request.html#ownUtxos"><span class="hs-identifier hs-var hs-var">ownUtxos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-507"></span><span>    </span><span id="local-6989586621680561124"><span class="annot"><span class="annottext">NonEmpty CardanoAddress
</span><a href="#local-6989586621680561124"><span class="hs-identifier hs-var">addrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Contract w s e (NonEmpty CardanoAddress)
forall w (s :: Row *) e.
AsContractError e =&gt;
Contract w s e (NonEmpty CardanoAddress)
</span><a href="Plutus.Contract.Request.html#ownAddresses"><span class="hs-identifier hs-var">ownAddresses</span></a></span><span>
</span><span id="line-508"></span><span>    </span><span class="annot"><span class="annottext">[Map TxOutRef DecoratedTxOut] -&gt; Map TxOutRef DecoratedTxOut
forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">([Map TxOutRef DecoratedTxOut] -&gt; Map TxOutRef DecoratedTxOut)
-&gt; Contract w s e [Map TxOutRef DecoratedTxOut]
-&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(CardanoAddress -&gt; Contract w s e (Map TxOutRef DecoratedTxOut))
-&gt; [CardanoAddress] -&gt; Contract w s e [Map TxOutRef DecoratedTxOut]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress -&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
forall w (s :: Row *) e.
AsContractError e =&gt;
CardanoAddress -&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
</span><a href="Plutus.Contract.Request.html#utxosAt"><span class="hs-identifier hs-var">utxosAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty CardanoAddress -&gt; [CardanoAddress]
forall a. NonEmpty a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">NonEmpty.toList</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty CardanoAddress
</span><a href="#local-6989586621680561124"><span class="hs-identifier hs-var">addrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span class="hs-comment">-- | Get an unspent output belonging to the wallet.</span><span>
</span><span id="line-511"></span><span id="local-6989586621680561119"><span id="local-6989586621680561120"><span id="local-6989586621680561121"><span class="annot"><a href="Plutus.Contract.Request.html#getUnspentOutput"><span class="hs-identifier hs-type">getUnspentOutput</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561121"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561120"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561119"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561121"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutRef</span></span></span></span></span><span>
</span><span id="line-512"></span><span id="getUnspentOutput"><span class="annot"><span class="annottext">getUnspentOutput :: Contract w s e TxOutRef
</span><a href="Plutus.Contract.Request.html#getUnspentOutput"><span class="hs-identifier hs-var hs-var">getUnspentOutput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-513"></span><span>    </span><span id="local-6989586621680561118"><span class="annot"><span class="annottext">Map TxOutRef DecoratedTxOut
</span><a href="#local-6989586621680561118"><span class="hs-identifier hs-var">utxos</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Contract w s e (Map TxOutRef DecoratedTxOut)
forall w (s :: Row *) e.
AsContractError e =&gt;
Contract w s e (Map TxOutRef DecoratedTxOut)
</span><a href="Plutus.Contract.Request.html#ownUtxos"><span class="hs-identifier hs-var">ownUtxos</span></a></span><span>
</span><span id="line-514"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Map TxOutRef DecoratedTxOut -&gt; [TxOutRef]
forall k a. Map k a -&gt; [k]
</span><span class="hs-identifier hs-var">Map.keys</span></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef DecoratedTxOut
</span><a href="#local-6989586621680561118"><span class="hs-identifier hs-var">utxos</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-515"></span><span>        </span><span id="local-6989586621680561116"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680561116"><span class="hs-identifier hs-var">inp</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOutRef]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; Contract w s e TxOutRef
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>  </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680561116"><span class="hs-identifier hs-var">inp</span></a></span><span>
</span><span id="line-516"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e -&gt; Contract w s e TxOutRef
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; Contract w s e TxOutRef) -&gt; e -&gt; Contract w s e TxOutRef
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AReview e Text -&gt; Text -&gt; e
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview e Text
forall r. AsContractError r =&gt; Prism' r Text
</span><a href="Plutus.Contract.Error.html#_OtherContractError"><span class="hs-identifier hs-var">_OtherContractError</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Balanced transaction has no inputs&quot;</span></span><span>
</span><span id="line-517"></span><span>
</span><span id="line-518"></span><span class="hs-comment">-- | Get all the unspent transaction output at an address w.r.t. a page query TxOutRef</span><span>
</span><span id="line-519"></span><span class="annot"><a href="Plutus.Contract.Request.html#queryUnspentTxOutsAt"><span class="hs-identifier hs-type">queryUnspentTxOutsAt</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-520"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561785"><span class="annot"><a href="#local-6989586621680561785"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561784"><span class="annot"><a href="#local-6989586621680561784"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561786"><span class="annot"><a href="#local-6989586621680561786"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-521"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561786"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-522"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-523"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAddress</span></span><span>
</span><span id="line-524"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PageQuery</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutRef</span></span><span>
</span><span id="line-525"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561785"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561784"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561786"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">QueryResponse</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxOutRef</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DecoratedTxOut</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-526"></span><span id="queryUnspentTxOutsAt"><span class="annot"><span class="annottext">queryUnspentTxOutsAt :: CardanoAddress
-&gt; PageQuery TxOutRef
-&gt; Contract w s e (QueryResponse [(TxOutRef, DecoratedTxOut)])
</span><a href="Plutus.Contract.Request.html#queryUnspentTxOutsAt"><span class="hs-identifier hs-var hs-var">queryUnspentTxOutsAt</span></a></span></span><span> </span><span id="local-6989586621680561114"><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680561114"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621680561113"><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680561113"><span class="hs-identifier hs-var">pq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-527"></span><span>  </span><span id="local-6989586621680561112"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561112"><span class="hs-identifier hs-var">cir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PABReq
-&gt; Prism' PABResp ChainIndexResponse
-&gt; Contract w s e ChainIndexResponse
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainIndexQuery -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#ChainIndexQueryReq"><span class="hs-identifier hs-var">ChainIndexQueryReq</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexQuery -&gt; PABReq) -&gt; ChainIndexQuery -&gt; PABReq
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef -&gt; CardanoAddress -&gt; ChainIndexQuery
</span><a href="Plutus.Contract.Effects.html#UnspentTxOutSetAtAddress"><span class="hs-identifier hs-var">E.UnspentTxOutSetAtAddress</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680561113"><span class="hs-identifier hs-var">pq</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680561114"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prism' PABResp ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#_ChainIndexQueryResp"><span class="hs-identifier hs-var">E._ChainIndexQueryResp</span></a></span><span>
</span><span id="line-528"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561112"><span class="hs-identifier hs-var">cir</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-529"></span><span>    </span><span class="annot"><a href="Plutus.Contract.Effects.html#UnspentTxOutsAtResponse"><span class="hs-identifier hs-type">E.UnspentTxOutsAtResponse</span></a></span><span> </span><span id="local-6989586621680561109"><span class="annot"><span class="annottext">QueryResponse [(TxOutRef, DecoratedTxOut)]
</span><a href="#local-6989586621680561109"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QueryResponse [(TxOutRef, DecoratedTxOut)]
-&gt; Contract w s e (QueryResponse [(TxOutRef, DecoratedTxOut)])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">QueryResponse [(TxOutRef, DecoratedTxOut)]
</span><a href="#local-6989586621680561109"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-530"></span><span>    </span><span id="local-6989586621680561108"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561108"><span class="hs-identifier hs-var">r</span></a></span></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e -&gt; Contract w s e (QueryResponse [(TxOutRef, DecoratedTxOut)])
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; Contract w s e (QueryResponse [(TxOutRef, DecoratedTxOut)]))
-&gt; e -&gt; Contract w s e (QueryResponse [(TxOutRef, DecoratedTxOut)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
-&gt; (Text, ChainIndexResponse) -&gt; e
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
forall r. AsContractError r =&gt; Prism' r (Text, ChainIndexResponse)
</span><a href="Plutus.Contract.Error.html#_ChainIndexContractError"><span class="hs-identifier hs-var">_ChainIndexContractError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;UnspentTxOutAtResponse&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561108"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span>
</span><span id="line-532"></span><span class="hs-comment">-- | Find the reference to an utxo containing a reference script</span><span>
</span><span id="line-533"></span><span class="hs-comment">-- by its the script hash, amongst the utxos at a given address</span><span>
</span><span id="line-534"></span><span class="annot"><a href="Plutus.Contract.Request.html#findReferenceValidatorScripByHash"><span class="hs-identifier hs-type">findReferenceValidatorScripByHash</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-535"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561107"><span class="annot"><a href="#local-6989586621680561107"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561106"><span class="annot"><a href="#local-6989586621680561106"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561105"><span class="annot"><a href="#local-6989586621680561105"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-536"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561105"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-537"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-538"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ValidatorHash</span></span><span>
</span><span id="line-539"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAddress</span></span><span>
</span><span id="line-540"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561107"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561106"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561105"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutRef</span></span><span>
</span><span id="line-541"></span><span id="findReferenceValidatorScripByHash"><span class="annot"><span class="annottext">findReferenceValidatorScripByHash :: ValidatorHash -&gt; CardanoAddress -&gt; Contract w s e TxOutRef
</span><a href="Plutus.Contract.Request.html#findReferenceValidatorScripByHash"><span class="hs-identifier hs-var hs-var">findReferenceValidatorScripByHash</span></a></span></span><span> </span><span id="local-6989586621680561104"><span class="annot"><span class="annottext">ValidatorHash
</span><a href="#local-6989586621680561104"><span class="hs-identifier hs-var">hash</span></a></span></span><span> </span><span id="local-6989586621680561103"><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680561103"><span class="hs-identifier hs-var">address</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-542"></span><span>    </span><span id="local-6989586621680561102"><span class="annot"><span class="annottext">Map TxOutRef DecoratedTxOut
</span><a href="#local-6989586621680561102"><span class="hs-identifier hs-var">utxos</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CardanoAddress -&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
forall w (s :: Row *) e.
AsContractError e =&gt;
CardanoAddress -&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
</span><a href="Plutus.Contract.Request.html#utxosAt"><span class="hs-identifier hs-var">utxosAt</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680561103"><span class="hs-identifier hs-var">address</span></a></span><span>
</span><span id="line-543"></span><span>    </span><span class="annot"><span class="annottext">Contract w s e TxOutRef
-&gt; (TxOutRef -&gt; Contract w s e TxOutRef)
-&gt; Maybe TxOutRef
-&gt; Contract w s e TxOutRef
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span>
</span><span id="line-544"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">e -&gt; Contract w s e TxOutRef
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; Contract w s e TxOutRef) -&gt; e -&gt; Contract w s e TxOutRef
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AReview e ContractError -&gt; ContractError -&gt; e
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview e ContractError
forall r. AsContractError r =&gt; Prism' r ContractError
</span><a href="Plutus.Contract.Error.html#_ContractError"><span class="hs-identifier hs-var">_ContractError</span></a></span><span> </span><span class="annot"><span class="annottext">(ContractError -&gt; e) -&gt; ContractError -&gt; e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ContractError
</span><a href="Plutus.Contract.Error.html#OtherContractError"><span class="hs-identifier hs-var">OtherContractError</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Enable to find the referenc script&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-545"></span><span>      </span><span class="annot"><span class="annottext">TxOutRef -&gt; Contract w s e TxOutRef
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-546"></span><span>      </span><span class="annot"><span class="annottext">(Maybe TxOutRef -&gt; Contract w s e TxOutRef)
-&gt; Maybe TxOutRef -&gt; Contract w s e TxOutRef
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ValidatorHash -&gt; Map TxOutRef DecoratedTxOut -&gt; Maybe TxOutRef
</span><a href="#local-6989586621680561100"><span class="hs-identifier hs-var">searchReferenceScript</span></a></span><span> </span><span class="annot"><span class="annottext">ValidatorHash
</span><a href="#local-6989586621680561104"><span class="hs-identifier hs-var">hash</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef DecoratedTxOut
</span><a href="#local-6989586621680561102"><span class="hs-identifier hs-var">utxos</span></a></span><span>
</span><span id="line-547"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-548"></span><span>        </span><span class="annot"><a href="#local-6989586621680561100"><span class="hs-identifier hs-type">searchReferenceScript</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ValidatorHash</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutRef</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DecoratedTxOut</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutRef</span></span><span>
</span><span id="line-549"></span><span>        </span><span id="local-6989586621680561100"><span class="annot"><span class="annottext">searchReferenceScript :: ValidatorHash -&gt; Map TxOutRef DecoratedTxOut -&gt; Maybe TxOutRef
</span><a href="#local-6989586621680561100"><span class="hs-identifier hs-var hs-var">searchReferenceScript</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ValidatorHash</span></span><span> </span><span id="local-6989586621680561099"><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="#local-6989586621680561099"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-550"></span><span>            </span><span id="local-6989586621680561098"><span class="annot"><span class="annottext">getReferenceScriptHash :: (() -&gt; Const (First ()) ())
-&gt; (TxOutRef, DecoratedTxOut)
-&gt; Const (First ()) (TxOutRef, DecoratedTxOut)
</span><a href="#local-6989586621680561098"><span class="hs-identifier hs-var hs-var">getReferenceScriptHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DecoratedTxOut -&gt; Const (First ()) DecoratedTxOut)
-&gt; (TxOutRef, DecoratedTxOut)
-&gt; Const (First ()) (TxOutRef, DecoratedTxOut)
forall s t a b. Field2 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_2</span></span><span> </span><span class="annot"><span class="annottext">((DecoratedTxOut -&gt; Const (First ()) DecoratedTxOut)
 -&gt; (TxOutRef, DecoratedTxOut)
 -&gt; Const (First ()) (TxOutRef, DecoratedTxOut))
-&gt; ((() -&gt; Const (First ()) ())
    -&gt; DecoratedTxOut -&gt; Const (First ()) DecoratedTxOut)
-&gt; (() -&gt; Const (First ()) ())
-&gt; (TxOutRef, DecoratedTxOut)
-&gt; Const (First ()) (TxOutRef, DecoratedTxOut)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Versioned Script)
 -&gt; Const (First ()) (Maybe (Versioned Script)))
-&gt; DecoratedTxOut -&gt; Const (First ()) DecoratedTxOut
Lens' DecoratedTxOut (Maybe (Versioned Script))
</span><span class="hs-identifier hs-var">decoratedTxOutReferenceScript</span></span><span>
</span><span id="line-551"></span><span>                </span><span class="annot"><span class="annottext">((Maybe (Versioned Script)
  -&gt; Const (First ()) (Maybe (Versioned Script)))
 -&gt; DecoratedTxOut -&gt; Const (First ()) DecoratedTxOut)
-&gt; ((() -&gt; Const (First ()) ())
    -&gt; Maybe (Versioned Script)
    -&gt; Const (First ()) (Maybe (Versioned Script)))
-&gt; (() -&gt; Const (First ()) ())
-&gt; DecoratedTxOut
-&gt; Const (First ()) DecoratedTxOut
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Versioned Script -&gt; Const (First ()) (Versioned Script))
-&gt; Maybe (Versioned Script)
-&gt; Const (First ()) (Maybe (Versioned Script))
forall a b. Prism (Maybe a) (Maybe b) a b
</span><span class="hs-identifier hs-var">_Just</span></span><span> </span><span class="annot"><span class="annottext">((Versioned Script -&gt; Const (First ()) (Versioned Script))
 -&gt; Maybe (Versioned Script)
 -&gt; Const (First ()) (Maybe (Versioned Script)))
-&gt; ((() -&gt; Const (First ()) ())
    -&gt; Versioned Script -&gt; Const (First ()) (Versioned Script))
-&gt; (() -&gt; Const (First ()) ())
-&gt; Maybe (Versioned Script)
-&gt; Const (First ()) (Maybe (Versioned Script))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Versioned Script -&gt; BuiltinByteString)
-&gt; Optic'
     (-&gt;) (Const (First ())) (Versioned Script) BuiltinByteString
forall (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s a.
(Profunctor p, Contravariant f) =&gt;
(s -&gt; a) -&gt; Optic' p f s a
</span><span class="hs-identifier hs-var">to</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScriptHash -&gt; BuiltinByteString
</span><span class="hs-identifier hs-var hs-var">getScriptHash</span></span><span> </span><span class="annot"><span class="annottext">(ScriptHash -&gt; BuiltinByteString)
-&gt; (Versioned Script -&gt; ScriptHash)
-&gt; Versioned Script
-&gt; BuiltinByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Versioned Script -&gt; ScriptHash
</span><span class="hs-identifier hs-var">scriptHash</span></span><span class="hs-special">)</span><span>
</span><span id="line-552"></span><span>                </span><span class="annot"><span class="annottext">Optic' (-&gt;) (Const (First ())) (Versioned Script) BuiltinByteString
-&gt; ((() -&gt; Const (First ()) ())
    -&gt; BuiltinByteString -&gt; Const (First ()) BuiltinByteString)
-&gt; (() -&gt; Const (First ()) ())
-&gt; Versioned Script
-&gt; Const (First ()) (Versioned Script)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinByteString -&gt; Prism' BuiltinByteString ()
forall a. Eq a =&gt; a -&gt; Prism' a ()
</span><span class="hs-identifier hs-var">only</span></span><span> </span><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="#local-6989586621680561099"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-553"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">((TxOutRef, DecoratedTxOut) -&gt; TxOutRef)
-&gt; Maybe (TxOutRef, DecoratedTxOut) -&gt; Maybe TxOutRef
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOutRef, DecoratedTxOut) -&gt; TxOutRef
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span>
</span><span id="line-554"></span><span>            </span><span class="annot"><span class="annottext">(Maybe (TxOutRef, DecoratedTxOut) -&gt; Maybe TxOutRef)
-&gt; (Map TxOutRef DecoratedTxOut
    -&gt; Maybe (TxOutRef, DecoratedTxOut))
-&gt; Map TxOutRef DecoratedTxOut
-&gt; Maybe TxOutRef
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((TxOutRef, DecoratedTxOut) -&gt; Bool)
-&gt; [(TxOutRef, DecoratedTxOut)] -&gt; Maybe (TxOutRef, DecoratedTxOut)
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">find</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe () -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">isJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe () -&gt; Bool)
-&gt; ((TxOutRef, DecoratedTxOut) -&gt; Maybe ())
-&gt; (TxOutRef, DecoratedTxOut)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((() -&gt; Const (First ()) ())
 -&gt; (TxOutRef, DecoratedTxOut)
 -&gt; Const (First ()) (TxOutRef, DecoratedTxOut))
-&gt; (TxOutRef, DecoratedTxOut) -&gt; Maybe ()
forall s (m :: * -&gt; *) a.
MonadReader s m =&gt;
Getting (First a) s a -&gt; m (Maybe a)
</span><span class="hs-identifier hs-var">preview</span></span><span> </span><span class="annot"><span class="annottext">(() -&gt; Const (First ()) ())
-&gt; (TxOutRef, DecoratedTxOut)
-&gt; Const (First ()) (TxOutRef, DecoratedTxOut)
</span><a href="#local-6989586621680561098"><span class="hs-identifier hs-var">getReferenceScriptHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-555"></span><span>            </span><span class="annot"><span class="annottext">([(TxOutRef, DecoratedTxOut)] -&gt; Maybe (TxOutRef, DecoratedTxOut))
-&gt; (Map TxOutRef DecoratedTxOut -&gt; [(TxOutRef, DecoratedTxOut)])
-&gt; Map TxOutRef DecoratedTxOut
-&gt; Maybe (TxOutRef, DecoratedTxOut)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef DecoratedTxOut -&gt; [(TxOutRef, DecoratedTxOut)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span>
</span><span id="line-556"></span><span>
</span><span id="line-557"></span><span class="hs-comment">-- | Get the unspent transaction outputs at an address.</span><span>
</span><span id="line-558"></span><span class="annot"><a href="Plutus.Contract.Request.html#utxosAt"><span class="hs-identifier hs-type">utxosAt</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-559"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561843"><span class="annot"><a href="#local-6989586621680561843"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561842"><span class="annot"><a href="#local-6989586621680561842"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561844"><span class="annot"><a href="#local-6989586621680561844"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-560"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561844"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-561"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-562"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAddress</span></span><span>
</span><span id="line-563"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561843"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561842"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561844"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutRef</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DecoratedTxOut</span></span><span class="hs-special">)</span><span>
</span><span id="line-564"></span><span id="utxosAt"><span class="annot"><span class="annottext">utxosAt :: CardanoAddress -&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
</span><a href="Plutus.Contract.Request.html#utxosAt"><span class="hs-identifier hs-var hs-var">utxosAt</span></a></span></span><span> </span><span id="local-6989586621680561096"><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680561096"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-565"></span><span>  </span><span class="annot"><span class="annottext">[(TxOutRef, DecoratedTxOut)] -&gt; Map TxOutRef DecoratedTxOut
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(TxOutRef, DecoratedTxOut)] -&gt; Map TxOutRef DecoratedTxOut)
-&gt; ([[(TxOutRef, DecoratedTxOut)]] -&gt; [(TxOutRef, DecoratedTxOut)])
-&gt; [[(TxOutRef, DecoratedTxOut)]]
-&gt; Map TxOutRef DecoratedTxOut
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[[(TxOutRef, DecoratedTxOut)]] -&gt; [(TxOutRef, DecoratedTxOut)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">([[(TxOutRef, DecoratedTxOut)]] -&gt; Map TxOutRef DecoratedTxOut)
-&gt; Contract w s e [[(TxOutRef, DecoratedTxOut)]]
-&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(PageQuery TxOutRef
 -&gt; Contract w s e (QueryResponse [(TxOutRef, DecoratedTxOut)]))
-&gt; Contract w s e [[(TxOutRef, DecoratedTxOut)]]
forall (m :: * -&gt; *) a.
Monad m =&gt;
(PageQuery TxOutRef -&gt; m (QueryResponse a)) -&gt; m [a]
</span><span class="hs-identifier hs-var">collectQueryResponse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardanoAddress
-&gt; PageQuery TxOutRef
-&gt; Contract w s e (QueryResponse [(TxOutRef, DecoratedTxOut)])
forall w (s :: Row *) e.
AsContractError e =&gt;
CardanoAddress
-&gt; PageQuery TxOutRef
-&gt; Contract w s e (QueryResponse [(TxOutRef, DecoratedTxOut)])
</span><a href="Plutus.Contract.Request.html#queryUnspentTxOutsAt"><span class="hs-identifier hs-var">queryUnspentTxOutsAt</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680561096"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span class="hs-comment">-- | Get unspent transaction outputs with transaction from address.</span><span>
</span><span id="line-568"></span><span class="annot"><a href="Plutus.Contract.Request.html#utxosTxOutTxAt"><span class="hs-identifier hs-type">utxosTxOutTxAt</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-569"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561094"><span class="annot"><a href="#local-6989586621680561094"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561093"><span class="annot"><a href="#local-6989586621680561093"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561092"><span class="annot"><a href="#local-6989586621680561092"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-570"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561092"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-571"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-572"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAddress</span></span><span>
</span><span id="line-573"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561094"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561093"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561092"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutRef</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DecoratedTxOut</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChainIndexTx</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-574"></span><span id="utxosTxOutTxAt"><span class="annot"><span class="annottext">utxosTxOutTxAt :: CardanoAddress
-&gt; Contract w s e (Map TxOutRef (DecoratedTxOut, ChainIndexTx))
</span><a href="Plutus.Contract.Request.html#utxosTxOutTxAt"><span class="hs-identifier hs-var hs-var">utxosTxOutTxAt</span></a></span></span><span> </span><span id="local-6989586621680561091"><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680561091"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-575"></span><span>  </span><span id="local-6989586621680561090"><span class="annot"><span class="annottext">Map TxOutRef DecoratedTxOut
</span><a href="#local-6989586621680561090"><span class="hs-identifier hs-var">utxos</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CardanoAddress -&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
forall w (s :: Row *) e.
AsContractError e =&gt;
CardanoAddress -&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
</span><a href="Plutus.Contract.Request.html#utxosAt"><span class="hs-identifier hs-var">utxosAt</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680561091"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-576"></span><span>  </span><span class="annot"><span class="annottext">StateT
  (Map TxId ChainIndexTx)
  (Contract w s e)
  (Map TxOutRef (DecoratedTxOut, ChainIndexTx))
-&gt; Map TxId ChainIndexTx
-&gt; Contract w s e (Map TxOutRef (DecoratedTxOut, ChainIndexTx))
forall (m :: * -&gt; *) s a. Monad m =&gt; StateT s m a -&gt; s -&gt; m a
</span><span class="hs-identifier hs-var">evalStateT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxOutRef
 -&gt; DecoratedTxOut
 -&gt; StateT
      (Map TxId ChainIndexTx)
      (Contract w s e)
      (Maybe (DecoratedTxOut, ChainIndexTx)))
-&gt; Map TxOutRef DecoratedTxOut
-&gt; StateT
     (Map TxId ChainIndexTx)
     (Contract w s e)
     (Map TxOutRef (DecoratedTxOut, ChainIndexTx))
forall (f :: * -&gt; *) k a b.
Applicative f =&gt;
(k -&gt; a -&gt; f (Maybe b)) -&gt; Map k a -&gt; f (Map k b)
</span><span class="hs-identifier hs-var">Map.traverseMaybeWithKey</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef
-&gt; DecoratedTxOut
-&gt; StateT
     (Map TxId ChainIndexTx)
     (Contract w s e)
     (Maybe (DecoratedTxOut, ChainIndexTx))
</span><a href="#local-6989586621680561088"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef DecoratedTxOut
</span><a href="#local-6989586621680561090"><span class="hs-identifier hs-var">utxos</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map TxId ChainIndexTx
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-577"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-578"></span><span>    </span><span class="annot"><a href="#local-6989586621680561088"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutRef</span></span><span>
</span><span id="line-579"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DecoratedTxOut</span></span><span>
</span><span id="line-580"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxId</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChainIndexTx</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561094"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561093"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561092"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DecoratedTxOut</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChainIndexTx</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-581"></span><span>    </span><span id="local-6989586621680561088"><span class="annot"><span class="annottext">go :: TxOutRef
-&gt; DecoratedTxOut
-&gt; StateT
     (Map TxId ChainIndexTx)
     (Contract w s e)
     (Maybe (DecoratedTxOut, ChainIndexTx))
</span><a href="#local-6989586621680561088"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680561087"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680561087"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span id="local-6989586621680561086"><span class="annot"><span class="annottext">DecoratedTxOut
</span><a href="#local-6989586621680561086"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Map TxId ChainIndexTx
 -&gt; Contract
      w
      s
      e
      (Maybe (DecoratedTxOut, ChainIndexTx), Map TxId ChainIndexTx))
-&gt; StateT
     (Map TxId ChainIndexTx)
     (Contract w s e)
     (Maybe (DecoratedTxOut, ChainIndexTx))
forall s (m :: * -&gt; *) a. (s -&gt; m (a, s)) -&gt; StateT s m a
</span><span class="hs-identifier hs-var">StateT</span></span><span> </span><span class="annot"><span class="annottext">((Map TxId ChainIndexTx
  -&gt; Contract
       w
       s
       e
       (Maybe (DecoratedTxOut, ChainIndexTx), Map TxId ChainIndexTx))
 -&gt; StateT
      (Map TxId ChainIndexTx)
      (Contract w s e)
      (Maybe (DecoratedTxOut, ChainIndexTx)))
-&gt; (Map TxId ChainIndexTx
    -&gt; Contract
         w
         s
         e
         (Maybe (DecoratedTxOut, ChainIndexTx), Map TxId ChainIndexTx))
-&gt; StateT
     (Map TxId ChainIndexTx)
     (Contract w s e)
     (Maybe (DecoratedTxOut, ChainIndexTx))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680561084"><span class="annot"><span class="annottext">Map TxId ChainIndexTx
</span><a href="#local-6989586621680561084"><span class="hs-identifier hs-var">lookupTx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-582"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680561083"><span class="annot"><span class="annottext">txid :: TxId
</span><a href="#local-6989586621680561083"><span class="hs-identifier hs-var hs-var">txid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; TxId
</span><span class="hs-identifier hs-var hs-var">txOutRefId</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680561087"><span class="hs-identifier hs-var">ref</span></a></span><span>
</span><span id="line-583"></span><span>      </span><span class="hs-comment">-- Lookup the txid in the lookup table. If it's present, we don't need</span><span>
</span><span id="line-584"></span><span>      </span><span class="hs-comment">-- to query the chain index again. If it's not, we query the chain</span><span>
</span><span id="line-585"></span><span>      </span><span class="hs-comment">-- index and store the result in the lookup table.</span><span>
</span><span id="line-586"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxId -&gt; Map TxId ChainIndexTx -&gt; Maybe ChainIndexTx
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621680561083"><span class="hs-identifier hs-var">txid</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxId ChainIndexTx
</span><a href="#local-6989586621680561084"><span class="hs-identifier hs-var">lookupTx</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-587"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680561081"><span class="annot"><span class="annottext">ChainIndexTx
</span><a href="#local-6989586621680561081"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-588"></span><span>          </span><span class="annot"><span class="annottext">(Maybe (DecoratedTxOut, ChainIndexTx), Map TxId ChainIndexTx)
-&gt; Contract
     w s e (Maybe (DecoratedTxOut, ChainIndexTx), Map TxId ChainIndexTx)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DecoratedTxOut, ChainIndexTx)
-&gt; Maybe (DecoratedTxOut, ChainIndexTx)
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DecoratedTxOut
</span><a href="#local-6989586621680561086"><span class="hs-identifier hs-var">out</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ChainIndexTx
</span><a href="#local-6989586621680561081"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map TxId ChainIndexTx
</span><a href="#local-6989586621680561084"><span class="hs-identifier hs-var">lookupTx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-589"></span><span>        </span><span class="annot"><span class="annottext">Maybe ChainIndexTx
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-590"></span><span>          </span><span class="hs-comment">-- We query the chain index for the tx and store it in the lookup</span><span>
</span><span id="line-591"></span><span>          </span><span class="hs-comment">-- table if it is found.</span><span>
</span><span id="line-592"></span><span>          </span><span id="local-6989586621680561080"><span class="annot"><span class="annottext">Maybe ChainIndexTx
</span><a href="#local-6989586621680561080"><span class="hs-identifier hs-var">txM</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxId -&gt; Contract w s e (Maybe ChainIndexTx)
forall w (s :: Row *) e.
AsContractError e =&gt;
TxId -&gt; Contract w s e (Maybe ChainIndexTx)
</span><a href="Plutus.Contract.Request.html#txFromTxId"><span class="hs-identifier hs-var">txFromTxId</span></a></span><span> </span><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621680561083"><span class="hs-identifier hs-var">txid</span></a></span><span>
</span><span id="line-593"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe ChainIndexTx
</span><a href="#local-6989586621680561080"><span class="hs-identifier hs-var">txM</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-594"></span><span>            </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680561079"><span class="annot"><span class="annottext">ChainIndexTx
</span><a href="#local-6989586621680561079"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-595"></span><span>              </span><span class="annot"><span class="annottext">(Maybe (DecoratedTxOut, ChainIndexTx), Map TxId ChainIndexTx)
-&gt; Contract
     w s e (Maybe (DecoratedTxOut, ChainIndexTx), Map TxId ChainIndexTx)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DecoratedTxOut, ChainIndexTx)
-&gt; Maybe (DecoratedTxOut, ChainIndexTx)
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DecoratedTxOut
</span><a href="#local-6989586621680561086"><span class="hs-identifier hs-var">out</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ChainIndexTx
</span><a href="#local-6989586621680561079"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxId
-&gt; ChainIndexTx -&gt; Map TxId ChainIndexTx -&gt; Map TxId ChainIndexTx
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621680561083"><span class="hs-identifier hs-var">txid</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexTx
</span><a href="#local-6989586621680561079"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxId ChainIndexTx
</span><a href="#local-6989586621680561084"><span class="hs-identifier hs-var">lookupTx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-596"></span><span>            </span><span class="annot"><span class="annottext">Maybe ChainIndexTx
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-597"></span><span>              </span><span class="annot"><span class="annottext">(Maybe (DecoratedTxOut, ChainIndexTx), Map TxId ChainIndexTx)
-&gt; Contract
     w s e (Maybe (DecoratedTxOut, ChainIndexTx), Map TxId ChainIndexTx)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (DecoratedTxOut, ChainIndexTx)
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map TxId ChainIndexTx
</span><a href="#local-6989586621680561084"><span class="hs-identifier hs-var">lookupTx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span>
</span><span id="line-600"></span><span class="hs-comment">-- | Get the unspent transaction outputs from a 'ChainIndexTx'.</span><span>
</span><span id="line-601"></span><span id="local-6989586621680561075"><span id="local-6989586621680561076"><span id="local-6989586621680561077"><span class="annot"><a href="Plutus.Contract.Request.html#utxosTxOutTxFromTx"><span class="hs-identifier hs-type">utxosTxOutTxFromTx</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-602"></span><span>    </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561077"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-603"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChainIndexTx</span></span><span>
</span><span id="line-604"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561076"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561075"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561077"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxOutRef</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DecoratedTxOut</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChainIndexTx</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-605"></span><span id="utxosTxOutTxFromTx"><span class="annot"><span class="annottext">utxosTxOutTxFromTx :: ChainIndexTx
-&gt; Contract w s e [(TxOutRef, (DecoratedTxOut, ChainIndexTx))]
</span><a href="Plutus.Contract.Request.html#utxosTxOutTxFromTx"><span class="hs-identifier hs-var hs-var">utxosTxOutTxFromTx</span></a></span></span><span> </span><span id="local-6989586621680561074"><span class="annot"><span class="annottext">ChainIndexTx
</span><a href="#local-6989586621680561074"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-606"></span><span>  </span><span class="annot"><span class="annottext">[Maybe (TxOutRef, (DecoratedTxOut, ChainIndexTx))]
-&gt; [(TxOutRef, (DecoratedTxOut, ChainIndexTx))]
forall a. [Maybe a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">catMaybes</span></a></span><span> </span><span class="annot"><span class="annottext">([Maybe (TxOutRef, (DecoratedTxOut, ChainIndexTx))]
 -&gt; [(TxOutRef, (DecoratedTxOut, ChainIndexTx))])
-&gt; Contract
     w s e [Maybe (TxOutRef, (DecoratedTxOut, ChainIndexTx))]
-&gt; Contract w s e [(TxOutRef, (DecoratedTxOut, ChainIndexTx))]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOutRef
 -&gt; Contract
      w s e (Maybe (TxOutRef, (DecoratedTxOut, ChainIndexTx))))
-&gt; [TxOutRef]
-&gt; Contract
     w s e [Maybe (TxOutRef, (DecoratedTxOut, ChainIndexTx))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
-&gt; Contract
     w s e (Maybe (TxOutRef, (DecoratedTxOut, ChainIndexTx)))
</span><a href="#local-6989586621680561073"><span class="hs-identifier hs-var">mkOutRef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainIndexTx -&gt; [TxOutRef]
</span><span class="hs-identifier hs-var">txOutRefs</span></span><span> </span><span class="annot"><span class="annottext">ChainIndexTx
</span><a href="#local-6989586621680561074"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-607"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-608"></span><span>    </span><span id="local-6989586621680561073"><span class="annot"><span class="annottext">mkOutRef :: TxOutRef
-&gt; Contract
     w s e (Maybe (TxOutRef, (DecoratedTxOut, ChainIndexTx)))
</span><a href="#local-6989586621680561073"><span class="hs-identifier hs-var hs-var">mkOutRef</span></a></span></span><span> </span><span id="local-6989586621680561072"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680561072"><span class="hs-identifier hs-var">txOutRef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-609"></span><span>      </span><span id="local-6989586621680561071"><span class="annot"><span class="annottext">Maybe DecoratedTxOut
</span><a href="#local-6989586621680561071"><span class="hs-identifier hs-var">decoratedTxOutM</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; Contract w s e (Maybe DecoratedTxOut)
forall w (s :: Row *) e.
AsContractError e =&gt;
TxOutRef -&gt; Contract w s e (Maybe DecoratedTxOut)
</span><a href="Plutus.Contract.Request.html#unspentTxOutFromRef"><span class="hs-identifier hs-var">unspentTxOutFromRef</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680561072"><span class="hs-identifier hs-var">txOutRef</span></a></span><span>
</span><span id="line-610"></span><span>      </span><span class="annot"><span class="annottext">Maybe (TxOutRef, (DecoratedTxOut, ChainIndexTx))
-&gt; Contract
     w s e (Maybe (TxOutRef, (DecoratedTxOut, ChainIndexTx)))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (TxOutRef, (DecoratedTxOut, ChainIndexTx))
 -&gt; Contract
      w s e (Maybe (TxOutRef, (DecoratedTxOut, ChainIndexTx))))
-&gt; Maybe (TxOutRef, (DecoratedTxOut, ChainIndexTx))
-&gt; Contract
     w s e (Maybe (TxOutRef, (DecoratedTxOut, ChainIndexTx)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DecoratedTxOut
</span><a href="#local-6989586621680561071"><span class="hs-identifier hs-var">decoratedTxOutM</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DecoratedTxOut
-&gt; (DecoratedTxOut
    -&gt; Maybe (TxOutRef, (DecoratedTxOut, ChainIndexTx)))
-&gt; Maybe (TxOutRef, (DecoratedTxOut, ChainIndexTx))
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680561070"><span class="annot"><span class="annottext">DecoratedTxOut
</span><a href="#local-6989586621680561070"><span class="hs-identifier hs-var">decoratedTxOut</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(TxOutRef, (DecoratedTxOut, ChainIndexTx))
-&gt; Maybe (TxOutRef, (DecoratedTxOut, ChainIndexTx))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680561072"><span class="hs-identifier hs-var">txOutRef</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DecoratedTxOut
</span><a href="#local-6989586621680561070"><span class="hs-identifier hs-var">decoratedTxOut</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ChainIndexTx
</span><a href="#local-6989586621680561074"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-611"></span><span>
</span><span id="line-612"></span><span class="annot"><a href="Plutus.Contract.Request.html#foldTxoRefsAt"><span class="hs-identifier hs-type">foldTxoRefsAt</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-613"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561733"><span class="annot"><a href="#local-6989586621680561733"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561732"><span class="annot"><a href="#local-6989586621680561732"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561735"><span class="annot"><a href="#local-6989586621680561735"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621680561734"><span class="annot"><a href="#local-6989586621680561734"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-614"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561735"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-615"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-616"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680561734"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Page</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutRef</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561733"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561732"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561735"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561734"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-617"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680561734"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-618"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAddress</span></span><span>
</span><span id="line-619"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561733"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561732"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561735"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561734"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-620"></span><span id="foldTxoRefsAt"><span class="annot"><span class="annottext">foldTxoRefsAt :: (a -&gt; Page TxOutRef -&gt; Contract w s e a)
-&gt; a -&gt; CardanoAddress -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#foldTxoRefsAt"><span class="hs-identifier hs-var hs-var">foldTxoRefsAt</span></a></span></span><span> </span><span id="local-6989586621680561068"><span class="annot"><span class="annottext">a -&gt; Page TxOutRef -&gt; Contract w s e a
</span><a href="#local-6989586621680561068"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680561067"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680561067"><span class="hs-identifier hs-var">ini</span></a></span></span><span> </span><span id="local-6989586621680561066"><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680561066"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe (PageQuery TxOutRef) -&gt; Contract w s e a
</span><a href="#local-6989586621680561065"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680561067"><span class="hs-identifier hs-var">ini</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PageQuery TxOutRef -&gt; Maybe (PageQuery TxOutRef)
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span class="hs-special">)</span><span>
</span><span id="line-621"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-622"></span><span>    </span><span id="local-6989586621680561065"><span class="annot"><span class="annottext">go :: a -&gt; Maybe (PageQuery TxOutRef) -&gt; Contract w s e a
</span><a href="#local-6989586621680561065"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680561064"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680561064"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (PageQuery TxOutRef)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Contract w s e a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680561064"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-623"></span><span>    </span><span class="annot"><a href="#local-6989586621680561065"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621680561063"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680561063"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680561062"><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680561062"><span class="hs-identifier hs-var">pq</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-624"></span><span>      </span><span id="local-6989586621680561061"><span class="annot"><span class="annottext">Page TxOutRef
</span><a href="#local-6989586621680561061"><span class="hs-identifier hs-var">page</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxosResponse -&gt; Page TxOutRef
</span><span class="hs-identifier hs-var hs-var">paget</span></span><span> </span><span class="annot"><span class="annottext">(TxosResponse -&gt; Page TxOutRef)
-&gt; Contract w s e TxosResponse -&gt; Contract w s e (Page TxOutRef)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef -&gt; CardanoAddress -&gt; Contract w s e TxosResponse
forall w (s :: Row *) e.
AsContractError e =&gt;
PageQuery TxOutRef -&gt; CardanoAddress -&gt; Contract w s e TxosResponse
</span><a href="Plutus.Contract.Request.html#txoRefsAt"><span class="hs-identifier hs-var">txoRefsAt</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680561062"><span class="hs-identifier hs-var">pq</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680561066"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-625"></span><span>      </span><span id="local-6989586621680561060"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680561060"><span class="hs-identifier hs-var">newAcc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; Page TxOutRef -&gt; Contract w s e a
</span><a href="#local-6989586621680561068"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680561063"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Page TxOutRef
</span><a href="#local-6989586621680561061"><span class="hs-identifier hs-var">page</span></a></span><span>
</span><span id="line-626"></span><span>      </span><span class="annot"><span class="annottext">a -&gt; Maybe (PageQuery TxOutRef) -&gt; Contract w s e a
</span><a href="#local-6989586621680561065"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680561060"><span class="hs-identifier hs-var">newAcc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Page TxOutRef -&gt; Maybe (PageQuery TxOutRef)
forall a. Page a -&gt; Maybe (PageQuery a)
</span><span class="hs-identifier hs-var hs-var">nextPageQuery</span></span><span> </span><span class="annot"><span class="annottext">Page TxOutRef
</span><a href="#local-6989586621680561061"><span class="hs-identifier hs-var">page</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-627"></span><span>
</span><span id="line-628"></span><span class="hs-comment">-- | Get the transactions at an address.</span><span>
</span><span id="line-629"></span><span class="annot"><a href="Plutus.Contract.Request.html#txsAt"><span class="hs-identifier hs-type">txsAt</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-630"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561059"><span class="annot"><a href="#local-6989586621680561059"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561058"><span class="annot"><a href="#local-6989586621680561058"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561057"><span class="annot"><a href="#local-6989586621680561057"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-631"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561057"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-632"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-633"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAddress</span></span><span>
</span><span id="line-634"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561059"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561058"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561057"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ChainIndexTx</span></span><span class="hs-special">]</span><span>
</span><span id="line-635"></span><span id="txsAt"><span class="annot"><span class="annottext">txsAt :: CardanoAddress -&gt; Contract w s e [ChainIndexTx]
</span><a href="Plutus.Contract.Request.html#txsAt"><span class="hs-identifier hs-var hs-var">txsAt</span></a></span></span><span> </span><span id="local-6989586621680561056"><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680561056"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-636"></span><span>  </span><span class="annot"><span class="annottext">([ChainIndexTx] -&gt; Page TxOutRef -&gt; Contract w s e [ChainIndexTx])
-&gt; [ChainIndexTx]
-&gt; CardanoAddress
-&gt; Contract w s e [ChainIndexTx]
forall w (s :: Row *) e a.
AsContractError e =&gt;
(a -&gt; Page TxOutRef -&gt; Contract w s e a)
-&gt; a -&gt; CardanoAddress -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#foldTxoRefsAt"><span class="hs-identifier hs-var">foldTxoRefsAt</span></a></span><span> </span><span class="annot"><span class="annottext">[ChainIndexTx] -&gt; Page TxOutRef -&gt; Contract w s e [ChainIndexTx]
forall e w (s :: Row *).
AsContractError e =&gt;
[ChainIndexTx] -&gt; Page TxOutRef -&gt; Contract w s e [ChainIndexTx]
</span><a href="#local-6989586621680561055"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680561056"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-637"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-638"></span><span>    </span><span id="local-6989586621680561055"><span class="annot"><span class="annottext">f :: [ChainIndexTx] -&gt; Page TxOutRef -&gt; Contract w s e [ChainIndexTx]
</span><a href="#local-6989586621680561055"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680561054"><span class="annot"><span class="annottext">[ChainIndexTx]
</span><a href="#local-6989586621680561054"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621680561053"><span class="annot"><span class="annottext">Page TxOutRef
</span><a href="#local-6989586621680561053"><span class="hs-identifier hs-var">page</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-639"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680561052"><span class="annot"><span class="annottext">txoRefs :: [TxOutRef]
</span><a href="#local-6989586621680561052"><span class="hs-identifier hs-var hs-var">txoRefs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Page TxOutRef -&gt; [TxOutRef]
forall a. Page a -&gt; [a]
</span><span class="hs-identifier hs-var hs-var">pageItems</span></span><span> </span><span class="annot"><span class="annottext">Page TxOutRef
</span><a href="#local-6989586621680561053"><span class="hs-identifier hs-var">page</span></a></span><span>
</span><span id="line-640"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680561051"><span class="annot"><span class="annottext">txIds :: [TxId]
</span><a href="#local-6989586621680561051"><span class="hs-identifier hs-var hs-var">txIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; TxId
</span><span class="hs-identifier hs-var hs-var">txOutRefId</span></span><span> </span><span class="annot"><span class="annottext">(TxOutRef -&gt; TxId) -&gt; [TxOutRef] -&gt; [TxId]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOutRef]
</span><a href="#local-6989586621680561052"><span class="hs-identifier hs-var">txoRefs</span></a></span><span>
</span><span id="line-641"></span><span>      </span><span id="local-6989586621680561050"><span class="annot"><span class="annottext">[ChainIndexTx]
</span><a href="#local-6989586621680561050"><span class="hs-identifier hs-var">txs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TxId] -&gt; Contract w s e [ChainIndexTx]
forall w (s :: Row *) e.
AsContractError e =&gt;
[TxId] -&gt; Contract w s e [ChainIndexTx]
</span><a href="Plutus.Contract.Request.html#txsFromTxIds"><span class="hs-identifier hs-var">txsFromTxIds</span></a></span><span> </span><span class="annot"><span class="annottext">[TxId]
</span><a href="#local-6989586621680561051"><span class="hs-identifier hs-var">txIds</span></a></span><span>
</span><span id="line-642"></span><span>      </span><span class="annot"><span class="annottext">[ChainIndexTx] -&gt; Contract w s e [ChainIndexTx]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">([ChainIndexTx] -&gt; Contract w s e [ChainIndexTx])
-&gt; [ChainIndexTx] -&gt; Contract w s e [ChainIndexTx]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[ChainIndexTx]
</span><a href="#local-6989586621680561054"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[ChainIndexTx] -&gt; [ChainIndexTx] -&gt; [ChainIndexTx]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[ChainIndexTx]
</span><a href="#local-6989586621680561050"><span class="hs-identifier hs-var">txs</span></a></span><span>
</span><span id="line-643"></span><span>
</span><span id="line-644"></span><span class="hs-comment">-- | Get the transaction outputs at an address.</span><span>
</span><span id="line-645"></span><span class="annot"><a href="Plutus.Contract.Request.html#txoRefsAt"><span class="hs-identifier hs-type">txoRefsAt</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-646"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561741"><span class="annot"><a href="#local-6989586621680561741"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561740"><span class="annot"><a href="#local-6989586621680561740"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561742"><span class="annot"><a href="#local-6989586621680561742"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-647"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561742"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-648"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-649"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PageQuery</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutRef</span></span><span>
</span><span id="line-650"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAddress</span></span><span>
</span><span id="line-651"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561741"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561740"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561742"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxosResponse</span></span><span>
</span><span id="line-652"></span><span id="txoRefsAt"><span class="annot"><span class="annottext">txoRefsAt :: PageQuery TxOutRef -&gt; CardanoAddress -&gt; Contract w s e TxosResponse
</span><a href="Plutus.Contract.Request.html#txoRefsAt"><span class="hs-identifier hs-var hs-var">txoRefsAt</span></a></span></span><span> </span><span id="local-6989586621680561049"><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680561049"><span class="hs-identifier hs-var">pq</span></a></span></span><span> </span><span id="local-6989586621680561048"><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680561048"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-653"></span><span>  </span><span id="local-6989586621680561047"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561047"><span class="hs-identifier hs-var">cir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PABReq
-&gt; Prism' PABResp ChainIndexResponse
-&gt; Contract w s e ChainIndexResponse
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainIndexQuery -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#ChainIndexQueryReq"><span class="hs-identifier hs-var">ChainIndexQueryReq</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexQuery -&gt; PABReq) -&gt; ChainIndexQuery -&gt; PABReq
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef -&gt; CardanoAddress -&gt; ChainIndexQuery
</span><a href="Plutus.Contract.Effects.html#TxoSetAtAddress"><span class="hs-identifier hs-var">E.TxoSetAtAddress</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680561049"><span class="hs-identifier hs-var">pq</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680561048"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prism' PABResp ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#_ChainIndexQueryResp"><span class="hs-identifier hs-var">E._ChainIndexQueryResp</span></a></span><span>
</span><span id="line-654"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561047"><span class="hs-identifier hs-var">cir</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-655"></span><span>    </span><span class="annot"><a href="Plutus.Contract.Effects.html#TxoSetAtResponse"><span class="hs-identifier hs-type">E.TxoSetAtResponse</span></a></span><span> </span><span id="local-6989586621680561044"><span class="annot"><span class="annottext">TxosResponse
</span><a href="#local-6989586621680561044"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxosResponse -&gt; Contract w s e TxosResponse
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">TxosResponse
</span><a href="#local-6989586621680561044"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-656"></span><span>    </span><span id="local-6989586621680561043"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561043"><span class="hs-identifier hs-var">r</span></a></span></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e -&gt; Contract w s e TxosResponse
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; Contract w s e TxosResponse)
-&gt; e -&gt; Contract w s e TxosResponse
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
-&gt; (Text, ChainIndexResponse) -&gt; e
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
forall r. AsContractError r =&gt; Prism' r (Text, ChainIndexResponse)
</span><a href="Plutus.Contract.Error.html#_ChainIndexContractError"><span class="hs-identifier hs-var">_ChainIndexContractError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;TxoSetAtAddress&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561043"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-657"></span><span>
</span><span id="line-658"></span><span class="hs-comment">-- | Get the transactions for a list of transaction ids.</span><span>
</span><span id="line-659"></span><span class="annot"><a href="Plutus.Contract.Request.html#txsFromTxIds"><span class="hs-identifier hs-type">txsFromTxIds</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-660"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561726"><span class="annot"><a href="#local-6989586621680561726"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561725"><span class="annot"><a href="#local-6989586621680561725"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561727"><span class="annot"><a href="#local-6989586621680561727"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-661"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561727"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-662"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-663"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TxId</span></span><span class="hs-special">]</span><span>
</span><span id="line-664"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561726"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561725"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561727"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ChainIndexTx</span></span><span class="hs-special">]</span><span>
</span><span id="line-665"></span><span id="txsFromTxIds"><span class="annot"><span class="annottext">txsFromTxIds :: [TxId] -&gt; Contract w s e [ChainIndexTx]
</span><a href="Plutus.Contract.Request.html#txsFromTxIds"><span class="hs-identifier hs-var hs-var">txsFromTxIds</span></a></span></span><span> </span><span id="local-6989586621680561042"><span class="annot"><span class="annottext">[TxId]
</span><a href="#local-6989586621680561042"><span class="hs-identifier hs-var">txid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-666"></span><span>  </span><span id="local-6989586621680561041"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561041"><span class="hs-identifier hs-var">cir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PABReq
-&gt; Prism' PABResp ChainIndexResponse
-&gt; Contract w s e ChainIndexResponse
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainIndexQuery -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#ChainIndexQueryReq"><span class="hs-identifier hs-var">ChainIndexQueryReq</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexQuery -&gt; PABReq) -&gt; ChainIndexQuery -&gt; PABReq
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[TxId] -&gt; ChainIndexQuery
</span><a href="Plutus.Contract.Effects.html#TxsFromTxIds"><span class="hs-identifier hs-var">E.TxsFromTxIds</span></a></span><span> </span><span class="annot"><span class="annottext">[TxId]
</span><a href="#local-6989586621680561042"><span class="hs-identifier hs-var">txid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prism' PABResp ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#_ChainIndexQueryResp"><span class="hs-identifier hs-var">E._ChainIndexQueryResp</span></a></span><span>
</span><span id="line-667"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561041"><span class="hs-identifier hs-var">cir</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-668"></span><span>    </span><span class="annot"><a href="Plutus.Contract.Effects.html#TxIdsResponse"><span class="hs-identifier hs-type">E.TxIdsResponse</span></a></span><span> </span><span id="local-6989586621680561038"><span class="annot"><span class="annottext">[ChainIndexTx]
</span><a href="#local-6989586621680561038"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ChainIndexTx] -&gt; Contract w s e [ChainIndexTx]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">[ChainIndexTx]
</span><a href="#local-6989586621680561038"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-669"></span><span>    </span><span id="local-6989586621680561037"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561037"><span class="hs-identifier hs-var">r</span></a></span></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e -&gt; Contract w s e [ChainIndexTx]
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; Contract w s e [ChainIndexTx])
-&gt; e -&gt; Contract w s e [ChainIndexTx]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
-&gt; (Text, ChainIndexResponse) -&gt; e
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
forall r. AsContractError r =&gt; Prism' r (Text, ChainIndexResponse)
</span><a href="Plutus.Contract.Error.html#_ChainIndexContractError"><span class="hs-identifier hs-var">_ChainIndexContractError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;TxIdsResponse&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561037"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-670"></span><span>
</span><span id="line-671"></span><span class="annot"><a href="Plutus.Contract.Request.html#getTip"><span class="hs-identifier hs-type">getTip</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-672"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561036"><span class="annot"><a href="#local-6989586621680561036"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561035"><span class="annot"><a href="#local-6989586621680561035"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561034"><span class="annot"><a href="#local-6989586621680561034"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-673"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561034"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-674"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-675"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561036"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561035"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561034"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tip</span></span><span>
</span><span id="line-676"></span><span id="getTip"><span class="annot"><span class="annottext">getTip :: Contract w s e Tip
</span><a href="Plutus.Contract.Request.html#getTip"><span class="hs-identifier hs-var hs-var">getTip</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-677"></span><span>  </span><span id="local-6989586621680561033"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561033"><span class="hs-identifier hs-var">cir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PABReq
-&gt; Prism' PABResp ChainIndexResponse
-&gt; Contract w s e ChainIndexResponse
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainIndexQuery -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#ChainIndexQueryReq"><span class="hs-identifier hs-var">ChainIndexQueryReq</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexQuery
</span><a href="Plutus.Contract.Effects.html#GetTip"><span class="hs-identifier hs-var">E.GetTip</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prism' PABResp ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#_ChainIndexQueryResp"><span class="hs-identifier hs-var">E._ChainIndexQueryResp</span></a></span><span>
</span><span id="line-678"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561033"><span class="hs-identifier hs-var">cir</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-679"></span><span>    </span><span class="annot"><a href="Plutus.Contract.Effects.html#GetTipResponse"><span class="hs-identifier hs-type">E.GetTipResponse</span></a></span><span> </span><span id="local-6989586621680561030"><span class="annot"><span class="annottext">Tip
</span><a href="#local-6989586621680561030"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Tip -&gt; Contract w s e Tip
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Tip
</span><a href="#local-6989586621680561030"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-680"></span><span>    </span><span id="local-6989586621680561029"><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561029"><span class="hs-identifier hs-var">r</span></a></span></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e -&gt; Contract w s e Tip
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; Contract w s e Tip) -&gt; e -&gt; Contract w s e Tip
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
-&gt; (Text, ChainIndexResponse) -&gt; e
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview e (Text, ChainIndexResponse)
forall r. AsContractError r =&gt; Prism' r (Text, ChainIndexResponse)
</span><a href="Plutus.Contract.Error.html#_ChainIndexContractError"><span class="hs-identifier hs-var">_ChainIndexContractError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;GetTipResponse&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ChainIndexResponse
</span><a href="#local-6989586621680561029"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-681"></span><span>
</span><span id="line-682"></span><span class="hs-comment">-- | Wait until the target slot and get the unspent transaction outputs at an</span><span>
</span><span id="line-683"></span><span class="hs-comment">-- address.</span><span>
</span><span id="line-684"></span><span class="annot"><a href="Plutus.Contract.Request.html#watchAddressUntilSlot"><span class="hs-identifier hs-type">watchAddressUntilSlot</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-685"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561028"><span class="annot"><a href="#local-6989586621680561028"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561027"><span class="annot"><a href="#local-6989586621680561027"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561026"><span class="annot"><a href="#local-6989586621680561026"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-686"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561026"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-687"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-688"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAddress</span></span><span>
</span><span id="line-689"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Slot</span></span><span>
</span><span id="line-690"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561028"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561027"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561026"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutRef</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DecoratedTxOut</span></span><span class="hs-special">)</span><span>
</span><span id="line-691"></span><span id="watchAddressUntilSlot"><span class="annot"><span class="annottext">watchAddressUntilSlot :: CardanoAddress
-&gt; Slot -&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
</span><a href="Plutus.Contract.Request.html#watchAddressUntilSlot"><span class="hs-identifier hs-var hs-var">watchAddressUntilSlot</span></a></span></span><span> </span><span id="local-6989586621680561025"><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680561025"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680561024"><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680561024"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Contract w s e Slot
forall w (s :: Row *) e.
AsContractError e =&gt;
Slot -&gt; Contract w s e Slot
</span><a href="Plutus.Contract.Request.html#awaitSlot"><span class="hs-identifier hs-var">awaitSlot</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680561024"><span class="hs-identifier hs-var">slot</span></a></span><span> </span><span class="annot"><span class="annottext">Contract w s e Slot
-&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
-&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress -&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
forall w (s :: Row *) e.
AsContractError e =&gt;
CardanoAddress -&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
</span><a href="Plutus.Contract.Request.html#utxosAt"><span class="hs-identifier hs-var">utxosAt</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680561025"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-692"></span><span>
</span><span id="line-693"></span><span class="hs-comment">-- | Wait until the target time and get the unspent transaction outputs at an</span><span>
</span><span id="line-694"></span><span class="hs-comment">-- address.</span><span>
</span><span id="line-695"></span><span class="annot"><a href="Plutus.Contract.Request.html#watchAddressUntilTime"><span class="hs-identifier hs-type">watchAddressUntilTime</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-696"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561023"><span class="annot"><a href="#local-6989586621680561023"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561022"><span class="annot"><a href="#local-6989586621680561022"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561021"><span class="annot"><a href="#local-6989586621680561021"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-697"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561021"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-698"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-699"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAddress</span></span><span>
</span><span id="line-700"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">POSIXTime</span></span><span>
</span><span id="line-701"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561023"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561022"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561021"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutRef</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DecoratedTxOut</span></span><span class="hs-special">)</span><span>
</span><span id="line-702"></span><span id="watchAddressUntilTime"><span class="annot"><span class="annottext">watchAddressUntilTime :: CardanoAddress
-&gt; POSIXTime -&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
</span><a href="Plutus.Contract.Request.html#watchAddressUntilTime"><span class="hs-identifier hs-var hs-var">watchAddressUntilTime</span></a></span></span><span> </span><span id="local-6989586621680561020"><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680561020"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680561019"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621680561019"><span class="hs-identifier hs-var">time</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; Contract w s e POSIXTime
forall w (s :: Row *) e.
AsContractError e =&gt;
POSIXTime -&gt; Contract w s e POSIXTime
</span><a href="Plutus.Contract.Request.html#awaitTime"><span class="hs-identifier hs-var">awaitTime</span></a></span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621680561019"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">Contract w s e POSIXTime
-&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
-&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress -&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
forall w (s :: Row *) e.
AsContractError e =&gt;
CardanoAddress -&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
</span><a href="Plutus.Contract.Request.html#utxosAt"><span class="hs-identifier hs-var">utxosAt</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680561020"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-703"></span><span>
</span><span id="line-704"></span><span class="hs-comment">{-| Wait until the UTXO has been spent, returning the transaction that spends it.
-}</span><span>
</span><span id="line-706"></span><span class="annot"><a href="Plutus.Contract.Request.html#awaitUtxoSpent"><span class="hs-identifier hs-type">awaitUtxoSpent</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-707"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561694"><span class="annot"><a href="#local-6989586621680561694"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561693"><span class="annot"><a href="#local-6989586621680561693"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561695"><span class="annot"><a href="#local-6989586621680561695"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-708"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561695"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-709"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-710"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutRef</span></span><span>
</span><span id="line-711"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561694"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561693"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561695"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChainIndexTx</span></span><span>
</span><span id="line-712"></span><span id="awaitUtxoSpent"><span class="annot"><span class="annottext">awaitUtxoSpent :: TxOutRef -&gt; Contract w s e ChainIndexTx
</span><a href="Plutus.Contract.Request.html#awaitUtxoSpent"><span class="hs-identifier hs-var hs-var">awaitUtxoSpent</span></a></span></span><span> </span><span id="local-6989586621680561018"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680561018"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-713"></span><span>  </span><span id="local-6989586621680561017"><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621680561017"><span class="hs-identifier hs-var">txIn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ToCardanoError -&gt; Contract w s e TxIn)
-&gt; (TxIn -&gt; Contract w s e TxIn)
-&gt; Either ToCardanoError TxIn
-&gt; Contract w s e TxIn
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">e -&gt; Contract w s e TxIn
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; Contract w s e TxIn)
-&gt; (ToCardanoError -&gt; e) -&gt; ToCardanoError -&gt; Contract w s e TxIn
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">AReview e ToCardanoError -&gt; ToCardanoError -&gt; e
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview e ToCardanoError
forall r. AsContractError r =&gt; Prism' r ToCardanoError
</span><a href="Plutus.Contract.Error.html#_ToCardanoConvertContractError"><span class="hs-identifier hs-var">_ToCardanoConvertContractError</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxIn -&gt; Contract w s e TxIn
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ToCardanoError TxIn -&gt; Contract w s e TxIn)
-&gt; Either ToCardanoError TxIn -&gt; Contract w s e TxIn
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; Either ToCardanoError TxIn
</span><span class="hs-identifier hs-var">toCardanoTxIn</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680561018"><span class="hs-identifier hs-var">ref</span></a></span><span>
</span><span id="line-714"></span><span>  </span><span class="annot"><span class="annottext">PABReq
-&gt; Prism' PABResp ChainIndexTx -&gt; Contract w s e ChainIndexTx
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#AwaitUtxoSpentReq"><span class="hs-identifier hs-var">AwaitUtxoSpentReq</span></a></span><span> </span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621680561017"><span class="hs-identifier hs-var">txIn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prism' PABResp ChainIndexTx
</span><a href="Plutus.Contract.Effects.html#_AwaitUtxoSpentResp"><span class="hs-identifier hs-var">E._AwaitUtxoSpentResp</span></a></span><span>
</span><span id="line-715"></span><span>
</span><span id="line-716"></span><span class="hs-comment">{-| Wait until the UTXO has been spent, returning the transaction that spends it.
-}</span><span>
</span><span id="line-718"></span><span class="annot"><a href="Plutus.Contract.Request.html#utxoIsSpent"><span class="hs-identifier hs-type">utxoIsSpent</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-719"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561014"><span class="annot"><a href="#local-6989586621680561014"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561013"><span class="annot"><a href="#local-6989586621680561013"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561012"><span class="annot"><a href="#local-6989586621680561012"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-720"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561012"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-721"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-722"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutRef</span></span><span>
</span><span id="line-723"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Promise"><span class="hs-identifier hs-type">Promise</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561014"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561013"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561012"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChainIndexTx</span></span><span>
</span><span id="line-724"></span><span id="utxoIsSpent"><span class="annot"><span class="annottext">utxoIsSpent :: TxOutRef -&gt; Promise w s e ChainIndexTx
</span><a href="Plutus.Contract.Request.html#utxoIsSpent"><span class="hs-identifier hs-var hs-var">utxoIsSpent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Contract w s e ChainIndexTx -&gt; Promise w s e ChainIndexTx
forall w (s :: Row *) e a. Contract w s e a -&gt; Promise w s e a
</span><a href="Plutus.Contract.Types.html#Promise"><span class="hs-identifier hs-var">Promise</span></a></span><span> </span><span class="annot"><span class="annottext">(Contract w s e ChainIndexTx -&gt; Promise w s e ChainIndexTx)
-&gt; (TxOutRef -&gt; Contract w s e ChainIndexTx)
-&gt; TxOutRef
-&gt; Promise w s e ChainIndexTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; Contract w s e ChainIndexTx
forall w (s :: Row *) e.
AsContractError e =&gt;
TxOutRef -&gt; Contract w s e ChainIndexTx
</span><a href="Plutus.Contract.Request.html#awaitUtxoSpent"><span class="hs-identifier hs-var">awaitUtxoSpent</span></a></span><span>
</span><span id="line-725"></span><span>
</span><span id="line-726"></span><span class="hs-comment">{-| Wait until one or more unspent outputs are produced at an address.
-}</span><span>
</span><span id="line-728"></span><span class="annot"><a href="Plutus.Contract.Request.html#awaitUtxoProduced"><span class="hs-identifier hs-type">awaitUtxoProduced</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-729"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561685"><span class="annot"><a href="#local-6989586621680561685"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561684"><span class="annot"><a href="#local-6989586621680561684"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561686"><span class="annot"><a href="#local-6989586621680561686"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span class="hs-operator">.</span><span>
</span><span id="line-730"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561686"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-731"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-732"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAddress</span></span><span>
</span><span id="line-733"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561685"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561684"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561686"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChainIndexTx</span></span><span class="hs-special">)</span><span>
</span><span id="line-734"></span><span id="awaitUtxoProduced"><span class="annot"><span class="annottext">awaitUtxoProduced :: CardanoAddress -&gt; Contract w s e (NonEmpty ChainIndexTx)
</span><a href="Plutus.Contract.Request.html#awaitUtxoProduced"><span class="hs-identifier hs-var hs-var">awaitUtxoProduced</span></a></span></span><span> </span><span id="local-6989586621680561011"><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680561011"><span class="hs-identifier hs-var">address</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-735"></span><span>  </span><span class="annot"><span class="annottext">PABReq
-&gt; Prism' PABResp (NonEmpty ChainIndexTx)
-&gt; Contract w s e (NonEmpty ChainIndexTx)
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardanoAddress -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#AwaitUtxoProducedReq"><span class="hs-identifier hs-var">AwaitUtxoProducedReq</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680561011"><span class="hs-identifier hs-var">address</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prism' PABResp (NonEmpty ChainIndexTx)
</span><a href="Plutus.Contract.Effects.html#_AwaitUtxoProducedResp"><span class="hs-identifier hs-var">E._AwaitUtxoProducedResp</span></a></span><span>
</span><span id="line-736"></span><span>
</span><span id="line-737"></span><span class="hs-comment">{-| Wait until one or more unspent outputs are produced at an address.
-}</span><span>
</span><span id="line-739"></span><span class="annot"><a href="Plutus.Contract.Request.html#utxoIsProduced"><span class="hs-identifier hs-type">utxoIsProduced</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-740"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561009"><span class="annot"><a href="#local-6989586621680561009"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561008"><span class="annot"><a href="#local-6989586621680561008"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561007"><span class="annot"><a href="#local-6989586621680561007"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span class="hs-operator">.</span><span>
</span><span id="line-741"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561007"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-742"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-743"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAddress</span></span><span>
</span><span id="line-744"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Promise"><span class="hs-identifier hs-type">Promise</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561009"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561008"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561007"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChainIndexTx</span></span><span class="hs-special">)</span><span>
</span><span id="line-745"></span><span id="utxoIsProduced"><span class="annot"><span class="annottext">utxoIsProduced :: CardanoAddress -&gt; Promise w s e (NonEmpty ChainIndexTx)
</span><a href="Plutus.Contract.Request.html#utxoIsProduced"><span class="hs-identifier hs-var hs-var">utxoIsProduced</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Contract w s e (NonEmpty ChainIndexTx)
-&gt; Promise w s e (NonEmpty ChainIndexTx)
forall w (s :: Row *) e a. Contract w s e a -&gt; Promise w s e a
</span><a href="Plutus.Contract.Types.html#Promise"><span class="hs-identifier hs-var">Promise</span></a></span><span> </span><span class="annot"><span class="annottext">(Contract w s e (NonEmpty ChainIndexTx)
 -&gt; Promise w s e (NonEmpty ChainIndexTx))
-&gt; (CardanoAddress -&gt; Contract w s e (NonEmpty ChainIndexTx))
-&gt; CardanoAddress
-&gt; Promise w s e (NonEmpty ChainIndexTx)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress -&gt; Contract w s e (NonEmpty ChainIndexTx)
forall w (s :: Row *) e.
AsContractError e =&gt;
CardanoAddress -&gt; Contract w s e (NonEmpty ChainIndexTx)
</span><a href="Plutus.Contract.Request.html#awaitUtxoProduced"><span class="hs-identifier hs-var">awaitUtxoProduced</span></a></span><span>
</span><span id="line-746"></span><span>
</span><span id="line-747"></span><span class="hs-comment">-- | Watch an address for changes, and return the outputs</span><span>
</span><span id="line-748"></span><span class="hs-comment">--   at that address when the total value at the address</span><span>
</span><span id="line-749"></span><span class="hs-comment">--   has surpassed the given value.</span><span>
</span><span id="line-750"></span><span class="annot"><a href="Plutus.Contract.Request.html#fundsAtAddressGt"><span class="hs-identifier hs-type">fundsAtAddressGt</span></a></span><span>
</span><span id="line-751"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561006"><span class="annot"><a href="#local-6989586621680561006"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561005"><span class="annot"><a href="#local-6989586621680561005"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561004"><span class="annot"><a href="#local-6989586621680561004"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-752"></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561004"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-753"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-754"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAddress</span></span><span>
</span><span id="line-755"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Value</span></span><span>
</span><span id="line-756"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561006"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561005"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561004"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutRef</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DecoratedTxOut</span></span><span class="hs-special">)</span><span>
</span><span id="line-757"></span><span id="fundsAtAddressGt"><span class="annot"><span class="annottext">fundsAtAddressGt :: CardanoAddress
-&gt; Value -&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
</span><a href="Plutus.Contract.Request.html#fundsAtAddressGt"><span class="hs-identifier hs-var hs-var">fundsAtAddressGt</span></a></span></span><span> </span><span id="local-6989586621680561003"><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680561003"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621680561002"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680561002"><span class="hs-identifier hs-var">vl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-758"></span><span>    </span><span class="annot"><span class="annottext">(Value -&gt; Bool)
-&gt; CardanoAddress -&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
forall w (s :: Row *) e.
AsContractError e =&gt;
(Value -&gt; Bool)
-&gt; CardanoAddress -&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
</span><a href="Plutus.Contract.Request.html#fundsAtAddressCondition"><span class="hs-identifier hs-var">fundsAtAddressCondition</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680561001"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680561001"><span class="hs-identifier hs-var">presentVal</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680561001"><span class="hs-identifier hs-var">presentVal</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; Bool
</span><span class="hs-operator hs-var">`valueLeq`</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680561002"><span class="hs-identifier hs-var">vl</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680561003"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-759"></span><span>
</span><span id="line-760"></span><span class="annot"><a href="Plutus.Contract.Request.html#fundsAtAddressCondition"><span class="hs-identifier hs-type">fundsAtAddressCondition</span></a></span><span>
</span><span id="line-761"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561678"><span class="annot"><a href="#local-6989586621680561678"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561677"><span class="annot"><a href="#local-6989586621680561677"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561679"><span class="annot"><a href="#local-6989586621680561679"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-762"></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561679"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-763"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-764"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-765"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAddress</span></span><span>
</span><span id="line-766"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561678"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561677"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561679"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutRef</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DecoratedTxOut</span></span><span class="hs-special">)</span><span>
</span><span id="line-767"></span><span id="fundsAtAddressCondition"><span class="annot"><span class="annottext">fundsAtAddressCondition :: (Value -&gt; Bool)
-&gt; CardanoAddress -&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
</span><a href="Plutus.Contract.Request.html#fundsAtAddressCondition"><span class="hs-identifier hs-var hs-var">fundsAtAddressCondition</span></a></span></span><span> </span><span id="local-6989586621680560999"><span class="annot"><span class="annottext">Value -&gt; Bool
</span><a href="#local-6989586621680560999"><span class="hs-identifier hs-var">condition</span></a></span></span><span> </span><span id="local-6989586621680560998"><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680560998"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() -&gt; Contract w s e (Either () (Map TxOutRef DecoratedTxOut)))
-&gt; () -&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m (Either a b)) -&gt; a -&gt; m b
</span><a href="Plutus.Contract.Util.html#loopM"><span class="hs-identifier hs-var">loopM</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; Contract w s e (Either () (Map TxOutRef DecoratedTxOut))
</span><a href="#local-6989586621680560997"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-768"></span><span>    </span><span id="local-6989586621680560997"><span class="annot"><span class="annottext">go :: () -&gt; Contract w s e (Either () (Map TxOutRef DecoratedTxOut))
</span><a href="#local-6989586621680560997"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-769"></span><span>        </span><span id="local-6989586621680560996"><span class="annot"><span class="annottext">Map TxOutRef DecoratedTxOut
</span><a href="#local-6989586621680560996"><span class="hs-identifier hs-var">cur</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CardanoAddress -&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
forall w (s :: Row *) e.
AsContractError e =&gt;
CardanoAddress -&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
</span><a href="Plutus.Contract.Request.html#utxosAt"><span class="hs-identifier hs-var">utxosAt</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680560998"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-770"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680560995"><span class="annot"><span class="annottext">presentVal :: Value
</span><a href="#local-6989586621680560995"><span class="hs-identifier hs-var hs-var">presentVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DecoratedTxOut -&gt; Value) -&gt; Map TxOutRef DecoratedTxOut -&gt; Value
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting Value DecoratedTxOut Value -&gt; DecoratedTxOut -&gt; Value
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting Value DecoratedTxOut Value
Lens' DecoratedTxOut Value
</span><span class="hs-identifier hs-var">decoratedTxOutValue</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map TxOutRef DecoratedTxOut
</span><a href="#local-6989586621680560996"><span class="hs-identifier hs-var">cur</span></a></span><span>
</span><span id="line-771"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Bool
</span><a href="#local-6989586621680560999"><span class="hs-identifier hs-var">condition</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680560995"><span class="hs-identifier hs-var">presentVal</span></a></span><span>
</span><span id="line-772"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Either () (Map TxOutRef DecoratedTxOut)
-&gt; Contract w s e (Either () (Map TxOutRef DecoratedTxOut))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxOutRef DecoratedTxOut
-&gt; Either () (Map TxOutRef DecoratedTxOut)
forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef DecoratedTxOut
</span><a href="#local-6989586621680560996"><span class="hs-identifier hs-var">cur</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-773"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">CardanoAddress -&gt; Contract w s e (NonEmpty ChainIndexTx)
forall w (s :: Row *) e.
AsContractError e =&gt;
CardanoAddress -&gt; Contract w s e (NonEmpty ChainIndexTx)
</span><a href="Plutus.Contract.Request.html#awaitUtxoProduced"><span class="hs-identifier hs-var">awaitUtxoProduced</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680560998"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">Contract w s e (NonEmpty ChainIndexTx)
-&gt; Contract w s e (Either () (Map TxOutRef DecoratedTxOut))
-&gt; Contract w s e (Either () (Map TxOutRef DecoratedTxOut))
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Either () (Map TxOutRef DecoratedTxOut)
-&gt; Contract w s e (Either () (Map TxOutRef DecoratedTxOut))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Either () (Map TxOutRef DecoratedTxOut)
forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-774"></span><span>
</span><span id="line-775"></span><span class="hs-comment">-- | Watch an address for changes, and return the outputs</span><span>
</span><span id="line-776"></span><span class="hs-comment">--   at that address when the total value at the address</span><span>
</span><span id="line-777"></span><span class="hs-comment">--   has reached or surpassed the given value.</span><span>
</span><span id="line-778"></span><span class="annot"><a href="Plutus.Contract.Request.html#fundsAtAddressGeq"><span class="hs-identifier hs-type">fundsAtAddressGeq</span></a></span><span>
</span><span id="line-779"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680560993"><span class="annot"><a href="#local-6989586621680560993"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680560992"><span class="annot"><a href="#local-6989586621680560992"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680560991"><span class="annot"><a href="#local-6989586621680560991"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-780"></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560991"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-781"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-782"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAddress</span></span><span>
</span><span id="line-783"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Value</span></span><span>
</span><span id="line-784"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560993"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560992"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560991"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutRef</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DecoratedTxOut</span></span><span class="hs-special">)</span><span>
</span><span id="line-785"></span><span id="fundsAtAddressGeq"><span class="annot"><span class="annottext">fundsAtAddressGeq :: CardanoAddress
-&gt; Value -&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
</span><a href="Plutus.Contract.Request.html#fundsAtAddressGeq"><span class="hs-identifier hs-var hs-var">fundsAtAddressGeq</span></a></span></span><span> </span><span id="local-6989586621680560990"><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680560990"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621680560989"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680560989"><span class="hs-identifier hs-var">vl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-786"></span><span>    </span><span class="annot"><span class="annottext">(Value -&gt; Bool)
-&gt; CardanoAddress -&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
forall w (s :: Row *) e.
AsContractError e =&gt;
(Value -&gt; Bool)
-&gt; CardanoAddress -&gt; Contract w s e (Map TxOutRef DecoratedTxOut)
</span><a href="Plutus.Contract.Request.html#fundsAtAddressCondition"><span class="hs-identifier hs-var">fundsAtAddressCondition</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680560988"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680560988"><span class="hs-identifier hs-var">presentVal</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680560988"><span class="hs-identifier hs-var">presentVal</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; Bool
</span><span class="hs-operator hs-var">`valueGeq`</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680560989"><span class="hs-identifier hs-var">vl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680560990"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-787"></span><span>
</span><span id="line-788"></span><span class="hs-comment">-- | Wait for the status of a transaction to change</span><span>
</span><span id="line-789"></span><span class="annot"><a href="Plutus.Contract.Request.html#awaitTxStatusChange"><span class="hs-identifier hs-type">awaitTxStatusChange</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561649"><span class="annot"><a href="#local-6989586621680561649"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561648"><span class="annot"><a href="#local-6989586621680561648"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561650"><span class="annot"><a href="#local-6989586621680561650"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561650"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.TxId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561649"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561648"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561650"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxStatus</span></span><span>
</span><span id="line-790"></span><span id="awaitTxStatusChange"><span class="annot"><span class="annottext">awaitTxStatusChange :: TxId -&gt; Contract w s e TxStatus
</span><a href="Plutus.Contract.Request.html#awaitTxStatusChange"><span class="hs-identifier hs-var hs-var">awaitTxStatusChange</span></a></span></span><span> </span><span id="local-6989586621680560987"><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621680560987"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PABReq -&gt; Prism' PABResp TxStatus -&gt; Contract w s e TxStatus
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxId -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#AwaitTxStatusChangeReq"><span class="hs-identifier hs-var">AwaitTxStatusChangeReq</span></a></span><span> </span><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621680560987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxId -&gt; Prism' PABResp TxStatus
</span><a href="Plutus.Contract.Effects.html#_AwaitTxStatusChangeResp%27"><span class="hs-identifier hs-var">E._AwaitTxStatusChangeResp'</span></a></span><span> </span><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621680560987"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-791"></span><span>
</span><span id="line-792"></span><span class="hs-comment">-- TODO: Configurable level of confirmation (for example, as soon as the tx is</span><span>
</span><span id="line-793"></span><span class="hs-comment">--       included in a block, or only when it can't be rolled back anymore)</span><span>
</span><span id="line-794"></span><span class="hs-comment">-- | Wait until a transaction is confirmed (added to the ledger).</span><span>
</span><span id="line-795"></span><span class="hs-comment">--   If the transaction is never added to the ledger then 'awaitTxConfirmed' never</span><span>
</span><span id="line-796"></span><span class="hs-comment">--   returns</span><span>
</span><span id="line-797"></span><span class="annot"><a href="Plutus.Contract.Request.html#awaitTxConfirmed"><span class="hs-identifier hs-type">awaitTxConfirmed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561643"><span class="annot"><a href="#local-6989586621680561643"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561642"><span class="annot"><a href="#local-6989586621680561642"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561644"><span class="annot"><a href="#local-6989586621680561644"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561644"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.TxId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561643"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561642"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561644"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-798"></span><span id="awaitTxConfirmed"><span class="annot"><span class="annottext">awaitTxConfirmed :: TxId -&gt; Contract w s e ()
</span><a href="Plutus.Contract.Request.html#awaitTxConfirmed"><span class="hs-identifier hs-var hs-var">awaitTxConfirmed</span></a></span></span><span> </span><span id="local-6989586621680560985"><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621680560985"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Contract w s e ()
</span><a href="#local-6989586621680560984"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-799"></span><span>  </span><span id="local-6989586621680560984"><span class="annot"><span class="annottext">go :: Contract w s e ()
</span><a href="#local-6989586621680560984"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-800"></span><span>    </span><span id="local-6989586621680560983"><span class="annot"><span class="annottext">TxStatus
</span><a href="#local-6989586621680560983"><span class="hs-identifier hs-var">newStatus</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxId -&gt; Contract w s e TxStatus
forall w (s :: Row *) e.
AsContractError e =&gt;
TxId -&gt; Contract w s e TxStatus
</span><a href="Plutus.Contract.Request.html#awaitTxStatusChange"><span class="hs-identifier hs-var">awaitTxStatusChange</span></a></span><span> </span><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621680560985"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-801"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxStatus
</span><a href="#local-6989586621680560983"><span class="hs-identifier hs-var">newStatus</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-802"></span><span>      </span><span class="annot"><span class="annottext">TxStatus
</span><span class="hs-identifier hs-var">Unknown</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Contract w s e ()
</span><a href="#local-6989586621680560984"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-803"></span><span>      </span><span class="annot"><span class="annottext">TxStatus
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Contract w s e ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-804"></span><span>
</span><span id="line-805"></span><span class="hs-comment">-- | Wait until a transaction is confirmed (added to the ledger).</span><span>
</span><span id="line-806"></span><span class="annot"><a href="Plutus.Contract.Request.html#isTxConfirmed"><span class="hs-identifier hs-type">isTxConfirmed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680560982"><span class="annot"><a href="#local-6989586621680560982"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680560981"><span class="annot"><a href="#local-6989586621680560981"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680560980"><span class="annot"><a href="#local-6989586621680560980"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560980"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.TxId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Promise"><span class="hs-identifier hs-type">Promise</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560982"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560981"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560980"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-807"></span><span id="isTxConfirmed"><span class="annot"><span class="annottext">isTxConfirmed :: TxId -&gt; Promise w s e ()
</span><a href="Plutus.Contract.Request.html#isTxConfirmed"><span class="hs-identifier hs-var hs-var">isTxConfirmed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Contract w s e () -&gt; Promise w s e ()
forall w (s :: Row *) e a. Contract w s e a -&gt; Promise w s e a
</span><a href="Plutus.Contract.Types.html#Promise"><span class="hs-identifier hs-var">Promise</span></a></span><span> </span><span class="annot"><span class="annottext">(Contract w s e () -&gt; Promise w s e ())
-&gt; (TxId -&gt; Contract w s e ()) -&gt; TxId -&gt; Promise w s e ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TxId -&gt; Contract w s e ()
forall w (s :: Row *) e.
AsContractError e =&gt;
TxId -&gt; Contract w s e ()
</span><a href="Plutus.Contract.Request.html#awaitTxConfirmed"><span class="hs-identifier hs-var">awaitTxConfirmed</span></a></span><span>
</span><span id="line-808"></span><span>
</span><span id="line-809"></span><span class="hs-comment">-- | Wait for the status of a transaction output to change.</span><span>
</span><span id="line-810"></span><span class="annot"><a href="Plutus.Contract.Request.html#awaitTxOutStatusChange"><span class="hs-identifier hs-type">awaitTxOutStatusChange</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680560979"><span class="annot"><a href="#local-6989586621680560979"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680560978"><span class="annot"><a href="#local-6989586621680560978"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680560977"><span class="annot"><a href="#local-6989586621680560977"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560977"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutRef</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560979"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560978"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560977"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutStatus</span></span><span>
</span><span id="line-811"></span><span id="awaitTxOutStatusChange"><span class="annot"><span class="annottext">awaitTxOutStatusChange :: TxOutRef -&gt; Contract w s e TxOutStatus
</span><a href="Plutus.Contract.Request.html#awaitTxOutStatusChange"><span class="hs-identifier hs-var hs-var">awaitTxOutStatusChange</span></a></span></span><span> </span><span id="local-6989586621680560976"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680560976"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-812"></span><span>  </span><span id="local-6989586621680560975"><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621680560975"><span class="hs-identifier hs-var">txIn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ToCardanoError -&gt; Contract w s e TxIn)
-&gt; (TxIn -&gt; Contract w s e TxIn)
-&gt; Either ToCardanoError TxIn
-&gt; Contract w s e TxIn
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">e -&gt; Contract w s e TxIn
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; Contract w s e TxIn)
-&gt; (ToCardanoError -&gt; e) -&gt; ToCardanoError -&gt; Contract w s e TxIn
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">AReview e ToCardanoError -&gt; ToCardanoError -&gt; e
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview e ToCardanoError
forall r. AsContractError r =&gt; Prism' r ToCardanoError
</span><a href="Plutus.Contract.Error.html#_ToCardanoConvertContractError"><span class="hs-identifier hs-var">_ToCardanoConvertContractError</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxIn -&gt; Contract w s e TxIn
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ToCardanoError TxIn -&gt; Contract w s e TxIn)
-&gt; Either ToCardanoError TxIn -&gt; Contract w s e TxIn
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; Either ToCardanoError TxIn
</span><span class="hs-identifier hs-var">toCardanoTxIn</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680560976"><span class="hs-identifier hs-var">ref</span></a></span><span>
</span><span id="line-813"></span><span>  </span><span class="annot"><span class="annottext">(TxIn, TxOutStatus) -&gt; TxOutStatus
forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">((TxIn, TxOutStatus) -&gt; TxOutStatus)
-&gt; Contract w s e (TxIn, TxOutStatus) -&gt; Contract w s e TxOutStatus
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PABReq
-&gt; Prism' PABResp (TxIn, TxOutStatus)
-&gt; Contract w s e (TxIn, TxOutStatus)
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#AwaitTxOutStatusChangeReq"><span class="hs-identifier hs-var">AwaitTxOutStatusChangeReq</span></a></span><span> </span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621680560975"><span class="hs-identifier hs-var">txIn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prism' PABResp (TxIn, TxOutStatus)
</span><a href="Plutus.Contract.Effects.html#_AwaitTxOutStatusChangeResp"><span class="hs-identifier hs-var">E._AwaitTxOutStatusChangeResp</span></a></span><span>
</span><span id="line-814"></span><span>
</span><span id="line-815"></span><span class="hs-comment">-- | Get the 'ContractInstanceId' of this instance.</span><span>
</span><span id="line-816"></span><span class="annot"><a href="Plutus.Contract.Request.html#ownInstanceId"><span class="hs-identifier hs-type">ownInstanceId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680560973"><span class="annot"><a href="#local-6989586621680560973"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680560972"><span class="annot"><a href="#local-6989586621680560972"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680560971"><span class="annot"><a href="#local-6989586621680560971"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560971"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560973"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560972"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560971"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="Wallet.Types.html#ContractInstanceId"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span>
</span><span id="line-817"></span><span id="ownInstanceId"><span class="annot"><span class="annottext">ownInstanceId :: Contract w s e ContractInstanceId
</span><a href="Plutus.Contract.Request.html#ownInstanceId"><span class="hs-identifier hs-var hs-var">ownInstanceId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PABReq
-&gt; Prism' PABResp ContractInstanceId
-&gt; Contract w s e ContractInstanceId
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="annot"><span class="annottext">PABReq
</span><a href="Plutus.Contract.Effects.html#OwnContractInstanceIdReq"><span class="hs-identifier hs-var">OwnContractInstanceIdReq</span></a></span><span> </span><span class="annot"><span class="annottext">Prism' PABResp ContractInstanceId
</span><a href="Plutus.Contract.Effects.html#_OwnContractInstanceIdResp"><span class="hs-identifier hs-var">E._OwnContractInstanceIdResp</span></a></span><span>
</span><span id="line-818"></span><span>
</span><span id="line-819"></span><span class="hs-keyword">type</span><span> </span><span id="HasEndpoint"><span class="annot"><a href="Plutus.Contract.Request.html#HasEndpoint"><span class="hs-identifier hs-var">HasEndpoint</span></a></span></span><span> </span><span id="local-6989586621680560969"><span class="annot"><a href="#local-6989586621680560969"><span class="hs-identifier hs-type">l</span></a></span></span><span> </span><span id="local-6989586621680560968"><span class="annot"><a href="#local-6989586621680560968"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621680560967"><span class="annot"><a href="#local-6989586621680560967"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-820"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasType</span></span><span> </span><span class="annot"><a href="#local-6989586621680560969"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Wallet.Types.html#EndpointValue"><span class="hs-identifier hs-type">EndpointValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560968"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Schema.html#Input"><span class="hs-identifier hs-type">Input</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560967"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-821"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasType</span></span><span> </span><span class="annot"><a href="#local-6989586621680560969"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#ActiveEndpoint"><span class="hs-identifier hs-type">ActiveEndpoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Schema.html#Output"><span class="hs-identifier hs-type">Output</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560967"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-822"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">KnownSymbol</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560969"><span class="hs-identifier hs-type">l</span></a></span><span>
</span><span id="line-823"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#ContractRow"><span class="hs-identifier hs-type">ContractRow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560967"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-824"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-825"></span><span>
</span><span id="line-826"></span><span class="hs-keyword">type</span><span> </span><span id="Endpoint"><span class="annot"><a href="Plutus.Contract.Request.html#Endpoint"><span class="hs-identifier hs-var">Endpoint</span></a></span></span><span> </span><span id="local-6989586621680560966"><span class="annot"><a href="#local-6989586621680560966"><span class="hs-identifier hs-type">l</span></a></span></span><span> </span><span id="local-6989586621680560965"><span class="annot"><a href="#local-6989586621680560965"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621680560966"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Wallet.Types.html#EndpointValue"><span class="hs-identifier hs-type">EndpointValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560965"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#ActiveEndpoint"><span class="hs-identifier hs-type">ActiveEndpoint</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-827"></span><span>
</span><span id="line-828"></span><span class="annot"><a href="Plutus.Contract.Request.html#endpointReq"><span class="hs-identifier hs-type">endpointReq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561606"><span class="annot"><a href="#local-6989586621680561606"><span class="hs-identifier hs-type">l</span></a></span></span><span> </span><span id="local-6989586621680561605"><span class="annot"><a href="#local-6989586621680561605"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621680561604"><span class="annot"><a href="#local-6989586621680561604"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-829"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#HasEndpoint"><span class="hs-identifier hs-type">HasEndpoint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561606"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561605"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561604"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-830"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#ActiveEndpoint"><span class="hs-identifier hs-type">ActiveEndpoint</span></a></span><span>
</span><span id="line-831"></span><span id="endpointReq"><span class="annot"><span class="annottext">endpointReq :: ActiveEndpoint
</span><a href="Plutus.Contract.Request.html#endpointReq"><span class="hs-identifier hs-var hs-var">endpointReq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-832"></span><span>    </span><span class="annot"><span class="annottext">ActiveEndpoint :: EndpointDescription -&gt; Maybe Value -&gt; ActiveEndpoint
</span><a href="Plutus.Contract.Effects.html#ActiveEndpoint"><span class="hs-identifier hs-type">ActiveEndpoint</span></a></span><span>
</span><span id="line-833"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">aeDescription :: EndpointDescription
</span><a href="Plutus.Contract.Effects.html#aeDescription"><span class="hs-identifier hs-var">aeDescription</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; EndpointDescription
</span><a href="Wallet.Types.html#EndpointDescription"><span class="hs-identifier hs-var">EndpointDescription</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; EndpointDescription) -&gt; String -&gt; EndpointDescription
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy l -&gt; String
forall (n :: Symbol) (proxy :: Symbol -&gt; *).
KnownSymbol n =&gt;
proxy n -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">symbolVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy l
forall k (t :: k). Proxy t
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680561606"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-834"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">aeMetadata :: Maybe Value
</span><a href="Plutus.Contract.Effects.html#aeMetadata"><span class="hs-identifier hs-var">aeMetadata</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Value
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-835"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-836"></span><span>
</span><span id="line-837"></span><span class="annot"><a href="Plutus.Contract.Request.html#endpointDesc"><span class="hs-identifier hs-type">endpointDesc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680561617"><span class="annot"><a href="#local-6989586621680561617"><span class="hs-identifier hs-type">l</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">KnownSymbol</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561617"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Wallet.Types.html#EndpointDescription"><span class="hs-identifier hs-type">EndpointDescription</span></a></span><span>
</span><span id="line-838"></span><span id="endpointDesc"><span class="annot"><span class="annottext">endpointDesc :: EndpointDescription
</span><a href="Plutus.Contract.Request.html#endpointDesc"><span class="hs-identifier hs-var hs-var">endpointDesc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; EndpointDescription
</span><a href="Wallet.Types.html#EndpointDescription"><span class="hs-identifier hs-var">EndpointDescription</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; EndpointDescription) -&gt; String -&gt; EndpointDescription
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy l -&gt; String
forall (n :: Symbol) (proxy :: Symbol -&gt; *).
KnownSymbol n =&gt;
proxy n -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">symbolVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy l
forall k (t :: k). Proxy t
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680561617"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-839"></span><span>
</span><span id="line-840"></span><span class="annot"><a href="Plutus.Contract.Request.html#endpointResp"><span class="hs-identifier hs-type">endpointResp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680560963"><span class="annot"><a href="#local-6989586621680560963"><span class="hs-identifier hs-type">l</span></a></span></span><span> </span><span id="local-6989586621680560962"><span class="annot"><a href="#local-6989586621680560962"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621680560961"><span class="annot"><a href="#local-6989586621680560961"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Request.html#HasEndpoint"><span class="hs-identifier hs-type">HasEndpoint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560963"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560962"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560961"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680560962"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680560962"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#PABResp"><span class="hs-identifier hs-type">PABResp</span></a></span><span>
</span><span id="line-841"></span><span id="endpointResp"><span class="annot"><span class="annottext">endpointResp :: a -&gt; PABResp
</span><a href="Plutus.Contract.Request.html#endpointResp"><span class="hs-identifier hs-var hs-var">endpointResp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EndpointDescription -&gt; EndpointValue Value -&gt; PABResp
</span><a href="Plutus.Contract.Effects.html#ExposeEndpointResp"><span class="hs-identifier hs-var">ExposeEndpointResp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KnownSymbol l =&gt; EndpointDescription
forall (l :: Symbol). KnownSymbol l =&gt; EndpointDescription
</span><a href="Plutus.Contract.Request.html#endpointDesc"><span class="hs-identifier hs-var">endpointDesc</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680560963"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(EndpointValue Value -&gt; PABResp)
-&gt; (a -&gt; EndpointValue Value) -&gt; a -&gt; PABResp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; EndpointValue Value
forall a. a -&gt; EndpointValue a
</span><a href="Wallet.Types.html#EndpointValue"><span class="hs-identifier hs-var">EndpointValue</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; EndpointValue Value)
-&gt; (a -&gt; Value) -&gt; a -&gt; EndpointValue Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">JSON.toJSON</span></span><span>
</span><span id="line-842"></span><span>
</span><span id="line-843"></span><span class="hs-comment">-- | Expose an endpoint, return the data that was entered</span><span>
</span><span id="line-844"></span><span class="annot"><a href="Plutus.Contract.Request.html#endpoint"><span class="hs-identifier hs-type">endpoint</span></a></span><span>
</span><span id="line-845"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680560959"><span class="annot"><a href="#local-6989586621680560959"><span class="hs-identifier hs-type">l</span></a></span></span><span> </span><span id="local-6989586621680560958"><span class="annot"><a href="#local-6989586621680560958"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621680560957"><span class="annot"><a href="#local-6989586621680560957"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680560956"><span class="annot"><a href="#local-6989586621680560956"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680560955"><span class="annot"><a href="#local-6989586621680560955"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621680560954"><span class="annot"><a href="#local-6989586621680560954"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-846"></span><span>     </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#HasEndpoint"><span class="hs-identifier hs-type">HasEndpoint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560959"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560958"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560956"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-847"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560955"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-848"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680560958"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-849"></span><span>     </span><span class="hs-special">)</span><span>
</span><span id="line-850"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680560958"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560957"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560956"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560955"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560954"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Promise"><span class="hs-identifier hs-type">Promise</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560957"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560956"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560955"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560954"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-851"></span><span id="endpoint"><span class="annot"><span class="annottext">endpoint :: (a -&gt; Contract w s e b) -&gt; Promise w s e b
</span><a href="Plutus.Contract.Request.html#endpoint"><span class="hs-identifier hs-var hs-var">endpoint</span></a></span></span><span> </span><span id="local-6989586621680560953"><span class="annot"><span class="annottext">a -&gt; Contract w s e b
</span><a href="#local-6989586621680560953"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Contract w s e b -&gt; Promise w s e b
forall w (s :: Row *) e a. Contract w s e a -&gt; Promise w s e a
</span><a href="Plutus.Contract.Types.html#Promise"><span class="hs-identifier hs-var">Promise</span></a></span><span> </span><span class="annot"><span class="annottext">(Contract w s e b -&gt; Promise w s e b)
-&gt; Contract w s e b -&gt; Promise w s e b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-852"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680560952"><span class="annot"><span class="annottext">EndpointDescription
</span><a href="#local-6989586621680560952"><span class="hs-identifier hs-var">ed</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680560951"><span class="annot"><span class="annottext">EndpointValue Value
</span><a href="#local-6989586621680560951"><span class="hs-identifier hs-var">ev</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PABReq
-&gt; Prism' PABResp (EndpointDescription, EndpointValue Value)
-&gt; Contract w s e (EndpointDescription, EndpointValue Value)
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ActiveEndpoint -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#ExposeEndpointReq"><span class="hs-identifier hs-var">ExposeEndpointReq</span></a></span><span> </span><span class="annot"><span class="annottext">(ActiveEndpoint -&gt; PABReq) -&gt; ActiveEndpoint -&gt; PABReq
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">HasEndpoint l a s =&gt; ActiveEndpoint
forall (l :: Symbol) a (s :: Row *).
HasEndpoint l a s =&gt;
ActiveEndpoint
</span><a href="Plutus.Contract.Request.html#endpointReq"><span class="hs-identifier hs-var">endpointReq</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680560959"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680560958"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680560956"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prism' PABResp (EndpointDescription, EndpointValue Value)
</span><a href="Plutus.Contract.Effects.html#_ExposeEndpointResp"><span class="hs-identifier hs-var">E._ExposeEndpointResp</span></a></span><span>
</span><span id="line-853"></span><span>    </span><span id="local-6989586621680560949"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680560949"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EndpointDescription -&gt; EndpointValue Value -&gt; Contract w s e a
forall a w (s :: Row *) e.
(FromJSON a, AsContractError e) =&gt;
EndpointDescription -&gt; EndpointValue Value -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#decode"><span class="hs-identifier hs-var">decode</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointDescription
</span><a href="#local-6989586621680560952"><span class="hs-identifier hs-var">ed</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointValue Value
</span><a href="#local-6989586621680560951"><span class="hs-identifier hs-var">ev</span></a></span><span>
</span><span id="line-854"></span><span>    </span><span class="annot"><span class="annottext">a -&gt; Contract w s e b
</span><a href="#local-6989586621680560953"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680560949"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-855"></span><span>
</span><span id="line-856"></span><span class="annot"><a href="Plutus.Contract.Request.html#decode"><span class="hs-identifier hs-type">decode</span></a></span><span>
</span><span id="line-857"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561603"><span class="annot"><a href="#local-6989586621680561603"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621680561600"><span class="annot"><a href="#local-6989586621680561600"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561599"><span class="annot"><a href="#local-6989586621680561599"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561601"><span class="annot"><a href="#local-6989586621680561601"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-858"></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680561603"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-859"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561601"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-860"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-861"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Wallet.Types.html#EndpointDescription"><span class="hs-identifier hs-type">EndpointDescription</span></a></span><span>
</span><span id="line-862"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Wallet.Types.html#EndpointValue"><span class="hs-identifier hs-type">EndpointValue</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">JSON.Value</span></span><span>
</span><span id="line-863"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561600"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561599"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561601"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561603"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-864"></span><span id="decode"><span class="annot"><span class="annottext">decode :: EndpointDescription -&gt; EndpointValue Value -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#decode"><span class="hs-identifier hs-var hs-var">decode</span></a></span></span><span> </span><span id="local-6989586621680560947"><span class="annot"><span class="annottext">EndpointDescription
</span><a href="#local-6989586621680560947"><span class="hs-identifier hs-var">ed</span></a></span></span><span> </span><span id="local-6989586621680560946"><span class="annot"><span class="annottext">ev :: EndpointValue Value
</span><a href="#local-6989586621680560946"><span class="hs-identifier hs-var">ev</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Wallet.Types.html#EndpointValue"><span class="hs-identifier hs-type">EndpointValue</span></a></span><span class="hs-special">{</span><span id="local-6989586621680560945"><span class="annot"><span class="annottext">Value
unEndpointValue :: Value
unEndpointValue :: forall a. EndpointValue a -&gt; a
</span><a href="#local-6989586621680560945"><span class="hs-identifier hs-var hs-var">unEndpointValue</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-865"></span><span>    </span><span class="annot"><span class="annottext">(String -&gt; Contract w s e a)
-&gt; (a -&gt; Contract w s e a) -&gt; Either String a -&gt; Contract w s e a
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span>
</span><span id="line-866"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680560944"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680560944"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e -&gt; Contract w s e a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; Contract w s e a) -&gt; e -&gt; Contract w s e a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AReview e (EndpointDescription, EndpointValue Value, Text)
-&gt; (EndpointDescription, EndpointValue Value, Text) -&gt; e
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview e (EndpointDescription, EndpointValue Value, Text)
forall r.
AsContractError r =&gt;
Prism' r (EndpointDescription, EndpointValue Value, Text)
</span><a href="Plutus.Contract.Error.html#_EndpointDecodeContractError"><span class="hs-identifier hs-var">_EndpointDecodeContractError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EndpointDescription
</span><a href="#local-6989586621680560947"><span class="hs-identifier hs-var">ed</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">EndpointValue Value
</span><a href="#local-6989586621680560946"><span class="hs-identifier hs-var">ev</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680560944"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-867"></span><span>        </span><span class="annot"><span class="annottext">a -&gt; Contract w s e a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-868"></span><span>        </span><span class="annot"><span class="annottext">(Either String a -&gt; Contract w s e a)
-&gt; Either String a -&gt; Contract w s e a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Parser a) -&gt; Value -&gt; Either String a
forall a b. (a -&gt; Parser b) -&gt; a -&gt; Either String b
</span><span class="hs-identifier hs-var">JSON.parseEither</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser a
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">JSON.parseJSON</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680560945"><span class="hs-identifier hs-var">unEndpointValue</span></a></span><span>
</span><span id="line-869"></span><span>
</span><span id="line-870"></span><span class="annot"><a href="Plutus.Contract.Request.html#handleEndpoint"><span class="hs-identifier hs-type">handleEndpoint</span></a></span><span>
</span><span id="line-871"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680560940"><span class="annot"><a href="#local-6989586621680560940"><span class="hs-identifier hs-type">l</span></a></span></span><span> </span><span id="local-6989586621680560939"><span class="annot"><a href="#local-6989586621680560939"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621680560938"><span class="annot"><a href="#local-6989586621680560938"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680560937"><span class="annot"><a href="#local-6989586621680560937"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680560936"><span class="annot"><a href="#local-6989586621680560936"><span class="hs-identifier hs-type">e1</span></a></span></span><span> </span><span id="local-6989586621680560935"><span class="annot"><a href="#local-6989586621680560935"><span class="hs-identifier hs-type">e2</span></a></span></span><span> </span><span id="local-6989586621680560934"><span class="annot"><a href="#local-6989586621680560934"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-872"></span><span>     </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#HasEndpoint"><span class="hs-identifier hs-type">HasEndpoint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560940"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560939"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560937"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-873"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560936"><span class="hs-identifier hs-type">e1</span></a></span><span>
</span><span id="line-874"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680560939"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-875"></span><span>     </span><span class="hs-special">)</span><span>
</span><span id="line-876"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560936"><span class="hs-identifier hs-type">e1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560939"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560938"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560937"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560935"><span class="hs-identifier hs-type">e2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560934"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Promise"><span class="hs-identifier hs-type">Promise</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560938"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560937"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560935"><span class="hs-identifier hs-type">e2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560934"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-877"></span><span id="handleEndpoint"><span class="annot"><span class="annottext">handleEndpoint :: (Either e1 a -&gt; Contract w s e2 b) -&gt; Promise w s e2 b
</span><a href="Plutus.Contract.Request.html#handleEndpoint"><span class="hs-identifier hs-var hs-var">handleEndpoint</span></a></span></span><span> </span><span id="local-6989586621680560933"><span class="annot"><span class="annottext">Either e1 a -&gt; Contract w s e2 b
</span><a href="#local-6989586621680560933"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Contract w s e2 b -&gt; Promise w s e2 b
forall w (s :: Row *) e a. Contract w s e a -&gt; Promise w s e a
</span><a href="Plutus.Contract.Types.html#Promise"><span class="hs-identifier hs-var">Promise</span></a></span><span> </span><span class="annot"><span class="annottext">(Contract w s e2 b -&gt; Promise w s e2 b)
-&gt; Contract w s e2 b -&gt; Promise w s e2 b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-878"></span><span>  </span><span id="local-6989586621680560932"><span class="annot"><span class="annottext">Either e1 a
</span><a href="#local-6989586621680560932"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Contract w s e1 a -&gt; Contract w s e2 (Either e1 a)
forall w (s :: Row *) e e0 a.
Contract w s e a -&gt; Contract w s e0 (Either e a)
</span><a href="Plutus.Contract.Types.html#runError"><span class="hs-identifier hs-var">runError</span></a></span><span> </span><span class="annot"><span class="annottext">(Contract w s e1 a -&gt; Contract w s e2 (Either e1 a))
-&gt; Contract w s e1 a -&gt; Contract w s e2 (Either e1 a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-879"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621680560931"><span class="annot"><span class="annottext">EndpointDescription
</span><a href="#local-6989586621680560931"><span class="hs-identifier hs-var">ed</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680560930"><span class="annot"><span class="annottext">EndpointValue Value
</span><a href="#local-6989586621680560930"><span class="hs-identifier hs-var">ev</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PABReq
-&gt; Prism' PABResp (EndpointDescription, EndpointValue Value)
-&gt; Contract w s e1 (EndpointDescription, EndpointValue Value)
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ActiveEndpoint -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#ExposeEndpointReq"><span class="hs-identifier hs-var">ExposeEndpointReq</span></a></span><span> </span><span class="annot"><span class="annottext">(ActiveEndpoint -&gt; PABReq) -&gt; ActiveEndpoint -&gt; PABReq
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">HasEndpoint l a s =&gt; ActiveEndpoint
forall (l :: Symbol) a (s :: Row *).
HasEndpoint l a s =&gt;
ActiveEndpoint
</span><a href="Plutus.Contract.Request.html#endpointReq"><span class="hs-identifier hs-var">endpointReq</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680560940"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680560939"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680560937"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prism' PABResp (EndpointDescription, EndpointValue Value)
</span><a href="Plutus.Contract.Effects.html#_ExposeEndpointResp"><span class="hs-identifier hs-var">E._ExposeEndpointResp</span></a></span><span>
</span><span id="line-880"></span><span>      </span><span class="annot"><span class="annottext">EndpointDescription -&gt; EndpointValue Value -&gt; Contract w s e1 a
forall a w (s :: Row *) e.
(FromJSON a, AsContractError e) =&gt;
EndpointDescription -&gt; EndpointValue Value -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#decode"><span class="hs-identifier hs-var">decode</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointDescription
</span><a href="#local-6989586621680560931"><span class="hs-identifier hs-var">ed</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointValue Value
</span><a href="#local-6989586621680560930"><span class="hs-identifier hs-var">ev</span></a></span><span>
</span><span id="line-881"></span><span>  </span><span class="annot"><span class="annottext">Either e1 a -&gt; Contract w s e2 b
</span><a href="#local-6989586621680560933"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Either e1 a
</span><a href="#local-6989586621680560932"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-882"></span><span>
</span><span id="line-883"></span><span class="hs-comment">-- | Expose an endpoint with some metadata. Return the data that was entered.</span><span>
</span><span id="line-884"></span><span class="annot"><a href="Plutus.Contract.Request.html#endpointWithMeta"><span class="hs-identifier hs-type">endpointWithMeta</span></a></span><span>
</span><span id="line-885"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680560929"><span class="annot"><a href="#local-6989586621680560929"><span class="hs-identifier hs-type">l</span></a></span></span><span> </span><span id="local-6989586621680560928"><span class="annot"><a href="#local-6989586621680560928"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621680560927"><span class="annot"><a href="#local-6989586621680560927"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680560926"><span class="annot"><a href="#local-6989586621680560926"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680560925"><span class="annot"><a href="#local-6989586621680560925"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621680560924"><span class="annot"><a href="#local-6989586621680560924"><span class="hs-identifier hs-type">meta</span></a></span></span><span> </span><span id="local-6989586621680560923"><span class="annot"><a href="#local-6989586621680560923"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-886"></span><span>     </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Request.html#HasEndpoint"><span class="hs-identifier hs-type">HasEndpoint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560929"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560928"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560926"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-887"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560925"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-888"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680560924"><span class="hs-identifier hs-type">meta</span></a></span><span>
</span><span id="line-889"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680560928"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-890"></span><span>     </span><span class="hs-special">)</span><span>
</span><span id="line-891"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680560924"><span class="hs-identifier hs-type">meta</span></a></span><span>
</span><span id="line-892"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680560928"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560927"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560926"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560925"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560923"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-893"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Promise"><span class="hs-identifier hs-type">Promise</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560927"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560926"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560925"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560923"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-894"></span><span id="endpointWithMeta"><span class="annot"><span class="annottext">endpointWithMeta :: meta -&gt; (a -&gt; Contract w s e b) -&gt; Promise w s e b
</span><a href="Plutus.Contract.Request.html#endpointWithMeta"><span class="hs-identifier hs-var hs-var">endpointWithMeta</span></a></span></span><span> </span><span id="local-6989586621680560922"><span class="annot"><span class="annottext">meta
</span><a href="#local-6989586621680560922"><span class="hs-identifier hs-var">meta</span></a></span></span><span> </span><span id="local-6989586621680560921"><span class="annot"><span class="annottext">a -&gt; Contract w s e b
</span><a href="#local-6989586621680560921"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Contract w s e b -&gt; Promise w s e b
forall w (s :: Row *) e a. Contract w s e a -&gt; Promise w s e a
</span><a href="Plutus.Contract.Types.html#Promise"><span class="hs-identifier hs-var">Promise</span></a></span><span> </span><span class="annot"><span class="annottext">(Contract w s e b -&gt; Promise w s e b)
-&gt; Contract w s e b -&gt; Promise w s e b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-895"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680560920"><span class="annot"><span class="annottext">EndpointDescription
</span><a href="#local-6989586621680560920"><span class="hs-identifier hs-var">ed</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680560919"><span class="annot"><span class="annottext">EndpointValue Value
</span><a href="#local-6989586621680560919"><span class="hs-identifier hs-var">ev</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PABReq
-&gt; Prism' PABResp (EndpointDescription, EndpointValue Value)
-&gt; Contract w s e (EndpointDescription, EndpointValue Value)
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ActiveEndpoint -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#ExposeEndpointReq"><span class="hs-identifier hs-var">ExposeEndpointReq</span></a></span><span> </span><span class="annot"><span class="annottext">ActiveEndpoint
</span><a href="#local-6989586621680560918"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prism' PABResp (EndpointDescription, EndpointValue Value)
</span><a href="Plutus.Contract.Effects.html#_ExposeEndpointResp"><span class="hs-identifier hs-var">E._ExposeEndpointResp</span></a></span><span>
</span><span id="line-896"></span><span>    </span><span id="local-6989586621680560917"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680560917"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EndpointDescription -&gt; EndpointValue Value -&gt; Contract w s e a
forall a w (s :: Row *) e.
(FromJSON a, AsContractError e) =&gt;
EndpointDescription -&gt; EndpointValue Value -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#decode"><span class="hs-identifier hs-var">decode</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointDescription
</span><a href="#local-6989586621680560920"><span class="hs-identifier hs-var">ed</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointValue Value
</span><a href="#local-6989586621680560919"><span class="hs-identifier hs-var">ev</span></a></span><span>
</span><span id="line-897"></span><span>    </span><span class="annot"><span class="annottext">a -&gt; Contract w s e b
</span><a href="#local-6989586621680560921"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680560917"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-898"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-899"></span><span>        </span><span id="local-6989586621680560918"><span class="annot"><span class="annottext">s :: ActiveEndpoint
</span><a href="#local-6989586621680560918"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ActiveEndpoint :: EndpointDescription -&gt; Maybe Value -&gt; ActiveEndpoint
</span><a href="Plutus.Contract.Effects.html#ActiveEndpoint"><span class="hs-identifier hs-type">ActiveEndpoint</span></a></span><span>
</span><span id="line-900"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">aeDescription :: EndpointDescription
</span><a href="Plutus.Contract.Effects.html#aeDescription"><span class="hs-identifier hs-var">aeDescription</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KnownSymbol l =&gt; EndpointDescription
forall (l :: Symbol). KnownSymbol l =&gt; EndpointDescription
</span><a href="Plutus.Contract.Request.html#endpointDesc"><span class="hs-identifier hs-var">endpointDesc</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680560929"><span class="hs-identifier hs-type">l</span></a></span><span>
</span><span id="line-901"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">aeMetadata :: Maybe Value
</span><a href="Plutus.Contract.Effects.html#aeMetadata"><span class="hs-identifier hs-var">aeMetadata</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Maybe Value
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Maybe Value) -&gt; Value -&gt; Maybe Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">meta -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">JSON.toJSON</span></span><span> </span><span class="annot"><span class="annottext">meta
</span><a href="#local-6989586621680560922"><span class="hs-identifier hs-var">meta</span></a></span><span>
</span><span id="line-902"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-903"></span><span>
</span><span id="line-904"></span><span class="annot"><a href="Plutus.Contract.Request.html#endpointDescription"><span class="hs-identifier hs-type">endpointDescription</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680560916"><span class="annot"><a href="#local-6989586621680560916"><span class="hs-identifier hs-type">l</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">KnownSymbol</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560916"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560916"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Wallet.Types.html#EndpointDescription"><span class="hs-identifier hs-type">EndpointDescription</span></a></span><span>
</span><span id="line-905"></span><span id="endpointDescription"><span class="annot"><span class="annottext">endpointDescription :: Proxy l -&gt; EndpointDescription
</span><a href="Plutus.Contract.Request.html#endpointDescription"><span class="hs-identifier hs-var hs-var">endpointDescription</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; EndpointDescription
</span><a href="Wallet.Types.html#EndpointDescription"><span class="hs-identifier hs-var">EndpointDescription</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; EndpointDescription)
-&gt; (Proxy l -&gt; String) -&gt; Proxy l -&gt; EndpointDescription
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy l -&gt; String
forall (n :: Symbol) (proxy :: Symbol -&gt; *).
KnownSymbol n =&gt;
proxy n -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">symbolVal</span></a></span><span>
</span><span id="line-906"></span><span>
</span><span id="line-907"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">ownPaymentPubKeyHash</span><span> </span><span class="hs-pragma">&quot;Use ownFirstPaymentPubKeyHash, ownPaymentPubKeyHashes or ownAddresses instead&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-908"></span><span class="hs-comment">-- | Get the hash of a public key belonging to the wallet that runs this contract.</span><span>
</span><span id="line-909"></span><span class="hs-comment">--   * Any funds paid to this public key hash will be treated as the wallet's own</span><span>
</span><span id="line-910"></span><span class="hs-comment">--     funds</span><span>
</span><span id="line-911"></span><span class="hs-comment">--   * The wallet is able to sign transactions with the private key of this</span><span>
</span><span id="line-912"></span><span class="hs-comment">--     public key, for example, if the public key is added to the</span><span>
</span><span id="line-913"></span><span class="hs-comment">--     'requiredSignatures' field of 'Tx'.</span><span>
</span><span id="line-914"></span><span class="hs-comment">--   * There is a 1-n relationship between wallets and public keys (although in</span><span>
</span><span id="line-915"></span><span class="hs-comment">--     the mockchain n=1)</span><span>
</span><span id="line-916"></span><span class="annot"><a href="Plutus.Contract.Request.html#ownPaymentPubKeyHash"><span class="hs-identifier hs-type">ownPaymentPubKeyHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680560915"><span class="annot"><a href="#local-6989586621680560915"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680560914"><span class="annot"><a href="#local-6989586621680560914"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680560913"><span class="annot"><a href="#local-6989586621680560913"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560913"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560915"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560914"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560913"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PaymentPubKeyHash</span></span><span>
</span><span id="line-917"></span><span id="ownPaymentPubKeyHash"><span class="annot"><span class="annottext">ownPaymentPubKeyHash :: Contract w s e PaymentPubKeyHash
</span><a href="Plutus.Contract.Request.html#ownPaymentPubKeyHash"><span class="hs-identifier hs-var hs-var">ownPaymentPubKeyHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Contract w s e PaymentPubKeyHash
forall w (s :: Row *) e.
AsContractError e =&gt;
Contract w s e PaymentPubKeyHash
</span><a href="Plutus.Contract.Request.html#ownFirstPaymentPubKeyHash"><span class="hs-identifier hs-var">ownFirstPaymentPubKeyHash</span></a></span><span>
</span><span id="line-918"></span><span>
</span><span id="line-919"></span><span class="hs-comment">-- | Get the addresses belonging to the wallet that runs this contract.</span><span>
</span><span id="line-920"></span><span class="hs-comment">--   * Any funds paid to one of these addresses will be treated as the wallet's own</span><span>
</span><span id="line-921"></span><span class="hs-comment">--     funds</span><span>
</span><span id="line-922"></span><span class="hs-comment">--   * The wallet is able to sign transactions with the private key of one of its</span><span>
</span><span id="line-923"></span><span class="hs-comment">--     public key, for example, if the public key is added to the</span><span>
</span><span id="line-924"></span><span class="hs-comment">--     'requiredSignatures' field of 'Tx'.</span><span>
</span><span id="line-925"></span><span class="hs-comment">--   * There is a 1-n relationship between wallets and addresses (although in</span><span>
</span><span id="line-926"></span><span class="hs-comment">--     the mockchain n=1)</span><span>
</span><span id="line-927"></span><span class="annot"><a href="Plutus.Contract.Request.html#ownAddresses"><span class="hs-identifier hs-type">ownAddresses</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561852"><span class="annot"><a href="#local-6989586621680561852"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561851"><span class="annot"><a href="#local-6989586621680561851"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561853"><span class="annot"><a href="#local-6989586621680561853"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561853"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561852"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561851"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561853"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAddress</span></span><span class="hs-special">)</span><span>
</span><span id="line-928"></span><span id="ownAddresses"><span class="annot"><span class="annottext">ownAddresses :: Contract w s e (NonEmpty CardanoAddress)
</span><a href="Plutus.Contract.Request.html#ownAddresses"><span class="hs-identifier hs-var hs-var">ownAddresses</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PABReq
-&gt; Prism' PABResp (NonEmpty CardanoAddress)
-&gt; Contract w s e (NonEmpty CardanoAddress)
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="annot"><span class="annottext">PABReq
</span><a href="Plutus.Contract.Effects.html#OwnAddressesReq"><span class="hs-identifier hs-var">OwnAddressesReq</span></a></span><span> </span><span class="annot"><span class="annottext">Prism' PABResp (NonEmpty CardanoAddress)
</span><a href="Plutus.Contract.Effects.html#_OwnAddressesResp"><span class="hs-identifier hs-var">E._OwnAddressesResp</span></a></span><span>
</span><span id="line-929"></span><span>
</span><span id="line-930"></span><span class="hs-comment">-- | Get the first address of the wallet that runs this contract.</span><span>
</span><span id="line-931"></span><span class="annot"><a href="Plutus.Contract.Request.html#ownAddress"><span class="hs-identifier hs-type">ownAddress</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680560911"><span class="annot"><a href="#local-6989586621680560911"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680560910"><span class="annot"><a href="#local-6989586621680560910"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680560909"><span class="annot"><a href="#local-6989586621680560909"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560909"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560911"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560910"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560909"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAddress</span></span><span>
</span><span id="line-932"></span><span id="ownAddress"><span class="annot"><span class="annottext">ownAddress :: Contract w s e CardanoAddress
</span><a href="Plutus.Contract.Request.html#ownAddress"><span class="hs-identifier hs-var hs-var">ownAddress</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty CardanoAddress -&gt; CardanoAddress
forall a. NonEmpty a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">NonEmpty.head</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty CardanoAddress -&gt; CardanoAddress)
-&gt; Contract w s e (NonEmpty CardanoAddress)
-&gt; Contract w s e CardanoAddress
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Contract w s e (NonEmpty CardanoAddress)
forall w (s :: Row *) e.
AsContractError e =&gt;
Contract w s e (NonEmpty CardanoAddress)
</span><a href="Plutus.Contract.Request.html#ownAddresses"><span class="hs-identifier hs-var">ownAddresses</span></a></span><span>
</span><span id="line-933"></span><span>
</span><span id="line-934"></span><span class="annot"><a href="Plutus.Contract.Request.html#ownPaymentPubKeyHashes"><span class="hs-identifier hs-type">ownPaymentPubKeyHashes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561544"><span class="annot"><a href="#local-6989586621680561544"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561543"><span class="annot"><a href="#local-6989586621680561543"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561545"><span class="annot"><a href="#local-6989586621680561545"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561545"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561544"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561543"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561545"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">PaymentPubKeyHash</span></span><span class="hs-special">]</span><span>
</span><span id="line-935"></span><span id="ownPaymentPubKeyHashes"><span class="annot"><span class="annottext">ownPaymentPubKeyHashes :: Contract w s e [PaymentPubKeyHash]
</span><a href="Plutus.Contract.Request.html#ownPaymentPubKeyHashes"><span class="hs-identifier hs-var hs-var">ownPaymentPubKeyHashes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-936"></span><span>    </span><span id="local-6989586621680560907"><span class="annot"><span class="annottext">NonEmpty CardanoAddress
</span><a href="#local-6989586621680560907"><span class="hs-identifier hs-var">addrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Contract w s e (NonEmpty CardanoAddress)
forall w (s :: Row *) e.
AsContractError e =&gt;
Contract w s e (NonEmpty CardanoAddress)
</span><a href="Plutus.Contract.Request.html#ownAddresses"><span class="hs-identifier hs-var">ownAddresses</span></a></span><span>
</span><span id="line-937"></span><span>    </span><span class="annot"><span class="annottext">[PaymentPubKeyHash] -&gt; Contract w s e [PaymentPubKeyHash]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">([PaymentPubKeyHash] -&gt; Contract w s e [PaymentPubKeyHash])
-&gt; [PaymentPubKeyHash] -&gt; Contract w s e [PaymentPubKeyHash]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(PubKeyHash -&gt; PaymentPubKeyHash)
-&gt; [PubKeyHash] -&gt; [PaymentPubKeyHash]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">PubKeyHash -&gt; PaymentPubKeyHash
</span><span class="hs-identifier hs-var">PaymentPubKeyHash</span></span><span> </span><span class="annot"><span class="annottext">([PubKeyHash] -&gt; [PaymentPubKeyHash])
-&gt; [PubKeyHash] -&gt; [PaymentPubKeyHash]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(CardanoAddress -&gt; Maybe PubKeyHash)
-&gt; [CardanoAddress] -&gt; [PubKeyHash]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress -&gt; Maybe PubKeyHash
forall era. AddressInEra era -&gt; Maybe PubKeyHash
</span><span class="hs-identifier hs-var">cardanoPubKeyHash</span></span><span> </span><span class="annot"><span class="annottext">([CardanoAddress] -&gt; [PubKeyHash])
-&gt; [CardanoAddress] -&gt; [PubKeyHash]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty CardanoAddress -&gt; [CardanoAddress]
forall a. NonEmpty a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">NonEmpty.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty CardanoAddress -&gt; [CardanoAddress])
-&gt; NonEmpty CardanoAddress -&gt; [CardanoAddress]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty CardanoAddress
</span><a href="#local-6989586621680560907"><span class="hs-identifier hs-var">addrs</span></a></span><span>
</span><span id="line-938"></span><span>
</span><span id="line-939"></span><span class="annot"><a href="Plutus.Contract.Request.html#ownFirstPaymentPubKeyHash"><span class="hs-identifier hs-type">ownFirstPaymentPubKeyHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561565"><span class="annot"><a href="#local-6989586621680561565"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561564"><span class="annot"><a href="#local-6989586621680561564"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561566"><span class="annot"><a href="#local-6989586621680561566"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561566"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561565"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561564"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561566"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PaymentPubKeyHash</span></span><span>
</span><span id="line-940"></span><span id="ownFirstPaymentPubKeyHash"><span class="annot"><span class="annottext">ownFirstPaymentPubKeyHash :: Contract w s e PaymentPubKeyHash
</span><a href="Plutus.Contract.Request.html#ownFirstPaymentPubKeyHash"><span class="hs-identifier hs-var hs-var">ownFirstPaymentPubKeyHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-941"></span><span>    </span><span id="local-6989586621680560906"><span class="annot"><span class="annottext">[PaymentPubKeyHash]
</span><a href="#local-6989586621680560906"><span class="hs-identifier hs-var">pkhs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Contract w s e [PaymentPubKeyHash]
forall w (s :: Row *) e.
AsContractError e =&gt;
Contract w s e [PaymentPubKeyHash]
</span><a href="Plutus.Contract.Request.html#ownPaymentPubKeyHashes"><span class="hs-identifier hs-var">ownPaymentPubKeyHashes</span></a></span><span>
</span><span id="line-942"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[PaymentPubKeyHash]
</span><a href="#local-6989586621680560906"><span class="hs-identifier hs-var">pkhs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-943"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e -&gt; Contract w s e PaymentPubKeyHash
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; Contract w s e PaymentPubKeyHash)
-&gt; e -&gt; Contract w s e PaymentPubKeyHash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AReview e WalletAPIError -&gt; WalletAPIError -&gt; e
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview e WalletAPIError
forall r. AsContractError r =&gt; Prism' r WalletAPIError
</span><a href="Plutus.Contract.Error.html#_WalletContractError"><span class="hs-identifier hs-var">_WalletContractError</span></a></span><span> </span><span class="annot"><span class="annottext">WalletAPIError
</span><a href="Wallet.Emulator.Error.html#NoPaymentPubKeyHashError"><span class="hs-identifier hs-var">NoPaymentPubKeyHashError</span></a></span><span>
</span><span id="line-944"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621680560905"><span class="annot"><span class="annottext">PaymentPubKeyHash
</span><a href="#local-6989586621680560905"><span class="hs-identifier hs-var">pkh</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><span class="annottext">[PaymentPubKeyHash]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PaymentPubKeyHash -&gt; Contract w s e PaymentPubKeyHash
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentPubKeyHash
</span><a href="#local-6989586621680560905"><span class="hs-identifier hs-var">pkh</span></a></span><span>
</span><span id="line-945"></span><span>
</span><span id="line-946"></span><span class="hs-comment">-- | Send an unbalanced transaction to be balanced and signed. Returns the ID</span><span>
</span><span id="line-947"></span><span class="hs-comment">--    of the final transaction when the transaction was submitted. Throws an</span><span>
</span><span id="line-948"></span><span class="hs-comment">--    error if balancing or signing failed.</span><span>
</span><span id="line-949"></span><span class="annot"><a href="Plutus.Contract.Request.html#submitUnbalancedTx"><span class="hs-identifier hs-type">submitUnbalancedTx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680560904"><span class="annot"><a href="#local-6989586621680560904"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680560903"><span class="annot"><a href="#local-6989586621680560903"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680560902"><span class="annot"><a href="#local-6989586621680560902"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560902"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UnbalancedTx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560904"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560903"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560902"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span>
</span><span id="line-950"></span><span id="submitUnbalancedTx"><span class="annot"><span class="annottext">submitUnbalancedTx :: UnbalancedTx -&gt; Contract w s e CardanoTx
</span><a href="Plutus.Contract.Request.html#submitUnbalancedTx"><span class="hs-identifier hs-var hs-var">submitUnbalancedTx</span></a></span></span><span> </span><span id="local-6989586621680560901"><span class="annot"><span class="annottext">UnbalancedTx
</span><a href="#local-6989586621680560901"><span class="hs-identifier hs-var">utx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-951"></span><span>  </span><span id="local-6989586621680560900"><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621680560900"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UnbalancedTx -&gt; Contract w s e CardanoTx
forall w (s :: Row *) e.
AsContractError e =&gt;
UnbalancedTx -&gt; Contract w s e CardanoTx
</span><a href="Plutus.Contract.Request.html#balanceTx"><span class="hs-identifier hs-var">balanceTx</span></a></span><span> </span><span class="annot"><span class="annottext">UnbalancedTx
</span><a href="#local-6989586621680560901"><span class="hs-identifier hs-var">utx</span></a></span><span>
</span><span id="line-952"></span><span>  </span><span class="annot"><span class="annottext">CardanoTx -&gt; Contract w s e CardanoTx
forall w (s :: Row *) e.
AsContractError e =&gt;
CardanoTx -&gt; Contract w s e CardanoTx
</span><a href="Plutus.Contract.Request.html#submitBalancedTx"><span class="hs-identifier hs-var">submitBalancedTx</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621680560900"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-953"></span><span>
</span><span id="line-954"></span><span class="hs-comment">-- | Send an unbalanced transaction to be balanced. Returns the balanced transaction.</span><span>
</span><span id="line-955"></span><span class="hs-comment">--    Throws an error if balancing failed.</span><span>
</span><span id="line-956"></span><span class="annot"><a href="Plutus.Contract.Request.html#balanceTx"><span class="hs-identifier hs-type">balanceTx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561536"><span class="annot"><a href="#local-6989586621680561536"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561535"><span class="annot"><a href="#local-6989586621680561535"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561537"><span class="annot"><a href="#local-6989586621680561537"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561537"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UnbalancedTx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561536"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561535"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561537"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span>
</span><span id="line-957"></span><span id="balanceTx"><span class="annot"><span class="annottext">balanceTx :: UnbalancedTx -&gt; Contract w s e CardanoTx
</span><a href="Plutus.Contract.Request.html#balanceTx"><span class="hs-identifier hs-var hs-var">balanceTx</span></a></span></span><span> </span><span id="local-6989586621680560899"><span class="annot"><span class="annottext">UnbalancedTx
</span><a href="#local-6989586621680560899"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-958"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680560898"><span class="annot"><span class="annottext">req :: Contract w s e BalanceTxResponse
</span><a href="#local-6989586621680560898"><span class="hs-identifier hs-var hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PABReq
-&gt; Prism' PABResp BalanceTxResponse
-&gt; Contract w s e BalanceTxResponse
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnbalancedTx -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#BalanceTxReq"><span class="hs-identifier hs-var">BalanceTxReq</span></a></span><span> </span><span class="annot"><span class="annottext">UnbalancedTx
</span><a href="#local-6989586621680560899"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prism' PABResp BalanceTxResponse
</span><a href="Plutus.Contract.Effects.html#_BalanceTxResp"><span class="hs-identifier hs-var">E._BalanceTxResp</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-959"></span><span>  </span><span class="annot"><span class="annottext">Contract w s e BalanceTxResponse
</span><a href="#local-6989586621680560898"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="annot"><span class="annottext">Contract w s e BalanceTxResponse
-&gt; (BalanceTxResponse -&gt; Contract w s e CardanoTx)
-&gt; Contract w s e CardanoTx
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(WalletAPIError -&gt; Contract w s e CardanoTx)
-&gt; (CardanoTx -&gt; Contract w s e CardanoTx)
-&gt; Either WalletAPIError CardanoTx
-&gt; Contract w s e CardanoTx
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">e -&gt; Contract w s e CardanoTx
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; Contract w s e CardanoTx)
-&gt; (WalletAPIError -&gt; e)
-&gt; WalletAPIError
-&gt; Contract w s e CardanoTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">AReview e WalletAPIError -&gt; WalletAPIError -&gt; e
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview e WalletAPIError
forall r. AsContractError r =&gt; Prism' r WalletAPIError
</span><a href="Plutus.Contract.Error.html#_WalletContractError"><span class="hs-identifier hs-var">_WalletContractError</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CardanoTx -&gt; Contract w s e CardanoTx
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Either WalletAPIError CardanoTx -&gt; Contract w s e CardanoTx)
-&gt; (BalanceTxResponse -&gt; Either WalletAPIError CardanoTx)
-&gt; BalanceTxResponse
-&gt; Contract w s e CardanoTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (Either WalletAPIError CardanoTx)
  BalanceTxResponse
  (Either WalletAPIError CardanoTx)
-&gt; BalanceTxResponse -&gt; Either WalletAPIError CardanoTx
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Either WalletAPIError CardanoTx)
  BalanceTxResponse
  (Either WalletAPIError CardanoTx)
Iso' BalanceTxResponse (Either WalletAPIError CardanoTx)
</span><a href="Plutus.Contract.Effects.html#balanceTxResponse"><span class="hs-identifier hs-var">E.balanceTxResponse</span></a></span><span>
</span><span id="line-960"></span><span>
</span><span id="line-961"></span><span class="hs-comment">-- | Send an balanced transaction to be signed. Returns the ID</span><span>
</span><span id="line-962"></span><span class="hs-comment">--    of the final transaction when the transaction was submitted. Throws an</span><span>
</span><span id="line-963"></span><span class="hs-comment">--    error if signing failed.</span><span>
</span><span id="line-964"></span><span class="annot"><a href="Plutus.Contract.Request.html#submitBalancedTx"><span class="hs-identifier hs-type">submitBalancedTx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561533"><span class="annot"><a href="#local-6989586621680561533"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561532"><span class="annot"><a href="#local-6989586621680561532"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561534"><span class="annot"><a href="#local-6989586621680561534"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561534"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561533"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561532"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561534"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span>
</span><span id="line-965"></span><span id="submitBalancedTx"><span class="annot"><span class="annottext">submitBalancedTx :: CardanoTx -&gt; Contract w s e CardanoTx
</span><a href="Plutus.Contract.Request.html#submitBalancedTx"><span class="hs-identifier hs-var hs-var">submitBalancedTx</span></a></span></span><span> </span><span id="local-6989586621680560895"><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621680560895"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-966"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680560894"><span class="annot"><span class="annottext">req :: Contract w s e WriteBalancedTxResponse
</span><a href="#local-6989586621680560894"><span class="hs-identifier hs-var hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PABReq
-&gt; Prism' PABResp WriteBalancedTxResponse
-&gt; Contract w s e WriteBalancedTxResponse
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardanoTx -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#WriteBalancedTxReq"><span class="hs-identifier hs-var">WriteBalancedTxReq</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621680560895"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prism' PABResp WriteBalancedTxResponse
</span><a href="Plutus.Contract.Effects.html#_WriteBalancedTxResp"><span class="hs-identifier hs-var">E._WriteBalancedTxResp</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-967"></span><span>  </span><span class="annot"><span class="annottext">Contract w s e WriteBalancedTxResponse
</span><a href="#local-6989586621680560894"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="annot"><span class="annottext">Contract w s e WriteBalancedTxResponse
-&gt; (WriteBalancedTxResponse -&gt; Contract w s e CardanoTx)
-&gt; Contract w s e CardanoTx
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(WalletAPIError -&gt; Contract w s e CardanoTx)
-&gt; (CardanoTx -&gt; Contract w s e CardanoTx)
-&gt; Either WalletAPIError CardanoTx
-&gt; Contract w s e CardanoTx
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">e -&gt; Contract w s e CardanoTx
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; Contract w s e CardanoTx)
-&gt; (WalletAPIError -&gt; e)
-&gt; WalletAPIError
-&gt; Contract w s e CardanoTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">AReview e WalletAPIError -&gt; WalletAPIError -&gt; e
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview e WalletAPIError
forall r. AsContractError r =&gt; Prism' r WalletAPIError
</span><a href="Plutus.Contract.Error.html#_WalletContractError"><span class="hs-identifier hs-var">_WalletContractError</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CardanoTx -&gt; Contract w s e CardanoTx
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Either WalletAPIError CardanoTx -&gt; Contract w s e CardanoTx)
-&gt; (WriteBalancedTxResponse -&gt; Either WalletAPIError CardanoTx)
-&gt; WriteBalancedTxResponse
-&gt; Contract w s e CardanoTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (Either WalletAPIError CardanoTx)
  WriteBalancedTxResponse
  (Either WalletAPIError CardanoTx)
-&gt; WriteBalancedTxResponse -&gt; Either WalletAPIError CardanoTx
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Either WalletAPIError CardanoTx)
  WriteBalancedTxResponse
  (Either WalletAPIError CardanoTx)
Iso' WriteBalancedTxResponse (Either WalletAPIError CardanoTx)
</span><a href="Plutus.Contract.Effects.html#writeBalancedTxResponse"><span class="hs-identifier hs-var">E.writeBalancedTxResponse</span></a></span><span>
</span><span id="line-968"></span><span>
</span><span id="line-969"></span><span class="hs-comment">-- | Build a transaction that satisfies the constraints, then submit it to the</span><span>
</span><span id="line-970"></span><span class="hs-comment">--   network. The constraints do not refer to any typed script inputs or</span><span>
</span><span id="line-971"></span><span class="hs-comment">--   outputs.</span><span>
</span><span id="line-972"></span><span class="annot"><a href="Plutus.Contract.Request.html#submitTx"><span class="hs-identifier hs-type">submitTx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680560891"><span class="annot"><a href="#local-6989586621680560891"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680560890"><span class="annot"><a href="#local-6989586621680560890"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680560889"><span class="annot"><a href="#local-6989586621680560889"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-973"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560889"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-974"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-975"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxConstraints</span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Void</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Void</span></a></span><span>
</span><span id="line-976"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560891"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560890"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560889"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span>
</span><span id="line-977"></span><span id="submitTx"><span class="annot"><span class="annottext">submitTx :: TxConstraints Void Void -&gt; Contract w s e CardanoTx
</span><a href="Plutus.Contract.Request.html#submitTx"><span class="hs-identifier hs-var hs-var">submitTx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScriptLookups Void
-&gt; TxConstraints (RedeemerType Void) (DatumType Void)
-&gt; Contract w s e CardanoTx
forall a w (s :: Row *) e.
(ToData (RedeemerType a), FromData (DatumType a),
 ToData (DatumType a), AsContractError e) =&gt;
ScriptLookups a
-&gt; TxConstraints (RedeemerType a) (DatumType a)
-&gt; Contract w s e CardanoTx
</span><a href="Plutus.Contract.Request.html#submitTxConstraintsWith"><span class="hs-identifier hs-var">submitTxConstraintsWith</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Void</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptLookups Void
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-978"></span><span>
</span><span id="line-979"></span><span class="hs-comment">-- | Build a transaction that satisfies the constraints, then submit it to the</span><span>
</span><span id="line-980"></span><span class="hs-comment">--   network. Using the current outputs at the contract address and the</span><span>
</span><span id="line-981"></span><span class="hs-comment">--   contract's own public key to solve the constraints.</span><span>
</span><span id="line-982"></span><span class="annot"><a href="Plutus.Contract.Request.html#submitTxConstraints"><span class="hs-identifier hs-type">submitTxConstraints</span></a></span><span>
</span><span id="line-983"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680560888"><span class="annot"><a href="#local-6989586621680560888"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621680560887"><span class="annot"><a href="#local-6989586621680560887"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680560886"><span class="annot"><a href="#local-6989586621680560886"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680560885"><span class="annot"><a href="#local-6989586621680560885"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-984"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PlutusTx.ToData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RedeemerType</span></span><span> </span><span class="annot"><a href="#local-6989586621680560888"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-985"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PlutusTx.FromData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621680560888"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-986"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PlutusTx.ToData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621680560888"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-987"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560885"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-988"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-989"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621680560888"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-990"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxConstraints</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RedeemerType</span></span><span> </span><span class="annot"><a href="#local-6989586621680560888"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621680560888"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-991"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560887"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560886"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560885"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span>
</span><span id="line-992"></span><span id="submitTxConstraints"><span class="annot"><span class="annottext">submitTxConstraints :: TypedValidator a
-&gt; TxConstraints (RedeemerType a) (DatumType a)
-&gt; Contract w s e CardanoTx
</span><a href="Plutus.Contract.Request.html#submitTxConstraints"><span class="hs-identifier hs-var hs-var">submitTxConstraints</span></a></span></span><span> </span><span id="local-6989586621680560884"><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621680560884"><span class="hs-identifier hs-var">inst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScriptLookups a
-&gt; TxConstraints (RedeemerType a) (DatumType a)
-&gt; Contract w s e CardanoTx
forall a w (s :: Row *) e.
(ToData (RedeemerType a), FromData (DatumType a),
 ToData (DatumType a), AsContractError e) =&gt;
ScriptLookups a
-&gt; TxConstraints (RedeemerType a) (DatumType a)
-&gt; Contract w s e CardanoTx
</span><a href="Plutus.Contract.Request.html#submitTxConstraintsWith"><span class="hs-identifier hs-var">submitTxConstraintsWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypedValidator a -&gt; ScriptLookups a
forall a. TypedValidator a -&gt; ScriptLookups a
</span><span class="hs-identifier hs-var">Constraints.typedValidatorLookups</span></span><span> </span><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621680560884"><span class="hs-identifier hs-var">inst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-993"></span><span>
</span><span id="line-994"></span><span class="hs-comment">-- | Build a transaction that satisfies the constraints using the UTXO map</span><span>
</span><span id="line-995"></span><span class="hs-comment">--   to resolve any input constraints (see 'Ledger.Constraints.TxConstraints.InputConstraint')</span><span>
</span><span id="line-996"></span><span class="annot"><a href="Plutus.Contract.Request.html#submitTxConstraintsSpending"><span class="hs-identifier hs-type">submitTxConstraintsSpending</span></a></span><span>
</span><span id="line-997"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680560882"><span class="annot"><a href="#local-6989586621680560882"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621680560881"><span class="annot"><a href="#local-6989586621680560881"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680560880"><span class="annot"><a href="#local-6989586621680560880"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680560879"><span class="annot"><a href="#local-6989586621680560879"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-998"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PlutusTx.ToData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RedeemerType</span></span><span> </span><span class="annot"><a href="#local-6989586621680560882"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-999"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PlutusTx.FromData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621680560882"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1000"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PlutusTx.ToData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621680560882"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1001"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560879"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-1002"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-1003"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621680560882"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1004"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOutRef</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DecoratedTxOut</span></span><span>
</span><span id="line-1005"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxConstraints</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RedeemerType</span></span><span> </span><span class="annot"><a href="#local-6989586621680560882"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621680560882"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1006"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560881"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560880"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560879"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span>
</span><span id="line-1007"></span><span id="submitTxConstraintsSpending"><span class="annot"><span class="annottext">submitTxConstraintsSpending :: TypedValidator a
-&gt; Map TxOutRef DecoratedTxOut
-&gt; TxConstraints (RedeemerType a) (DatumType a)
-&gt; Contract w s e CardanoTx
</span><a href="Plutus.Contract.Request.html#submitTxConstraintsSpending"><span class="hs-identifier hs-var hs-var">submitTxConstraintsSpending</span></a></span></span><span> </span><span id="local-6989586621680560878"><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621680560878"><span class="hs-identifier hs-var">inst</span></a></span></span><span> </span><span id="local-6989586621680560877"><span class="annot"><span class="annottext">Map TxOutRef DecoratedTxOut
</span><a href="#local-6989586621680560877"><span class="hs-identifier hs-var">utxo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1008"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680560876"><span class="annot"><span class="annottext">lookups :: ScriptLookups a
</span><a href="#local-6989586621680560876"><span class="hs-identifier hs-var hs-var">lookups</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypedValidator a -&gt; ScriptLookups a
forall a. TypedValidator a -&gt; ScriptLookups a
</span><span class="hs-identifier hs-var">Constraints.typedValidatorLookups</span></span><span> </span><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621680560878"><span class="hs-identifier hs-var">inst</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptLookups a -&gt; ScriptLookups a -&gt; ScriptLookups a
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef DecoratedTxOut -&gt; ScriptLookups a
forall a. Map TxOutRef DecoratedTxOut -&gt; ScriptLookups a
</span><span class="hs-identifier hs-var">Constraints.unspentOutputs</span></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef DecoratedTxOut
</span><a href="#local-6989586621680560877"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-1009"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ScriptLookups a
-&gt; TxConstraints (RedeemerType a) (DatumType a)
-&gt; Contract w s e CardanoTx
forall a w (s :: Row *) e.
(ToData (RedeemerType a), FromData (DatumType a),
 ToData (DatumType a), AsContractError e) =&gt;
ScriptLookups a
-&gt; TxConstraints (RedeemerType a) (DatumType a)
-&gt; Contract w s e CardanoTx
</span><a href="Plutus.Contract.Request.html#submitTxConstraintsWith"><span class="hs-identifier hs-var">submitTxConstraintsWith</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptLookups a
</span><a href="#local-6989586621680560876"><span class="hs-identifier hs-var">lookups</span></a></span><span>
</span><span id="line-1010"></span><span>
</span><span id="line-1011"></span><span class="hs-comment">-- | Build a transaction that satisfies the constraints</span><span>
</span><span id="line-1012"></span><span class="annot"><a href="Plutus.Contract.Request.html#mkTxConstraints"><span class="hs-identifier hs-type">mkTxConstraints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561456"><span class="annot"><a href="#local-6989586621680561456"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621680561454"><span class="annot"><a href="#local-6989586621680561454"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561453"><span class="annot"><a href="#local-6989586621680561453"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561455"><span class="annot"><a href="#local-6989586621680561455"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-1013"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PlutusTx.ToData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RedeemerType</span></span><span> </span><span class="annot"><a href="#local-6989586621680561456"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1014"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PlutusTx.FromData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621680561456"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1015"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PlutusTx.ToData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621680561456"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1016"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561455"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-1017"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-1018"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScriptLookups</span></span><span> </span><span class="annot"><a href="#local-6989586621680561456"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1019"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxConstraints</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RedeemerType</span></span><span> </span><span class="annot"><a href="#local-6989586621680561456"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621680561456"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1020"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561454"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561453"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561455"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UnbalancedTx</span></span><span>
</span><span id="line-1021"></span><span id="mkTxConstraints"><span class="annot"><span class="annottext">mkTxConstraints :: ScriptLookups a
-&gt; TxConstraints (RedeemerType a) (DatumType a)
-&gt; Contract w s e UnbalancedTx
</span><a href="Plutus.Contract.Request.html#mkTxConstraints"><span class="hs-identifier hs-var hs-var">mkTxConstraints</span></a></span></span><span> </span><span id="local-6989586621680560874"><span class="annot"><span class="annottext">ScriptLookups a
</span><a href="#local-6989586621680560874"><span class="hs-identifier hs-var">lookups</span></a></span></span><span> </span><span id="local-6989586621680560873"><span class="annot"><span class="annottext">TxConstraints (RedeemerType a) (DatumType a)
</span><a href="#local-6989586621680560873"><span class="hs-identifier hs-var">constraints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1022"></span><span>    </span><span id="local-6989586621680560872"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680560872"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Contract w s e Params
forall w (s :: Row *) e. AsContractError e =&gt; Contract w s e Params
</span><a href="Plutus.Contract.Request.html#getParams"><span class="hs-identifier hs-var">getParams</span></a></span><span>
</span><span id="line-1023"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680560871"><span class="annot"><span class="annottext">result :: Either MkTxError UnbalancedTx
</span><a href="#local-6989586621680560871"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; ScriptLookups a
-&gt; TxConstraints (RedeemerType a) (DatumType a)
-&gt; Either MkTxError UnbalancedTx
forall a.
(FromData (DatumType a), ToData (DatumType a),
 ToData (RedeemerType a)) =&gt;
Params
-&gt; ScriptLookups a
-&gt; TxConstraints (RedeemerType a) (DatumType a)
-&gt; Either MkTxError UnbalancedTx
</span><span class="hs-identifier hs-var">Constraints.mkTx</span></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680560872"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptLookups a
</span><a href="#local-6989586621680560874"><span class="hs-identifier hs-var">lookups</span></a></span><span> </span><span class="annot"><span class="annottext">TxConstraints (RedeemerType a) (DatumType a)
</span><a href="#local-6989586621680560873"><span class="hs-identifier hs-var">constraints</span></a></span><span>
</span><span id="line-1024"></span><span>        </span><span id="local-6989586621680560869"><span class="annot"><span class="annottext">logData :: MkTxLog
</span><a href="#local-6989586621680560869"><span class="hs-identifier hs-var hs-var">logData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MkTxLog :: ScriptLookups Any
-&gt; TxConstraints BuiltinData BuiltinData
-&gt; Either MkTxError UnbalancedTx
-&gt; MkTxLog
</span><a href="Plutus.Contract.Request.html#MkTxLog"><span class="hs-identifier hs-type">MkTxLog</span></a></span><span>
</span><span id="line-1025"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mkTxLogLookups :: ScriptLookups Any
</span><a href="Plutus.Contract.Request.html#mkTxLogLookups"><span class="hs-identifier hs-var">mkTxLogLookups</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScriptLookups a -&gt; ScriptLookups Any
forall a. ScriptLookups a -&gt; ScriptLookups Any
</span><span class="hs-identifier hs-var">Constraints.generalise</span></span><span> </span><span class="annot"><span class="annottext">ScriptLookups a
</span><a href="#local-6989586621680560874"><span class="hs-identifier hs-var">lookups</span></a></span><span>
</span><span id="line-1026"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mkTxLogTxConstraints :: TxConstraints BuiltinData BuiltinData
</span><a href="Plutus.Contract.Request.html#mkTxLogTxConstraints"><span class="hs-identifier hs-var">mkTxLogTxConstraints</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RedeemerType a -&gt; BuiltinData)
-&gt; (DatumType a -&gt; BuiltinData)
-&gt; TxConstraints (RedeemerType a) (DatumType a)
-&gt; TxConstraints BuiltinData BuiltinData
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">bimap</span></a></span><span> </span><span class="annot"><span class="annottext">RedeemerType a -&gt; BuiltinData
forall a. ToData a =&gt; a -&gt; BuiltinData
</span><span class="hs-identifier hs-var">PlutusTx.toBuiltinData</span></span><span> </span><span class="annot"><span class="annottext">DatumType a -&gt; BuiltinData
forall a. ToData a =&gt; a -&gt; BuiltinData
</span><span class="hs-identifier hs-var">PlutusTx.toBuiltinData</span></span><span> </span><span class="annot"><span class="annottext">TxConstraints (RedeemerType a) (DatumType a)
</span><a href="#local-6989586621680560873"><span class="hs-identifier hs-var">constraints</span></a></span><span>
</span><span id="line-1027"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mkTxLogResult :: Either MkTxError UnbalancedTx
</span><a href="Plutus.Contract.Request.html#mkTxLogResult"><span class="hs-identifier hs-var">mkTxLogResult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either MkTxError UnbalancedTx
</span><a href="#local-6989586621680560871"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-1028"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-1029"></span><span>    </span><span class="annot"><span class="annottext">MkTxLog -&gt; Contract w s e ()
forall a w (s :: Row *) e. ToJSON a =&gt; a -&gt; Contract w s e ()
</span><a href="Plutus.Contract.Logging.html#logDebug"><span class="hs-identifier hs-var">logDebug</span></a></span><span> </span><span class="annot"><span class="annottext">MkTxLog
</span><a href="#local-6989586621680560869"><span class="hs-identifier hs-var">logData</span></a></span><span>
</span><span id="line-1030"></span><span>    </span><span class="annot"><span class="annottext">(MkTxError -&gt; e)
-&gt; Contract w s MkTxError UnbalancedTx
-&gt; Contract w s e UnbalancedTx
forall w (s :: Row *) e e' a.
(e -&gt; e') -&gt; Contract w s e a -&gt; Contract w s e' a
</span><a href="Plutus.Contract.Types.html#mapError"><span class="hs-identifier hs-var">mapError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AReview e MkTxError -&gt; MkTxError -&gt; e
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview e MkTxError
forall r. AsContractError r =&gt; Prism' r MkTxError
</span><a href="Plutus.Contract.Error.html#_ConstraintResolutionContractError"><span class="hs-identifier hs-var">_ConstraintResolutionContractError</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Contract w s MkTxError UnbalancedTx
 -&gt; Contract w s e UnbalancedTx)
-&gt; Contract w s MkTxError UnbalancedTx
-&gt; Contract w s e UnbalancedTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(MkTxError -&gt; Contract w s MkTxError UnbalancedTx)
-&gt; (UnbalancedTx -&gt; Contract w s MkTxError UnbalancedTx)
-&gt; Either MkTxError UnbalancedTx
-&gt; Contract w s MkTxError UnbalancedTx
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="annot"><span class="annottext">MkTxError -&gt; Contract w s MkTxError UnbalancedTx
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">UnbalancedTx -&gt; Contract w s MkTxError UnbalancedTx
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Either MkTxError UnbalancedTx
</span><a href="#local-6989586621680560871"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-1031"></span><span>
</span><span id="line-1032"></span><span class="hs-comment">{-| Arguments and result of a call to 'mkTx'
-}</span><span>
</span><span id="line-1034"></span><span id="local-6989586621680560860"><span id="local-6989586621680560861"></span></span><span class="hs-keyword">data</span><span> </span><span id="MkTxLog"><span class="annot"><a href="Plutus.Contract.Request.html#MkTxLog"><span class="hs-identifier hs-var">MkTxLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1035"></span><span>    </span><span id="MkTxLog"><span class="annot"><a href="Plutus.Contract.Request.html#MkTxLog"><span class="hs-identifier hs-var">MkTxLog</span></a></span></span><span>
</span><span id="line-1036"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="mkTxLogLookups"><span class="annot"><span class="annottext">MkTxLog -&gt; ScriptLookups Any
</span><a href="Plutus.Contract.Request.html#mkTxLogLookups"><span class="hs-identifier hs-var hs-var">mkTxLogLookups</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScriptLookups</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Any</span></span><span>
</span><span id="line-1037"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="mkTxLogTxConstraints"><span class="annot"><span class="annottext">MkTxLog -&gt; TxConstraints BuiltinData BuiltinData
</span><a href="Plutus.Contract.Request.html#mkTxLogTxConstraints"><span class="hs-identifier hs-var hs-var">mkTxLogTxConstraints</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxConstraints</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PlutusTx.BuiltinData</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PlutusTx.BuiltinData</span></span><span>
</span><span id="line-1038"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="mkTxLogResult"><span class="annot"><span class="annottext">MkTxLog -&gt; Either MkTxError UnbalancedTx
</span><a href="Plutus.Contract.Request.html#mkTxLogResult"><span class="hs-identifier hs-var hs-var">mkTxLogResult</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Constraints.MkTxError</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UnbalancedTx</span></span><span>
</span><span id="line-1039"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-1040"></span><span>        </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680560854"><span id="local-6989586621680560856"><span id="local-6989586621680560858"><span class="annot"><span class="annottext">Int -&gt; MkTxLog -&gt; ShowS
[MkTxLog] -&gt; ShowS
MkTxLog -&gt; String
(Int -&gt; MkTxLog -&gt; ShowS)
-&gt; (MkTxLog -&gt; String) -&gt; ([MkTxLog] -&gt; ShowS) -&gt; Show MkTxLog
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [MkTxLog] -&gt; ShowS
$cshowList :: [MkTxLog] -&gt; ShowS
show :: MkTxLog -&gt; String
$cshow :: MkTxLog -&gt; String
showsPrec :: Int -&gt; MkTxLog -&gt; ShowS
$cshowsPrec :: Int -&gt; MkTxLog -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. MkTxLog -&gt; Rep MkTxLog x)
-&gt; (forall x. Rep MkTxLog x -&gt; MkTxLog) -&gt; Generic MkTxLog
forall x. Rep MkTxLog x -&gt; MkTxLog
forall x. MkTxLog -&gt; Rep MkTxLog x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep MkTxLog x -&gt; MkTxLog
$cfrom :: forall x. MkTxLog -&gt; Rep MkTxLog x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1041"></span><span>        </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680560842"><span id="local-6989586621680560844"><span id="local-6989586621680560846"><span id="local-6989586621680560848"><span class="annot"><span class="annottext">[MkTxLog] -&gt; Encoding
[MkTxLog] -&gt; Value
MkTxLog -&gt; Encoding
MkTxLog -&gt; Value
(MkTxLog -&gt; Value)
-&gt; (MkTxLog -&gt; Encoding)
-&gt; ([MkTxLog] -&gt; Value)
-&gt; ([MkTxLog] -&gt; Encoding)
-&gt; ToJSON MkTxLog
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [MkTxLog] -&gt; Encoding
$ctoEncodingList :: [MkTxLog] -&gt; Encoding
toJSONList :: [MkTxLog] -&gt; Value
$ctoJSONList :: [MkTxLog] -&gt; Value
toEncoding :: MkTxLog -&gt; Encoding
$ctoEncoding :: MkTxLog -&gt; Encoding
toJSON :: MkTxLog -&gt; Value
$ctoJSON :: MkTxLog -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680560837"><span id="local-6989586621680560839"><span class="annot"><span class="annottext">Value -&gt; Parser [MkTxLog]
Value -&gt; Parser MkTxLog
(Value -&gt; Parser MkTxLog)
-&gt; (Value -&gt; Parser [MkTxLog]) -&gt; FromJSON MkTxLog
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [MkTxLog]
$cparseJSONList :: Value -&gt; Parser [MkTxLog]
parseJSON :: Value -&gt; Parser MkTxLog
$cparseJSON :: Value -&gt; Parser MkTxLog
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-1042"></span><span>
</span><span id="line-1043"></span><span class="hs-comment">-- | Build a transaction that satisfies the constraints, then submit it to the</span><span>
</span><span id="line-1044"></span><span class="hs-comment">--   network. Using the given constraints.</span><span>
</span><span id="line-1045"></span><span class="annot"><a href="Plutus.Contract.Request.html#submitTxConstraintsWith"><span class="hs-identifier hs-type">submitTxConstraintsWith</span></a></span><span>
</span><span id="line-1046"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680561514"><span class="annot"><a href="#local-6989586621680561514"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621680561510"><span class="annot"><a href="#local-6989586621680561510"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680561509"><span class="annot"><a href="#local-6989586621680561509"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680561511"><span class="annot"><a href="#local-6989586621680561511"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-1047"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PlutusTx.ToData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RedeemerType</span></span><span> </span><span class="annot"><a href="#local-6989586621680561514"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1048"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PlutusTx.FromData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621680561514"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1049"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PlutusTx.ToData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621680561514"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1050"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561511"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-1051"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-1052"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScriptLookups</span></span><span> </span><span class="annot"><a href="#local-6989586621680561514"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1053"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxConstraints</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RedeemerType</span></span><span> </span><span class="annot"><a href="#local-6989586621680561514"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621680561514"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1054"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561510"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561509"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680561511"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span>
</span><span id="line-1055"></span><span id="submitTxConstraintsWith"><span class="annot"><span class="annottext">submitTxConstraintsWith :: ScriptLookups a
-&gt; TxConstraints (RedeemerType a) (DatumType a)
-&gt; Contract w s e CardanoTx
</span><a href="Plutus.Contract.Request.html#submitTxConstraintsWith"><span class="hs-identifier hs-var hs-var">submitTxConstraintsWith</span></a></span></span><span> </span><span id="local-6989586621680560835"><span class="annot"><span class="annottext">ScriptLookups a
</span><a href="#local-6989586621680560835"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span id="local-6989586621680560834"><span class="annot"><span class="annottext">TxConstraints (RedeemerType a) (DatumType a)
</span><a href="#local-6989586621680560834"><span class="hs-identifier hs-var">constraints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1056"></span><span>  </span><span class="annot"><span class="annottext">ScriptLookups a
-&gt; TxConstraints (RedeemerType a) (DatumType a)
-&gt; Contract w s e UnbalancedTx
forall a w (s :: Row *) e.
(ToData (RedeemerType a), FromData (DatumType a),
 ToData (DatumType a), AsContractError e) =&gt;
ScriptLookups a
-&gt; TxConstraints (RedeemerType a) (DatumType a)
-&gt; Contract w s e UnbalancedTx
</span><a href="Plutus.Contract.Request.html#mkTxConstraints"><span class="hs-identifier hs-var">mkTxConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptLookups a
</span><a href="#local-6989586621680560835"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">TxConstraints (RedeemerType a) (DatumType a)
</span><a href="#local-6989586621680560834"><span class="hs-identifier hs-var">constraints</span></a></span><span> </span><span class="annot"><span class="annottext">Contract w s e UnbalancedTx
-&gt; (UnbalancedTx -&gt; Contract w s e CardanoTx)
-&gt; Contract w s e CardanoTx
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">UnbalancedTx -&gt; Contract w s e CardanoTx
forall w (s :: Row *) e.
AsContractError e =&gt;
UnbalancedTx -&gt; Contract w s e CardanoTx
</span><a href="Plutus.Contract.Request.html#submitUnbalancedTx"><span class="hs-identifier hs-var">submitUnbalancedTx</span></a></span><span>
</span><span id="line-1057"></span><span>
</span><span id="line-1058"></span><span class="hs-comment">-- | A version of 'submitTx' that waits until the transaction has been</span><span>
</span><span id="line-1059"></span><span class="hs-comment">--   confirmed on the ledger before returning.</span><span>
</span><span id="line-1060"></span><span class="annot"><a href="Plutus.Contract.Request.html#submitTxConfirmed"><span class="hs-identifier hs-type">submitTxConfirmed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680560833"><span class="annot"><a href="#local-6989586621680560833"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680560832"><span class="annot"><a href="#local-6989586621680560832"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680560831"><span class="annot"><a href="#local-6989586621680560831"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560831"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UnbalancedTx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560833"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560832"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560831"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1061"></span><span id="submitTxConfirmed"><span class="annot"><span class="annottext">submitTxConfirmed :: UnbalancedTx -&gt; Contract w s e ()
</span><a href="Plutus.Contract.Request.html#submitTxConfirmed"><span class="hs-identifier hs-var hs-var">submitTxConfirmed</span></a></span></span><span> </span><span id="local-6989586621680560830"><span class="annot"><span class="annottext">UnbalancedTx
</span><a href="#local-6989586621680560830"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnbalancedTx -&gt; Contract w s e CardanoTx
forall w (s :: Row *) e.
AsContractError e =&gt;
UnbalancedTx -&gt; Contract w s e CardanoTx
</span><a href="Plutus.Contract.Request.html#submitUnbalancedTx"><span class="hs-identifier hs-var">submitUnbalancedTx</span></a></span><span> </span><span class="annot"><span class="annottext">UnbalancedTx
</span><a href="#local-6989586621680560830"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Contract w s e CardanoTx
-&gt; (CardanoTx -&gt; Contract w s e ()) -&gt; Contract w s e ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">TxId -&gt; Contract w s e ()
forall w (s :: Row *) e.
AsContractError e =&gt;
TxId -&gt; Contract w s e ()
</span><a href="Plutus.Contract.Request.html#awaitTxConfirmed"><span class="hs-identifier hs-var">awaitTxConfirmed</span></a></span><span> </span><span class="annot"><span class="annottext">(TxId -&gt; Contract w s e ())
-&gt; (CardanoTx -&gt; TxId) -&gt; CardanoTx -&gt; Contract w s e ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoTx -&gt; TxId
</span><span class="hs-identifier hs-var">getCardanoTxId</span></span><span>
</span><span id="line-1062"></span><span>
</span><span id="line-1063"></span><span class="hs-comment">-- | Take an 'UnbalancedTx' then balance, sign and submit it to the blockchain</span><span>
</span><span id="line-1064"></span><span class="hs-comment">-- without returning any results.</span><span>
</span><span id="line-1065"></span><span class="annot"><a href="Plutus.Contract.Request.html#yieldUnbalancedTx"><span class="hs-identifier hs-type">yieldUnbalancedTx</span></a></span><span>
</span><span id="line-1066"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680560829"><span class="annot"><a href="#local-6989586621680560829"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680560828"><span class="annot"><a href="#local-6989586621680560828"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680560827"><span class="annot"><a href="#local-6989586621680560827"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Error.html#AsContractError"><span class="hs-identifier hs-type">AsContractError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560827"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1067"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UnbalancedTx</span></span><span>
</span><span id="line-1068"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560829"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560828"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680560827"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1069"></span><span id="yieldUnbalancedTx"><span class="annot"><span class="annottext">yieldUnbalancedTx :: UnbalancedTx -&gt; Contract w s e ()
</span><a href="Plutus.Contract.Request.html#yieldUnbalancedTx"><span class="hs-identifier hs-var hs-var">yieldUnbalancedTx</span></a></span></span><span> </span><span id="local-6989586621680560826"><span class="annot"><span class="annottext">UnbalancedTx
</span><a href="#local-6989586621680560826"><span class="hs-identifier hs-var">utx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PABReq -&gt; Prism' PABResp () -&gt; Contract w s e ()
forall w (s :: Row *) e a.
AsContractError e =&gt;
PABReq -&gt; Prism' PABResp a -&gt; Contract w s e a
</span><a href="Plutus.Contract.Request.html#pabReq"><span class="hs-identifier hs-var">pabReq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnbalancedTx -&gt; PABReq
</span><a href="Plutus.Contract.Effects.html#YieldUnbalancedTxReq"><span class="hs-identifier hs-var">YieldUnbalancedTxReq</span></a></span><span> </span><span class="annot"><span class="annottext">UnbalancedTx
</span><a href="#local-6989586621680560826"><span class="hs-identifier hs-var">utx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prism' PABResp ()
</span><a href="Plutus.Contract.Effects.html#_YieldUnbalancedTxResp"><span class="hs-identifier hs-var">E._YieldUnbalancedTxResp</span></a></span><span>
</span><span id="line-1070"></span></pre></body></html>