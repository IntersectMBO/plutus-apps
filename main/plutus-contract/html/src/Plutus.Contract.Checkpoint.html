<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_9qxhR4kSGTRI8hURSIRTjf"></span><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds           #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass      #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric       #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies  #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts    #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE GADTs               #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE KindSignatures      #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase          #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns      #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings   #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes          #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell     #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications    #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators       #-}</span><span>
</span><span id="line-16"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Plutus.Contract.Checkpoint</span><span class="hs-special">(</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Checkpoints</span></span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><span class="hs-comment">-- $checkpoints</span></span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#Checkpoint"><span class="hs-identifier">Checkpoint</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointError"><span class="hs-identifier">CheckpointError</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#AsCheckpointError"><span class="hs-identifier">AsCheckpointError</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointStore"><span class="hs-identifier">CheckpointStore</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointStoreItem"><span class="hs-identifier">CheckpointStoreItem</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier">CheckpointKey</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointLogMsg"><span class="hs-identifier">CheckpointLogMsg</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#jsonCheckpoint"><span class="hs-identifier">jsonCheckpoint</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#jsonCheckpointLoop"><span class="hs-identifier">jsonCheckpointLoop</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#handleCheckpoint"><span class="hs-identifier">handleCheckpoint</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#completedIntervals"><span class="hs-identifier">completedIntervals</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#maxKey"><span class="hs-identifier">maxKey</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Freer</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Freer.Error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Error</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">throwError</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Freer.Extras.Log</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">LogMsg</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">logDebug</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">logError</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Freer.State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">State</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">get</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">gets</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">modify</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">put</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">FromJSON</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">FromJSONKey</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ToJSON</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ToJSONKey</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Value</span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson.Types</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">JSON</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.IntervalMap.Interval</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Interval</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ClosedInterval</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.IntervalSet</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IS</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prettyprinter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">colon</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">vsep</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;+&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-comment">-- $checkpoints</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- This module contains a checkpoints mechanism that can be used to store</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- intermediate results of 'Control.Monad.Freer.Eff' programs as JSON values</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- inside a 'CheckpointStore'. It works similar to the short-circuiting behavior</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- of 'Control.Monad.Freer.Error.Error': Before we execute an action</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- @Eff effs a@ whose result should be checkpointed, we check if the there is</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- already a value of @a@ for this checkpoint it in the store. If there is, we</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- return it /instead/ of running the action. If there isn't, we run the action</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- @a@ and then store the result.</span><span>
</span><span id="line-58"></span><span class="hs-comment">--</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- * To create a checkpoint use 'jsonCheckpoint'.</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- * To handle the checkpoint effect use 'handleCheckpoint'.</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span id="local-6989586621680547365"><span id="local-6989586621680547366"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="CheckpointKey"><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-var">CheckpointKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CheckpointKey"><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-var">CheckpointKey</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/integer-gmp-1.0.3.0/src"><span class="hs-identifier hs-type">Integer</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680547360"><span id="local-6989586621680547362"><span class="annot"><span class="annottext">CheckpointKey -&gt; CheckpointKey -&gt; Bool
(CheckpointKey -&gt; CheckpointKey -&gt; Bool)
-&gt; (CheckpointKey -&gt; CheckpointKey -&gt; Bool) -&gt; Eq CheckpointKey
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: CheckpointKey -&gt; CheckpointKey -&gt; Bool
$c/= :: CheckpointKey -&gt; CheckpointKey -&gt; Bool
== :: CheckpointKey -&gt; CheckpointKey -&gt; Bool
$c== :: CheckpointKey -&gt; CheckpointKey -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680547344"><span id="local-6989586621680547346"><span id="local-6989586621680547348"><span id="local-6989586621680547350"><span id="local-6989586621680547352"><span id="local-6989586621680547354"><span id="local-6989586621680547356"><span class="annot"><span class="annottext">Eq CheckpointKey
Eq CheckpointKey
-&gt; (CheckpointKey -&gt; CheckpointKey -&gt; Ordering)
-&gt; (CheckpointKey -&gt; CheckpointKey -&gt; Bool)
-&gt; (CheckpointKey -&gt; CheckpointKey -&gt; Bool)
-&gt; (CheckpointKey -&gt; CheckpointKey -&gt; Bool)
-&gt; (CheckpointKey -&gt; CheckpointKey -&gt; Bool)
-&gt; (CheckpointKey -&gt; CheckpointKey -&gt; CheckpointKey)
-&gt; (CheckpointKey -&gt; CheckpointKey -&gt; CheckpointKey)
-&gt; Ord CheckpointKey
CheckpointKey -&gt; CheckpointKey -&gt; Bool
CheckpointKey -&gt; CheckpointKey -&gt; Ordering
CheckpointKey -&gt; CheckpointKey -&gt; CheckpointKey
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: CheckpointKey -&gt; CheckpointKey -&gt; CheckpointKey
$cmin :: CheckpointKey -&gt; CheckpointKey -&gt; CheckpointKey
max :: CheckpointKey -&gt; CheckpointKey -&gt; CheckpointKey
$cmax :: CheckpointKey -&gt; CheckpointKey -&gt; CheckpointKey
&gt;= :: CheckpointKey -&gt; CheckpointKey -&gt; Bool
$c&gt;= :: CheckpointKey -&gt; CheckpointKey -&gt; Bool
&gt; :: CheckpointKey -&gt; CheckpointKey -&gt; Bool
$c&gt; :: CheckpointKey -&gt; CheckpointKey -&gt; Bool
&lt;= :: CheckpointKey -&gt; CheckpointKey -&gt; Bool
$c&lt;= :: CheckpointKey -&gt; CheckpointKey -&gt; Bool
&lt; :: CheckpointKey -&gt; CheckpointKey -&gt; Bool
$c&lt; :: CheckpointKey -&gt; CheckpointKey -&gt; Bool
compare :: CheckpointKey -&gt; CheckpointKey -&gt; Ordering
$ccompare :: CheckpointKey -&gt; CheckpointKey -&gt; Ordering
$cp1Ord :: Eq CheckpointKey
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680547337"><span id="local-6989586621680547339"><span id="local-6989586621680547341"><span class="annot"><span class="annottext">Int -&gt; CheckpointKey -&gt; ShowS
[CheckpointKey] -&gt; ShowS
CheckpointKey -&gt; String
(Int -&gt; CheckpointKey -&gt; ShowS)
-&gt; (CheckpointKey -&gt; String)
-&gt; ([CheckpointKey] -&gt; ShowS)
-&gt; Show CheckpointKey
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [CheckpointKey] -&gt; ShowS
$cshowList :: [CheckpointKey] -&gt; ShowS
show :: CheckpointKey -&gt; String
$cshow :: CheckpointKey -&gt; String
showsPrec :: Int -&gt; CheckpointKey -&gt; ShowS
$cshowsPrec :: Int -&gt; CheckpointKey -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. CheckpointKey -&gt; Rep CheckpointKey x)
-&gt; (forall x. Rep CheckpointKey x -&gt; CheckpointKey)
-&gt; Generic CheckpointKey
forall x. Rep CheckpointKey x -&gt; CheckpointKey
forall x. CheckpointKey -&gt; Rep CheckpointKey x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep CheckpointKey x -&gt; CheckpointKey
$cfrom :: forall x. CheckpointKey -&gt; Rep CheckpointKey x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680547329"><span id="local-6989586621680547331"><span class="annot"><span class="annottext">Value -&gt; Parser [CheckpointKey]
Value -&gt; Parser CheckpointKey
(Value -&gt; Parser CheckpointKey)
-&gt; (Value -&gt; Parser [CheckpointKey]) -&gt; FromJSON CheckpointKey
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [CheckpointKey]
$cparseJSONList :: Value -&gt; Parser [CheckpointKey]
parseJSON :: Value -&gt; Parser CheckpointKey
$cparseJSON :: Value -&gt; Parser CheckpointKey
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680547320"><span id="local-6989586621680547322"><span id="local-6989586621680547324"><span id="local-6989586621680547326"><span class="annot"><span class="annottext">[CheckpointKey] -&gt; Encoding
[CheckpointKey] -&gt; Value
CheckpointKey -&gt; Encoding
CheckpointKey -&gt; Value
(CheckpointKey -&gt; Value)
-&gt; (CheckpointKey -&gt; Encoding)
-&gt; ([CheckpointKey] -&gt; Value)
-&gt; ([CheckpointKey] -&gt; Encoding)
-&gt; ToJSON CheckpointKey
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [CheckpointKey] -&gt; Encoding
$ctoEncodingList :: [CheckpointKey] -&gt; Encoding
toJSONList :: [CheckpointKey] -&gt; Value
$ctoJSONList :: [CheckpointKey] -&gt; Value
toEncoding :: CheckpointKey -&gt; Encoding
$ctoEncoding :: CheckpointKey -&gt; Encoding
toJSON :: CheckpointKey -&gt; Value
$ctoJSON :: CheckpointKey -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680547315"><span id="local-6989586621680547317"><span class="annot"><span class="annottext">ToJSONKeyFunction [CheckpointKey]
ToJSONKeyFunction CheckpointKey
ToJSONKeyFunction CheckpointKey
-&gt; ToJSONKeyFunction [CheckpointKey] -&gt; ToJSONKey CheckpointKey
forall a.
ToJSONKeyFunction a -&gt; ToJSONKeyFunction [a] -&gt; ToJSONKey a
toJSONKeyList :: ToJSONKeyFunction [CheckpointKey]
$ctoJSONKeyList :: ToJSONKeyFunction [CheckpointKey]
toJSONKey :: ToJSONKeyFunction CheckpointKey
$ctoJSONKey :: ToJSONKeyFunction CheckpointKey
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">ToJSONKey</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680547310"><span id="local-6989586621680547312"><span class="annot"><span class="annottext">FromJSONKeyFunction [CheckpointKey]
FromJSONKeyFunction CheckpointKey
FromJSONKeyFunction CheckpointKey
-&gt; FromJSONKeyFunction [CheckpointKey] -&gt; FromJSONKey CheckpointKey
forall a.
FromJSONKeyFunction a -&gt; FromJSONKeyFunction [a] -&gt; FromJSONKey a
fromJSONKeyList :: FromJSONKeyFunction [CheckpointKey]
$cfromJSONKeyList :: FromJSONKeyFunction [CheckpointKey]
fromJSONKey :: FromJSONKeyFunction CheckpointKey
$cfromJSONKey :: FromJSONKeyFunction CheckpointKey
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSONKey</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680547295"><span id="local-6989586621680547297"><span id="local-6989586621680547299"><span id="local-6989586621680547301"><span id="local-6989586621680547303"><span id="local-6989586621680547305"><span id="local-6989586621680547307"><span class="annot"><span class="annottext">Integer -&gt; CheckpointKey
CheckpointKey -&gt; CheckpointKey
CheckpointKey -&gt; CheckpointKey -&gt; CheckpointKey
(CheckpointKey -&gt; CheckpointKey -&gt; CheckpointKey)
-&gt; (CheckpointKey -&gt; CheckpointKey -&gt; CheckpointKey)
-&gt; (CheckpointKey -&gt; CheckpointKey -&gt; CheckpointKey)
-&gt; (CheckpointKey -&gt; CheckpointKey)
-&gt; (CheckpointKey -&gt; CheckpointKey)
-&gt; (CheckpointKey -&gt; CheckpointKey)
-&gt; (Integer -&gt; CheckpointKey)
-&gt; Num CheckpointKey
forall a.
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Integer -&gt; a)
-&gt; Num a
fromInteger :: Integer -&gt; CheckpointKey
$cfromInteger :: Integer -&gt; CheckpointKey
signum :: CheckpointKey -&gt; CheckpointKey
$csignum :: CheckpointKey -&gt; CheckpointKey
abs :: CheckpointKey -&gt; CheckpointKey
$cabs :: CheckpointKey -&gt; CheckpointKey
negate :: CheckpointKey -&gt; CheckpointKey
$cnegate :: CheckpointKey -&gt; CheckpointKey
* :: CheckpointKey -&gt; CheckpointKey -&gt; CheckpointKey
$c* :: CheckpointKey -&gt; CheckpointKey -&gt; CheckpointKey
- :: CheckpointKey -&gt; CheckpointKey -&gt; CheckpointKey
$c- :: CheckpointKey -&gt; CheckpointKey -&gt; CheckpointKey
+ :: CheckpointKey -&gt; CheckpointKey -&gt; CheckpointKey
$c+ :: CheckpointKey -&gt; CheckpointKey -&gt; CheckpointKey
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Num</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680547278"><span id="local-6989586621680547280"><span id="local-6989586621680547282"><span id="local-6989586621680547284"><span id="local-6989586621680547286"><span id="local-6989586621680547288"><span id="local-6989586621680547290"><span id="local-6989586621680547292"><span class="annot"><span class="annottext">Int -&gt; CheckpointKey
CheckpointKey -&gt; Int
CheckpointKey -&gt; [CheckpointKey]
CheckpointKey -&gt; CheckpointKey
CheckpointKey -&gt; CheckpointKey -&gt; [CheckpointKey]
CheckpointKey -&gt; CheckpointKey -&gt; CheckpointKey -&gt; [CheckpointKey]
(CheckpointKey -&gt; CheckpointKey)
-&gt; (CheckpointKey -&gt; CheckpointKey)
-&gt; (Int -&gt; CheckpointKey)
-&gt; (CheckpointKey -&gt; Int)
-&gt; (CheckpointKey -&gt; [CheckpointKey])
-&gt; (CheckpointKey -&gt; CheckpointKey -&gt; [CheckpointKey])
-&gt; (CheckpointKey -&gt; CheckpointKey -&gt; [CheckpointKey])
-&gt; (CheckpointKey
    -&gt; CheckpointKey -&gt; CheckpointKey -&gt; [CheckpointKey])
-&gt; Enum CheckpointKey
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: CheckpointKey -&gt; CheckpointKey -&gt; CheckpointKey -&gt; [CheckpointKey]
$cenumFromThenTo :: CheckpointKey -&gt; CheckpointKey -&gt; CheckpointKey -&gt; [CheckpointKey]
enumFromTo :: CheckpointKey -&gt; CheckpointKey -&gt; [CheckpointKey]
$cenumFromTo :: CheckpointKey -&gt; CheckpointKey -&gt; [CheckpointKey]
enumFromThen :: CheckpointKey -&gt; CheckpointKey -&gt; [CheckpointKey]
$cenumFromThen :: CheckpointKey -&gt; CheckpointKey -&gt; [CheckpointKey]
enumFrom :: CheckpointKey -&gt; [CheckpointKey]
$cenumFrom :: CheckpointKey -&gt; [CheckpointKey]
fromEnum :: CheckpointKey -&gt; Int
$cfromEnum :: CheckpointKey -&gt; Int
toEnum :: Int -&gt; CheckpointKey
$ctoEnum :: Int -&gt; CheckpointKey
pred :: CheckpointKey -&gt; CheckpointKey
$cpred :: CheckpointKey -&gt; CheckpointKey
succ :: CheckpointKey -&gt; CheckpointKey
$csucc :: CheckpointKey -&gt; CheckpointKey
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></a></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680547273"><span id="local-6989586621680547275"><span class="annot"><span class="annottext">[CheckpointKey] -&gt; Doc ann
CheckpointKey -&gt; Doc ann
(forall ann. CheckpointKey -&gt; Doc ann)
-&gt; (forall ann. [CheckpointKey] -&gt; Doc ann) -&gt; Pretty CheckpointKey
forall ann. [CheckpointKey] -&gt; Doc ann
forall ann. CheckpointKey -&gt; Doc ann
forall a.
(forall ann. a -&gt; Doc ann)
-&gt; (forall ann. [a] -&gt; Doc ann) -&gt; Pretty a
prettyList :: [CheckpointKey] -&gt; Doc ann
$cprettyList :: forall ann. [CheckpointKey] -&gt; Doc ann
pretty :: CheckpointKey -&gt; Doc ann
$cpretty :: forall ann. CheckpointKey -&gt; Doc ann
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Pretty</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span id="local-6989586621680547270"><span id="local-6989586621680547271"></span></span><span class="hs-keyword">data</span><span> </span><span id="CheckpointError"><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointError"><span class="hs-identifier hs-var">CheckpointError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="JSONDecodeError"><span class="annot"><a href="Plutus.Contract.Checkpoint.html#JSONDecodeError"><span class="hs-identifier hs-var">JSONDecodeError</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680547265"><span id="local-6989586621680547267"><span class="annot"><span class="annottext">CheckpointError -&gt; CheckpointError -&gt; Bool
(CheckpointError -&gt; CheckpointError -&gt; Bool)
-&gt; (CheckpointError -&gt; CheckpointError -&gt; Bool)
-&gt; Eq CheckpointError
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: CheckpointError -&gt; CheckpointError -&gt; Bool
$c/= :: CheckpointError -&gt; CheckpointError -&gt; Bool
== :: CheckpointError -&gt; CheckpointError -&gt; Bool
$c== :: CheckpointError -&gt; CheckpointError -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680547250"><span id="local-6989586621680547252"><span id="local-6989586621680547254"><span id="local-6989586621680547256"><span id="local-6989586621680547258"><span id="local-6989586621680547260"><span id="local-6989586621680547262"><span class="annot"><span class="annottext">Eq CheckpointError
Eq CheckpointError
-&gt; (CheckpointError -&gt; CheckpointError -&gt; Ordering)
-&gt; (CheckpointError -&gt; CheckpointError -&gt; Bool)
-&gt; (CheckpointError -&gt; CheckpointError -&gt; Bool)
-&gt; (CheckpointError -&gt; CheckpointError -&gt; Bool)
-&gt; (CheckpointError -&gt; CheckpointError -&gt; Bool)
-&gt; (CheckpointError -&gt; CheckpointError -&gt; CheckpointError)
-&gt; (CheckpointError -&gt; CheckpointError -&gt; CheckpointError)
-&gt; Ord CheckpointError
CheckpointError -&gt; CheckpointError -&gt; Bool
CheckpointError -&gt; CheckpointError -&gt; Ordering
CheckpointError -&gt; CheckpointError -&gt; CheckpointError
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: CheckpointError -&gt; CheckpointError -&gt; CheckpointError
$cmin :: CheckpointError -&gt; CheckpointError -&gt; CheckpointError
max :: CheckpointError -&gt; CheckpointError -&gt; CheckpointError
$cmax :: CheckpointError -&gt; CheckpointError -&gt; CheckpointError
&gt;= :: CheckpointError -&gt; CheckpointError -&gt; Bool
$c&gt;= :: CheckpointError -&gt; CheckpointError -&gt; Bool
&gt; :: CheckpointError -&gt; CheckpointError -&gt; Bool
$c&gt; :: CheckpointError -&gt; CheckpointError -&gt; Bool
&lt;= :: CheckpointError -&gt; CheckpointError -&gt; Bool
$c&lt;= :: CheckpointError -&gt; CheckpointError -&gt; Bool
&lt; :: CheckpointError -&gt; CheckpointError -&gt; Bool
$c&lt; :: CheckpointError -&gt; CheckpointError -&gt; Bool
compare :: CheckpointError -&gt; CheckpointError -&gt; Ordering
$ccompare :: CheckpointError -&gt; CheckpointError -&gt; Ordering
$cp1Ord :: Eq CheckpointError
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680547244"><span id="local-6989586621680547246"><span id="local-6989586621680547248"><span class="annot"><span class="annottext">Int -&gt; CheckpointError -&gt; ShowS
[CheckpointError] -&gt; ShowS
CheckpointError -&gt; String
(Int -&gt; CheckpointError -&gt; ShowS)
-&gt; (CheckpointError -&gt; String)
-&gt; ([CheckpointError] -&gt; ShowS)
-&gt; Show CheckpointError
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [CheckpointError] -&gt; ShowS
$cshowList :: [CheckpointError] -&gt; ShowS
show :: CheckpointError -&gt; String
$cshow :: CheckpointError -&gt; String
showsPrec :: Int -&gt; CheckpointError -&gt; ShowS
$cshowsPrec :: Int -&gt; CheckpointError -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. CheckpointError -&gt; Rep CheckpointError x)
-&gt; (forall x. Rep CheckpointError x -&gt; CheckpointError)
-&gt; Generic CheckpointError
forall x. Rep CheckpointError x -&gt; CheckpointError
forall x. CheckpointError -&gt; Rep CheckpointError x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep CheckpointError x -&gt; CheckpointError
$cfrom :: forall x. CheckpointError -&gt; Rep CheckpointError x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680547238"><span id="local-6989586621680547240"><span class="annot"><span class="annottext">Value -&gt; Parser [CheckpointError]
Value -&gt; Parser CheckpointError
(Value -&gt; Parser CheckpointError)
-&gt; (Value -&gt; Parser [CheckpointError]) -&gt; FromJSON CheckpointError
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [CheckpointError]
$cparseJSONList :: Value -&gt; Parser [CheckpointError]
parseJSON :: Value -&gt; Parser CheckpointError
$cparseJSON :: Value -&gt; Parser CheckpointError
</span><a href="#local-6989586621680547238"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680547230"><span id="local-6989586621680547232"><span id="local-6989586621680547234"><span id="local-6989586621680547236"><span class="annot"><span class="annottext">[CheckpointError] -&gt; Encoding
[CheckpointError] -&gt; Value
CheckpointError -&gt; Encoding
CheckpointError -&gt; Value
(CheckpointError -&gt; Value)
-&gt; (CheckpointError -&gt; Encoding)
-&gt; ([CheckpointError] -&gt; Value)
-&gt; ([CheckpointError] -&gt; Encoding)
-&gt; ToJSON CheckpointError
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [CheckpointError] -&gt; Encoding
$ctoEncodingList :: [CheckpointError] -&gt; Encoding
toJSONList :: [CheckpointError] -&gt; Value
$ctoJSONList :: [CheckpointError] -&gt; Value
toEncoding :: CheckpointError -&gt; Encoding
$ctoEncoding :: CheckpointError -&gt; Encoding
toJSON :: CheckpointError -&gt; Value
$ctoJSON :: CheckpointError -&gt; Value
</span><a href="#local-6989586621680547230"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></a></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680547227"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointError"><span class="hs-identifier hs-type">CheckpointError</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-72"></span><span>    </span><span id="local-6989586621680547226"><span class="annot"><span class="annottext">pretty :: CheckpointError -&gt; Doc ann
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-73"></span><span>        </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#JSONDecodeError"><span class="hs-identifier hs-type">JSONDecodeError</span></a></span><span> </span><span id="local-6989586621680547224"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680547224"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;JSON decoding error:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680547224"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span id="_JSONDecodeError"><span id="_CheckpointError"><span id="local-6989586621680547219"><span id="local-6989586621680547221"><span id="local-6989586621680547223"><span id="AsCheckpointError"><span id="local-6989586621680547615"><span class="hs-identifier">makeClassyPrisms</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">CheckpointError</span></span></span></span></span></span></span></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span id="local-6989586621680547214"><span id="local-6989586621680547215"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="CheckpointStore"><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointStore"><span class="hs-identifier hs-var">CheckpointStore</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CheckpointStore"><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointStore"><span class="hs-identifier hs-var">CheckpointStore</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unCheckpointStore"><span class="annot"><span class="annottext">CheckpointStore -&gt; Map CheckpointKey (CheckpointStoreItem Value)
</span><a href="Plutus.Contract.Checkpoint.html#unCheckpointStore"><span class="hs-identifier hs-var hs-var">unCheckpointStore</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointStoreItem"><span class="hs-identifier hs-type">CheckpointStoreItem</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680547208"><span id="local-6989586621680547210"><span class="annot"><span class="annottext">CheckpointStore -&gt; CheckpointStore -&gt; Bool
(CheckpointStore -&gt; CheckpointStore -&gt; Bool)
-&gt; (CheckpointStore -&gt; CheckpointStore -&gt; Bool)
-&gt; Eq CheckpointStore
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: CheckpointStore -&gt; CheckpointStore -&gt; Bool
$c/= :: CheckpointStore -&gt; CheckpointStore -&gt; Bool
== :: CheckpointStore -&gt; CheckpointStore -&gt; Bool
$c== :: CheckpointStore -&gt; CheckpointStore -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680547202"><span id="local-6989586621680547204"><span id="local-6989586621680547206"><span class="annot"><span class="annottext">Int -&gt; CheckpointStore -&gt; ShowS
[CheckpointStore] -&gt; ShowS
CheckpointStore -&gt; String
(Int -&gt; CheckpointStore -&gt; ShowS)
-&gt; (CheckpointStore -&gt; String)
-&gt; ([CheckpointStore] -&gt; ShowS)
-&gt; Show CheckpointStore
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [CheckpointStore] -&gt; ShowS
$cshowList :: [CheckpointStore] -&gt; ShowS
show :: CheckpointStore -&gt; String
$cshow :: CheckpointStore -&gt; String
showsPrec :: Int -&gt; CheckpointStore -&gt; ShowS
$cshowsPrec :: Int -&gt; CheckpointStore -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. CheckpointStore -&gt; Rep CheckpointStore x)
-&gt; (forall x. Rep CheckpointStore x -&gt; CheckpointStore)
-&gt; Generic CheckpointStore
forall x. Rep CheckpointStore x -&gt; CheckpointStore
forall x. CheckpointStore -&gt; Rep CheckpointStore x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep CheckpointStore x -&gt; CheckpointStore
$cfrom :: forall x. CheckpointStore -&gt; Rep CheckpointStore x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680547192"><span id="local-6989586621680547194"><span id="local-6989586621680547196"><span id="local-6989586621680547198"><span class="annot"><span class="annottext">[CheckpointStore] -&gt; Encoding
[CheckpointStore] -&gt; Value
CheckpointStore -&gt; Encoding
CheckpointStore -&gt; Value
(CheckpointStore -&gt; Value)
-&gt; (CheckpointStore -&gt; Encoding)
-&gt; ([CheckpointStore] -&gt; Value)
-&gt; ([CheckpointStore] -&gt; Encoding)
-&gt; ToJSON CheckpointStore
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [CheckpointStore] -&gt; Encoding
$ctoEncodingList :: [CheckpointStore] -&gt; Encoding
toJSONList :: [CheckpointStore] -&gt; Value
$ctoJSONList :: [CheckpointStore] -&gt; Value
toEncoding :: CheckpointStore -&gt; Encoding
$ctoEncoding :: CheckpointStore -&gt; Encoding
toJSON :: CheckpointStore -&gt; Value
$ctoJSON :: CheckpointStore -&gt; Value
</span><a href="#local-6989586621680547192"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></a></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680547188"><span id="local-6989586621680547190"><span class="annot"><span class="annottext">Value -&gt; Parser [CheckpointStore]
Value -&gt; Parser CheckpointStore
(Value -&gt; Parser CheckpointStore)
-&gt; (Value -&gt; Parser [CheckpointStore]) -&gt; FromJSON CheckpointStore
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [CheckpointStore]
$cparseJSONList :: Value -&gt; Parser [CheckpointStore]
parseJSON :: Value -&gt; Parser CheckpointStore
$cparseJSON :: Value -&gt; Parser CheckpointStore
</span><a href="#local-6989586621680547188"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680547182"><span id="local-6989586621680547184"><span id="local-6989586621680547186"><span class="annot"><span class="annottext">b -&gt; CheckpointStore -&gt; CheckpointStore
NonEmpty CheckpointStore -&gt; CheckpointStore
CheckpointStore -&gt; CheckpointStore -&gt; CheckpointStore
(CheckpointStore -&gt; CheckpointStore -&gt; CheckpointStore)
-&gt; (NonEmpty CheckpointStore -&gt; CheckpointStore)
-&gt; (forall b.
    Integral b =&gt;
    b -&gt; CheckpointStore -&gt; CheckpointStore)
-&gt; Semigroup CheckpointStore
forall b. Integral b =&gt; b -&gt; CheckpointStore -&gt; CheckpointStore
forall a.
(a -&gt; a -&gt; a)
-&gt; (NonEmpty a -&gt; a)
-&gt; (forall b. Integral b =&gt; b -&gt; a -&gt; a)
-&gt; Semigroup a
stimes :: b -&gt; CheckpointStore -&gt; CheckpointStore
$cstimes :: forall b. Integral b =&gt; b -&gt; CheckpointStore -&gt; CheckpointStore
sconcat :: NonEmpty CheckpointStore -&gt; CheckpointStore
$csconcat :: NonEmpty CheckpointStore -&gt; CheckpointStore
&lt;&gt; :: CheckpointStore -&gt; CheckpointStore -&gt; CheckpointStore
$c&lt;&gt; :: CheckpointStore -&gt; CheckpointStore -&gt; CheckpointStore
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Semigroup</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680547174"><span id="local-6989586621680547176"><span id="local-6989586621680547178"><span class="annot"><span class="annottext">Semigroup CheckpointStore
CheckpointStore
Semigroup CheckpointStore
-&gt; CheckpointStore
-&gt; (CheckpointStore -&gt; CheckpointStore -&gt; CheckpointStore)
-&gt; ([CheckpointStore] -&gt; CheckpointStore)
-&gt; Monoid CheckpointStore
[CheckpointStore] -&gt; CheckpointStore
CheckpointStore -&gt; CheckpointStore -&gt; CheckpointStore
forall a.
Semigroup a -&gt; a -&gt; (a -&gt; a -&gt; a) -&gt; ([a] -&gt; a) -&gt; Monoid a
mconcat :: [CheckpointStore] -&gt; CheckpointStore
$cmconcat :: [CheckpointStore] -&gt; CheckpointStore
mappend :: CheckpointStore -&gt; CheckpointStore -&gt; CheckpointStore
$cmappend :: CheckpointStore -&gt; CheckpointStore -&gt; CheckpointStore
mempty :: CheckpointStore
$cmempty :: CheckpointStore
$cp1Monoid :: Semigroup CheckpointStore
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monoid</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680547170"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointStore"><span class="hs-identifier hs-type">CheckpointStore</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-83"></span><span>    </span><span id="local-6989586621680547169"><span class="annot"><span class="annottext">pretty :: CheckpointStore -&gt; Doc ann
</span><a href="#local-6989586621680547169"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointStore"><span class="hs-identifier hs-type">CheckpointStore</span></a></span><span> </span><span id="local-6989586621680547168"><span class="annot"><span class="annottext">Map CheckpointKey (CheckpointStoreItem Value)
</span><a href="#local-6989586621680547168"><span class="hs-identifier hs-var">mp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-84"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680547167"><span class="annot"><span class="annottext">p :: a -&gt; a -&gt; Doc ann
</span><a href="#local-6989586621680547167"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680547166"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680547166"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680547165"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680547165"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680547166"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">colon</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc ann) -&gt; (a -&gt; String) -&gt; a -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ShowS
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; (a -&gt; String) -&gt; a -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680547165"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-85"></span><span>        </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">vsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CheckpointKey -&gt; CheckpointStoreItem Value -&gt; Doc ann)
-&gt; (CheckpointKey, CheckpointStoreItem Value) -&gt; Doc ann
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointKey -&gt; CheckpointStoreItem Value -&gt; Doc ann
forall a a ann. (Pretty a, Show a) =&gt; a -&gt; a -&gt; Doc ann
</span><a href="#local-6989586621680547167"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">((CheckpointKey, CheckpointStoreItem Value) -&gt; Doc ann)
-&gt; [(CheckpointKey, CheckpointStoreItem Value)] -&gt; [Doc ann]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Map CheckpointKey (CheckpointStoreItem Value)
-&gt; [(CheckpointKey, CheckpointStoreItem Value)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">Map CheckpointKey (CheckpointStoreItem Value)
</span><a href="#local-6989586621680547168"><span class="hs-identifier hs-var">mp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#_CheckpointStore"><span class="hs-identifier hs-type">_CheckpointStore</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Iso'</span></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointStore"><span class="hs-identifier hs-type">CheckpointStore</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointStoreItem"><span class="hs-identifier hs-type">CheckpointStoreItem</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span id="_CheckpointStore"><span class="annot"><span class="annottext">_CheckpointStore :: p (Map CheckpointKey (CheckpointStoreItem Value))
  (f (Map CheckpointKey (CheckpointStoreItem Value)))
-&gt; p CheckpointStore (f CheckpointStore)
</span><a href="Plutus.Contract.Checkpoint.html#_CheckpointStore"><span class="hs-identifier hs-var hs-var">_CheckpointStore</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CheckpointStore -&gt; Map CheckpointKey (CheckpointStoreItem Value))
-&gt; (Map CheckpointKey (CheckpointStoreItem Value)
    -&gt; CheckpointStore)
-&gt; Iso
     CheckpointStore
     CheckpointStore
     (Map CheckpointKey (CheckpointStoreItem Value))
     (Map CheckpointKey (CheckpointStoreItem Value))
forall s a b t. (s -&gt; a) -&gt; (b -&gt; t) -&gt; Iso s t a b
</span><span class="hs-identifier hs-var">iso</span></span><span> </span><span class="annot"><span class="annottext">CheckpointStore -&gt; Map CheckpointKey (CheckpointStoreItem Value)
</span><a href="Plutus.Contract.Checkpoint.html#unCheckpointStore"><span class="hs-identifier hs-var hs-var">unCheckpointStore</span></a></span><span> </span><span class="annot"><span class="annottext">Map CheckpointKey (CheckpointStoreItem Value) -&gt; CheckpointStore
</span><a href="Plutus.Contract.Checkpoint.html#CheckpointStore"><span class="hs-identifier hs-var">CheckpointStore</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-comment">-- | Intervals of checkpoint keys that are completely covered by the</span><span>
</span><span id="line-91"></span><span class="hs-comment">--   checkpoint store.</span><span>
</span><span id="line-92"></span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#completedIntervals"><span class="hs-identifier hs-type">completedIntervals</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointStore"><span class="hs-identifier hs-type">CheckpointStore</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IS.IntervalSet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Interval</span></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span id="completedIntervals"><span class="annot"><span class="annottext">completedIntervals :: CheckpointStore -&gt; IntervalSet (Interval CheckpointKey)
</span><a href="Plutus.Contract.Checkpoint.html#completedIntervals"><span class="hs-identifier hs-var hs-var">completedIntervals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Interval CheckpointKey] -&gt; IntervalSet (Interval CheckpointKey)
forall k e. (Interval k e, Ord k) =&gt; [k] -&gt; IntervalSet k
</span><span class="hs-identifier hs-var">IS.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Interval CheckpointKey] -&gt; IntervalSet (Interval CheckpointKey))
-&gt; (CheckpointStore -&gt; [Interval CheckpointKey])
-&gt; CheckpointStore
-&gt; IntervalSet (Interval CheckpointKey)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((CheckpointKey, CheckpointStoreItem Value)
 -&gt; Interval CheckpointKey)
-&gt; [(CheckpointKey, CheckpointStoreItem Value)]
-&gt; [Interval CheckpointKey]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CheckpointKey
 -&gt; CheckpointStoreItem Value -&gt; Interval CheckpointKey)
-&gt; (CheckpointKey, CheckpointStoreItem Value)
-&gt; Interval CheckpointKey
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
-&gt; CheckpointStoreItem Value -&gt; Interval CheckpointKey
forall a.
CheckpointKey -&gt; CheckpointStoreItem a -&gt; Interval CheckpointKey
</span><a href="#local-6989586621680547154"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(CheckpointKey, CheckpointStoreItem Value)]
 -&gt; [Interval CheckpointKey])
-&gt; (CheckpointStore
    -&gt; [(CheckpointKey, CheckpointStoreItem Value)])
-&gt; CheckpointStore
-&gt; [Interval CheckpointKey]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Map CheckpointKey (CheckpointStoreItem Value)
-&gt; [(CheckpointKey, CheckpointStoreItem Value)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">(Map CheckpointKey (CheckpointStoreItem Value)
 -&gt; [(CheckpointKey, CheckpointStoreItem Value)])
-&gt; (CheckpointStore
    -&gt; Map CheckpointKey (CheckpointStoreItem Value))
-&gt; CheckpointStore
-&gt; [(CheckpointKey, CheckpointStoreItem Value)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointStore -&gt; Map CheckpointKey (CheckpointStoreItem Value)
</span><a href="Plutus.Contract.Checkpoint.html#unCheckpointStore"><span class="hs-identifier hs-var hs-var">unCheckpointStore</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-94"></span><span>    </span><span id="local-6989586621680547154"><span class="annot"><span class="annottext">f :: CheckpointKey -&gt; CheckpointStoreItem a -&gt; Interval CheckpointKey
</span><a href="#local-6989586621680547154"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680547153"><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680547153"><span class="hs-identifier hs-var">from_</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointStoreItem"><span class="hs-identifier hs-type">CheckpointStoreItem</span></a></span><span class="hs-special">{</span><span id="local-6989586621680547151"><span class="annot"><span class="annottext">CheckpointKey
csNewKey :: forall a. CheckpointStoreItem a -&gt; CheckpointKey
csNewKey :: CheckpointKey
</span><a href="Plutus.Contract.Checkpoint.html#csNewKey"><span class="hs-identifier hs-var hs-var">csNewKey</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CheckpointKey -&gt; CheckpointKey -&gt; Interval CheckpointKey
forall a. a -&gt; a -&gt; Interval a
</span><span class="hs-identifier hs-var">ClosedInterval</span></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680547153"><span class="hs-identifier hs-var">from_</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680547151"><span class="hs-identifier hs-var">csNewKey</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-comment">-- | The maximum key that is present in the store</span><span>
</span><span id="line-97"></span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#maxKey"><span class="hs-identifier hs-type">maxKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointStore"><span class="hs-identifier hs-type">CheckpointStore</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span>
</span><span id="line-98"></span><span id="maxKey"><span class="annot"><span class="annottext">maxKey :: CheckpointStore -&gt; Maybe CheckpointKey
</span><a href="Plutus.Contract.Checkpoint.html#maxKey"><span class="hs-identifier hs-var hs-var">maxKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((CheckpointKey, CheckpointStoreItem Value) -&gt; CheckpointKey)
-&gt; Maybe (CheckpointKey, CheckpointStoreItem Value)
-&gt; Maybe CheckpointKey
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">(CheckpointKey, CheckpointStoreItem Value) -&gt; CheckpointKey
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (CheckpointKey, CheckpointStoreItem Value)
 -&gt; Maybe CheckpointKey)
-&gt; (CheckpointStore
    -&gt; Maybe (CheckpointKey, CheckpointStoreItem Value))
-&gt; CheckpointStore
-&gt; Maybe CheckpointKey
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Map CheckpointKey (CheckpointStoreItem Value)
-&gt; Maybe (CheckpointKey, CheckpointStoreItem Value)
forall k a. Map k a -&gt; Maybe (k, a)
</span><span class="hs-identifier hs-var">Map.lookupMax</span></span><span> </span><span class="annot"><span class="annottext">(Map CheckpointKey (CheckpointStoreItem Value)
 -&gt; Maybe (CheckpointKey, CheckpointStoreItem Value))
-&gt; (CheckpointStore
    -&gt; Map CheckpointKey (CheckpointStoreItem Value))
-&gt; CheckpointStore
-&gt; Maybe (CheckpointKey, CheckpointStoreItem Value)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointStore -&gt; Map CheckpointKey (CheckpointStoreItem Value)
</span><a href="Plutus.Contract.Checkpoint.html#unCheckpointStore"><span class="hs-identifier hs-var hs-var">unCheckpointStore</span></a></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span id="local-6989586621680547147"><span id="local-6989586621680547148"></span></span><span class="hs-keyword">data</span><span> </span><span id="CheckpointStoreItem"><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointStoreItem"><span class="hs-identifier hs-var">CheckpointStoreItem</span></a></span></span><span> </span><span id="local-6989586621680547563"><span class="annot"><a href="#local-6989586621680547563"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-101"></span><span>    </span><span id="CheckpointStoreItem"><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointStoreItem"><span class="hs-identifier hs-var">CheckpointStoreItem</span></a></span></span><span>
</span><span id="line-102"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="csValue"><span class="annot"><span class="annottext">CheckpointStoreItem a -&gt; a
</span><a href="Plutus.Contract.Checkpoint.html#csValue"><span class="hs-identifier hs-var hs-var">csValue</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680547563"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-103"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="csNewKey"><span class="annot"><span class="annottext">CheckpointStoreItem a -&gt; CheckpointKey
</span><a href="Plutus.Contract.Checkpoint.html#csNewKey"><span class="hs-identifier hs-var hs-var">csNewKey</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span>
</span><span id="line-104"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680547142"><span id="local-6989586621680547144"><span class="annot"><span class="annottext">CheckpointStoreItem a -&gt; CheckpointStoreItem a -&gt; Bool
(CheckpointStoreItem a -&gt; CheckpointStoreItem a -&gt; Bool)
-&gt; (CheckpointStoreItem a -&gt; CheckpointStoreItem a -&gt; Bool)
-&gt; Eq (CheckpointStoreItem a)
forall a.
Eq a =&gt;
CheckpointStoreItem a -&gt; CheckpointStoreItem a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: CheckpointStoreItem a -&gt; CheckpointStoreItem a -&gt; Bool
$c/= :: forall a.
Eq a =&gt;
CheckpointStoreItem a -&gt; CheckpointStoreItem a -&gt; Bool
== :: CheckpointStoreItem a -&gt; CheckpointStoreItem a -&gt; Bool
$c== :: forall a.
Eq a =&gt;
CheckpointStoreItem a -&gt; CheckpointStoreItem a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680547127"><span id="local-6989586621680547129"><span id="local-6989586621680547131"><span id="local-6989586621680547133"><span id="local-6989586621680547135"><span id="local-6989586621680547137"><span id="local-6989586621680547139"><span class="annot"><span class="annottext">Eq (CheckpointStoreItem a)
Eq (CheckpointStoreItem a)
-&gt; (CheckpointStoreItem a -&gt; CheckpointStoreItem a -&gt; Ordering)
-&gt; (CheckpointStoreItem a -&gt; CheckpointStoreItem a -&gt; Bool)
-&gt; (CheckpointStoreItem a -&gt; CheckpointStoreItem a -&gt; Bool)
-&gt; (CheckpointStoreItem a -&gt; CheckpointStoreItem a -&gt; Bool)
-&gt; (CheckpointStoreItem a -&gt; CheckpointStoreItem a -&gt; Bool)
-&gt; (CheckpointStoreItem a
    -&gt; CheckpointStoreItem a -&gt; CheckpointStoreItem a)
-&gt; (CheckpointStoreItem a
    -&gt; CheckpointStoreItem a -&gt; CheckpointStoreItem a)
-&gt; Ord (CheckpointStoreItem a)
CheckpointStoreItem a -&gt; CheckpointStoreItem a -&gt; Bool
CheckpointStoreItem a -&gt; CheckpointStoreItem a -&gt; Ordering
CheckpointStoreItem a
-&gt; CheckpointStoreItem a -&gt; CheckpointStoreItem a
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall a. Ord a =&gt; Eq (CheckpointStoreItem a)
forall a.
Ord a =&gt;
CheckpointStoreItem a -&gt; CheckpointStoreItem a -&gt; Bool
forall a.
Ord a =&gt;
CheckpointStoreItem a -&gt; CheckpointStoreItem a -&gt; Ordering
forall a.
Ord a =&gt;
CheckpointStoreItem a
-&gt; CheckpointStoreItem a -&gt; CheckpointStoreItem a
min :: CheckpointStoreItem a
-&gt; CheckpointStoreItem a -&gt; CheckpointStoreItem a
$cmin :: forall a.
Ord a =&gt;
CheckpointStoreItem a
-&gt; CheckpointStoreItem a -&gt; CheckpointStoreItem a
max :: CheckpointStoreItem a
-&gt; CheckpointStoreItem a -&gt; CheckpointStoreItem a
$cmax :: forall a.
Ord a =&gt;
CheckpointStoreItem a
-&gt; CheckpointStoreItem a -&gt; CheckpointStoreItem a
&gt;= :: CheckpointStoreItem a -&gt; CheckpointStoreItem a -&gt; Bool
$c&gt;= :: forall a.
Ord a =&gt;
CheckpointStoreItem a -&gt; CheckpointStoreItem a -&gt; Bool
&gt; :: CheckpointStoreItem a -&gt; CheckpointStoreItem a -&gt; Bool
$c&gt; :: forall a.
Ord a =&gt;
CheckpointStoreItem a -&gt; CheckpointStoreItem a -&gt; Bool
&lt;= :: CheckpointStoreItem a -&gt; CheckpointStoreItem a -&gt; Bool
$c&lt;= :: forall a.
Ord a =&gt;
CheckpointStoreItem a -&gt; CheckpointStoreItem a -&gt; Bool
&lt; :: CheckpointStoreItem a -&gt; CheckpointStoreItem a -&gt; Bool
$c&lt; :: forall a.
Ord a =&gt;
CheckpointStoreItem a -&gt; CheckpointStoreItem a -&gt; Bool
compare :: CheckpointStoreItem a -&gt; CheckpointStoreItem a -&gt; Ordering
$ccompare :: forall a.
Ord a =&gt;
CheckpointStoreItem a -&gt; CheckpointStoreItem a -&gt; Ordering
$cp1Ord :: forall a. Ord a =&gt; Eq (CheckpointStoreItem a)
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680547121"><span id="local-6989586621680547123"><span id="local-6989586621680547125"><span class="annot"><span class="annottext">Int -&gt; CheckpointStoreItem a -&gt; ShowS
[CheckpointStoreItem a] -&gt; ShowS
CheckpointStoreItem a -&gt; String
(Int -&gt; CheckpointStoreItem a -&gt; ShowS)
-&gt; (CheckpointStoreItem a -&gt; String)
-&gt; ([CheckpointStoreItem a] -&gt; ShowS)
-&gt; Show (CheckpointStoreItem a)
forall a. Show a =&gt; Int -&gt; CheckpointStoreItem a -&gt; ShowS
forall a. Show a =&gt; [CheckpointStoreItem a] -&gt; ShowS
forall a. Show a =&gt; CheckpointStoreItem a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [CheckpointStoreItem a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [CheckpointStoreItem a] -&gt; ShowS
show :: CheckpointStoreItem a -&gt; String
$cshow :: forall a. Show a =&gt; CheckpointStoreItem a -&gt; String
showsPrec :: Int -&gt; CheckpointStoreItem a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; CheckpointStoreItem a -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. CheckpointStoreItem a -&gt; Rep (CheckpointStoreItem a) x)
-&gt; (forall x.
    Rep (CheckpointStoreItem a) x -&gt; CheckpointStoreItem a)
-&gt; Generic (CheckpointStoreItem a)
forall x. Rep (CheckpointStoreItem a) x -&gt; CheckpointStoreItem a
forall x. CheckpointStoreItem a -&gt; Rep (CheckpointStoreItem a) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall a x. Rep (CheckpointStoreItem a) x -&gt; CheckpointStoreItem a
forall a x. CheckpointStoreItem a -&gt; Rep (CheckpointStoreItem a) x
$cto :: forall a x. Rep (CheckpointStoreItem a) x -&gt; CheckpointStoreItem a
$cfrom :: forall a x. CheckpointStoreItem a -&gt; Rep (CheckpointStoreItem a) x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680547115"><span id="local-6989586621680547117"><span class="annot"><span class="annottext">a -&gt; CheckpointStoreItem b -&gt; CheckpointStoreItem a
(a -&gt; b) -&gt; CheckpointStoreItem a -&gt; CheckpointStoreItem b
(forall a b.
 (a -&gt; b) -&gt; CheckpointStoreItem a -&gt; CheckpointStoreItem b)
-&gt; (forall a b.
    a -&gt; CheckpointStoreItem b -&gt; CheckpointStoreItem a)
-&gt; Functor CheckpointStoreItem
forall a b. a -&gt; CheckpointStoreItem b -&gt; CheckpointStoreItem a
forall a b.
(a -&gt; b) -&gt; CheckpointStoreItem a -&gt; CheckpointStoreItem b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; CheckpointStoreItem b -&gt; CheckpointStoreItem a
$c&lt;$ :: forall a b. a -&gt; CheckpointStoreItem b -&gt; CheckpointStoreItem a
fmap :: (a -&gt; b) -&gt; CheckpointStoreItem a -&gt; CheckpointStoreItem b
$cfmap :: forall a b.
(a -&gt; b) -&gt; CheckpointStoreItem a -&gt; CheckpointStoreItem b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680547080"><span id="local-6989586621680547082"><span id="local-6989586621680547084"><span id="local-6989586621680547086"><span id="local-6989586621680547088"><span id="local-6989586621680547090"><span id="local-6989586621680547092"><span id="local-6989586621680547094"><span id="local-6989586621680547096"><span id="local-6989586621680547098"><span id="local-6989586621680547100"><span id="local-6989586621680547102"><span id="local-6989586621680547104"><span id="local-6989586621680547106"><span id="local-6989586621680547108"><span id="local-6989586621680547110"><span id="local-6989586621680547112"><span class="annot"><span class="annottext">CheckpointStoreItem a -&gt; Bool
(a -&gt; m) -&gt; CheckpointStoreItem a -&gt; m
(a -&gt; b -&gt; b) -&gt; b -&gt; CheckpointStoreItem a -&gt; b
(forall m. Monoid m =&gt; CheckpointStoreItem m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; CheckpointStoreItem a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; CheckpointStoreItem a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; CheckpointStoreItem a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; CheckpointStoreItem a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; CheckpointStoreItem a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; CheckpointStoreItem a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; CheckpointStoreItem a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; CheckpointStoreItem a -&gt; a)
-&gt; (forall a. CheckpointStoreItem a -&gt; [a])
-&gt; (forall a. CheckpointStoreItem a -&gt; Bool)
-&gt; (forall a. CheckpointStoreItem a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; CheckpointStoreItem a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; CheckpointStoreItem a -&gt; a)
-&gt; (forall a. Ord a =&gt; CheckpointStoreItem a -&gt; a)
-&gt; (forall a. Num a =&gt; CheckpointStoreItem a -&gt; a)
-&gt; (forall a. Num a =&gt; CheckpointStoreItem a -&gt; a)
-&gt; Foldable CheckpointStoreItem
forall a. Eq a =&gt; a -&gt; CheckpointStoreItem a -&gt; Bool
forall a. Num a =&gt; CheckpointStoreItem a -&gt; a
forall a. Ord a =&gt; CheckpointStoreItem a -&gt; a
forall m. Monoid m =&gt; CheckpointStoreItem m -&gt; m
forall a. CheckpointStoreItem a -&gt; Bool
forall a. CheckpointStoreItem a -&gt; Int
forall a. CheckpointStoreItem a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; CheckpointStoreItem a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; CheckpointStoreItem a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; CheckpointStoreItem a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; CheckpointStoreItem a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
product :: CheckpointStoreItem a -&gt; a
$cproduct :: forall a. Num a =&gt; CheckpointStoreItem a -&gt; a
sum :: CheckpointStoreItem a -&gt; a
$csum :: forall a. Num a =&gt; CheckpointStoreItem a -&gt; a
minimum :: CheckpointStoreItem a -&gt; a
$cminimum :: forall a. Ord a =&gt; CheckpointStoreItem a -&gt; a
maximum :: CheckpointStoreItem a -&gt; a
$cmaximum :: forall a. Ord a =&gt; CheckpointStoreItem a -&gt; a
elem :: a -&gt; CheckpointStoreItem a -&gt; Bool
$celem :: forall a. Eq a =&gt; a -&gt; CheckpointStoreItem a -&gt; Bool
length :: CheckpointStoreItem a -&gt; Int
$clength :: forall a. CheckpointStoreItem a -&gt; Int
null :: CheckpointStoreItem a -&gt; Bool
$cnull :: forall a. CheckpointStoreItem a -&gt; Bool
toList :: CheckpointStoreItem a -&gt; [a]
$ctoList :: forall a. CheckpointStoreItem a -&gt; [a]
foldl1 :: (a -&gt; a -&gt; a) -&gt; CheckpointStoreItem a -&gt; a
$cfoldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; CheckpointStoreItem a -&gt; a
foldr1 :: (a -&gt; a -&gt; a) -&gt; CheckpointStoreItem a -&gt; a
$cfoldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; CheckpointStoreItem a -&gt; a
foldl' :: (b -&gt; a -&gt; b) -&gt; b -&gt; CheckpointStoreItem a -&gt; b
$cfoldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; CheckpointStoreItem a -&gt; b
foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; CheckpointStoreItem a -&gt; b
$cfoldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; CheckpointStoreItem a -&gt; b
foldr' :: (a -&gt; b -&gt; b) -&gt; b -&gt; CheckpointStoreItem a -&gt; b
$cfoldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; CheckpointStoreItem a -&gt; b
foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; CheckpointStoreItem a -&gt; b
$cfoldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; CheckpointStoreItem a -&gt; b
foldMap' :: (a -&gt; m) -&gt; CheckpointStoreItem a -&gt; m
$cfoldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; CheckpointStoreItem a -&gt; m
foldMap :: (a -&gt; m) -&gt; CheckpointStoreItem a -&gt; m
$cfoldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; CheckpointStoreItem a -&gt; m
fold :: CheckpointStoreItem m -&gt; m
$cfold :: forall m. Monoid m =&gt; CheckpointStoreItem m -&gt; m
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680547069"><span id="local-6989586621680547071"><span id="local-6989586621680547073"><span id="local-6989586621680547075"><span class="annot"><span class="annottext">Functor CheckpointStoreItem
Foldable CheckpointStoreItem
Functor CheckpointStoreItem
-&gt; Foldable CheckpointStoreItem
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; CheckpointStoreItem a -&gt; f (CheckpointStoreItem b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    CheckpointStoreItem (f a) -&gt; f (CheckpointStoreItem a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; CheckpointStoreItem a -&gt; m (CheckpointStoreItem b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    CheckpointStoreItem (m a) -&gt; m (CheckpointStoreItem a))
-&gt; Traversable CheckpointStoreItem
(a -&gt; f b) -&gt; CheckpointStoreItem a -&gt; f (CheckpointStoreItem b)
forall (t :: * -&gt; *).
Functor t
-&gt; Foldable t
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a.
Monad m =&gt;
CheckpointStoreItem (m a) -&gt; m (CheckpointStoreItem a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
CheckpointStoreItem (f a) -&gt; f (CheckpointStoreItem a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; CheckpointStoreItem a -&gt; m (CheckpointStoreItem b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; CheckpointStoreItem a -&gt; f (CheckpointStoreItem b)
sequence :: CheckpointStoreItem (m a) -&gt; m (CheckpointStoreItem a)
$csequence :: forall (m :: * -&gt; *) a.
Monad m =&gt;
CheckpointStoreItem (m a) -&gt; m (CheckpointStoreItem a)
mapM :: (a -&gt; m b) -&gt; CheckpointStoreItem a -&gt; m (CheckpointStoreItem b)
$cmapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; CheckpointStoreItem a -&gt; m (CheckpointStoreItem b)
sequenceA :: CheckpointStoreItem (f a) -&gt; f (CheckpointStoreItem a)
$csequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
CheckpointStoreItem (f a) -&gt; f (CheckpointStoreItem a)
traverse :: (a -&gt; f b) -&gt; CheckpointStoreItem a -&gt; f (CheckpointStoreItem b)
$ctraverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; CheckpointStoreItem a -&gt; f (CheckpointStoreItem b)
$cp2Traversable :: Foldable CheckpointStoreItem
$cp1Traversable :: Functor CheckpointStoreItem
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></a></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680547060"><span id="local-6989586621680547062"><span id="local-6989586621680547064"><span id="local-6989586621680547066"><span class="annot"><span class="annottext">[CheckpointStoreItem a] -&gt; Encoding
[CheckpointStoreItem a] -&gt; Value
CheckpointStoreItem a -&gt; Encoding
CheckpointStoreItem a -&gt; Value
(CheckpointStoreItem a -&gt; Value)
-&gt; (CheckpointStoreItem a -&gt; Encoding)
-&gt; ([CheckpointStoreItem a] -&gt; Value)
-&gt; ([CheckpointStoreItem a] -&gt; Encoding)
-&gt; ToJSON (CheckpointStoreItem a)
forall a. ToJSON a =&gt; [CheckpointStoreItem a] -&gt; Encoding
forall a. ToJSON a =&gt; [CheckpointStoreItem a] -&gt; Value
forall a. ToJSON a =&gt; CheckpointStoreItem a -&gt; Encoding
forall a. ToJSON a =&gt; CheckpointStoreItem a -&gt; Value
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [CheckpointStoreItem a] -&gt; Encoding
$ctoEncodingList :: forall a. ToJSON a =&gt; [CheckpointStoreItem a] -&gt; Encoding
toJSONList :: [CheckpointStoreItem a] -&gt; Value
$ctoJSONList :: forall a. ToJSON a =&gt; [CheckpointStoreItem a] -&gt; Value
toEncoding :: CheckpointStoreItem a -&gt; Encoding
$ctoEncoding :: forall a. ToJSON a =&gt; CheckpointStoreItem a -&gt; Encoding
toJSON :: CheckpointStoreItem a -&gt; Value
$ctoJSON :: forall a. ToJSON a =&gt; CheckpointStoreItem a -&gt; Value
</span><a href="#local-6989586621680547060"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></a></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680547056"><span id="local-6989586621680547058"><span class="annot"><span class="annottext">Value -&gt; Parser [CheckpointStoreItem a]
Value -&gt; Parser (CheckpointStoreItem a)
(Value -&gt; Parser (CheckpointStoreItem a))
-&gt; (Value -&gt; Parser [CheckpointStoreItem a])
-&gt; FromJSON (CheckpointStoreItem a)
forall a. FromJSON a =&gt; Value -&gt; Parser [CheckpointStoreItem a]
forall a. FromJSON a =&gt; Value -&gt; Parser (CheckpointStoreItem a)
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [CheckpointStoreItem a]
$cparseJSONList :: forall a. FromJSON a =&gt; Value -&gt; Parser [CheckpointStoreItem a]
parseJSON :: Value -&gt; Parser (CheckpointStoreItem a)
$cparseJSON :: forall a. FromJSON a =&gt; Value -&gt; Parser (CheckpointStoreItem a)
</span><a href="#local-6989586621680547056"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span id="local-6989586621680547054"><span id="local-6989586621680547055"></span></span><span class="hs-keyword">data</span><span> </span><span id="CheckpointLogMsg"><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointLogMsg"><span class="hs-identifier hs-var">CheckpointLogMsg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-109"></span><span>    </span><span id="LogFoundValueRestoringKey"><span class="annot"><a href="Plutus.Contract.Checkpoint.html#LogFoundValueRestoringKey"><span class="hs-identifier hs-var">LogFoundValueRestoringKey</span></a></span></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="LogDecodingErrorAtKey"><span class="annot"><a href="Plutus.Contract.Checkpoint.html#LogDecodingErrorAtKey"><span class="hs-identifier hs-var">LogDecodingErrorAtKey</span></a></span></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="LogNoValueForKey"><span class="annot"><a href="Plutus.Contract.Checkpoint.html#LogNoValueForKey"><span class="hs-identifier hs-var">LogNoValueForKey</span></a></span></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="LogDoCheckpoint"><span class="annot"><a href="Plutus.Contract.Checkpoint.html#LogDoCheckpoint"><span class="hs-identifier hs-var">LogDoCheckpoint</span></a></span></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="LogAllocateKey"><span class="annot"><a href="Plutus.Contract.Checkpoint.html#LogAllocateKey"><span class="hs-identifier hs-var">LogAllocateKey</span></a></span></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="LogRetrieve"><span class="annot"><a href="Plutus.Contract.Checkpoint.html#LogRetrieve"><span class="hs-identifier hs-var">LogRetrieve</span></a></span></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="LogStore"><span class="annot"><a href="Plutus.Contract.Checkpoint.html#LogStore"><span class="hs-identifier hs-var">LogStore</span></a></span></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="LogKeyUpdate"><span class="annot"><a href="Plutus.Contract.Checkpoint.html#LogKeyUpdate"><span class="hs-identifier hs-var">LogKeyUpdate</span></a></span></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680547042"><span id="local-6989586621680547044"><span class="annot"><span class="annottext">CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; Bool
(CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; Bool)
-&gt; (CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; Bool)
-&gt; Eq CheckpointLogMsg
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; Bool
$c/= :: CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; Bool
== :: CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; Bool
$c== :: CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680547027"><span id="local-6989586621680547029"><span id="local-6989586621680547031"><span id="local-6989586621680547033"><span id="local-6989586621680547035"><span id="local-6989586621680547037"><span id="local-6989586621680547039"><span class="annot"><span class="annottext">Eq CheckpointLogMsg
Eq CheckpointLogMsg
-&gt; (CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; Ordering)
-&gt; (CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; Bool)
-&gt; (CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; Bool)
-&gt; (CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; Bool)
-&gt; (CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; Bool)
-&gt; (CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; CheckpointLogMsg)
-&gt; (CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; CheckpointLogMsg)
-&gt; Ord CheckpointLogMsg
CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; Bool
CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; Ordering
CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; CheckpointLogMsg
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; CheckpointLogMsg
$cmin :: CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; CheckpointLogMsg
max :: CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; CheckpointLogMsg
$cmax :: CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; CheckpointLogMsg
&gt;= :: CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; Bool
$c&gt;= :: CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; Bool
&gt; :: CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; Bool
$c&gt; :: CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; Bool
&lt;= :: CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; Bool
$c&lt;= :: CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; Bool
&lt; :: CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; Bool
$c&lt; :: CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; Bool
compare :: CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; Ordering
$ccompare :: CheckpointLogMsg -&gt; CheckpointLogMsg -&gt; Ordering
$cp1Ord :: Eq CheckpointLogMsg
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680547021"><span id="local-6989586621680547023"><span id="local-6989586621680547025"><span class="annot"><span class="annottext">Int -&gt; CheckpointLogMsg -&gt; ShowS
[CheckpointLogMsg] -&gt; ShowS
CheckpointLogMsg -&gt; String
(Int -&gt; CheckpointLogMsg -&gt; ShowS)
-&gt; (CheckpointLogMsg -&gt; String)
-&gt; ([CheckpointLogMsg] -&gt; ShowS)
-&gt; Show CheckpointLogMsg
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [CheckpointLogMsg] -&gt; ShowS
$cshowList :: [CheckpointLogMsg] -&gt; ShowS
show :: CheckpointLogMsg -&gt; String
$cshow :: CheckpointLogMsg -&gt; String
showsPrec :: Int -&gt; CheckpointLogMsg -&gt; ShowS
$cshowsPrec :: Int -&gt; CheckpointLogMsg -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. CheckpointLogMsg -&gt; Rep CheckpointLogMsg x)
-&gt; (forall x. Rep CheckpointLogMsg x -&gt; CheckpointLogMsg)
-&gt; Generic CheckpointLogMsg
forall x. Rep CheckpointLogMsg x -&gt; CheckpointLogMsg
forall x. CheckpointLogMsg -&gt; Rep CheckpointLogMsg x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep CheckpointLogMsg x -&gt; CheckpointLogMsg
$cfrom :: forall x. CheckpointLogMsg -&gt; Rep CheckpointLogMsg x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680547011"><span id="local-6989586621680547013"><span id="local-6989586621680547015"><span id="local-6989586621680547017"><span class="annot"><span class="annottext">[CheckpointLogMsg] -&gt; Encoding
[CheckpointLogMsg] -&gt; Value
CheckpointLogMsg -&gt; Encoding
CheckpointLogMsg -&gt; Value
(CheckpointLogMsg -&gt; Value)
-&gt; (CheckpointLogMsg -&gt; Encoding)
-&gt; ([CheckpointLogMsg] -&gt; Value)
-&gt; ([CheckpointLogMsg] -&gt; Encoding)
-&gt; ToJSON CheckpointLogMsg
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [CheckpointLogMsg] -&gt; Encoding
$ctoEncodingList :: [CheckpointLogMsg] -&gt; Encoding
toJSONList :: [CheckpointLogMsg] -&gt; Value
$ctoJSONList :: [CheckpointLogMsg] -&gt; Value
toEncoding :: CheckpointLogMsg -&gt; Encoding
$ctoEncoding :: CheckpointLogMsg -&gt; Encoding
toJSON :: CheckpointLogMsg -&gt; Value
$ctoJSON :: CheckpointLogMsg -&gt; Value
</span><a href="#local-6989586621680547011"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></a></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680547007"><span id="local-6989586621680547009"><span class="annot"><span class="annottext">Value -&gt; Parser [CheckpointLogMsg]
Value -&gt; Parser CheckpointLogMsg
(Value -&gt; Parser CheckpointLogMsg)
-&gt; (Value -&gt; Parser [CheckpointLogMsg])
-&gt; FromJSON CheckpointLogMsg
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [CheckpointLogMsg]
$cparseJSONList :: Value -&gt; Parser [CheckpointLogMsg]
parseJSON :: Value -&gt; Parser CheckpointLogMsg
$cparseJSON :: Value -&gt; Parser CheckpointLogMsg
</span><a href="#local-6989586621680547007"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680547004"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointLogMsg"><span class="hs-identifier hs-type">CheckpointLogMsg</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-121"></span><span>    </span><span id="local-6989586621680547003"><span class="annot"><span class="annottext">pretty :: CheckpointLogMsg -&gt; Doc ann
</span><a href="#local-6989586621680547003"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-122"></span><span>        </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#LogFoundValueRestoringKey"><span class="hs-identifier hs-type">LogFoundValueRestoringKey</span></a></span><span> </span><span id="local-6989586621680547002"><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680547002"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Found a value, restoring previous key&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">CheckpointKey -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680547002"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-123"></span><span>        </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#LogDecodingErrorAtKey"><span class="hs-identifier hs-type">LogDecodingErrorAtKey</span></a></span><span> </span><span id="local-6989586621680547001"><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680547001"><span class="hs-identifier hs-var">k</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Decoding error at key&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">CheckpointKey -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680547001"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-124"></span><span>        </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#LogNoValueForKey"><span class="hs-identifier hs-type">LogNoValueForKey</span></a></span><span> </span><span id="local-6989586621680547000"><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680547000"><span class="hs-identifier hs-var">k</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;No value for key&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">CheckpointKey -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680547000"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;. The action will be once.&quot;</span></span><span>
</span><span id="line-125"></span><span>        </span><span class="annot"><span class="annottext">CheckpointLogMsg
</span><a href="Plutus.Contract.Checkpoint.html#LogDoCheckpoint"><span class="hs-identifier hs-var">LogDoCheckpoint</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;doCheckpoint&quot;</span></span><span>
</span><span id="line-126"></span><span>        </span><span class="annot"><span class="annottext">CheckpointLogMsg
</span><a href="Plutus.Contract.Checkpoint.html#LogAllocateKey"><span class="hs-identifier hs-var">LogAllocateKey</span></a></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;allocateKey&quot;</span></span><span>
</span><span id="line-127"></span><span>        </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#LogRetrieve"><span class="hs-identifier hs-type">LogRetrieve</span></a></span><span> </span><span id="local-6989586621680546999"><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546999"><span class="hs-identifier hs-var">k</span></a></span></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;retrieve&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">CheckpointKey -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546999"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-128"></span><span>        </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#LogStore"><span class="hs-identifier hs-type">LogStore</span></a></span><span> </span><span id="local-6989586621680546998"><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546998"><span class="hs-identifier hs-var">k1</span></a></span></span><span> </span><span id="local-6989586621680546997"><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546997"><span class="hs-identifier hs-var">k2</span></a></span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Store; key1:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">CheckpointKey -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546998"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;; key2:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">CheckpointKey -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546997"><span class="hs-identifier hs-var">k2</span></a></span><span>
</span><span id="line-129"></span><span>        </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#LogKeyUpdate"><span class="hs-identifier hs-type">LogKeyUpdate</span></a></span><span> </span><span id="local-6989586621680546996"><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546996"><span class="hs-identifier hs-var">k1</span></a></span></span><span> </span><span id="local-6989586621680546995"><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546995"><span class="hs-identifier hs-var">k2</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Key update; key then:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">CheckpointKey -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546996"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;; key now:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">CheckpointKey -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546995"><span class="hs-identifier hs-var">k2</span></a></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="hs-comment">{-| Insert a new value into the checkpoint store. The first 'CheckpointKey' is
    the checkpoint key *before* running the checkpointed action, the second
    'Checkpoint' key is the value *after* running it. When we restore the
    checkpoint from the state (in 'restore') we set the 'CheckpointKey' state
    to the second argument to prevent chaos.
-}</span><span>
</span><span id="line-137"></span><span id="local-6989586621680547411"><span id="local-6989586621680547412"><span class="annot"><a href="Plutus.Contract.Checkpoint.html#insert"><span class="hs-identifier hs-type">insert</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680547412"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointStore"><span class="hs-identifier hs-type">CheckpointStore</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680547411"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680547412"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680547411"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-145"></span><span id="insert"><span class="annot"><span class="annottext">insert :: CheckpointKey -&gt; CheckpointKey -&gt; a -&gt; Eff effs ()
</span><a href="Plutus.Contract.Checkpoint.html#insert"><span class="hs-identifier hs-var hs-var">insert</span></a></span></span><span> </span><span id="local-6989586621680546993"><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546993"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680546992"><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546992"><span class="hs-identifier hs-var">k'</span></a></span></span><span> </span><span id="local-6989586621680546991"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680546991"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680546990"><span class="annot"><span class="annottext">vl :: CheckpointStoreItem Value
</span><a href="#local-6989586621680546990"><span class="hs-identifier hs-var hs-var">vl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CheckpointStoreItem :: forall a. a -&gt; CheckpointKey -&gt; CheckpointStoreItem a
</span><a href="Plutus.Contract.Checkpoint.html#CheckpointStoreItem"><span class="hs-identifier hs-type">CheckpointStoreItem</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">csValue :: Value
</span><a href="Plutus.Contract.Checkpoint.html#csValue"><span class="hs-identifier hs-var">csValue</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">JSON.toJSON</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680546991"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">csNewKey :: CheckpointKey
</span><a href="Plutus.Contract.Checkpoint.html#csNewKey"><span class="hs-identifier hs-var">csNewKey</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546992"><span class="hs-identifier hs-var">k'</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(CheckpointStore -&gt; CheckpointStore) -&gt; Eff effs ()
forall s (effs :: [* -&gt; *]).
Member (State s) effs =&gt;
(s -&gt; s) -&gt; Eff effs ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASetter
  CheckpointStore
  CheckpointStore
  (Map CheckpointKey (CheckpointStoreItem Value))
  (Map CheckpointKey (CheckpointStoreItem Value))
-&gt; (Map CheckpointKey (CheckpointStoreItem Value)
    -&gt; Map CheckpointKey (CheckpointStoreItem Value))
-&gt; CheckpointStore
-&gt; CheckpointStore
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">over</span></span><span> </span><span class="annot"><span class="annottext">ASetter
  CheckpointStore
  CheckpointStore
  (Map CheckpointKey (CheckpointStoreItem Value))
  (Map CheckpointKey (CheckpointStoreItem Value))
Iso
  CheckpointStore
  CheckpointStore
  (Map CheckpointKey (CheckpointStoreItem Value))
  (Map CheckpointKey (CheckpointStoreItem Value))
</span><a href="Plutus.Contract.Checkpoint.html#_CheckpointStore"><span class="hs-identifier hs-var">_CheckpointStore</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CheckpointKey
-&gt; CheckpointStoreItem Value
-&gt; Map CheckpointKey (CheckpointStoreItem Value)
-&gt; Map CheckpointKey (CheckpointStoreItem Value)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546993"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointStoreItem Value
</span><a href="#local-6989586621680546990"><span class="hs-identifier hs-var">vl</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-comment">{-| @restore k@ checks for an entry for @k@ in the checkpoint store,
    and parses the result if there is such an entry. It returns

    * @Right Nothing@ if no entry was found
    * @Left err@ if an entry was found but failed to parse with the
      'FromJSON' instance
    * @Right (Just a)@ if an entry was found and parsed succesfully.

-}</span><span>
</span><span id="line-158"></span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#restore"><span class="hs-identifier hs-type">restore</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680547409"><span class="annot"><a href="#local-6989586621680547409"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621680547408"><span class="annot"><a href="#local-6989586621680547408"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680547409"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointStore"><span class="hs-identifier hs-type">CheckpointStore</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680547408"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680547408"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogMsg</span></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointLogMsg"><span class="hs-identifier hs-type">CheckpointLogMsg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680547408"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680547408"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointError"><span class="hs-identifier hs-type">CheckpointError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680547409"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span id="restore"><span class="annot"><span class="annottext">restore :: CheckpointKey -&gt; Eff effs (Either CheckpointError (Maybe a))
</span><a href="Plutus.Contract.Checkpoint.html#restore"><span class="hs-identifier hs-var hs-var">restore</span></a></span></span><span> </span><span id="local-6989586621680546985"><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546985"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-168"></span><span>    </span><span id="local-6989586621680546984"><span class="annot"><span class="annottext">Maybe (CheckpointStoreItem Value)
</span><a href="#local-6989586621680546984"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CheckpointStore -&gt; Maybe (CheckpointStoreItem Value))
-&gt; Eff effs (Maybe (CheckpointStoreItem Value))
forall s a (effs :: [* -&gt; *]).
Member (State s) effs =&gt;
(s -&gt; a) -&gt; Eff effs a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting
  (Maybe (CheckpointStoreItem Value))
  CheckpointStore
  (Maybe (CheckpointStoreItem Value))
-&gt; CheckpointStore -&gt; Maybe (CheckpointStoreItem Value)
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">(Getting
   (Maybe (CheckpointStoreItem Value))
   CheckpointStore
   (Maybe (CheckpointStoreItem Value))
 -&gt; CheckpointStore -&gt; Maybe (CheckpointStoreItem Value))
-&gt; Getting
     (Maybe (CheckpointStoreItem Value))
     CheckpointStore
     (Maybe (CheckpointStoreItem Value))
-&gt; CheckpointStore
-&gt; Maybe (CheckpointStoreItem Value)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Map CheckpointKey (CheckpointStoreItem Value)
 -&gt; Const
      (Maybe (CheckpointStoreItem Value))
      (Map CheckpointKey (CheckpointStoreItem Value)))
-&gt; CheckpointStore
-&gt; Const (Maybe (CheckpointStoreItem Value)) CheckpointStore
Iso
  CheckpointStore
  CheckpointStore
  (Map CheckpointKey (CheckpointStoreItem Value))
  (Map CheckpointKey (CheckpointStoreItem Value))
</span><a href="Plutus.Contract.Checkpoint.html#_CheckpointStore"><span class="hs-identifier hs-var">_CheckpointStore</span></a></span><span> </span><span class="annot"><span class="annottext">((Map CheckpointKey (CheckpointStoreItem Value)
  -&gt; Const
       (Maybe (CheckpointStoreItem Value))
       (Map CheckpointKey (CheckpointStoreItem Value)))
 -&gt; CheckpointStore
 -&gt; Const (Maybe (CheckpointStoreItem Value)) CheckpointStore)
-&gt; ((Maybe (CheckpointStoreItem Value)
     -&gt; Const
          (Maybe (CheckpointStoreItem Value))
          (Maybe (CheckpointStoreItem Value)))
    -&gt; Map CheckpointKey (CheckpointStoreItem Value)
    -&gt; Const
         (Maybe (CheckpointStoreItem Value))
         (Map CheckpointKey (CheckpointStoreItem Value)))
-&gt; Getting
     (Maybe (CheckpointStoreItem Value))
     CheckpointStore
     (Maybe (CheckpointStoreItem Value))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Index (Map CheckpointKey (CheckpointStoreItem Value))
-&gt; Lens'
     (Map CheckpointKey (CheckpointStoreItem Value))
     (Maybe (IxValue (Map CheckpointKey (CheckpointStoreItem Value))))
forall m. At m =&gt; Index m -&gt; Lens' m (Maybe (IxValue m))
</span><span class="hs-identifier hs-var">at</span></span><span> </span><span class="annot"><span class="annottext">Index (Map CheckpointKey (CheckpointStoreItem Value))
CheckpointKey
</span><a href="#local-6989586621680546985"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680546981"><span class="annot"><span class="annottext">Maybe (Either String (CheckpointStoreItem a))
</span><a href="#local-6989586621680546981"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointStoreItem"><span class="hs-identifier hs-type">CheckpointStoreItem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680547409"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CheckpointStoreItem Value
 -&gt; Either String (CheckpointStoreItem a))
-&gt; Maybe (CheckpointStoreItem Value)
-&gt; Maybe (Either String (CheckpointStoreItem a))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Value -&gt; Either String a)
-&gt; CheckpointStoreItem Value
-&gt; Either String (CheckpointStoreItem a)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Value -&gt; Parser a) -&gt; Value -&gt; Either String a
forall a b. (a -&gt; Parser b) -&gt; a -&gt; Either String b
</span><span class="hs-identifier hs-var">JSON.parseEither</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser a
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">JSON.parseJSON</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (CheckpointStoreItem Value)
</span><a href="#local-6989586621680546984"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Either String (CheckpointStoreItem a))
</span><a href="#local-6989586621680546981"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-171"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Either String (CheckpointStoreItem a))
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-172"></span><span>            </span><span class="annot"><span class="annottext">CheckpointLogMsg -&gt; Eff effs ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><span class="hs-identifier hs-var">logDebug</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CheckpointKey -&gt; CheckpointLogMsg
</span><a href="Plutus.Contract.Checkpoint.html#LogNoValueForKey"><span class="hs-identifier hs-var">LogNoValueForKey</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546985"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>            </span><span class="annot"><span class="annottext">Either CheckpointError (Maybe a)
-&gt; Eff effs (Either CheckpointError (Maybe a))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Either CheckpointError (Maybe a)
 -&gt; Eff effs (Either CheckpointError (Maybe a)))
-&gt; Either CheckpointError (Maybe a)
-&gt; Eff effs (Either CheckpointError (Maybe a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Either CheckpointError (Maybe a)
forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-174"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621680546977"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680546977"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-175"></span><span>            </span><span class="annot"><span class="annottext">CheckpointLogMsg -&gt; Eff effs ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><span class="hs-identifier hs-var">logError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CheckpointKey -&gt; CheckpointLogMsg
</span><a href="Plutus.Contract.Checkpoint.html#LogDecodingErrorAtKey"><span class="hs-identifier hs-var">LogDecodingErrorAtKey</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546985"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>            </span><span class="annot"><span class="annottext">Either CheckpointError (Maybe a)
-&gt; Eff effs (Either CheckpointError (Maybe a))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Either CheckpointError (Maybe a)
 -&gt; Eff effs (Either CheckpointError (Maybe a)))
-&gt; Either CheckpointError (Maybe a)
-&gt; Eff effs (Either CheckpointError (Maybe a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointError -&gt; Either CheckpointError (Maybe a)
forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; CheckpointError
</span><a href="Plutus.Contract.Checkpoint.html#JSONDecodeError"><span class="hs-identifier hs-var">JSONDecodeError</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; CheckpointError) -&gt; Text -&gt; CheckpointError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680546977"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointStoreItem"><span class="hs-identifier hs-type">CheckpointStoreItem</span></a></span><span class="hs-special">{</span><span id="local-6989586621680546975"><span class="annot"><span class="annottext">a
csValue :: a
csValue :: forall a. CheckpointStoreItem a -&gt; a
</span><a href="#local-6989586621680546975"><span class="hs-identifier hs-var hs-var">csValue</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680546974"><span class="annot"><span class="annottext">CheckpointKey
csNewKey :: CheckpointKey
csNewKey :: forall a. CheckpointStoreItem a -&gt; CheckpointKey
</span><a href="#local-6989586621680546974"><span class="hs-identifier hs-var hs-var">csNewKey</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-178"></span><span>            </span><span class="annot"><span class="annottext">CheckpointLogMsg -&gt; Eff effs ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><span class="hs-identifier hs-var">logDebug</span></span><span> </span><span class="annot"><span class="annottext">(CheckpointLogMsg -&gt; Eff effs ())
-&gt; CheckpointLogMsg -&gt; Eff effs ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointKey -&gt; CheckpointLogMsg
</span><a href="Plutus.Contract.Checkpoint.html#LogFoundValueRestoringKey"><span class="hs-identifier hs-var">LogFoundValueRestoringKey</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546974"><span class="hs-identifier hs-var">csNewKey</span></a></span><span>
</span><span id="line-179"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680546973"><span class="annot"><span class="annottext">nk :: CheckpointKey
</span><a href="#local-6989586621680546973"><span class="hs-identifier hs-var hs-var">nk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CheckpointKey -&gt; CheckpointKey
forall a. Enum a =&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">succ</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546974"><span class="hs-identifier hs-var">csNewKey</span></a></span><span>
</span><span id="line-180"></span><span>            </span><span class="annot"><span class="annottext">CheckpointKey -&gt; Eff effs ()
forall s (effs :: [* -&gt; *]).
Member (State s) effs =&gt;
s -&gt; Eff effs ()
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546973"><span class="hs-identifier hs-var">nk</span></a></span><span>
</span><span id="line-181"></span><span>            </span><span class="annot"><span class="annottext">Either CheckpointError (Maybe a)
-&gt; Eff effs (Either CheckpointError (Maybe a))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a -&gt; Either CheckpointError (Maybe a)
forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680546975"><span class="hs-identifier hs-var">csValue</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-keyword">data</span><span> </span><span id="Checkpoint"><span class="annot"><a href="Plutus.Contract.Checkpoint.html#Checkpoint"><span class="hs-identifier hs-var">Checkpoint</span></a></span></span><span> </span><span id="local-6989586621680546971"><span class="annot"><a href="#local-6989586621680546971"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-184"></span><span>    </span><span id="DoCheckpoint"><span class="annot"><a href="Plutus.Contract.Checkpoint.html#DoCheckpoint"><span class="hs-identifier hs-var">DoCheckpoint</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#Checkpoint"><span class="hs-identifier hs-type">Checkpoint</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>    </span><span id="AllocateKey"><span class="annot"><a href="Plutus.Contract.Checkpoint.html#AllocateKey"><span class="hs-identifier hs-var">AllocateKey</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#Checkpoint"><span class="hs-identifier hs-type">Checkpoint</span></a></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span>
</span><span id="line-186"></span><span>    </span><span id="local-6989586621680546968"><span id="Store"><span class="annot"><a href="Plutus.Contract.Checkpoint.html#Store"><span class="hs-identifier hs-var">Store</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680546968"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680546968"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#Checkpoint"><span class="hs-identifier hs-type">Checkpoint</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-187"></span><span>    </span><span id="local-6989586621680546966"><span id="Retrieve"><span class="annot"><a href="Plutus.Contract.Checkpoint.html#Retrieve"><span class="hs-identifier hs-var">Retrieve</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680546966"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#Checkpoint"><span class="hs-identifier hs-type">Checkpoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointError"><span class="hs-identifier hs-type">CheckpointError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680546966"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#doCheckpoint"><span class="hs-identifier hs-type">doCheckpoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680547397"><span class="annot"><a href="#local-6989586621680547397"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#Checkpoint"><span class="hs-identifier hs-type">Checkpoint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680547397"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680547397"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span id="doCheckpoint"><span class="annot"><span class="annottext">doCheckpoint :: Eff effs ()
</span><a href="Plutus.Contract.Checkpoint.html#doCheckpoint"><span class="hs-identifier hs-var hs-var">doCheckpoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Checkpoint () -&gt; Eff effs ()
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]) a.
Member eff effs =&gt;
eff a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">send</span></span><span> </span><span class="annot"><span class="annottext">Checkpoint ()
</span><a href="Plutus.Contract.Checkpoint.html#DoCheckpoint"><span class="hs-identifier hs-var">DoCheckpoint</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#allocateKey"><span class="hs-identifier hs-type">allocateKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680547396"><span class="annot"><a href="#local-6989586621680547396"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#Checkpoint"><span class="hs-identifier hs-type">Checkpoint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680547396"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680547396"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span>
</span><span id="line-193"></span><span id="allocateKey"><span class="annot"><span class="annottext">allocateKey :: Eff effs CheckpointKey
</span><a href="Plutus.Contract.Checkpoint.html#allocateKey"><span class="hs-identifier hs-var hs-var">allocateKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Checkpoint CheckpointKey -&gt; Eff effs CheckpointKey
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]) a.
Member eff effs =&gt;
eff a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">send</span></span><span> </span><span class="annot"><span class="annottext">Checkpoint CheckpointKey
</span><a href="Plutus.Contract.Checkpoint.html#AllocateKey"><span class="hs-identifier hs-var">AllocateKey</span></a></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#store"><span class="hs-identifier hs-type">store</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680547384"><span class="annot"><a href="#local-6989586621680547384"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621680547385"><span class="annot"><a href="#local-6989586621680547385"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#Checkpoint"><span class="hs-identifier hs-type">Checkpoint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680547385"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680547384"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680547384"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680547385"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span id="store"><span class="annot"><span class="annottext">store :: CheckpointKey -&gt; CheckpointKey -&gt; a -&gt; Eff effs ()
</span><a href="Plutus.Contract.Checkpoint.html#store"><span class="hs-identifier hs-var hs-var">store</span></a></span></span><span> </span><span id="local-6989586621680546960"><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546960"><span class="hs-identifier hs-var">k1</span></a></span></span><span> </span><span id="local-6989586621680546959"><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546959"><span class="hs-identifier hs-var">k2</span></a></span></span><span> </span><span id="local-6989586621680546958"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680546958"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Checkpoint () -&gt; Eff effs ()
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]) a.
Member eff effs =&gt;
eff a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">send</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#Checkpoint"><span class="hs-identifier hs-type">Checkpoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CheckpointKey -&gt; CheckpointKey -&gt; a -&gt; Checkpoint ()
forall a.
ToJSON a =&gt;
CheckpointKey -&gt; CheckpointKey -&gt; a -&gt; Checkpoint ()
</span><a href="Plutus.Contract.Checkpoint.html#Store"><span class="hs-identifier hs-var">Store</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546960"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546959"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680546958"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#retrieve"><span class="hs-identifier hs-type">retrieve</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680547394"><span class="annot"><a href="#local-6989586621680547394"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621680547395"><span class="annot"><a href="#local-6989586621680547395"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#Checkpoint"><span class="hs-identifier hs-type">Checkpoint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680547395"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680547394"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680547395"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointError"><span class="hs-identifier hs-type">CheckpointError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680547394"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span id="retrieve"><span class="annot"><span class="annottext">retrieve :: CheckpointKey -&gt; Eff effs (Either CheckpointError (Maybe a))
</span><a href="Plutus.Contract.Checkpoint.html#retrieve"><span class="hs-identifier hs-var hs-var">retrieve</span></a></span></span><span> </span><span id="local-6989586621680546956"><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546956"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Checkpoint (Either CheckpointError (Maybe a))
-&gt; Eff effs (Either CheckpointError (Maybe a))
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]) a.
Member eff effs =&gt;
eff a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">send</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#Checkpoint"><span class="hs-identifier hs-type">Checkpoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CheckpointKey -&gt; Checkpoint (Either CheckpointError (Maybe a))
forall a.
FromJSON a =&gt;
CheckpointKey -&gt; Checkpoint (Either CheckpointError (Maybe a))
</span><a href="Plutus.Contract.Checkpoint.html#Retrieve"><span class="hs-identifier hs-var">Retrieve</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546956"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">-- | Handle the 'Checkpoint' effect in terms of 'CheckpointStore' and</span><span>
</span><span id="line-202"></span><span class="hs-comment">--   'CheckpointKey' states.</span><span>
</span><span id="line-203"></span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#handleCheckpoint"><span class="hs-identifier hs-type">handleCheckpoint</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680546955"><span class="annot"><a href="#local-6989586621680546955"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointStore"><span class="hs-identifier hs-type">CheckpointStore</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680546955"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680546955"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogMsg</span></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointLogMsg"><span class="hs-identifier hs-type">CheckpointLogMsg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680546955"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#Checkpoint"><span class="hs-identifier hs-type">Checkpoint</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621680546955"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>    </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680546955"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-211"></span><span id="handleCheckpoint"><span class="annot"><span class="annottext">handleCheckpoint :: Eff (Checkpoint : effs) ~&gt; Eff effs
</span><a href="Plutus.Contract.Checkpoint.html#handleCheckpoint"><span class="hs-identifier hs-var hs-var">handleCheckpoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Checkpoint ~&gt; Eff effs) -&gt; Eff (Checkpoint : effs) ~&gt; Eff effs
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="annot"><span class="annottext">((Checkpoint ~&gt; Eff effs) -&gt; Eff (Checkpoint : effs) ~&gt; Eff effs)
-&gt; (Checkpoint ~&gt; Eff effs) -&gt; Eff (Checkpoint : effs) ~&gt; Eff effs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-212"></span><span>    </span><span class="annot"><span class="annottext">Checkpoint x
</span><a href="Plutus.Contract.Checkpoint.html#DoCheckpoint"><span class="hs-identifier hs-var">DoCheckpoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-213"></span><span>        </span><span class="annot"><span class="annottext">CheckpointLogMsg -&gt; Eff effs ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><span class="hs-identifier hs-var">logDebug</span></span><span> </span><span class="annot"><span class="annottext">CheckpointLogMsg
</span><a href="Plutus.Contract.Checkpoint.html#LogDoCheckpoint"><span class="hs-identifier hs-var">LogDoCheckpoint</span></a></span><span>
</span><span id="line-214"></span><span>        </span><span class="annot"><span class="annottext">(CheckpointKey -&gt; CheckpointKey) -&gt; Eff effs ()
forall s (effs :: [* -&gt; *]).
Member (State s) effs =&gt;
(s -&gt; s) -&gt; Eff effs ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointKey -&gt; CheckpointKey
forall a. Enum a =&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">succ</span></a></span><span>
</span><span id="line-215"></span><span>    </span><span class="annot"><span class="annottext">Checkpoint x
</span><a href="Plutus.Contract.Checkpoint.html#AllocateKey"><span class="hs-identifier hs-var">AllocateKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-216"></span><span>        </span><span class="annot"><span class="annottext">CheckpointLogMsg -&gt; Eff effs ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><span class="hs-identifier hs-var">logDebug</span></span><span> </span><span class="annot"><span class="annottext">CheckpointLogMsg
</span><a href="Plutus.Contract.Checkpoint.html#LogAllocateKey"><span class="hs-identifier hs-var">LogAllocateKey</span></a></span><span>
</span><span id="line-217"></span><span>        </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (State CheckpointKey) effs =&gt;
Eff effs CheckpointKey
forall s (effs :: [* -&gt; *]). Member (State s) effs =&gt; Eff effs s
</span><span class="hs-identifier hs-var">get</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span>
</span><span id="line-218"></span><span>    </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#Store"><span class="hs-identifier hs-type">Store</span></a></span><span> </span><span id="local-6989586621680546953"><span class="annot"><a href="#local-6989586621680546953"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680546952"><span class="annot"><a href="#local-6989586621680546952"><span class="hs-identifier hs-var">k'</span></a></span></span><span> </span><span id="local-6989586621680546951"><span class="annot"><a href="#local-6989586621680546951"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-219"></span><span>        </span><span class="annot"><span class="annottext">CheckpointLogMsg -&gt; Eff effs ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><span class="hs-identifier hs-var">logDebug</span></span><span> </span><span class="annot"><span class="annottext">(CheckpointLogMsg -&gt; Eff effs ())
-&gt; CheckpointLogMsg -&gt; Eff effs ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointKey -&gt; CheckpointKey -&gt; CheckpointLogMsg
</span><a href="Plutus.Contract.Checkpoint.html#LogStore"><span class="hs-identifier hs-var">LogStore</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546953"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546952"><span class="hs-identifier hs-var">k'</span></a></span><span>
</span><span id="line-220"></span><span>        </span><span class="annot"><span class="annottext">CheckpointKey -&gt; CheckpointKey -&gt; a -&gt; Eff effs ()
forall a (effs :: [* -&gt; *]).
(ToJSON a, Member (State CheckpointStore) effs) =&gt;
CheckpointKey -&gt; CheckpointKey -&gt; a -&gt; Eff effs ()
</span><a href="Plutus.Contract.Checkpoint.html#insert"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546953"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546952"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680546951"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#Retrieve"><span class="hs-identifier hs-type">Retrieve</span></a></span><span> </span><span id="local-6989586621680546950"><span class="annot"><a href="#local-6989586621680546950"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-222"></span><span>        </span><span class="annot"><span class="annottext">CheckpointLogMsg -&gt; Eff effs ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><span class="hs-identifier hs-var">logDebug</span></span><span> </span><span class="annot"><span class="annottext">(CheckpointLogMsg -&gt; Eff effs ())
-&gt; CheckpointLogMsg -&gt; Eff effs ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointKey -&gt; CheckpointLogMsg
</span><a href="Plutus.Contract.Checkpoint.html#LogRetrieve"><span class="hs-identifier hs-var">LogRetrieve</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546950"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-223"></span><span>        </span><span id="local-6989586621680546949"><span class="annot"><span class="annottext">Either CheckpointError (Maybe a)
</span><a href="#local-6989586621680546949"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CheckpointKey -&gt; Eff effs (Either CheckpointError (Maybe a))
forall a (effs :: [* -&gt; *]).
(FromJSON a, Member (State CheckpointStore) effs,
 Member (State CheckpointKey) effs,
 Member (LogMsg CheckpointLogMsg) effs) =&gt;
CheckpointKey -&gt; Eff effs (Either CheckpointError (Maybe a))
</span><a href="Plutus.Contract.Checkpoint.html#restore"><span class="hs-identifier hs-var">restore</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680546955"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546950"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-224"></span><span>        </span><span id="local-6989586621680546948"><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546948"><span class="hs-identifier hs-var">k'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (State CheckpointKey) effs =&gt;
Eff effs CheckpointKey
forall s (effs :: [* -&gt; *]). Member (State s) effs =&gt; Eff effs s
</span><span class="hs-identifier hs-var">get</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#CheckpointKey"><span class="hs-identifier hs-type">CheckpointKey</span></a></span><span>
</span><span id="line-225"></span><span>        </span><span class="annot"><span class="annottext">CheckpointLogMsg -&gt; Eff effs ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><span class="hs-identifier hs-var">logDebug</span></span><span> </span><span class="annot"><span class="annottext">(CheckpointLogMsg -&gt; Eff effs ())
-&gt; CheckpointLogMsg -&gt; Eff effs ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointKey -&gt; CheckpointKey -&gt; CheckpointLogMsg
</span><a href="Plutus.Contract.Checkpoint.html#LogKeyUpdate"><span class="hs-identifier hs-var">LogKeyUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546950"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546948"><span class="hs-identifier hs-var">k'</span></a></span><span>
</span><span id="line-226"></span><span>        </span><span class="annot"><span class="annottext">Either CheckpointError (Maybe a)
-&gt; Eff effs (Either CheckpointError (Maybe a))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Either CheckpointError (Maybe a)
</span><a href="#local-6989586621680546949"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">{-| Create a checkpoint for an action.
    @handleCheckpoint (jsonCheckpoint action)@ will

    * Obtain a 'CheckpointKey' that identifies the position of the current
      checkpoint in the program
    * Run @action@, convert its result to JSON and store it in the checkpoint
      store if there is no value at the key
    * Retrieve the result as a JSON value from the store, parse it, and return
      it *instead* of running @action@ if there is a value at the key.

-}</span><span>
</span><span id="line-239"></span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#jsonCheckpoint"><span class="hs-identifier hs-type">jsonCheckpoint</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-240"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680546947"><span class="annot"><a href="#local-6989586621680546947"><span class="hs-identifier hs-type">err</span></a></span></span><span> </span><span id="local-6989586621680546946"><span class="annot"><a href="#local-6989586621680546946"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621680546945"><span class="annot"><a href="#local-6989586621680546945"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#Checkpoint"><span class="hs-identifier hs-type">Checkpoint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680546945"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-242"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="annot"><a href="#local-6989586621680546947"><span class="hs-identifier hs-type">err</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680546945"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680546946"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680546946"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#AsCheckpointError"><span class="hs-identifier hs-type">AsCheckpointError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680546947"><span class="hs-identifier hs-type">err</span></a></span><span>
</span><span id="line-246"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680546945"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680546946"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ The @action@ that is checkpointed</span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680546945"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680546946"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-249"></span><span id="jsonCheckpoint"><span class="annot"><span class="annottext">jsonCheckpoint :: Eff effs a -&gt; Eff effs a
</span><a href="Plutus.Contract.Checkpoint.html#jsonCheckpoint"><span class="hs-identifier hs-var hs-var">jsonCheckpoint</span></a></span></span><span> </span><span id="local-6989586621680546944"><span class="annot"><span class="annottext">Eff effs a
</span><a href="#local-6989586621680546944"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() -&gt; Eff effs (Either a ())) -&gt; () -&gt; Eff effs a
forall err a b (effs :: [* -&gt; *]).
(Member Checkpoint effs, Member (Error err) effs, ToJSON a,
 FromJSON a, ToJSON b, FromJSON b, AsCheckpointError err) =&gt;
(a -&gt; Eff effs (Either b a)) -&gt; a -&gt; Eff effs b
</span><a href="Plutus.Contract.Checkpoint.html#jsonCheckpointLoop"><span class="hs-identifier hs-var">jsonCheckpointLoop</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680546947"><span class="hs-identifier hs-type">err</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680546946"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either a ()
forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Either a ()) -&gt; Eff effs a -&gt; Eff effs (Either a ())
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Eff effs a
</span><a href="#local-6989586621680546944"><span class="hs-identifier hs-var">action</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-comment">{-

Create a checkpoint for an action that is run repeatedly.

-}</span><span>
</span><span id="line-256"></span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#jsonCheckpointLoop"><span class="hs-identifier hs-type">jsonCheckpointLoop</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680547404"><span class="annot"><a href="#local-6989586621680547404"><span class="hs-identifier hs-type">err</span></a></span></span><span> </span><span id="local-6989586621680547402"><span class="annot"><a href="#local-6989586621680547402"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621680547401"><span class="annot"><a href="#local-6989586621680547401"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621680547405"><span class="annot"><a href="#local-6989586621680547405"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#Checkpoint"><span class="hs-identifier hs-type">Checkpoint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680547405"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-259"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="annot"><a href="#local-6989586621680547404"><span class="hs-identifier hs-type">err</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680547405"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680547402"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680547402"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680547401"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621680547401"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Checkpoint.html#AsCheckpointError"><span class="hs-identifier hs-type">AsCheckpointError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680547404"><span class="hs-identifier hs-type">err</span></a></span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680547402"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680547405"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680547401"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680547402"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ The action that is repeated until it returns a 'Left'. Only the accumulated result of the action will be stored.</span><span>
</span><span id="line-267"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680547402"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ Initial value</span><span>
</span><span id="line-268"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680547405"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680547401"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-269"></span><span id="jsonCheckpointLoop"><span class="annot"><span class="annottext">jsonCheckpointLoop :: (a -&gt; Eff effs (Either b a)) -&gt; a -&gt; Eff effs b
</span><a href="Plutus.Contract.Checkpoint.html#jsonCheckpointLoop"><span class="hs-identifier hs-var hs-var">jsonCheckpointLoop</span></a></span></span><span> </span><span id="local-6989586621680546943"><span class="annot"><span class="annottext">a -&gt; Eff effs (Either b a)
</span><a href="#local-6989586621680546943"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span id="local-6989586621680546942"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680546942"><span class="hs-identifier hs-var">initial</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-270"></span><span>    </span><span class="annot"><span class="annottext">Eff effs ()
forall (effs :: [* -&gt; *]). Member Checkpoint effs =&gt; Eff effs ()
</span><a href="Plutus.Contract.Checkpoint.html#doCheckpoint"><span class="hs-identifier hs-var">doCheckpoint</span></a></span><span>
</span><span id="line-271"></span><span>    </span><span id="local-6989586621680546941"><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546941"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff effs CheckpointKey
forall (effs :: [* -&gt; *]).
Member Checkpoint effs =&gt;
Eff effs CheckpointKey
</span><a href="Plutus.Contract.Checkpoint.html#allocateKey"><span class="hs-identifier hs-var">allocateKey</span></a></span><span>
</span><span id="line-272"></span><span>    </span><span id="local-6989586621680546940"><span class="annot"><span class="annottext">Either b a
</span><a href="#local-6989586621680546940"><span class="hs-identifier hs-var">current</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-273"></span><span>                </span><span id="local-6989586621680546939"><span class="annot"><span class="annottext">Either CheckpointError (Maybe (Either b a))
</span><a href="#local-6989586621680546939"><span class="hs-identifier hs-var">vl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CheckpointKey
-&gt; Eff effs (Either CheckpointError (Maybe (Either b a)))
forall a (effs :: [* -&gt; *]).
(Member Checkpoint effs, FromJSON a) =&gt;
CheckpointKey -&gt; Eff effs (Either CheckpointError (Maybe a))
</span><a href="Plutus.Contract.Checkpoint.html#retrieve"><span class="hs-identifier hs-var">retrieve</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546941"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-274"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either CheckpointError (Maybe (Either b a))
</span><a href="#local-6989586621680546939"><span class="hs-identifier hs-var">vl</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-275"></span><span>                    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621680546938"><span class="annot"><span class="annottext">CheckpointError
</span><a href="#local-6989586621680546938"><span class="hs-identifier hs-var">err</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-276"></span><span>                        </span><span class="annot"><span class="annottext">err -&gt; Eff effs (Either b a)
forall e (effs :: [* -&gt; *]) a.
Member (Error e) effs =&gt;
e -&gt; Eff effs a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680547404"><span class="hs-identifier hs-type">err</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AReview err CheckpointError -&gt; CheckpointError -&gt; err
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview err CheckpointError
forall r. AsCheckpointError r =&gt; Prism' r CheckpointError
</span><a href="Plutus.Contract.Checkpoint.html#_CheckpointError"><span class="hs-identifier hs-var">_CheckpointError</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointError
</span><a href="#local-6989586621680546938"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>                    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680546936"><span class="annot"><span class="annottext">Either b a
</span><a href="#local-6989586621680546936"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-278"></span><span>                        </span><span class="annot"><span class="annottext">Either b a -&gt; Eff effs (Either b a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Either b a
</span><a href="#local-6989586621680546936"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-279"></span><span>                    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Either b a)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-280"></span><span>                        </span><span class="annot"><span class="annottext">Either b a -&gt; Eff effs (Either b a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Either b a
forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680546942"><span class="hs-identifier hs-var">initial</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680546935"><span class="annot"><span class="annottext">go :: Either b a -&gt; Eff effs b
</span><a href="#local-6989586621680546935"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621680546934"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680546934"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; Eff effs b
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680546934"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-282"></span><span>        </span><span class="annot"><a href="#local-6989586621680546935"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621680546933"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680546933"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-283"></span><span>                </span><span id="local-6989586621680546932"><span class="annot"><span class="annottext">Either b a
</span><a href="#local-6989586621680546932"><span class="hs-identifier hs-var">actionResult</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; Eff effs (Either b a)
</span><a href="#local-6989586621680546943"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680546933"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-284"></span><span>                </span><span id="local-6989586621680546931"><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546931"><span class="hs-identifier hs-var">k'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff effs CheckpointKey
forall (effs :: [* -&gt; *]).
Member Checkpoint effs =&gt;
Eff effs CheckpointKey
</span><a href="Plutus.Contract.Checkpoint.html#allocateKey"><span class="hs-identifier hs-var">allocateKey</span></a></span><span>
</span><span id="line-285"></span><span>                </span><span class="annot"><span class="annottext">CheckpointKey -&gt; CheckpointKey -&gt; Either b a -&gt; Eff effs ()
forall a (effs :: [* -&gt; *]).
(Member Checkpoint effs, ToJSON a) =&gt;
CheckpointKey -&gt; CheckpointKey -&gt; a -&gt; Eff effs ()
</span><a href="Plutus.Contract.Checkpoint.html#store"><span class="hs-identifier hs-var">store</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546941"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">CheckpointKey
</span><a href="#local-6989586621680546931"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">Either b a
</span><a href="#local-6989586621680546932"><span class="hs-identifier hs-var">actionResult</span></a></span><span>
</span><span id="line-286"></span><span>                </span><span class="annot"><span class="annottext">Eff effs ()
forall (effs :: [* -&gt; *]). Member Checkpoint effs =&gt; Eff effs ()
</span><a href="Plutus.Contract.Checkpoint.html#doCheckpoint"><span class="hs-identifier hs-var">doCheckpoint</span></a></span><span>
</span><span id="line-287"></span><span>                </span><span class="annot"><span class="annottext">Either b a -&gt; Eff effs b
</span><a href="#local-6989586621680546935"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Either b a
</span><a href="#local-6989586621680546932"><span class="hs-identifier hs-var">actionResult</span></a></span><span>
</span><span id="line-288"></span><span>    </span><span class="annot"><span class="annottext">Either b a -&gt; Eff effs b
</span><a href="#local-6989586621680546935"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Either b a
</span><a href="#local-6989586621680546940"><span class="hs-identifier hs-var">current</span></a></span><span>
</span><span id="line-289"></span></pre></body></html>