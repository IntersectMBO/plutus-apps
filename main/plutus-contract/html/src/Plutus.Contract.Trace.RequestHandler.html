<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds         #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DerivingVia       #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts  #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE MonoLocalBinds    #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns    #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes        #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications  #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators     #-}</span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Plutus.Contract.Trace.RequestHandler</span><span class="hs-special">(</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier">RequestHandler</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Wallet.Emulator.LogMessages.html#RequestHandlerLogMsg"><span class="hs-identifier">RequestHandlerLogMsg</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#tryHandler"><span class="hs-identifier">tryHandler</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#tryHandler%27"><span class="hs-identifier">tryHandler'</span></a></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#wrapHandler"><span class="hs-identifier">wrapHandler</span></a></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#extract"><span class="hs-identifier">extract</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#maybeToHandler"><span class="hs-identifier">maybeToHandler</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#generalise"><span class="hs-identifier">generalise</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><span class="hs-comment">-- * handlers for common requests</span></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handleAdjustUnbalancedTx"><span class="hs-identifier">handleAdjustUnbalancedTx</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handleOwnAddresses"><span class="hs-identifier">handleOwnAddresses</span></a></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handleSlotNotifications"><span class="hs-identifier">handleSlotNotifications</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handleCurrentNodeClientSlot"><span class="hs-identifier">handleCurrentNodeClientSlot</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handleCurrentChainIndexSlot"><span class="hs-identifier">handleCurrentChainIndexSlot</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handleTimeNotifications"><span class="hs-identifier">handleTimeNotifications</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handleCurrentTime"><span class="hs-identifier">handleCurrentTime</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handleCurrentNodeClientTimeRange"><span class="hs-identifier">handleCurrentNodeClientTimeRange</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handleTimeToSlotConversions"><span class="hs-identifier">handleTimeToSlotConversions</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handleUnbalancedTransactions"><span class="hs-identifier">handleUnbalancedTransactions</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handlePendingTransactions"><span class="hs-identifier">handlePendingTransactions</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handleChainIndexQueries"><span class="hs-identifier">handleChainIndexQueries</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handleOwnInstanceIdQueries"><span class="hs-identifier">handleOwnInstanceIdQueries</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handleYieldedUnbalancedTx"><span class="hs-identifier">handleYieldedUnbalancedTx</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handleGetParams"><span class="hs-identifier">handleGetParams</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Applicative</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Alternative</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">empty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator">(&lt;|&gt;)</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Arrow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Arrow</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Kleisli</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Kleisli</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Category</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Category</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Prism'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Profunctor</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">preview</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">foldM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">guard</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">join</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Freer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Eff</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Member</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Freer.Error</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Eff</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Freer.NonDet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonDet</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Freer.NonDet</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonDet</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Freer.Reader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Reader</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ask</span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Monoid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Alt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Alt</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Ap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Ap</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.Contract.Resumable.html"><span class="hs-identifier">Plutus.Contract.Resumable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Resumable.html#Request"><span class="hs-identifier">Request</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Resumable.html#Request"><span class="hs-identifier">Request</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Resumable.html#itID"><span class="hs-identifier">itID</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Resumable.html#rqID"><span class="hs-identifier">rqID</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Resumable.html#rqRequest"><span class="hs-identifier">rqRequest</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>                                  </span><span class="annot"><a href="Plutus.Contract.Resumable.html#Response"><span class="hs-identifier">Response</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Resumable.html#Response"><span class="hs-identifier">Response</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Resumable.html#rspItID"><span class="hs-identifier">rspItID</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Resumable.html#rspResponse"><span class="hs-identifier">rspResponse</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Resumable.html#rspRqID"><span class="hs-identifier">rspRqID</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Node.Emulator.Internal.Node</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Params</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">posixTimeRangeToContainedSlotRange</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">posixTimeToEnclosingSlot</span></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>                                            </span><span class="annot"><span class="hs-identifier">slotToBeginPOSIXTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">slotToEndPOSIXTime</span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Freer.Extras.Log</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">LogMessage</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">LogMsg</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">LogObserve</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">logDebug</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">logWarn</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">surroundDebug</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">NonEmpty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CardanoAddress</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">POSIXTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">POSIXTimeRange</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Slot</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SlotRange</span></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Tx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CardanoTx</span></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Tx.Constraints</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">UnbalancedTx</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Tx.Constraints</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Constraints</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.ChainIndex</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ChainIndexQueryEffect</span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.ChainIndex.Effects</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ChainIndexEff</span></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.ChainIndex.Types</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Tip</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html"><span class="hs-identifier">Plutus.Contract.Effects</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Effects.html#ChainIndexQuery"><span class="hs-identifier">ChainIndexQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#ChainIndexResponse"><span class="hs-identifier">ChainIndexResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Wallet.API.html"><span class="hs-identifier">Wallet.API</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Wallet.Emulator.Error.html#WalletAPIError"><span class="hs-identifier">WalletAPIError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Wallet.API.html#signTxAndSubmit"><span class="hs-identifier">signTxAndSubmit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Wallet.Effects.html"><span class="hs-identifier">Wallet.Effects</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Wallet.Effects.html#NodeClientEffect"><span class="hs-identifier">NodeClientEffect</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Wallet.Effects.html#WalletEffect"><span class="hs-identifier">WalletEffect</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Wallet.Effects.html#getClientParams"><span class="hs-identifier">getClientParams</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Wallet.Effects.html#getClientSlot"><span class="hs-identifier">getClientSlot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Wallet.Effects.html"><span class="hs-identifier">Wallet.Effects</span></a></span><span> </span><span class="hs-keyword">qualified</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Wallet.Emulator.LogMessages.html"><span class="hs-identifier">Wallet.Emulator.LogMessages</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Wallet.Emulator.LogMessages.html#RequestHandlerLogMsg"><span class="hs-identifier">RequestHandlerLogMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Wallet.Emulator.LogMessages.html#AdjustingUnbalancedTx"><span class="hs-identifier">AdjustingUnbalancedTx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Wallet.Emulator.LogMessages.html#HandleTxFailed"><span class="hs-identifier">HandleTxFailed</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Wallet.Emulator.LogMessages.html#SlotNoticationTargetVsCurrent"><span class="hs-identifier">SlotNoticationTargetVsCurrent</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Wallet.Types.html"><span class="hs-identifier">Wallet.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Wallet.Types.html#ContractInstanceId"><span class="hs-identifier">ContractInstanceId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-comment">-- | Request handlers that can choose whether to handle an effect (using</span><span>
</span><span id="line-71"></span><span class="hs-comment">--   'Alternative'). This is useful if 'req' is a sum type.</span><span>
</span><span id="line-72"></span><span class="hs-keyword">newtype</span><span> </span><span id="RequestHandler"><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-var">RequestHandler</span></a></span></span><span> </span><span id="local-6989586621680558400"><span class="annot"><a href="#local-6989586621680558400"><span class="hs-identifier hs-type">effs</span></a></span></span><span> </span><span id="local-6989586621680558401"><span class="annot"><a href="#local-6989586621680558401"><span class="hs-identifier hs-type">req</span></a></span></span><span> </span><span id="local-6989586621680558399"><span class="annot"><a href="#local-6989586621680558399"><span class="hs-identifier hs-type">resp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RequestHandler"><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-var">RequestHandler</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unRequestHandler"><span class="annot"><span class="annottext">RequestHandler effs req resp -&gt; req -&gt; Eff (NonDet : effs) resp
</span><a href="Plutus.Contract.Trace.RequestHandler.html#unRequestHandler"><span class="hs-identifier hs-var hs-var">unRequestHandler</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680558401"><span class="hs-identifier hs-type">req</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonDet</span></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621680558400"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680558399"><span class="hs-identifier hs-type">resp</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680558218"><span id="local-6989586621680558220"><span class="annot"><span class="annottext">a -&gt; RequestHandler effs req b -&gt; RequestHandler effs req a
(a -&gt; b) -&gt; RequestHandler effs req a -&gt; RequestHandler effs req b
(forall a b.
 (a -&gt; b) -&gt; RequestHandler effs req a -&gt; RequestHandler effs req b)
-&gt; (forall a b.
    a -&gt; RequestHandler effs req b -&gt; RequestHandler effs req a)
-&gt; Functor (RequestHandler effs req)
forall (effs :: [* -&gt; *]) req a b.
a -&gt; RequestHandler effs req b -&gt; RequestHandler effs req a
forall (effs :: [* -&gt; *]) req a b.
(a -&gt; b) -&gt; RequestHandler effs req a -&gt; RequestHandler effs req b
forall a b.
a -&gt; RequestHandler effs req b -&gt; RequestHandler effs req a
forall a b.
(a -&gt; b) -&gt; RequestHandler effs req a -&gt; RequestHandler effs req b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; RequestHandler effs req b -&gt; RequestHandler effs req a
$c&lt;$ :: forall (effs :: [* -&gt; *]) req a b.
a -&gt; RequestHandler effs req b -&gt; RequestHandler effs req a
fmap :: (a -&gt; b) -&gt; RequestHandler effs req a -&gt; RequestHandler effs req b
$cfmap :: forall (effs :: [* -&gt; *]) req a b.
(a -&gt; b) -&gt; RequestHandler effs req a -&gt; RequestHandler effs req b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680558207"><span id="local-6989586621680558209"><span id="local-6989586621680558211"><span id="local-6989586621680558213"><span id="local-6989586621680558215"><span class="annot"><span class="annottext">q b c -&gt; RequestHandler effs a b -&gt; RequestHandler effs a c
RequestHandler effs b c -&gt; q a b -&gt; RequestHandler effs a c
(a -&gt; b)
-&gt; (c -&gt; d) -&gt; RequestHandler effs b c -&gt; RequestHandler effs a d
(a -&gt; b) -&gt; RequestHandler effs b c -&gt; RequestHandler effs a c
(b -&gt; c) -&gt; RequestHandler effs a b -&gt; RequestHandler effs a c
(forall a b c d.
 (a -&gt; b)
 -&gt; (c -&gt; d) -&gt; RequestHandler effs b c -&gt; RequestHandler effs a d)
-&gt; (forall a b c.
    (a -&gt; b) -&gt; RequestHandler effs b c -&gt; RequestHandler effs a c)
-&gt; (forall b c a.
    (b -&gt; c) -&gt; RequestHandler effs a b -&gt; RequestHandler effs a c)
-&gt; (forall a b c (q :: * -&gt; * -&gt; *).
    Coercible c b =&gt;
    q b c -&gt; RequestHandler effs a b -&gt; RequestHandler effs a c)
-&gt; (forall a b c (q :: * -&gt; * -&gt; *).
    Coercible b a =&gt;
    RequestHandler effs b c -&gt; q a b -&gt; RequestHandler effs a c)
-&gt; Profunctor (RequestHandler effs)
forall (effs :: [* -&gt; *]) a b c.
(a -&gt; b) -&gt; RequestHandler effs b c -&gt; RequestHandler effs a c
forall (effs :: [* -&gt; *]) b c a.
(b -&gt; c) -&gt; RequestHandler effs a b -&gt; RequestHandler effs a c
forall (effs :: [* -&gt; *]) a b c d.
(a -&gt; b)
-&gt; (c -&gt; d) -&gt; RequestHandler effs b c -&gt; RequestHandler effs a d
forall (effs :: [* -&gt; *]) a b c (q :: * -&gt; * -&gt; *).
Coercible b a =&gt;
RequestHandler effs b c -&gt; q a b -&gt; RequestHandler effs a c
forall (effs :: [* -&gt; *]) a b c (q :: * -&gt; * -&gt; *).
Coercible c b =&gt;
q b c -&gt; RequestHandler effs a b -&gt; RequestHandler effs a c
forall a b c.
(a -&gt; b) -&gt; RequestHandler effs b c -&gt; RequestHandler effs a c
forall b c a.
(b -&gt; c) -&gt; RequestHandler effs a b -&gt; RequestHandler effs a c
forall a b c d.
(a -&gt; b)
-&gt; (c -&gt; d) -&gt; RequestHandler effs b c -&gt; RequestHandler effs a d
forall a b c (q :: * -&gt; * -&gt; *).
Coercible b a =&gt;
RequestHandler effs b c -&gt; q a b -&gt; RequestHandler effs a c
forall a b c (q :: * -&gt; * -&gt; *).
Coercible c b =&gt;
q b c -&gt; RequestHandler effs a b -&gt; RequestHandler effs a c
forall (p :: * -&gt; * -&gt; *).
(forall a b c d. (a -&gt; b) -&gt; (c -&gt; d) -&gt; p b c -&gt; p a d)
-&gt; (forall a b c. (a -&gt; b) -&gt; p b c -&gt; p a c)
-&gt; (forall b c a. (b -&gt; c) -&gt; p a b -&gt; p a c)
-&gt; (forall a b c (q :: * -&gt; * -&gt; *).
    Coercible c b =&gt;
    q b c -&gt; p a b -&gt; p a c)
-&gt; (forall a b c (q :: * -&gt; * -&gt; *).
    Coercible b a =&gt;
    p b c -&gt; q a b -&gt; p a c)
-&gt; Profunctor p
.# :: RequestHandler effs b c -&gt; q a b -&gt; RequestHandler effs a c
$c.# :: forall (effs :: [* -&gt; *]) a b c (q :: * -&gt; * -&gt; *).
Coercible b a =&gt;
RequestHandler effs b c -&gt; q a b -&gt; RequestHandler effs a c
#. :: q b c -&gt; RequestHandler effs a b -&gt; RequestHandler effs a c
$c#. :: forall (effs :: [* -&gt; *]) a b c (q :: * -&gt; * -&gt; *).
Coercible c b =&gt;
q b c -&gt; RequestHandler effs a b -&gt; RequestHandler effs a c
rmap :: (b -&gt; c) -&gt; RequestHandler effs a b -&gt; RequestHandler effs a c
$crmap :: forall (effs :: [* -&gt; *]) b c a.
(b -&gt; c) -&gt; RequestHandler effs a b -&gt; RequestHandler effs a c
lmap :: (a -&gt; b) -&gt; RequestHandler effs b c -&gt; RequestHandler effs a c
$clmap :: forall (effs :: [* -&gt; *]) a b c.
(a -&gt; b) -&gt; RequestHandler effs b c -&gt; RequestHandler effs a c
dimap :: (a -&gt; b)
-&gt; (c -&gt; d) -&gt; RequestHandler effs b c -&gt; RequestHandler effs a d
$cdimap :: forall (effs :: [* -&gt; *]) a b c d.
(a -&gt; b)
-&gt; (c -&gt; d) -&gt; RequestHandler effs b c -&gt; RequestHandler effs a d
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Profunctor</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680558202"><span id="local-6989586621680558204"><span class="annot"><span class="annottext">RequestHandler effs a a
RequestHandler effs b c
-&gt; RequestHandler effs a b -&gt; RequestHandler effs a c
(forall a. RequestHandler effs a a)
-&gt; (forall b c a.
    RequestHandler effs b c
    -&gt; RequestHandler effs a b -&gt; RequestHandler effs a c)
-&gt; Category (RequestHandler effs)
forall (effs :: [* -&gt; *]) a. RequestHandler effs a a
forall (effs :: [* -&gt; *]) b c a.
RequestHandler effs b c
-&gt; RequestHandler effs a b -&gt; RequestHandler effs a c
forall a. RequestHandler effs a a
forall b c a.
RequestHandler effs b c
-&gt; RequestHandler effs a b -&gt; RequestHandler effs a c
forall k (cat :: k -&gt; k -&gt; *).
(forall (a :: k). cat a a)
-&gt; (forall (b :: k) (c :: k) (a :: k).
    cat b c -&gt; cat a b -&gt; cat a c)
-&gt; Category cat
. :: RequestHandler effs b c
-&gt; RequestHandler effs a b -&gt; RequestHandler effs a c
$c. :: forall (effs :: [* -&gt; *]) b c a.
RequestHandler effs b c
-&gt; RequestHandler effs a b -&gt; RequestHandler effs a c
id :: RequestHandler effs a a
$cid :: forall (effs :: [* -&gt; *]) a. RequestHandler effs a a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Category</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680558190"><span id="local-6989586621680558192"><span id="local-6989586621680558194"><span id="local-6989586621680558196"><span id="local-6989586621680558198"><span class="annot"><span class="annottext">Category (RequestHandler effs)
Category (RequestHandler effs)
-&gt; (forall b c. (b -&gt; c) -&gt; RequestHandler effs b c)
-&gt; (forall b c d.
    RequestHandler effs b c -&gt; RequestHandler effs (b, d) (c, d))
-&gt; (forall b c d.
    RequestHandler effs b c -&gt; RequestHandler effs (d, b) (d, c))
-&gt; (forall b c b' c'.
    RequestHandler effs b c
    -&gt; RequestHandler effs b' c'
    -&gt; RequestHandler effs (b, b') (c, c'))
-&gt; (forall b c c'.
    RequestHandler effs b c
    -&gt; RequestHandler effs b c' -&gt; RequestHandler effs b (c, c'))
-&gt; Arrow (RequestHandler effs)
RequestHandler effs b c -&gt; RequestHandler effs (b, d) (c, d)
RequestHandler effs b c -&gt; RequestHandler effs (d, b) (d, c)
RequestHandler effs b c
-&gt; RequestHandler effs b' c' -&gt; RequestHandler effs (b, b') (c, c')
RequestHandler effs b c
-&gt; RequestHandler effs b c' -&gt; RequestHandler effs b (c, c')
(b -&gt; c) -&gt; RequestHandler effs b c
forall (effs :: [* -&gt; *]). Category (RequestHandler effs)
forall (effs :: [* -&gt; *]) b c. (b -&gt; c) -&gt; RequestHandler effs b c
forall (effs :: [* -&gt; *]) b c d.
RequestHandler effs b c -&gt; RequestHandler effs (b, d) (c, d)
forall (effs :: [* -&gt; *]) b c d.
RequestHandler effs b c -&gt; RequestHandler effs (d, b) (d, c)
forall (effs :: [* -&gt; *]) b c c'.
RequestHandler effs b c
-&gt; RequestHandler effs b c' -&gt; RequestHandler effs b (c, c')
forall (effs :: [* -&gt; *]) b c b' c'.
RequestHandler effs b c
-&gt; RequestHandler effs b' c' -&gt; RequestHandler effs (b, b') (c, c')
forall b c. (b -&gt; c) -&gt; RequestHandler effs b c
forall b c d.
RequestHandler effs b c -&gt; RequestHandler effs (b, d) (c, d)
forall b c d.
RequestHandler effs b c -&gt; RequestHandler effs (d, b) (d, c)
forall b c c'.
RequestHandler effs b c
-&gt; RequestHandler effs b c' -&gt; RequestHandler effs b (c, c')
forall b c b' c'.
RequestHandler effs b c
-&gt; RequestHandler effs b' c' -&gt; RequestHandler effs (b, b') (c, c')
forall (a :: * -&gt; * -&gt; *).
Category a
-&gt; (forall b c. (b -&gt; c) -&gt; a b c)
-&gt; (forall b c d. a b c -&gt; a (b, d) (c, d))
-&gt; (forall b c d. a b c -&gt; a (d, b) (d, c))
-&gt; (forall b c b' c'. a b c -&gt; a b' c' -&gt; a (b, b') (c, c'))
-&gt; (forall b c c'. a b c -&gt; a b c' -&gt; a b (c, c'))
-&gt; Arrow a
&amp;&amp;&amp; :: RequestHandler effs b c
-&gt; RequestHandler effs b c' -&gt; RequestHandler effs b (c, c')
$c&amp;&amp;&amp; :: forall (effs :: [* -&gt; *]) b c c'.
RequestHandler effs b c
-&gt; RequestHandler effs b c' -&gt; RequestHandler effs b (c, c')
*** :: RequestHandler effs b c
-&gt; RequestHandler effs b' c' -&gt; RequestHandler effs (b, b') (c, c')
$c*** :: forall (effs :: [* -&gt; *]) b c b' c'.
RequestHandler effs b c
-&gt; RequestHandler effs b' c' -&gt; RequestHandler effs (b, b') (c, c')
second :: RequestHandler effs b c -&gt; RequestHandler effs (d, b) (d, c)
$csecond :: forall (effs :: [* -&gt; *]) b c d.
RequestHandler effs b c -&gt; RequestHandler effs (d, b) (d, c)
first :: RequestHandler effs b c -&gt; RequestHandler effs (b, d) (c, d)
$cfirst :: forall (effs :: [* -&gt; *]) b c d.
RequestHandler effs b c -&gt; RequestHandler effs (b, d) (c, d)
arr :: (b -&gt; c) -&gt; RequestHandler effs b c
$carr :: forall (effs :: [* -&gt; *]) b c. (b -&gt; c) -&gt; RequestHandler effs b c
$cp1Arrow :: forall (effs :: [* -&gt; *]). Category (RequestHandler effs)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Arrow</span></a></span></span></span></span></span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">via</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Kleisli</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonDet</span></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621680558400"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680558183"><span id="local-6989586621680558185"><span id="local-6989586621680558187"><span class="annot"><span class="annottext">b -&gt; RequestHandler effs req resp -&gt; RequestHandler effs req resp
NonEmpty (RequestHandler effs req resp)
-&gt; RequestHandler effs req resp
RequestHandler effs req resp
-&gt; RequestHandler effs req resp -&gt; RequestHandler effs req resp
(RequestHandler effs req resp
 -&gt; RequestHandler effs req resp -&gt; RequestHandler effs req resp)
-&gt; (NonEmpty (RequestHandler effs req resp)
    -&gt; RequestHandler effs req resp)
-&gt; (forall b.
    Integral b =&gt;
    b -&gt; RequestHandler effs req resp -&gt; RequestHandler effs req resp)
-&gt; Semigroup (RequestHandler effs req resp)
forall b.
Integral b =&gt;
b -&gt; RequestHandler effs req resp -&gt; RequestHandler effs req resp
forall a.
(a -&gt; a -&gt; a)
-&gt; (NonEmpty a -&gt; a)
-&gt; (forall b. Integral b =&gt; b -&gt; a -&gt; a)
-&gt; Semigroup a
forall req (effs :: [* -&gt; *]) resp.
NonEmpty (RequestHandler effs req resp)
-&gt; RequestHandler effs req resp
forall req (effs :: [* -&gt; *]) resp.
RequestHandler effs req resp
-&gt; RequestHandler effs req resp -&gt; RequestHandler effs req resp
forall req (effs :: [* -&gt; *]) resp b.
Integral b =&gt;
b -&gt; RequestHandler effs req resp -&gt; RequestHandler effs req resp
stimes :: b -&gt; RequestHandler effs req resp -&gt; RequestHandler effs req resp
$cstimes :: forall req (effs :: [* -&gt; *]) resp b.
Integral b =&gt;
b -&gt; RequestHandler effs req resp -&gt; RequestHandler effs req resp
sconcat :: NonEmpty (RequestHandler effs req resp)
-&gt; RequestHandler effs req resp
$csconcat :: forall req (effs :: [* -&gt; *]) resp.
NonEmpty (RequestHandler effs req resp)
-&gt; RequestHandler effs req resp
&lt;&gt; :: RequestHandler effs req resp
-&gt; RequestHandler effs req resp -&gt; RequestHandler effs req resp
$c&lt;&gt; :: forall req (effs :: [* -&gt; *]) resp.
RequestHandler effs req resp
-&gt; RequestHandler effs req resp -&gt; RequestHandler effs req resp
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Semigroup</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680558175"><span id="local-6989586621680558177"><span id="local-6989586621680558179"><span class="annot"><span class="annottext">Semigroup (RequestHandler effs req resp)
RequestHandler effs req resp
Semigroup (RequestHandler effs req resp)
-&gt; RequestHandler effs req resp
-&gt; (RequestHandler effs req resp
    -&gt; RequestHandler effs req resp -&gt; RequestHandler effs req resp)
-&gt; ([RequestHandler effs req resp] -&gt; RequestHandler effs req resp)
-&gt; Monoid (RequestHandler effs req resp)
[RequestHandler effs req resp] -&gt; RequestHandler effs req resp
RequestHandler effs req resp
-&gt; RequestHandler effs req resp -&gt; RequestHandler effs req resp
forall a.
Semigroup a -&gt; a -&gt; (a -&gt; a -&gt; a) -&gt; ([a] -&gt; a) -&gt; Monoid a
forall req (effs :: [* -&gt; *]) resp.
Semigroup (RequestHandler effs req resp)
forall req (effs :: [* -&gt; *]) resp. RequestHandler effs req resp
forall req (effs :: [* -&gt; *]) resp.
[RequestHandler effs req resp] -&gt; RequestHandler effs req resp
forall req (effs :: [* -&gt; *]) resp.
RequestHandler effs req resp
-&gt; RequestHandler effs req resp -&gt; RequestHandler effs req resp
mconcat :: [RequestHandler effs req resp] -&gt; RequestHandler effs req resp
$cmconcat :: forall req (effs :: [* -&gt; *]) resp.
[RequestHandler effs req resp] -&gt; RequestHandler effs req resp
mappend :: RequestHandler effs req resp
-&gt; RequestHandler effs req resp -&gt; RequestHandler effs req resp
$cmappend :: forall req (effs :: [* -&gt; *]) resp.
RequestHandler effs req resp
-&gt; RequestHandler effs req resp -&gt; RequestHandler effs req resp
mempty :: RequestHandler effs req resp
$cmempty :: forall req (effs :: [* -&gt; *]) resp. RequestHandler effs req resp
$cp1Monoid :: forall req (effs :: [* -&gt; *]) resp.
Semigroup (RequestHandler effs req resp)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monoid</span></a></span></span></span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">via</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Ap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">-&gt;</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680558401"><span class="hs-identifier hs-type">req</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Alt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonDet</span></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621680558400"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680558399"><span class="hs-identifier hs-type">resp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-comment">-- Try the handler on the requests until it succeeds for the first time, then stop.</span><span>
</span><span id="line-78"></span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#tryHandler"><span class="hs-identifier hs-type">tryHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680558173"><span class="annot"><a href="#local-6989586621680558173"><span class="hs-identifier hs-type">effs</span></a></span></span><span> </span><span id="local-6989586621680558172"><span class="annot"><a href="#local-6989586621680558172"><span class="hs-identifier hs-type">req</span></a></span></span><span> </span><span id="local-6989586621680558171"><span class="annot"><a href="#local-6989586621680558171"><span class="hs-identifier hs-type">resp</span></a></span></span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-type">RequestHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558173"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558172"><span class="hs-identifier hs-type">req</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558171"><span class="hs-identifier hs-type">resp</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680558172"><span class="hs-identifier hs-type">req</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680558173"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558171"><span class="hs-identifier hs-type">resp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span id="tryHandler"><span class="annot"><span class="annottext">tryHandler :: RequestHandler effs req resp -&gt; [req] -&gt; Eff effs (Maybe resp)
</span><a href="Plutus.Contract.Trace.RequestHandler.html#tryHandler"><span class="hs-identifier hs-var hs-var">tryHandler</span></a></span></span><span> </span><span id="local-6989586621680558170"><span class="annot"><span class="annottext">RequestHandler effs req resp
</span><a href="#local-6989586621680558170"><span class="hs-identifier hs-var">handler</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RequestHandler effs req (Maybe resp)
-&gt; [req] -&gt; Eff effs (Maybe resp)
forall (f :: * -&gt; *) (effs :: [* -&gt; *]) req resp.
(Alternative f, Monad f) =&gt;
RequestHandler effs req (f resp) -&gt; [req] -&gt; Eff effs (f resp)
</span><a href="Plutus.Contract.Trace.RequestHandler.html#tryHandler%27"><span class="hs-identifier hs-var">tryHandler'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">resp -&gt; Maybe resp
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(resp -&gt; Maybe resp)
-&gt; RequestHandler effs req resp
-&gt; RequestHandler effs req (Maybe resp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">RequestHandler effs req resp
</span><a href="#local-6989586621680558170"><span class="hs-identifier hs-var">handler</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">-- Try the handler on the requests, using the 'Alternative' instance of @f@</span><span>
</span><span id="line-86"></span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#tryHandler%27"><span class="hs-identifier hs-type">tryHandler'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680558451"><span class="annot"><a href="#local-6989586621680558451"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621680558449"><span class="annot"><a href="#local-6989586621680558449"><span class="hs-identifier hs-type">effs</span></a></span></span><span> </span><span id="local-6989586621680558448"><span class="annot"><a href="#local-6989586621680558448"><span class="hs-identifier hs-type">req</span></a></span></span><span> </span><span id="local-6989586621680558447"><span class="annot"><a href="#local-6989586621680558447"><span class="hs-identifier hs-type">resp</span></a></span></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Alternative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558451"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558451"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-type">RequestHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558449"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558448"><span class="hs-identifier hs-type">req</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680558451"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558447"><span class="hs-identifier hs-type">resp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680558448"><span class="hs-identifier hs-type">req</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680558449"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680558451"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558447"><span class="hs-identifier hs-type">resp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span id="tryHandler%27"><span class="annot"><span class="annottext">tryHandler' :: RequestHandler effs req (f resp) -&gt; [req] -&gt; Eff effs (f resp)
</span><a href="Plutus.Contract.Trace.RequestHandler.html#tryHandler%27"><span class="hs-identifier hs-var hs-var">tryHandler'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-type">RequestHandler</span></a></span><span> </span><span id="local-6989586621680558168"><span class="annot"><span class="annottext">req -&gt; Eff (NonDet : effs) (f resp)
</span><a href="#local-6989586621680558168"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><span class="annottext">(f resp -&gt; req -&gt; Eff effs (f resp))
-&gt; f resp -&gt; [req] -&gt; Eff effs (f resp)
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680558167"><span class="annot"><span class="annottext">f resp
</span><a href="#local-6989586621680558167"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680558166"><span class="annot"><span class="annottext">req
</span><a href="#local-6989586621680558166"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(f (f resp) -&gt; f resp)
-&gt; Eff effs (f (f resp)) -&gt; Eff effs (f resp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">f resp
</span><a href="#local-6989586621680558167"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">f resp -&gt; f resp -&gt; f resp
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(f resp -&gt; f resp)
-&gt; (f (f resp) -&gt; f resp) -&gt; f (f resp) -&gt; f resp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">f (f resp) -&gt; f resp
forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">join</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Eff effs (f (f resp)) -&gt; Eff effs (f resp))
-&gt; Eff effs (f (f resp)) -&gt; Eff effs (f resp)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]) a.
Alternative f =&gt;
Eff (NonDet : effs) a -&gt; Eff effs (f a)
forall (f :: * -&gt; *) (effs :: [* -&gt; *]) a.
Alternative f =&gt;
Eff (NonDet : effs) a -&gt; Eff effs (f a)
</span><span class="hs-identifier hs-var">NonDet.makeChoiceA</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680558451"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff (NonDet : effs) (f resp) -&gt; Eff effs (f (f resp)))
-&gt; Eff (NonDet : effs) (f resp) -&gt; Eff effs (f (f resp))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">req -&gt; Eff (NonDet : effs) (f resp)
</span><a href="#local-6989586621680558168"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">req
</span><a href="#local-6989586621680558166"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f resp
forall (f :: * -&gt; *) a. Alternative f =&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span id="local-6989586621680558161"><span id="local-6989586621680558162"><span id="local-6989586621680558163"><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#extract"><span class="hs-identifier hs-type">extract</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Alternative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558163"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prism'</span></span><span> </span><span class="annot"><a href="#local-6989586621680558162"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558161"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680558162"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680558163"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558161"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-96"></span><span id="extract"><span class="annot"><span class="annottext">extract :: Prism' a b -&gt; a -&gt; f b
</span><a href="Plutus.Contract.Trace.RequestHandler.html#extract"><span class="hs-identifier hs-var hs-var">extract</span></a></span></span><span> </span><span id="local-6989586621680558160"><span class="annot"><span class="annottext">Prism' a b
</span><a href="#local-6989586621680558160"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f b -&gt; (b -&gt; f b) -&gt; Maybe b -&gt; f b
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">f b
forall (f :: * -&gt; *) a. Alternative f =&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; f b
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe b -&gt; f b) -&gt; (a -&gt; Maybe b) -&gt; a -&gt; f b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (First b) a b -&gt; a -&gt; Maybe b
forall s (m :: * -&gt; *) a.
MonadReader s m =&gt;
Getting (First a) s a -&gt; m (Maybe a)
</span><span class="hs-identifier hs-var">preview</span></span><span> </span><span class="annot"><span class="annottext">Getting (First b) a b
Prism' a b
</span><a href="#local-6989586621680558160"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">-- | Generalise a request handler</span><span>
</span><span id="line-99"></span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#generalise"><span class="hs-identifier hs-type">generalise</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680558158"><span class="annot"><a href="#local-6989586621680558158"><span class="hs-identifier hs-type">effs</span></a></span></span><span> </span><span id="local-6989586621680558157"><span class="annot"><a href="#local-6989586621680558157"><span class="hs-identifier hs-type">req</span></a></span></span><span> </span><span id="local-6989586621680558156"><span class="annot"><a href="#local-6989586621680558156"><span class="hs-identifier hs-type">req'</span></a></span></span><span> </span><span id="local-6989586621680558155"><span class="annot"><a href="#local-6989586621680558155"><span class="hs-identifier hs-type">resp</span></a></span></span><span> </span><span id="local-6989586621680558154"><span class="annot"><a href="#local-6989586621680558154"><span class="hs-identifier hs-type">resp'</span></a></span></span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680558156"><span class="hs-identifier hs-type">req'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558157"><span class="hs-identifier hs-type">req</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680558155"><span class="hs-identifier hs-type">resp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680558154"><span class="hs-identifier hs-type">resp'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-type">RequestHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558158"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558157"><span class="hs-identifier hs-type">req</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558155"><span class="hs-identifier hs-type">resp</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-type">RequestHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558158"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558156"><span class="hs-identifier hs-type">req'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558154"><span class="hs-identifier hs-type">resp'</span></a></span><span>
</span><span id="line-105"></span><span id="generalise"><span class="annot"><span class="annottext">generalise :: (req' -&gt; Maybe req)
-&gt; (resp -&gt; resp')
-&gt; RequestHandler effs req resp
-&gt; RequestHandler effs req' resp'
</span><a href="Plutus.Contract.Trace.RequestHandler.html#generalise"><span class="hs-identifier hs-var hs-var">generalise</span></a></span></span><span> </span><span id="local-6989586621680558153"><span class="annot"><span class="annottext">req' -&gt; Maybe req
</span><a href="#local-6989586621680558153"><span class="hs-identifier hs-var">rq</span></a></span></span><span> </span><span id="local-6989586621680558152"><span class="annot"><span class="annottext">resp -&gt; resp'
</span><a href="#local-6989586621680558152"><span class="hs-identifier hs-var">rsp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-type">RequestHandler</span></a></span><span> </span><span id="local-6989586621680558151"><span class="annot"><span class="annottext">req -&gt; Eff (NonDet : effs) resp
</span><a href="#local-6989586621680558151"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(req' -&gt; Eff (NonDet : effs) resp')
-&gt; RequestHandler effs req' resp'
forall (effs :: [* -&gt; *]) req resp.
(req -&gt; Eff (NonDet : effs) resp) -&gt; RequestHandler effs req resp
</span><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-var">RequestHandler</span></a></span><span> </span><span class="annot"><span class="annottext">((req' -&gt; Eff (NonDet : effs) resp')
 -&gt; RequestHandler effs req' resp')
-&gt; (req' -&gt; Eff (NonDet : effs) resp')
-&gt; RequestHandler effs req' resp'
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680558150"><span class="annot"><span class="annottext">req'
</span><a href="#local-6989586621680558150"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">req' -&gt; Maybe req
</span><a href="#local-6989586621680558153"><span class="hs-identifier hs-var">rq</span></a></span><span> </span><span class="annot"><span class="annottext">req'
</span><a href="#local-6989586621680558150"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-107"></span><span>        </span><span class="annot"><span class="annottext">Maybe req
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Eff (NonDet : effs) resp'
forall (f :: * -&gt; *) a. Alternative f =&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-108"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680558149"><span class="annot"><span class="annottext">req
</span><a href="#local-6989586621680558149"><span class="hs-identifier hs-var">k'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">resp -&gt; resp'
</span><a href="#local-6989586621680558152"><span class="hs-identifier hs-var">rsp</span></a></span><span> </span><span class="annot"><span class="annottext">(resp -&gt; resp')
-&gt; Eff (NonDet : effs) resp -&gt; Eff (NonDet : effs) resp'
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">req -&gt; Eff (NonDet : effs) resp
</span><a href="#local-6989586621680558151"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">req
</span><a href="#local-6989586621680558149"><span class="hs-identifier hs-var">k'</span></a></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span id="local-6989586621680558146"><span id="local-6989586621680558147"><span id="local-6989586621680558148"><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#wrapHandler"><span class="hs-identifier hs-type">wrapHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-type">RequestHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558148"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558147"><span class="hs-identifier hs-type">req</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558146"><span class="hs-identifier hs-type">resp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-type">RequestHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558148"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Resumable.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558147"><span class="hs-identifier hs-type">req</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Resumable.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558146"><span class="hs-identifier hs-type">resp</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-111"></span><span id="wrapHandler"><span class="annot"><span class="annottext">wrapHandler :: RequestHandler effs req resp
-&gt; RequestHandler effs (Request req) (Response resp)
</span><a href="Plutus.Contract.Trace.RequestHandler.html#wrapHandler"><span class="hs-identifier hs-var hs-var">wrapHandler</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-type">RequestHandler</span></a></span><span> </span><span id="local-6989586621680558145"><span class="annot"><span class="annottext">req -&gt; Eff (NonDet : effs) resp
</span><a href="#local-6989586621680558145"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Request req -&gt; Eff (NonDet : effs) (Response resp))
-&gt; RequestHandler effs (Request req) (Response resp)
forall (effs :: [* -&gt; *]) req resp.
(req -&gt; Eff (NonDet : effs) resp) -&gt; RequestHandler effs req resp
</span><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-var">RequestHandler</span></a></span><span> </span><span class="annot"><span class="annottext">((Request req -&gt; Eff (NonDet : effs) (Response resp))
 -&gt; RequestHandler effs (Request req) (Response resp))
-&gt; (Request req -&gt; Eff (NonDet : effs) (Response resp))
-&gt; RequestHandler effs (Request req) (Response resp)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><a href="Plutus.Contract.Resumable.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span class="hs-special">{</span><span id="local-6989586621680558144"><span class="annot"><span class="annottext">RequestID
rqID :: RequestID
rqID :: forall o. Request o -&gt; RequestID
</span><a href="#local-6989586621680558144"><span class="hs-identifier hs-var hs-var">rqID</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680558143"><span class="annot"><span class="annottext">IterationID
itID :: IterationID
itID :: forall o. Request o -&gt; IterationID
</span><a href="#local-6989586621680558143"><span class="hs-identifier hs-var hs-var">itID</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680558142"><span class="annot"><span class="annottext">req
rqRequest :: req
rqRequest :: forall o. Request o -&gt; o
</span><a href="#local-6989586621680558142"><span class="hs-identifier hs-var hs-var">rqRequest</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-112"></span><span>    </span><span id="local-6989586621680558141"><span class="annot"><span class="annottext">resp
</span><a href="#local-6989586621680558141"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">req -&gt; Eff (NonDet : effs) resp
</span><a href="#local-6989586621680558145"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">req
</span><a href="#local-6989586621680558142"><span class="hs-identifier hs-var">rqRequest</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span class="annot"><span class="annottext">Response resp -&gt; Eff (NonDet : effs) (Response resp)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Response resp -&gt; Eff (NonDet : effs) (Response resp))
-&gt; Response resp -&gt; Eff (NonDet : effs) (Response resp)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Response :: forall i. RequestID -&gt; IterationID -&gt; i -&gt; Response i
</span><a href="Plutus.Contract.Resumable.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">rspRqID :: RequestID
</span><a href="Plutus.Contract.Resumable.html#rspRqID"><span class="hs-identifier hs-var">rspRqID</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RequestID
</span><a href="#local-6989586621680558144"><span class="hs-identifier hs-var">rqID</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rspResponse :: resp
</span><a href="Plutus.Contract.Resumable.html#rspResponse"><span class="hs-identifier hs-var">rspResponse</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">resp
</span><a href="#local-6989586621680558141"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rspItID :: IterationID
</span><a href="Plutus.Contract.Resumable.html#rspItID"><span class="hs-identifier hs-var">rspItID</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IterationID
</span><a href="#local-6989586621680558143"><span class="hs-identifier hs-var">itID</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span id="local-6989586621680558138"><span id="local-6989586621680558139"><span id="local-6989586621680558140"><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#maybeToHandler"><span class="hs-identifier hs-type">maybeToHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680558140"><span class="hs-identifier hs-type">req</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558139"><span class="hs-identifier hs-type">resp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-type">RequestHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558138"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558140"><span class="hs-identifier hs-type">req</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558139"><span class="hs-identifier hs-type">resp</span></a></span></span></span></span><span>
</span><span id="line-116"></span><span id="maybeToHandler"><span class="annot"><span class="annottext">maybeToHandler :: (req -&gt; Maybe resp) -&gt; RequestHandler effs req resp
</span><a href="Plutus.Contract.Trace.RequestHandler.html#maybeToHandler"><span class="hs-identifier hs-var hs-var">maybeToHandler</span></a></span></span><span> </span><span id="local-6989586621680558137"><span class="annot"><span class="annottext">req -&gt; Maybe resp
</span><a href="#local-6989586621680558137"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(req -&gt; Eff (NonDet : effs) resp) -&gt; RequestHandler effs req resp
forall (effs :: [* -&gt; *]) req resp.
(req -&gt; Eff (NonDet : effs) resp) -&gt; RequestHandler effs req resp
</span><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-var">RequestHandler</span></a></span><span> </span><span class="annot"><span class="annottext">((req -&gt; Eff (NonDet : effs) resp) -&gt; RequestHandler effs req resp)
-&gt; (req -&gt; Eff (NonDet : effs) resp)
-&gt; RequestHandler effs req resp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (NonDet : effs) resp
-&gt; (resp -&gt; Eff (NonDet : effs) resp)
-&gt; Maybe resp
-&gt; Eff (NonDet : effs) resp
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (NonDet : effs) resp
forall (f :: * -&gt; *) a. Alternative f =&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="annot"><span class="annottext">resp -&gt; Eff (NonDet : effs) resp
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe resp -&gt; Eff (NonDet : effs) resp)
-&gt; (req -&gt; Maybe resp) -&gt; req -&gt; Eff (NonDet : effs) resp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">req -&gt; Maybe resp
</span><a href="#local-6989586621680558137"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="hs-comment">-- handlers for common requests</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handleOwnAddresses"><span class="hs-identifier hs-type">handleOwnAddresses</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680558136"><span class="annot"><a href="#local-6989586621680558136"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621680558135"><span class="annot"><a href="#local-6989586621680558135"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="annot"><a href="Wallet.Effects.html#WalletEffect"><span class="hs-identifier hs-type">WalletEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558135"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogObserve</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogMessage</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680558135"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-type">RequestHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558135"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558136"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoAddress</span></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span id="handleOwnAddresses"><span class="annot"><span class="annottext">handleOwnAddresses :: RequestHandler effs a (NonEmpty CardanoAddress)
</span><a href="Plutus.Contract.Trace.RequestHandler.html#handleOwnAddresses"><span class="hs-identifier hs-var hs-var">handleOwnAddresses</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><span class="annottext">(a -&gt; Eff (NonDet : effs) (NonEmpty CardanoAddress))
-&gt; RequestHandler effs a (NonEmpty CardanoAddress)
forall (effs :: [* -&gt; *]) req resp.
(req -&gt; Eff (NonDet : effs) resp) -&gt; RequestHandler effs req resp
</span><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-var">RequestHandler</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; Eff (NonDet : effs) (NonEmpty CardanoAddress))
 -&gt; RequestHandler effs a (NonEmpty CardanoAddress))
-&gt; (a -&gt; Eff (NonDet : effs) (NonEmpty CardanoAddress))
-&gt; RequestHandler effs a (NonEmpty CardanoAddress)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-128"></span><span>        </span><span class="annot"><span class="annottext">Text
-&gt; Eff (NonDet : effs) (NonEmpty CardanoAddress)
-&gt; Eff (NonDet : effs) (NonEmpty CardanoAddress)
forall v (effs :: [* -&gt; *]) a.
Member (LogObserve (LogMessage v)) effs =&gt;
v -&gt; Eff effs a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">surroundDebug</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;handleOwnAddresses&quot;</span></span><span> </span><span class="annot"><span class="annottext">Eff (NonDet : effs) (NonEmpty CardanoAddress)
forall (effs :: [* -&gt; *]).
Member WalletEffect effs =&gt;
Eff effs (NonEmpty CardanoAddress)
</span><a href="Wallet.Effects.html#ownAddresses"><span class="hs-identifier hs-var">Wallet.Effects.ownAddresses</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handleSlotNotifications"><span class="hs-identifier hs-type">handleSlotNotifications</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680558133"><span class="annot"><a href="#local-6989586621680558133"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="annot"><a href="Wallet.Effects.html#NodeClientEffect"><span class="hs-identifier hs-type">NodeClientEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558133"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogObserve</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogMessage</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680558133"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogMsg</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.LogMessages.html#RequestHandlerLogMsg"><span class="hs-identifier hs-type">RequestHandlerLogMsg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680558133"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-type">RequestHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558133"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Slot</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Slot</span></span><span>
</span><span id="line-137"></span><span id="handleSlotNotifications"><span class="annot"><span class="annottext">handleSlotNotifications :: RequestHandler effs Slot Slot
</span><a href="Plutus.Contract.Trace.RequestHandler.html#handleSlotNotifications"><span class="hs-identifier hs-var hs-var">handleSlotNotifications</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-138"></span><span>    </span><span class="annot"><span class="annottext">(Slot -&gt; Eff (NonDet : effs) Slot) -&gt; RequestHandler effs Slot Slot
forall (effs :: [* -&gt; *]) req resp.
(req -&gt; Eff (NonDet : effs) resp) -&gt; RequestHandler effs req resp
</span><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-var">RequestHandler</span></a></span><span> </span><span class="annot"><span class="annottext">((Slot -&gt; Eff (NonDet : effs) Slot)
 -&gt; RequestHandler effs Slot Slot)
-&gt; (Slot -&gt; Eff (NonDet : effs) Slot)
-&gt; RequestHandler effs Slot Slot
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680558132"><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680558132"><span class="hs-identifier hs-var">targetSlot_</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-139"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; Eff (NonDet : effs) Slot -&gt; Eff (NonDet : effs) Slot
forall v (effs :: [* -&gt; *]) a.
Member (LogObserve (LogMessage v)) effs =&gt;
v -&gt; Eff effs a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">surroundDebug</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;handleSlotNotifications&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Eff (NonDet : effs) Slot -&gt; Eff (NonDet : effs) Slot)
-&gt; Eff (NonDet : effs) Slot -&gt; Eff (NonDet : effs) Slot
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-140"></span><span>            </span><span id="local-6989586621680558131"><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680558131"><span class="hs-identifier hs-var">currentSlot</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff (NonDet : effs) Slot
forall (effs :: [* -&gt; *]).
Member NodeClientEffect effs =&gt;
Eff effs Slot
</span><a href="Wallet.Effects.html#getClientSlot"><span class="hs-identifier hs-var">getClientSlot</span></a></span><span>
</span><span id="line-141"></span><span>            </span><span class="annot"><span class="annottext">RequestHandlerLogMsg -&gt; Eff (NonDet : effs) ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><span class="hs-identifier hs-var">logDebug</span></span><span> </span><span class="annot"><span class="annottext">(RequestHandlerLogMsg -&gt; Eff (NonDet : effs) ())
-&gt; RequestHandlerLogMsg -&gt; Eff (NonDet : effs) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Slot -&gt; RequestHandlerLogMsg
</span><a href="Wallet.Emulator.LogMessages.html#SlotNoticationTargetVsCurrent"><span class="hs-identifier hs-var">SlotNoticationTargetVsCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680558132"><span class="hs-identifier hs-var">targetSlot_</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680558131"><span class="hs-identifier hs-var">currentSlot</span></a></span><span>
</span><span id="line-142"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; Eff (NonDet : effs) ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680558131"><span class="hs-identifier hs-var">currentSlot</span></a></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Slot -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680558132"><span class="hs-identifier hs-var">targetSlot_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>            </span><span class="annot"><span class="annottext">Slot -&gt; Eff (NonDet : effs) Slot
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680558131"><span class="hs-identifier hs-var">currentSlot</span></a></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handleTimeNotifications"><span class="hs-identifier hs-type">handleTimeNotifications</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680558130"><span class="annot"><a href="#local-6989586621680558130"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="annot"><a href="Wallet.Effects.html#NodeClientEffect"><span class="hs-identifier hs-type">NodeClientEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558130"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogObserve</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogMessage</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680558130"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogMsg</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.LogMessages.html#RequestHandlerLogMsg"><span class="hs-identifier hs-type">RequestHandlerLogMsg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680558130"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-type">RequestHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558130"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">POSIXTime</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">POSIXTime</span></span><span>
</span><span id="line-152"></span><span id="handleTimeNotifications"><span class="annot"><span class="annottext">handleTimeNotifications :: RequestHandler effs POSIXTime POSIXTime
</span><a href="Plutus.Contract.Trace.RequestHandler.html#handleTimeNotifications"><span class="hs-identifier hs-var hs-var">handleTimeNotifications</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><span class="annottext">(POSIXTime -&gt; Eff (NonDet : effs) POSIXTime)
-&gt; RequestHandler effs POSIXTime POSIXTime
forall (effs :: [* -&gt; *]) req resp.
(req -&gt; Eff (NonDet : effs) resp) -&gt; RequestHandler effs req resp
</span><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-var">RequestHandler</span></a></span><span> </span><span class="annot"><span class="annottext">((POSIXTime -&gt; Eff (NonDet : effs) POSIXTime)
 -&gt; RequestHandler effs POSIXTime POSIXTime)
-&gt; (POSIXTime -&gt; Eff (NonDet : effs) POSIXTime)
-&gt; RequestHandler effs POSIXTime POSIXTime
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680558129"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621680558129"><span class="hs-identifier hs-var">targetTime_</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-154"></span><span>        </span><span class="annot"><span class="annottext">Text
-&gt; Eff (NonDet : effs) POSIXTime -&gt; Eff (NonDet : effs) POSIXTime
forall v (effs :: [* -&gt; *]) a.
Member (LogObserve (LogMessage v)) effs =&gt;
v -&gt; Eff effs a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">surroundDebug</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;handleTimeNotifications&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Eff (NonDet : effs) POSIXTime -&gt; Eff (NonDet : effs) POSIXTime)
-&gt; Eff (NonDet : effs) POSIXTime -&gt; Eff (NonDet : effs) POSIXTime
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-155"></span><span>            </span><span id="local-6989586621680558128"><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680558128"><span class="hs-identifier hs-var">currentSlot</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff (NonDet : effs) Slot
forall (effs :: [* -&gt; *]).
Member NodeClientEffect effs =&gt;
Eff effs Slot
</span><a href="Wallet.Effects.html#getClientSlot"><span class="hs-identifier hs-var">getClientSlot</span></a></span><span>
</span><span id="line-156"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Params</span></span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680558126"><span class="annot"><span class="annottext">SlotConfig
pSlotConfig :: Params -&gt; SlotConfig
pSlotConfig :: SlotConfig
</span><span class="hs-identifier hs-var hs-var">pSlotConfig</span></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff (NonDet : effs) Params
forall (effs :: [* -&gt; *]).
Member NodeClientEffect effs =&gt;
Eff effs Params
</span><a href="Wallet.Effects.html#getClientParams"><span class="hs-identifier hs-var">getClientParams</span></a></span><span>
</span><span id="line-157"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680558124"><span class="annot"><span class="annottext">targetSlot_ :: Slot
</span><a href="#local-6989586621680558124"><span class="hs-identifier hs-var hs-var">targetSlot_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SlotConfig -&gt; POSIXTime -&gt; Slot
</span><span class="hs-identifier hs-var">posixTimeToEnclosingSlot</span></span><span> </span><span class="annot"><span class="annottext">SlotConfig
</span><a href="#local-6989586621680558126"><span class="hs-identifier hs-var">pSlotConfig</span></a></span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621680558129"><span class="hs-identifier hs-var">targetTime_</span></a></span><span>
</span><span id="line-158"></span><span>            </span><span class="annot"><span class="annottext">RequestHandlerLogMsg -&gt; Eff (NonDet : effs) ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><span class="hs-identifier hs-var">logDebug</span></span><span> </span><span class="annot"><span class="annottext">(RequestHandlerLogMsg -&gt; Eff (NonDet : effs) ())
-&gt; RequestHandlerLogMsg -&gt; Eff (NonDet : effs) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Slot -&gt; RequestHandlerLogMsg
</span><a href="Wallet.Emulator.LogMessages.html#SlotNoticationTargetVsCurrent"><span class="hs-identifier hs-var">SlotNoticationTargetVsCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680558124"><span class="hs-identifier hs-var">targetSlot_</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680558128"><span class="hs-identifier hs-var">currentSlot</span></a></span><span>
</span><span id="line-159"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; Eff (NonDet : effs) ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680558128"><span class="hs-identifier hs-var">currentSlot</span></a></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Slot -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680558124"><span class="hs-identifier hs-var">targetSlot_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>            </span><span class="annot"><span class="annottext">POSIXTime -&gt; Eff (NonDet : effs) POSIXTime
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(POSIXTime -&gt; Eff (NonDet : effs) POSIXTime)
-&gt; POSIXTime -&gt; Eff (NonDet : effs) POSIXTime
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SlotConfig -&gt; Slot -&gt; POSIXTime
</span><span class="hs-identifier hs-var">slotToEndPOSIXTime</span></span><span> </span><span class="annot"><span class="annottext">SlotConfig
</span><a href="#local-6989586621680558126"><span class="hs-identifier hs-var">pSlotConfig</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680558128"><span class="hs-identifier hs-var">currentSlot</span></a></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handleCurrentNodeClientSlot"><span class="hs-identifier hs-type">handleCurrentNodeClientSlot</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680558123"><span class="annot"><a href="#local-6989586621680558123"><span class="hs-identifier hs-type">effs</span></a></span></span><span> </span><span id="local-6989586621680558122"><span class="annot"><a href="#local-6989586621680558122"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="annot"><a href="Wallet.Effects.html#NodeClientEffect"><span class="hs-identifier hs-type">NodeClientEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558123"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogObserve</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogMessage</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680558123"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-type">RequestHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558123"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558122"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Slot</span></span><span>
</span><span id="line-168"></span><span id="handleCurrentNodeClientSlot"><span class="annot"><span class="annottext">handleCurrentNodeClientSlot :: RequestHandler effs a Slot
</span><a href="Plutus.Contract.Trace.RequestHandler.html#handleCurrentNodeClientSlot"><span class="hs-identifier hs-var hs-var">handleCurrentNodeClientSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-169"></span><span>    </span><span class="annot"><span class="annottext">(a -&gt; Eff (NonDet : effs) Slot) -&gt; RequestHandler effs a Slot
forall (effs :: [* -&gt; *]) req resp.
(req -&gt; Eff (NonDet : effs) resp) -&gt; RequestHandler effs req resp
</span><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-var">RequestHandler</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; Eff (NonDet : effs) Slot) -&gt; RequestHandler effs a Slot)
-&gt; (a -&gt; Eff (NonDet : effs) Slot) -&gt; RequestHandler effs a Slot
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-170"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; Eff (NonDet : effs) Slot -&gt; Eff (NonDet : effs) Slot
forall v (effs :: [* -&gt; *]) a.
Member (LogObserve (LogMessage v)) effs =&gt;
v -&gt; Eff effs a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">surroundDebug</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;handleCurrentNodeClientSlot&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Eff (NonDet : effs) Slot -&gt; Eff (NonDet : effs) Slot)
-&gt; Eff (NonDet : effs) Slot -&gt; Eff (NonDet : effs) Slot
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-171"></span><span>            </span><span class="annot"><span class="annottext">Eff (NonDet : effs) Slot
forall (effs :: [* -&gt; *]).
Member NodeClientEffect effs =&gt;
Eff effs Slot
</span><a href="Wallet.Effects.html#getClientSlot"><span class="hs-identifier hs-var">getClientSlot</span></a></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handleCurrentChainIndexSlot"><span class="hs-identifier hs-type">handleCurrentChainIndexSlot</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680558121"><span class="annot"><a href="#local-6989586621680558121"><span class="hs-identifier hs-type">effs</span></a></span></span><span> </span><span id="local-6989586621680558120"><span class="annot"><a href="#local-6989586621680558120"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogObserve</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogMessage</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680558121"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChainIndexQueryEffect</span></span><span> </span><span class="annot"><a href="#local-6989586621680558121"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-type">RequestHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558121"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558120"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Slot</span></span><span>
</span><span id="line-179"></span><span id="handleCurrentChainIndexSlot"><span class="annot"><span class="annottext">handleCurrentChainIndexSlot :: RequestHandler effs a Slot
</span><a href="Plutus.Contract.Trace.RequestHandler.html#handleCurrentChainIndexSlot"><span class="hs-identifier hs-var hs-var">handleCurrentChainIndexSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><span class="annottext">(a -&gt; Eff (NonDet : effs) Slot) -&gt; RequestHandler effs a Slot
forall (effs :: [* -&gt; *]) req resp.
(req -&gt; Eff (NonDet : effs) resp) -&gt; RequestHandler effs req resp
</span><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-var">RequestHandler</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; Eff (NonDet : effs) Slot) -&gt; RequestHandler effs a Slot)
-&gt; (a -&gt; Eff (NonDet : effs) Slot) -&gt; RequestHandler effs a Slot
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-181"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; Eff (NonDet : effs) Slot -&gt; Eff (NonDet : effs) Slot
forall v (effs :: [* -&gt; *]) a.
Member (LogObserve (LogMessage v)) effs =&gt;
v -&gt; Eff effs a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">surroundDebug</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;handleCurrentChainIndexSlot&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Eff (NonDet : effs) Slot -&gt; Eff (NonDet : effs) Slot)
-&gt; Eff (NonDet : effs) Slot -&gt; Eff (NonDet : effs) Slot
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-182"></span><span>            </span><span id="local-6989586621680558119"><span class="annot"><span class="annottext">Tip
</span><a href="#local-6989586621680558119"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff (NonDet : effs) Tip
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
Eff effs Tip
</span><span class="hs-identifier hs-var">ChainIndexEff.getTip</span></span><span>
</span><span id="line-183"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Tip
</span><a href="#local-6989586621680558119"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-184"></span><span>                </span><span class="annot"><span class="annottext">Tip
</span><span class="hs-identifier hs-var">TipAtGenesis</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Eff (NonDet : effs) Slot
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Slot -&gt; Eff (NonDet : effs) Slot)
-&gt; Slot -&gt; Eff (NonDet : effs) Slot
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Slot
</span><span class="hs-identifier hs-var">Slot</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-185"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Tip</span></span><span> </span><span id="local-6989586621680558114"><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680558114"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span class="annot"><span class="annottext">BlockId
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">BlockNumber
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Eff (NonDet : effs) Slot
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680558114"><span class="hs-identifier hs-var">slot</span></a></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handleCurrentTime"><span class="hs-identifier hs-type">handleCurrentTime</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680558113"><span class="annot"><a href="#local-6989586621680558113"><span class="hs-identifier hs-type">effs</span></a></span></span><span> </span><span id="local-6989586621680558112"><span class="annot"><a href="#local-6989586621680558112"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="annot"><a href="Wallet.Effects.html#NodeClientEffect"><span class="hs-identifier hs-type">NodeClientEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558113"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogObserve</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogMessage</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680558113"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-type">RequestHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558113"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558112"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">POSIXTime</span></span><span>
</span><span id="line-193"></span><span id="handleCurrentTime"><span class="annot"><span class="annottext">handleCurrentTime :: RequestHandler effs a POSIXTime
</span><a href="Plutus.Contract.Trace.RequestHandler.html#handleCurrentTime"><span class="hs-identifier hs-var hs-var">handleCurrentTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><span class="annottext">(a -&gt; Eff (NonDet : effs) POSIXTime)
-&gt; RequestHandler effs a POSIXTime
forall (effs :: [* -&gt; *]) req resp.
(req -&gt; Eff (NonDet : effs) resp) -&gt; RequestHandler effs req resp
</span><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-var">RequestHandler</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; Eff (NonDet : effs) POSIXTime)
 -&gt; RequestHandler effs a POSIXTime)
-&gt; (a -&gt; Eff (NonDet : effs) POSIXTime)
-&gt; RequestHandler effs a POSIXTime
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-195"></span><span>        </span><span class="annot"><span class="annottext">Text
-&gt; Eff (NonDet : effs) POSIXTime -&gt; Eff (NonDet : effs) POSIXTime
forall v (effs :: [* -&gt; *]) a.
Member (LogObserve (LogMessage v)) effs =&gt;
v -&gt; Eff effs a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">surroundDebug</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;handleCurrentTime&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Eff (NonDet : effs) POSIXTime -&gt; Eff (NonDet : effs) POSIXTime)
-&gt; Eff (NonDet : effs) POSIXTime -&gt; Eff (NonDet : effs) POSIXTime
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-196"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Params</span></span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680558111"><span class="annot"><span class="annottext">SlotConfig
pSlotConfig :: SlotConfig
pSlotConfig :: Params -&gt; SlotConfig
</span><a href="#local-6989586621680558111"><span class="hs-identifier hs-var hs-var">pSlotConfig</span></a></span></span><span> </span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff (NonDet : effs) Params
forall (effs :: [* -&gt; *]).
Member NodeClientEffect effs =&gt;
Eff effs Params
</span><a href="Wallet.Effects.html#getClientParams"><span class="hs-identifier hs-var">getClientParams</span></a></span><span>
</span><span id="line-197"></span><span>            </span><span class="annot"><span class="annottext">SlotConfig -&gt; Slot -&gt; POSIXTime
</span><span class="hs-identifier hs-var">slotToEndPOSIXTime</span></span><span> </span><span class="annot"><span class="annottext">SlotConfig
</span><a href="#local-6989586621680558111"><span class="hs-identifier hs-var">pSlotConfig</span></a></span><span> </span><span class="annot"><span class="annottext">(Slot -&gt; POSIXTime)
-&gt; Eff (NonDet : effs) Slot -&gt; Eff (NonDet : effs) POSIXTime
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (NonDet : effs) Slot
forall (effs :: [* -&gt; *]).
Member NodeClientEffect effs =&gt;
Eff effs Slot
</span><a href="Wallet.Effects.html#getClientSlot"><span class="hs-identifier hs-var">getClientSlot</span></a></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handleCurrentNodeClientTimeRange"><span class="hs-identifier hs-type">handleCurrentNodeClientTimeRange</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680558110"><span class="annot"><a href="#local-6989586621680558110"><span class="hs-identifier hs-type">effs</span></a></span></span><span> </span><span id="local-6989586621680558109"><span class="annot"><a href="#local-6989586621680558109"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="annot"><a href="Wallet.Effects.html#NodeClientEffect"><span class="hs-identifier hs-type">NodeClientEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558110"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogObserve</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogMessage</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680558110"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-type">RequestHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558110"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558109"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">POSIXTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">POSIXTime</span></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span id="handleCurrentNodeClientTimeRange"><span class="annot"><span class="annottext">handleCurrentNodeClientTimeRange :: RequestHandler effs a (POSIXTime, POSIXTime)
</span><a href="Plutus.Contract.Trace.RequestHandler.html#handleCurrentNodeClientTimeRange"><span class="hs-identifier hs-var hs-var">handleCurrentNodeClientTimeRange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-206"></span><span>    </span><span class="annot"><span class="annottext">(a -&gt; Eff (NonDet : effs) (POSIXTime, POSIXTime))
-&gt; RequestHandler effs a (POSIXTime, POSIXTime)
forall (effs :: [* -&gt; *]) req resp.
(req -&gt; Eff (NonDet : effs) resp) -&gt; RequestHandler effs req resp
</span><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-var">RequestHandler</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; Eff (NonDet : effs) (POSIXTime, POSIXTime))
 -&gt; RequestHandler effs a (POSIXTime, POSIXTime))
-&gt; (a -&gt; Eff (NonDet : effs) (POSIXTime, POSIXTime))
-&gt; RequestHandler effs a (POSIXTime, POSIXTime)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-207"></span><span>        </span><span class="annot"><span class="annottext">Text
-&gt; Eff (NonDet : effs) (POSIXTime, POSIXTime)
-&gt; Eff (NonDet : effs) (POSIXTime, POSIXTime)
forall v (effs :: [* -&gt; *]) a.
Member (LogObserve (LogMessage v)) effs =&gt;
v -&gt; Eff effs a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">surroundDebug</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;handleCurrentNodeClientTimeRange&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Eff (NonDet : effs) (POSIXTime, POSIXTime)
 -&gt; Eff (NonDet : effs) (POSIXTime, POSIXTime))
-&gt; Eff (NonDet : effs) (POSIXTime, POSIXTime)
-&gt; Eff (NonDet : effs) (POSIXTime, POSIXTime)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-208"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Params</span></span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680558108"><span class="annot"><span class="annottext">SlotConfig
pSlotConfig :: SlotConfig
pSlotConfig :: Params -&gt; SlotConfig
</span><a href="#local-6989586621680558108"><span class="hs-identifier hs-var hs-var">pSlotConfig</span></a></span></span><span> </span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff (NonDet : effs) Params
forall (effs :: [* -&gt; *]).
Member NodeClientEffect effs =&gt;
Eff effs Params
</span><a href="Wallet.Effects.html#getClientParams"><span class="hs-identifier hs-var">getClientParams</span></a></span><span>
</span><span id="line-209"></span><span>            </span><span id="local-6989586621680558107"><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680558107"><span class="hs-identifier hs-var">nodeClientSlot</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff (NonDet : effs) Slot
forall (effs :: [* -&gt; *]).
Member NodeClientEffect effs =&gt;
Eff effs Slot
</span><a href="Wallet.Effects.html#getClientSlot"><span class="hs-identifier hs-var">getClientSlot</span></a></span><span>
</span><span id="line-210"></span><span>            </span><span class="annot"><span class="annottext">(POSIXTime, POSIXTime)
-&gt; Eff (NonDet : effs) (POSIXTime, POSIXTime)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">SlotConfig -&gt; Slot -&gt; POSIXTime
</span><span class="hs-identifier hs-var">slotToBeginPOSIXTime</span></span><span> </span><span class="annot"><span class="annottext">SlotConfig
</span><a href="#local-6989586621680558108"><span class="hs-identifier hs-var">pSlotConfig</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680558107"><span class="hs-identifier hs-var">nodeClientSlot</span></a></span><span>
</span><span id="line-211"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SlotConfig -&gt; Slot -&gt; POSIXTime
</span><span class="hs-identifier hs-var">slotToEndPOSIXTime</span></span><span> </span><span class="annot"><span class="annottext">SlotConfig
</span><a href="#local-6989586621680558108"><span class="hs-identifier hs-var">pSlotConfig</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680558107"><span class="hs-identifier hs-var">nodeClientSlot</span></a></span><span>
</span><span id="line-212"></span><span>                 </span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handleTimeToSlotConversions"><span class="hs-identifier hs-type">handleTimeToSlotConversions</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680558106"><span class="annot"><a href="#local-6989586621680558106"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="annot"><a href="Wallet.Effects.html#NodeClientEffect"><span class="hs-identifier hs-type">NodeClientEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558106"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogObserve</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogMessage</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680558106"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-type">RequestHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558106"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">POSIXTimeRange</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotRange</span></span><span>
</span><span id="line-220"></span><span id="handleTimeToSlotConversions"><span class="annot"><span class="annottext">handleTimeToSlotConversions :: RequestHandler effs POSIXTimeRange SlotRange
</span><a href="Plutus.Contract.Trace.RequestHandler.html#handleTimeToSlotConversions"><span class="hs-identifier hs-var hs-var">handleTimeToSlotConversions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><span class="annottext">(POSIXTimeRange -&gt; Eff (NonDet : effs) SlotRange)
-&gt; RequestHandler effs POSIXTimeRange SlotRange
forall (effs :: [* -&gt; *]) req resp.
(req -&gt; Eff (NonDet : effs) resp) -&gt; RequestHandler effs req resp
</span><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-var">RequestHandler</span></a></span><span> </span><span class="annot"><span class="annottext">((POSIXTimeRange -&gt; Eff (NonDet : effs) SlotRange)
 -&gt; RequestHandler effs POSIXTimeRange SlotRange)
-&gt; (POSIXTimeRange -&gt; Eff (NonDet : effs) SlotRange)
-&gt; RequestHandler effs POSIXTimeRange SlotRange
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680558105"><span class="annot"><span class="annottext">POSIXTimeRange
</span><a href="#local-6989586621680558105"><span class="hs-identifier hs-var">poxisTimeRange</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-222"></span><span>        </span><span class="annot"><span class="annottext">Text
-&gt; Eff (NonDet : effs) SlotRange -&gt; Eff (NonDet : effs) SlotRange
forall v (effs :: [* -&gt; *]) a.
Member (LogObserve (LogMessage v)) effs =&gt;
v -&gt; Eff effs a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">surroundDebug</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;handleTimeToSlotConversions&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Eff (NonDet : effs) SlotRange -&gt; Eff (NonDet : effs) SlotRange)
-&gt; Eff (NonDet : effs) SlotRange -&gt; Eff (NonDet : effs) SlotRange
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-223"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Params</span></span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680558104"><span class="annot"><span class="annottext">SlotConfig
pSlotConfig :: SlotConfig
pSlotConfig :: Params -&gt; SlotConfig
</span><a href="#local-6989586621680558104"><span class="hs-identifier hs-var hs-var">pSlotConfig</span></a></span></span><span> </span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff (NonDet : effs) Params
forall (effs :: [* -&gt; *]).
Member NodeClientEffect effs =&gt;
Eff effs Params
</span><a href="Wallet.Effects.html#getClientParams"><span class="hs-identifier hs-var">getClientParams</span></a></span><span>
</span><span id="line-224"></span><span>            </span><span class="annot"><span class="annottext">SlotRange -&gt; Eff (NonDet : effs) SlotRange
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(SlotRange -&gt; Eff (NonDet : effs) SlotRange)
-&gt; SlotRange -&gt; Eff (NonDet : effs) SlotRange
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SlotConfig -&gt; POSIXTimeRange -&gt; SlotRange
</span><span class="hs-identifier hs-var">posixTimeRangeToContainedSlotRange</span></span><span> </span><span class="annot"><span class="annottext">SlotConfig
</span><a href="#local-6989586621680558104"><span class="hs-identifier hs-var">pSlotConfig</span></a></span><span> </span><span class="annot"><span class="annottext">POSIXTimeRange
</span><a href="#local-6989586621680558105"><span class="hs-identifier hs-var">poxisTimeRange</span></a></span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handleUnbalancedTransactions"><span class="hs-identifier hs-type">handleUnbalancedTransactions</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680558103"><span class="annot"><a href="#local-6989586621680558103"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="annot"><a href="Wallet.Effects.html#WalletEffect"><span class="hs-identifier hs-type">WalletEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558103"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogObserve</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogMessage</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680558103"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogMsg</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.LogMessages.html#RequestHandlerLogMsg"><span class="hs-identifier hs-type">RequestHandlerLogMsg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680558103"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-type">RequestHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558103"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UnbalancedTx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Wallet.Emulator.Error.html#WalletAPIError"><span class="hs-identifier hs-type">WalletAPIError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span id="handleUnbalancedTransactions"><span class="annot"><span class="annottext">handleUnbalancedTransactions :: RequestHandler effs UnbalancedTx (Either WalletAPIError CardanoTx)
</span><a href="Plutus.Contract.Trace.RequestHandler.html#handleUnbalancedTransactions"><span class="hs-identifier hs-var hs-var">handleUnbalancedTransactions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-234"></span><span>    </span><span class="annot"><span class="annottext">(UnbalancedTx
 -&gt; Eff (NonDet : effs) (Either WalletAPIError CardanoTx))
-&gt; RequestHandler
     effs UnbalancedTx (Either WalletAPIError CardanoTx)
forall (effs :: [* -&gt; *]) req resp.
(req -&gt; Eff (NonDet : effs) resp) -&gt; RequestHandler effs req resp
</span><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-var">RequestHandler</span></a></span><span> </span><span class="annot"><span class="annottext">((UnbalancedTx
  -&gt; Eff (NonDet : effs) (Either WalletAPIError CardanoTx))
 -&gt; RequestHandler
      effs UnbalancedTx (Either WalletAPIError CardanoTx))
-&gt; (UnbalancedTx
    -&gt; Eff (NonDet : effs) (Either WalletAPIError CardanoTx))
-&gt; RequestHandler
     effs UnbalancedTx (Either WalletAPIError CardanoTx)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680558102"><span class="annot"><span class="annottext">UnbalancedTx
</span><a href="#local-6989586621680558102"><span class="hs-identifier hs-var">unbalancedTx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-235"></span><span>        </span><span class="annot"><span class="annottext">Text
-&gt; Eff (NonDet : effs) (Either WalletAPIError CardanoTx)
-&gt; Eff (NonDet : effs) (Either WalletAPIError CardanoTx)
forall v (effs :: [* -&gt; *]) a.
Member (LogObserve (LogMessage v)) effs =&gt;
v -&gt; Eff effs a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">surroundDebug</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;handleUnbalancedTransactions&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Eff (NonDet : effs) (Either WalletAPIError CardanoTx)
 -&gt; Eff (NonDet : effs) (Either WalletAPIError CardanoTx))
-&gt; Eff (NonDet : effs) (Either WalletAPIError CardanoTx)
-&gt; Eff (NonDet : effs) (Either WalletAPIError CardanoTx)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-236"></span><span>        </span><span class="annot"><span class="annottext">UnbalancedTx
-&gt; Eff
     (Error WalletAPIError : NonDet : effs)
     (Either WalletAPIError CardanoTx)
forall (effs :: [* -&gt; *]).
Member WalletEffect effs =&gt;
UnbalancedTx -&gt; Eff effs (Either WalletAPIError CardanoTx)
</span><a href="Wallet.Effects.html#balanceTx"><span class="hs-identifier hs-var">Wallet.Effects.balanceTx</span></a></span><span> </span><span class="annot"><span class="annottext">UnbalancedTx
</span><a href="#local-6989586621680558102"><span class="hs-identifier hs-var">unbalancedTx</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  (Error WalletAPIError : NonDet : effs)
  (Either WalletAPIError CardanoTx)
-&gt; (WalletAPIError
    -&gt; Eff (NonDet : effs) (Either WalletAPIError CardanoTx))
-&gt; Eff (NonDet : effs) (Either WalletAPIError CardanoTx)
forall e (effs :: [* -&gt; *]) a.
Eff (Error e : effs) a -&gt; (e -&gt; Eff effs a) -&gt; Eff effs a
</span><span class="hs-operator hs-var">`Eff.handleError`</span></span><span>
</span><span id="line-237"></span><span>          </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680558099"><span class="annot"><span class="annottext">WalletAPIError
</span><a href="#local-6989586621680558099"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RequestHandlerLogMsg -&gt; Eff (NonDet : effs) ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><span class="hs-identifier hs-var">logWarn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WalletAPIError -&gt; RequestHandlerLogMsg
</span><a href="Wallet.Emulator.LogMessages.html#HandleTxFailed"><span class="hs-identifier hs-var">HandleTxFailed</span></a></span><span> </span><span class="annot"><span class="annottext">WalletAPIError
</span><a href="#local-6989586621680558099"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Eff (NonDet : effs) ()
-&gt; Eff (NonDet : effs) (Either WalletAPIError CardanoTx)
-&gt; Eff (NonDet : effs) (Either WalletAPIError CardanoTx)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Either WalletAPIError CardanoTx
-&gt; Eff (NonDet : effs) (Either WalletAPIError CardanoTx)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WalletAPIError -&gt; Either WalletAPIError CardanoTx
forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">WalletAPIError
</span><a href="#local-6989586621680558099"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handlePendingTransactions"><span class="hs-identifier hs-type">handlePendingTransactions</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-240"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680558098"><span class="annot"><a href="#local-6989586621680558098"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="annot"><a href="Wallet.Effects.html#WalletEffect"><span class="hs-identifier hs-type">WalletEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558098"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-242"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogObserve</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogMessage</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680558098"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogMsg</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.LogMessages.html#RequestHandlerLogMsg"><span class="hs-identifier hs-type">RequestHandlerLogMsg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680558098"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-type">RequestHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558098"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Wallet.Emulator.Error.html#WalletAPIError"><span class="hs-identifier hs-type">WalletAPIError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span id="handlePendingTransactions"><span class="annot"><span class="annottext">handlePendingTransactions :: RequestHandler effs CardanoTx (Either WalletAPIError CardanoTx)
</span><a href="Plutus.Contract.Trace.RequestHandler.html#handlePendingTransactions"><span class="hs-identifier hs-var hs-var">handlePendingTransactions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-247"></span><span>    </span><span class="annot"><span class="annottext">(CardanoTx
 -&gt; Eff (NonDet : effs) (Either WalletAPIError CardanoTx))
-&gt; RequestHandler effs CardanoTx (Either WalletAPIError CardanoTx)
forall (effs :: [* -&gt; *]) req resp.
(req -&gt; Eff (NonDet : effs) resp) -&gt; RequestHandler effs req resp
</span><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-var">RequestHandler</span></a></span><span> </span><span class="annot"><span class="annottext">((CardanoTx
  -&gt; Eff (NonDet : effs) (Either WalletAPIError CardanoTx))
 -&gt; RequestHandler effs CardanoTx (Either WalletAPIError CardanoTx))
-&gt; (CardanoTx
    -&gt; Eff (NonDet : effs) (Either WalletAPIError CardanoTx))
-&gt; RequestHandler effs CardanoTx (Either WalletAPIError CardanoTx)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680558097"><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621680558097"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-248"></span><span>        </span><span class="annot"><span class="annottext">Text
-&gt; Eff (NonDet : effs) (Either WalletAPIError CardanoTx)
-&gt; Eff (NonDet : effs) (Either WalletAPIError CardanoTx)
forall v (effs :: [* -&gt; *]) a.
Member (LogObserve (LogMessage v)) effs =&gt;
v -&gt; Eff effs a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">surroundDebug</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;handlePendingTransactions&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Eff (NonDet : effs) (Either WalletAPIError CardanoTx)
 -&gt; Eff (NonDet : effs) (Either WalletAPIError CardanoTx))
-&gt; Eff (NonDet : effs) (Either WalletAPIError CardanoTx)
-&gt; Eff (NonDet : effs) (Either WalletAPIError CardanoTx)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-249"></span><span>        </span><span class="annot"><span class="annottext">Eff
  (Error WalletAPIError : NonDet : effs)
  (Either WalletAPIError CardanoTx)
-&gt; (WalletAPIError
    -&gt; Eff (NonDet : effs) (Either WalletAPIError CardanoTx))
-&gt; Eff (NonDet : effs) (Either WalletAPIError CardanoTx)
forall e (effs :: [* -&gt; *]) a.
Eff (Error e : effs) a -&gt; (e -&gt; Eff effs a) -&gt; Eff effs a
</span><span class="hs-identifier hs-var">Eff.handleError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardanoTx -&gt; Either WalletAPIError CardanoTx
forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">(CardanoTx -&gt; Either WalletAPIError CardanoTx)
-&gt; Eff (Error WalletAPIError : NonDet : effs) CardanoTx
-&gt; Eff
     (Error WalletAPIError : NonDet : effs)
     (Either WalletAPIError CardanoTx)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoTx -&gt; Eff (Error WalletAPIError : NonDet : effs) CardanoTx
forall (effs :: [* -&gt; *]).
Member WalletEffect effs =&gt;
CardanoTx -&gt; Eff effs CardanoTx
</span><a href="Wallet.API.html#signTxAndSubmit"><span class="hs-identifier hs-var">signTxAndSubmit</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621680558097"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>                        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680558096"><span class="annot"><span class="annottext">WalletAPIError
</span><a href="#local-6989586621680558096"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RequestHandlerLogMsg -&gt; Eff (NonDet : effs) ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><span class="hs-identifier hs-var">logWarn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WalletAPIError -&gt; RequestHandlerLogMsg
</span><a href="Wallet.Emulator.LogMessages.html#HandleTxFailed"><span class="hs-identifier hs-var">HandleTxFailed</span></a></span><span> </span><span class="annot"><span class="annottext">WalletAPIError
</span><a href="#local-6989586621680558096"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Eff (NonDet : effs) ()
-&gt; Eff (NonDet : effs) (Either WalletAPIError CardanoTx)
-&gt; Eff (NonDet : effs) (Either WalletAPIError CardanoTx)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Either WalletAPIError CardanoTx
-&gt; Eff (NonDet : effs) (Either WalletAPIError CardanoTx)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WalletAPIError -&gt; Either WalletAPIError CardanoTx
forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">WalletAPIError
</span><a href="#local-6989586621680558096"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handleChainIndexQueries"><span class="hs-identifier hs-type">handleChainIndexQueries</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680558095"><span class="annot"><a href="#local-6989586621680558095"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogObserve</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogMessage</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680558095"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChainIndexQueryEffect</span></span><span> </span><span class="annot"><a href="#local-6989586621680558095"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-type">RequestHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558095"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#ChainIndexQuery"><span class="hs-identifier hs-type">ChainIndexQuery</span></a></span><span> </span><span class="annot"><a href="Plutus.Contract.Effects.html#ChainIndexResponse"><span class="hs-identifier hs-type">ChainIndexResponse</span></a></span><span>
</span><span id="line-258"></span><span id="handleChainIndexQueries"><span class="annot"><span class="annottext">handleChainIndexQueries :: RequestHandler effs ChainIndexQuery ChainIndexResponse
</span><a href="Plutus.Contract.Trace.RequestHandler.html#handleChainIndexQueries"><span class="hs-identifier hs-var hs-var">handleChainIndexQueries</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ChainIndexQuery -&gt; Eff (NonDet : effs) ChainIndexResponse)
-&gt; RequestHandler effs ChainIndexQuery ChainIndexResponse
forall (effs :: [* -&gt; *]) req resp.
(req -&gt; Eff (NonDet : effs) resp) -&gt; RequestHandler effs req resp
</span><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-var">RequestHandler</span></a></span><span> </span><span class="annot"><span class="annottext">((ChainIndexQuery -&gt; Eff (NonDet : effs) ChainIndexResponse)
 -&gt; RequestHandler effs ChainIndexQuery ChainIndexResponse)
-&gt; (ChainIndexQuery -&gt; Eff (NonDet : effs) ChainIndexResponse)
-&gt; RequestHandler effs ChainIndexQuery ChainIndexResponse
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680558094"><span class="annot"><span class="annottext">ChainIndexQuery
</span><a href="#local-6989586621680558094"><span class="hs-identifier hs-var">chainIndexQuery</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-259"></span><span>    </span><span class="annot"><span class="annottext">Text
-&gt; Eff (NonDet : effs) ChainIndexResponse
-&gt; Eff (NonDet : effs) ChainIndexResponse
forall v (effs :: [* -&gt; *]) a.
Member (LogObserve (LogMessage v)) effs =&gt;
v -&gt; Eff effs a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">surroundDebug</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;handleChainIndexQueries&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Eff (NonDet : effs) ChainIndexResponse
 -&gt; Eff (NonDet : effs) ChainIndexResponse)
-&gt; Eff (NonDet : effs) ChainIndexResponse
-&gt; Eff (NonDet : effs) ChainIndexResponse
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-260"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ChainIndexQuery
</span><a href="#local-6989586621680558094"><span class="hs-identifier hs-var">chainIndexQuery</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-261"></span><span>        </span><span class="annot"><a href="Plutus.Contract.Effects.html#DatumFromHash"><span class="hs-identifier hs-type">DatumFromHash</span></a></span><span> </span><span id="local-6989586621680558092"><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621680558092"><span class="hs-identifier hs-var">h</span></a></span></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Datum -&gt; ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#DatumHashResponse"><span class="hs-identifier hs-var">DatumHashResponse</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Datum -&gt; ChainIndexResponse)
-&gt; Eff (NonDet : effs) (Maybe Datum)
-&gt; Eff (NonDet : effs) ChainIndexResponse
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash -&gt; Eff (NonDet : effs) (Maybe Datum)
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
DatumHash -&gt; Eff effs (Maybe Datum)
</span><span class="hs-identifier hs-var">ChainIndexEff.datumFromHash</span></span><span> </span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621680558092"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-262"></span><span>        </span><span class="annot"><a href="Plutus.Contract.Effects.html#ValidatorFromHash"><span class="hs-identifier hs-type">ValidatorFromHash</span></a></span><span> </span><span id="local-6989586621680558088"><span class="annot"><span class="annottext">ValidatorHash
</span><a href="#local-6989586621680558088"><span class="hs-identifier hs-var">h</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Versioned Validator) -&gt; ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#ValidatorHashResponse"><span class="hs-identifier hs-var">ValidatorHashResponse</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Versioned Validator) -&gt; ChainIndexResponse)
-&gt; Eff (NonDet : effs) (Maybe (Versioned Validator))
-&gt; Eff (NonDet : effs) ChainIndexResponse
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ValidatorHash -&gt; Eff (NonDet : effs) (Maybe (Versioned Validator))
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
ValidatorHash -&gt; Eff effs (Maybe (Versioned Validator))
</span><span class="hs-identifier hs-var">ChainIndexEff.validatorFromHash</span></span><span> </span><span class="annot"><span class="annottext">ValidatorHash
</span><a href="#local-6989586621680558088"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-263"></span><span>        </span><span class="annot"><a href="Plutus.Contract.Effects.html#MintingPolicyFromHash"><span class="hs-identifier hs-type">MintingPolicyFromHash</span></a></span><span> </span><span id="local-6989586621680558084"><span class="annot"><span class="annottext">MintingPolicyHash
</span><a href="#local-6989586621680558084"><span class="hs-identifier hs-var">h</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Versioned MintingPolicy) -&gt; ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#MintingPolicyHashResponse"><span class="hs-identifier hs-var">MintingPolicyHashResponse</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Versioned MintingPolicy) -&gt; ChainIndexResponse)
-&gt; Eff (NonDet : effs) (Maybe (Versioned MintingPolicy))
-&gt; Eff (NonDet : effs) ChainIndexResponse
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">MintingPolicyHash
-&gt; Eff (NonDet : effs) (Maybe (Versioned MintingPolicy))
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
MintingPolicyHash -&gt; Eff effs (Maybe (Versioned MintingPolicy))
</span><span class="hs-identifier hs-var">ChainIndexEff.mintingPolicyFromHash</span></span><span> </span><span class="annot"><span class="annottext">MintingPolicyHash
</span><a href="#local-6989586621680558084"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-264"></span><span>        </span><span class="annot"><a href="Plutus.Contract.Effects.html#StakeValidatorFromHash"><span class="hs-identifier hs-type">StakeValidatorFromHash</span></a></span><span> </span><span id="local-6989586621680558080"><span class="annot"><span class="annottext">StakeValidatorHash
</span><a href="#local-6989586621680558080"><span class="hs-identifier hs-var">h</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Versioned StakeValidator) -&gt; ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#StakeValidatorHashResponse"><span class="hs-identifier hs-var">StakeValidatorHashResponse</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Versioned StakeValidator) -&gt; ChainIndexResponse)
-&gt; Eff (NonDet : effs) (Maybe (Versioned StakeValidator))
-&gt; Eff (NonDet : effs) ChainIndexResponse
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">StakeValidatorHash
-&gt; Eff (NonDet : effs) (Maybe (Versioned StakeValidator))
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
StakeValidatorHash -&gt; Eff effs (Maybe (Versioned StakeValidator))
</span><span class="hs-identifier hs-var">ChainIndexEff.stakeValidatorFromHash</span></span><span> </span><span class="annot"><span class="annottext">StakeValidatorHash
</span><a href="#local-6989586621680558080"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-265"></span><span>        </span><span class="annot"><a href="Plutus.Contract.Effects.html#RedeemerFromHash"><span class="hs-identifier hs-type">RedeemerFromHash</span></a></span><span> </span><span id="local-6989586621680558076"><span class="annot"><span class="annottext">RedeemerHash
</span><a href="#local-6989586621680558076"><span class="hs-identifier hs-var">h</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Redeemer -&gt; ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#RedeemerHashResponse"><span class="hs-identifier hs-var">RedeemerHashResponse</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Redeemer -&gt; ChainIndexResponse)
-&gt; Eff (NonDet : effs) (Maybe Redeemer)
-&gt; Eff (NonDet : effs) ChainIndexResponse
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">RedeemerHash -&gt; Eff (NonDet : effs) (Maybe Redeemer)
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
RedeemerHash -&gt; Eff effs (Maybe Redeemer)
</span><span class="hs-identifier hs-var">ChainIndexEff.redeemerFromHash</span></span><span> </span><span class="annot"><span class="annottext">RedeemerHash
</span><a href="#local-6989586621680558076"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-266"></span><span>        </span><span class="annot"><a href="Plutus.Contract.Effects.html#TxOutFromRef"><span class="hs-identifier hs-type">TxOutFromRef</span></a></span><span> </span><span id="local-6989586621680558072"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680558072"><span class="hs-identifier hs-var">txOutRef</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe DecoratedTxOut -&gt; ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#TxOutRefResponse"><span class="hs-identifier hs-var">TxOutRefResponse</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe DecoratedTxOut -&gt; ChainIndexResponse)
-&gt; Eff (NonDet : effs) (Maybe DecoratedTxOut)
-&gt; Eff (NonDet : effs) ChainIndexResponse
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; Eff (NonDet : effs) (Maybe DecoratedTxOut)
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
TxOutRef -&gt; Eff effs (Maybe DecoratedTxOut)
</span><span class="hs-identifier hs-var">ChainIndexEff.txOutFromRef</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680558072"><span class="hs-identifier hs-var">txOutRef</span></a></span><span>
</span><span id="line-267"></span><span>        </span><span class="annot"><a href="Plutus.Contract.Effects.html#TxFromTxId"><span class="hs-identifier hs-type">TxFromTxId</span></a></span><span> </span><span id="local-6989586621680558068"><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621680558068"><span class="hs-identifier hs-var">txid</span></a></span></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ChainIndexTx -&gt; ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#TxIdResponse"><span class="hs-identifier hs-var">TxIdResponse</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe ChainIndexTx -&gt; ChainIndexResponse)
-&gt; Eff (NonDet : effs) (Maybe ChainIndexTx)
-&gt; Eff (NonDet : effs) ChainIndexResponse
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TxId -&gt; Eff (NonDet : effs) (Maybe ChainIndexTx)
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
TxId -&gt; Eff effs (Maybe ChainIndexTx)
</span><span class="hs-identifier hs-var">ChainIndexEff.txFromTxId</span></span><span> </span><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621680558068"><span class="hs-identifier hs-var">txid</span></a></span><span>
</span><span id="line-268"></span><span>        </span><span class="annot"><a href="Plutus.Contract.Effects.html#UnspentTxOutFromRef"><span class="hs-identifier hs-type">UnspentTxOutFromRef</span></a></span><span> </span><span id="local-6989586621680558064"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680558064"><span class="hs-identifier hs-var">ref</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe DecoratedTxOut -&gt; ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#UnspentTxOutResponse"><span class="hs-identifier hs-var">UnspentTxOutResponse</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe DecoratedTxOut -&gt; ChainIndexResponse)
-&gt; Eff (NonDet : effs) (Maybe DecoratedTxOut)
-&gt; Eff (NonDet : effs) ChainIndexResponse
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; Eff (NonDet : effs) (Maybe DecoratedTxOut)
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
TxOutRef -&gt; Eff effs (Maybe DecoratedTxOut)
</span><span class="hs-identifier hs-var">ChainIndexEff.unspentTxOutFromRef</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680558064"><span class="hs-identifier hs-var">ref</span></a></span><span>
</span><span id="line-269"></span><span>        </span><span class="annot"><a href="Plutus.Contract.Effects.html#UtxoSetMembership"><span class="hs-identifier hs-type">UtxoSetMembership</span></a></span><span> </span><span id="local-6989586621680558060"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680558060"><span class="hs-identifier hs-var">txOutRef</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IsUtxoResponse -&gt; ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#UtxoSetMembershipResponse"><span class="hs-identifier hs-var">UtxoSetMembershipResponse</span></a></span><span> </span><span class="annot"><span class="annottext">(IsUtxoResponse -&gt; ChainIndexResponse)
-&gt; Eff (NonDet : effs) IsUtxoResponse
-&gt; Eff (NonDet : effs) ChainIndexResponse
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; Eff (NonDet : effs) IsUtxoResponse
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
TxOutRef -&gt; Eff effs IsUtxoResponse
</span><span class="hs-identifier hs-var">ChainIndexEff.utxoSetMembership</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680558060"><span class="hs-identifier hs-var">txOutRef</span></a></span><span>
</span><span id="line-270"></span><span>        </span><span class="annot"><a href="Plutus.Contract.Effects.html#UtxoSetAtAddress"><span class="hs-identifier hs-type">UtxoSetAtAddress</span></a></span><span> </span><span id="local-6989586621680558056"><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680558056"><span class="hs-identifier hs-var">pq</span></a></span></span><span> </span><span id="local-6989586621680558055"><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680558055"><span class="hs-identifier hs-var">c</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UtxosResponse -&gt; ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#UtxoSetAtResponse"><span class="hs-identifier hs-var">UtxoSetAtResponse</span></a></span><span> </span><span class="annot"><span class="annottext">(UtxosResponse -&gt; ChainIndexResponse)
-&gt; Eff (NonDet : effs) UtxosResponse
-&gt; Eff (NonDet : effs) ChainIndexResponse
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
-&gt; CardanoAddress -&gt; Eff (NonDet : effs) UtxosResponse
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
PageQuery TxOutRef -&gt; CardanoAddress -&gt; Eff effs UtxosResponse
</span><span class="hs-identifier hs-var">ChainIndexEff.utxoSetAtAddress</span></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680558056"><span class="hs-identifier hs-var">pq</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680558055"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-271"></span><span>        </span><span class="annot"><a href="Plutus.Contract.Effects.html#UnspentTxOutSetAtAddress"><span class="hs-identifier hs-type">UnspentTxOutSetAtAddress</span></a></span><span> </span><span id="local-6989586621680558051"><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680558051"><span class="hs-identifier hs-var">pq</span></a></span></span><span> </span><span id="local-6989586621680558050"><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680558050"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QueryResponse [(TxOutRef, DecoratedTxOut)] -&gt; ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#UnspentTxOutsAtResponse"><span class="hs-identifier hs-var">UnspentTxOutsAtResponse</span></a></span><span> </span><span class="annot"><span class="annottext">(QueryResponse [(TxOutRef, DecoratedTxOut)] -&gt; ChainIndexResponse)
-&gt; Eff (NonDet : effs) (QueryResponse [(TxOutRef, DecoratedTxOut)])
-&gt; Eff (NonDet : effs) ChainIndexResponse
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
-&gt; CardanoAddress
-&gt; Eff (NonDet : effs) (QueryResponse [(TxOutRef, DecoratedTxOut)])
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
PageQuery TxOutRef
-&gt; CardanoAddress
-&gt; Eff effs (QueryResponse [(TxOutRef, DecoratedTxOut)])
</span><span class="hs-identifier hs-var">ChainIndexEff.unspentTxOutSetAtAddress</span></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680558051"><span class="hs-identifier hs-var">pq</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680558050"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-272"></span><span>        </span><span class="annot"><a href="Plutus.Contract.Effects.html#DatumsAtAddress"><span class="hs-identifier hs-type">DatumsAtAddress</span></a></span><span> </span><span id="local-6989586621680558046"><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680558046"><span class="hs-identifier hs-var">pq</span></a></span></span><span> </span><span id="local-6989586621680558045"><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680558045"><span class="hs-identifier hs-var">c</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QueryResponse [Datum] -&gt; ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#DatumsAtResponse"><span class="hs-identifier hs-var">DatumsAtResponse</span></a></span><span> </span><span class="annot"><span class="annottext">(QueryResponse [Datum] -&gt; ChainIndexResponse)
-&gt; Eff (NonDet : effs) (QueryResponse [Datum])
-&gt; Eff (NonDet : effs) ChainIndexResponse
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
-&gt; CardanoAddress -&gt; Eff (NonDet : effs) (QueryResponse [Datum])
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
PageQuery TxOutRef
-&gt; CardanoAddress -&gt; Eff effs (QueryResponse [Datum])
</span><span class="hs-identifier hs-var">ChainIndexEff.datumsAtAddress</span></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680558046"><span class="hs-identifier hs-var">pq</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680558045"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-273"></span><span>        </span><span class="annot"><a href="Plutus.Contract.Effects.html#UtxoSetWithCurrency"><span class="hs-identifier hs-type">UtxoSetWithCurrency</span></a></span><span> </span><span id="local-6989586621680558041"><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680558041"><span class="hs-identifier hs-var">pq</span></a></span></span><span> </span><span id="local-6989586621680558040"><span class="annot"><span class="annottext">AssetClass
</span><a href="#local-6989586621680558040"><span class="hs-identifier hs-var">ac</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UtxosResponse -&gt; ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#UtxoSetWithCurrencyResponse"><span class="hs-identifier hs-var">UtxoSetWithCurrencyResponse</span></a></span><span> </span><span class="annot"><span class="annottext">(UtxosResponse -&gt; ChainIndexResponse)
-&gt; Eff (NonDet : effs) UtxosResponse
-&gt; Eff (NonDet : effs) ChainIndexResponse
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
-&gt; AssetClass -&gt; Eff (NonDet : effs) UtxosResponse
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
PageQuery TxOutRef -&gt; AssetClass -&gt; Eff effs UtxosResponse
</span><span class="hs-identifier hs-var">ChainIndexEff.utxoSetWithCurrency</span></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680558041"><span class="hs-identifier hs-var">pq</span></a></span><span> </span><span class="annot"><span class="annottext">AssetClass
</span><a href="#local-6989586621680558040"><span class="hs-identifier hs-var">ac</span></a></span><span>
</span><span id="line-274"></span><span>        </span><span class="annot"><a href="Plutus.Contract.Effects.html#TxoSetAtAddress"><span class="hs-identifier hs-type">TxoSetAtAddress</span></a></span><span> </span><span id="local-6989586621680558036"><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680558036"><span class="hs-identifier hs-var">pq</span></a></span></span><span> </span><span id="local-6989586621680558035"><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680558035"><span class="hs-identifier hs-var">a</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxosResponse -&gt; ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#TxoSetAtResponse"><span class="hs-identifier hs-var">TxoSetAtResponse</span></a></span><span> </span><span class="annot"><span class="annottext">(TxosResponse -&gt; ChainIndexResponse)
-&gt; Eff (NonDet : effs) TxosResponse
-&gt; Eff (NonDet : effs) ChainIndexResponse
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
-&gt; CardanoAddress -&gt; Eff (NonDet : effs) TxosResponse
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
PageQuery TxOutRef -&gt; CardanoAddress -&gt; Eff effs TxosResponse
</span><span class="hs-identifier hs-var">ChainIndexEff.txoSetAtAddress</span></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680558036"><span class="hs-identifier hs-var">pq</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680558035"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-275"></span><span>        </span><span class="annot"><a href="Plutus.Contract.Effects.html#TxsFromTxIds"><span class="hs-identifier hs-type">TxsFromTxIds</span></a></span><span> </span><span id="local-6989586621680558031"><span class="annot"><span class="annottext">[TxId]
</span><a href="#local-6989586621680558031"><span class="hs-identifier hs-var">txids</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ChainIndexTx] -&gt; ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#TxIdsResponse"><span class="hs-identifier hs-var">TxIdsResponse</span></a></span><span> </span><span class="annot"><span class="annottext">([ChainIndexTx] -&gt; ChainIndexResponse)
-&gt; Eff (NonDet : effs) [ChainIndexTx]
-&gt; Eff (NonDet : effs) ChainIndexResponse
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[TxId] -&gt; Eff (NonDet : effs) [ChainIndexTx]
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
[TxId] -&gt; Eff effs [ChainIndexTx]
</span><span class="hs-identifier hs-var">ChainIndexEff.txsFromTxIds</span></span><span> </span><span class="annot"><span class="annottext">[TxId]
</span><a href="#local-6989586621680558031"><span class="hs-identifier hs-var">txids</span></a></span><span>
</span><span id="line-276"></span><span>        </span><span class="annot"><span class="annottext">ChainIndexQuery
</span><a href="Plutus.Contract.Effects.html#GetTip"><span class="hs-identifier hs-var">GetTip</span></a></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Tip -&gt; ChainIndexResponse
</span><a href="Plutus.Contract.Effects.html#GetTipResponse"><span class="hs-identifier hs-var">GetTipResponse</span></a></span><span> </span><span class="annot"><span class="annottext">(Tip -&gt; ChainIndexResponse)
-&gt; Eff (NonDet : effs) Tip
-&gt; Eff (NonDet : effs) ChainIndexResponse
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (NonDet : effs) Tip
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
Eff effs Tip
</span><span class="hs-identifier hs-var">ChainIndexEff.getTip</span></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handleOwnInstanceIdQueries"><span class="hs-identifier hs-type">handleOwnInstanceIdQueries</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-279"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680558026"><span class="annot"><a href="#local-6989586621680558026"><span class="hs-identifier hs-type">effs</span></a></span></span><span> </span><span id="local-6989586621680558025"><span class="annot"><a href="#local-6989586621680558025"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogObserve</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogMessage</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680558026"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-281"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Reader</span></span><span> </span><span class="annot"><a href="Wallet.Types.html#ContractInstanceId"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680558026"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-282"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-type">RequestHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558026"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558025"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Wallet.Types.html#ContractInstanceId"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span>
</span><span id="line-284"></span><span id="handleOwnInstanceIdQueries"><span class="annot"><span class="annottext">handleOwnInstanceIdQueries :: RequestHandler effs a ContractInstanceId
</span><a href="Plutus.Contract.Trace.RequestHandler.html#handleOwnInstanceIdQueries"><span class="hs-identifier hs-var hs-var">handleOwnInstanceIdQueries</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Eff (NonDet : effs) ContractInstanceId)
-&gt; RequestHandler effs a ContractInstanceId
forall (effs :: [* -&gt; *]) req resp.
(req -&gt; Eff (NonDet : effs) resp) -&gt; RequestHandler effs req resp
</span><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-var">RequestHandler</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; Eff (NonDet : effs) ContractInstanceId)
 -&gt; RequestHandler effs a ContractInstanceId)
-&gt; (a -&gt; Eff (NonDet : effs) ContractInstanceId)
-&gt; RequestHandler effs a ContractInstanceId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-285"></span><span>    </span><span class="annot"><span class="annottext">Text
-&gt; Eff (NonDet : effs) ContractInstanceId
-&gt; Eff (NonDet : effs) ContractInstanceId
forall v (effs :: [* -&gt; *]) a.
Member (LogObserve (LogMessage v)) effs =&gt;
v -&gt; Eff effs a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">surroundDebug</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;handleOwnInstanceIdQueries&quot;</span></span><span> </span><span class="annot"><span class="annottext">Eff (NonDet : effs) ContractInstanceId
forall r (effs :: [* -&gt; *]). Member (Reader r) effs =&gt; Eff effs r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handleYieldedUnbalancedTx"><span class="hs-identifier hs-type">handleYieldedUnbalancedTx</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-288"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680558024"><span class="annot"><a href="#local-6989586621680558024"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-289"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="annot"><a href="Wallet.Effects.html#WalletEffect"><span class="hs-identifier hs-type">WalletEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558024"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-290"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogObserve</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogMessage</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680558024"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-type">RequestHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558024"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UnbalancedTx</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span id="handleYieldedUnbalancedTx"><span class="annot"><span class="annottext">handleYieldedUnbalancedTx :: RequestHandler effs UnbalancedTx ()
</span><a href="Plutus.Contract.Trace.RequestHandler.html#handleYieldedUnbalancedTx"><span class="hs-identifier hs-var hs-var">handleYieldedUnbalancedTx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-294"></span><span>    </span><span class="annot"><span class="annottext">(UnbalancedTx -&gt; Eff (NonDet : effs) ())
-&gt; RequestHandler effs UnbalancedTx ()
forall (effs :: [* -&gt; *]) req resp.
(req -&gt; Eff (NonDet : effs) resp) -&gt; RequestHandler effs req resp
</span><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-var">RequestHandler</span></a></span><span> </span><span class="annot"><span class="annottext">((UnbalancedTx -&gt; Eff (NonDet : effs) ())
 -&gt; RequestHandler effs UnbalancedTx ())
-&gt; (UnbalancedTx -&gt; Eff (NonDet : effs) ())
-&gt; RequestHandler effs UnbalancedTx ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680558023"><span class="annot"><span class="annottext">UnbalancedTx
</span><a href="#local-6989586621680558023"><span class="hs-identifier hs-var">utx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-295"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; Eff (NonDet : effs) () -&gt; Eff (NonDet : effs) ()
forall v (effs :: [* -&gt; *]) a.
Member (LogObserve (LogMessage v)) effs =&gt;
v -&gt; Eff effs a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">surroundDebug</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;handleYieldedUnbalancedTx&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Eff (NonDet : effs) () -&gt; Eff (NonDet : effs) ())
-&gt; Eff (NonDet : effs) () -&gt; Eff (NonDet : effs) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-296"></span><span>            </span><span class="annot"><span class="annottext">UnbalancedTx -&gt; Eff (NonDet : effs) ()
forall (effs :: [* -&gt; *]).
Member WalletEffect effs =&gt;
UnbalancedTx -&gt; Eff effs ()
</span><a href="Wallet.Effects.html#yieldUnbalancedTx"><span class="hs-identifier hs-var">Wallet.Effects.yieldUnbalancedTx</span></a></span><span> </span><span class="annot"><span class="annottext">UnbalancedTx
</span><a href="#local-6989586621680558023"><span class="hs-identifier hs-var">utx</span></a></span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handleAdjustUnbalancedTx"><span class="hs-identifier hs-type">handleAdjustUnbalancedTx</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680558021"><span class="annot"><a href="#local-6989586621680558021"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogObserve</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogMessage</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680558021"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-301"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogMsg</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.LogMessages.html#RequestHandlerLogMsg"><span class="hs-identifier hs-type">RequestHandlerLogMsg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680558021"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-302"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="annot"><a href="Wallet.Effects.html#NodeClientEffect"><span class="hs-identifier hs-type">NodeClientEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558021"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-type">RequestHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558021"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UnbalancedTx</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UnbalancedTx</span></span><span>
</span><span id="line-305"></span><span id="handleAdjustUnbalancedTx"><span class="annot"><span class="annottext">handleAdjustUnbalancedTx :: RequestHandler effs UnbalancedTx UnbalancedTx
</span><a href="Plutus.Contract.Trace.RequestHandler.html#handleAdjustUnbalancedTx"><span class="hs-identifier hs-var hs-var">handleAdjustUnbalancedTx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><span class="annottext">(UnbalancedTx -&gt; Eff (NonDet : effs) UnbalancedTx)
-&gt; RequestHandler effs UnbalancedTx UnbalancedTx
forall (effs :: [* -&gt; *]) req resp.
(req -&gt; Eff (NonDet : effs) resp) -&gt; RequestHandler effs req resp
</span><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-var">RequestHandler</span></a></span><span> </span><span class="annot"><span class="annottext">((UnbalancedTx -&gt; Eff (NonDet : effs) UnbalancedTx)
 -&gt; RequestHandler effs UnbalancedTx UnbalancedTx)
-&gt; (UnbalancedTx -&gt; Eff (NonDet : effs) UnbalancedTx)
-&gt; RequestHandler effs UnbalancedTx UnbalancedTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680558020"><span class="annot"><span class="annottext">UnbalancedTx
</span><a href="#local-6989586621680558020"><span class="hs-identifier hs-var">utx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-307"></span><span>        </span><span class="annot"><span class="annottext">Text
-&gt; Eff (NonDet : effs) UnbalancedTx
-&gt; Eff (NonDet : effs) UnbalancedTx
forall v (effs :: [* -&gt; *]) a.
Member (LogObserve (LogMessage v)) effs =&gt;
v -&gt; Eff effs a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">surroundDebug</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;handleAdjustUnbalancedTx&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Eff (NonDet : effs) UnbalancedTx
 -&gt; Eff (NonDet : effs) UnbalancedTx)
-&gt; Eff (NonDet : effs) UnbalancedTx
-&gt; Eff (NonDet : effs) UnbalancedTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-308"></span><span>            </span><span id="local-6989586621680558019"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680558019"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff (NonDet : effs) Params
forall (effs :: [* -&gt; *]).
Member NodeClientEffect effs =&gt;
Eff effs Params
</span><a href="Wallet.Effects.html#getClientParams"><span class="hs-identifier hs-var">getClientParams</span></a></span><span>
</span><span id="line-309"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680558018"><span class="annot"><span class="annottext">[Lovelace]
</span><a href="#local-6989586621680558018"><span class="hs-identifier hs-var">missingAdaCosts</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680558017"><span class="annot"><span class="annottext">UnbalancedTx
</span><a href="#local-6989586621680558017"><span class="hs-identifier hs-var">adjusted</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams -&gt; UnbalancedTx -&gt; ([Lovelace], UnbalancedTx)
</span><span class="hs-identifier hs-var">Constraints.adjustUnbalancedTx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params -&gt; PParams
</span><span class="hs-identifier hs-var hs-var">emulatorPParams</span></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680558019"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UnbalancedTx
</span><a href="#local-6989586621680558020"><span class="hs-identifier hs-var">utx</span></a></span><span>
</span><span id="line-310"></span><span>            </span><span class="annot"><span class="annottext">RequestHandlerLogMsg -&gt; Eff (NonDet : effs) ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><span class="hs-identifier hs-var">logDebug</span></span><span> </span><span class="annot"><span class="annottext">(RequestHandlerLogMsg -&gt; Eff (NonDet : effs) ())
-&gt; RequestHandlerLogMsg -&gt; Eff (NonDet : effs) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Lovelace] -&gt; RequestHandlerLogMsg
</span><a href="Wallet.Emulator.LogMessages.html#AdjustingUnbalancedTx"><span class="hs-identifier hs-var">AdjustingUnbalancedTx</span></a></span><span> </span><span class="annot"><span class="annottext">[Lovelace]
</span><a href="#local-6989586621680558018"><span class="hs-identifier hs-var">missingAdaCosts</span></a></span><span>
</span><span id="line-311"></span><span>            </span><span class="annot"><span class="annottext">UnbalancedTx -&gt; Eff (NonDet : effs) UnbalancedTx
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">UnbalancedTx
</span><a href="#local-6989586621680558017"><span class="hs-identifier hs-var">adjusted</span></a></span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#handleGetParams"><span class="hs-identifier hs-type">handleGetParams</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-314"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680558014"><span class="annot"><a href="#local-6989586621680558014"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-315"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogObserve</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogMessage</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680558014"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-316"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="annot"><a href="Wallet.Effects.html#NodeClientEffect"><span class="hs-identifier hs-type">NodeClientEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558014"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-317"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-type">RequestHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680558014"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Params</span></span><span>
</span><span id="line-319"></span><span id="handleGetParams"><span class="annot"><span class="annottext">handleGetParams :: RequestHandler effs () Params
</span><a href="Plutus.Contract.Trace.RequestHandler.html#handleGetParams"><span class="hs-identifier hs-var hs-var">handleGetParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-320"></span><span>    </span><span class="annot"><span class="annottext">(() -&gt; Eff (NonDet : effs) Params) -&gt; RequestHandler effs () Params
forall (effs :: [* -&gt; *]) req resp.
(req -&gt; Eff (NonDet : effs) resp) -&gt; RequestHandler effs req resp
</span><a href="Plutus.Contract.Trace.RequestHandler.html#RequestHandler"><span class="hs-identifier hs-var">RequestHandler</span></a></span><span> </span><span class="annot"><span class="annottext">((() -&gt; Eff (NonDet : effs) Params)
 -&gt; RequestHandler effs () Params)
-&gt; (() -&gt; Eff (NonDet : effs) Params)
-&gt; RequestHandler effs () Params
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-321"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; Eff (NonDet : effs) Params -&gt; Eff (NonDet : effs) Params
forall v (effs :: [* -&gt; *]) a.
Member (LogObserve (LogMessage v)) effs =&gt;
v -&gt; Eff effs a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">surroundDebug</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;handleGetParams&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Eff (NonDet : effs) Params -&gt; Eff (NonDet : effs) Params)
-&gt; Eff (NonDet : effs) Params -&gt; Eff (NonDet : effs) Params
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-322"></span><span>            </span><span class="annot"><span class="annottext">Eff (NonDet : effs) Params
forall (effs :: [* -&gt; *]).
Member NodeClientEffect effs =&gt;
Eff effs Params
</span><a href="Wallet.Effects.html#getClientParams"><span class="hs-identifier hs-var">getClientParams</span></a></span><span>
</span><span id="line-323"></span></pre></body></html>