<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ConstraintKinds       #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds             #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass        #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies    #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts      #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances     #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE GADTs                 #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase            #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns        #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings     #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms       #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE Rank2Types            #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell       #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE TupleSections         #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications      #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators         #-}</span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-overlapping-patterns #-}</span><span>
</span><span id="line-19"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Wallet.Emulator.MultiAgent</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Api</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Api.Shelley</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Node.Emulator.Generators</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">alwaysSucceedPolicy</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">alwaysSucceedPolicyId</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">signAll</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Node.Emulator.Internal.Node.Chain</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Chain</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Node.Emulator.Internal.Node.Params</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Params</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">AReview</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Getter</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Lens'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Prism'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">anon</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">at</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">folded</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">makeLenses</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">prism'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">reversed</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">review</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">to</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">view</span></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>                     </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator">(&amp;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.~)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(^..)</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Freer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Eff</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Member</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Members</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">interpret</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">send</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">subsume</span></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">type</span><span> </span><span class="annot"><span class="hs-operator">(~&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Freer.Error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Error</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Freer.Extras.Log</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">LogMessage</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">LogMsg</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">LogObserve</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">handleObserveLog</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapLog</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Freer.Extras.Modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">handleZoomedState</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">raiseEnd</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">writeIntoState</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Freer.State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">State</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">FromJSON</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ToJSON</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">fold</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">fromMaybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">isNothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Address</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PaymentPubKeyHash</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">pubKeyHashAddress</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.AddressMap</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">AM</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Blockchain</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Blockchain</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Index</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">minAdaTxOut</span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Index</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Index</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Scripts</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MintingPolicy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">getMintingPolicy</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Slot</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Slot</span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Tx.CardanoAPI</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ToCardanoError</span></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><span class="hs-identifier">CardanoEmulatorEraTx</span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Tx.CardanoAPI.Internal</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toCardanoPlutusScript</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">toCardanoValidityRange</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">zeroExecutionUnits</span></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Tx.CardanoAPI.Internal</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CardanoAPI</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toCardanoAddressInEra</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">toCardanoTxOutValue</span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Tx.Internal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">TxOut</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">TxOut</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">emptyTxBodyContent</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">txOutValue</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Tx.Internal</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Tx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">TxOut</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">getTxOut</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Value.CardanoAPI</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lovelaceToValue</span></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Value.CardanoAPI</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CardanoAPI</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.ChainIndex.ChainIndexError</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ChainIndex</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ChainIndexError</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.ChainIndex.ChainIndexLog</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ChainIndex</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ChainIndexLog</span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.ChainIndex.Effects</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ChainIndex</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ChainIndexControlEffect</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ChainIndexQueryEffect</span></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.ChainIndex.Emulator.Handlers</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ChainIndex</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">handleControl</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">handleQuery</span></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.Trace.Emulator.Types.html"><span class="hs-identifier">Plutus.Trace.Emulator.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Trace.Emulator.Types.html#ContractInstanceLog"><span class="hs-identifier">ContractInstanceLog</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Trace.Emulator.Types.html#EmulatedWalletEffects"><span class="hs-identifier">EmulatedWalletEffects</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Trace.Emulator.Types.html#EmulatedWalletEffects%27"><span class="hs-identifier">EmulatedWalletEffects'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Trace.Emulator.Types.html#UserThreadMsg"><span class="hs-identifier">UserThreadMsg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.Trace.Scheduler.html"><span class="hs-identifier">Plutus.Trace.Scheduler</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Scheduler</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.V1.Ledger.Scripts</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Script</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PlutusTx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toData</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prettyprinter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">pretty</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">colon</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;+&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Wallet.API.html"><span class="hs-identifier">Wallet.API</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">WAPI</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Wallet.Emulator.LogMessages.html"><span class="hs-identifier">Wallet.Emulator.LogMessages</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Wallet.Emulator.LogMessages.html#RequestHandlerLogMsg"><span class="hs-identifier">RequestHandlerLogMsg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxBalanceMsg</span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Wallet.Emulator.NodeClient.html"><span class="hs-identifier">Wallet.Emulator.NodeClient</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NC</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Wallet.Emulator.Wallet.html"><span class="hs-identifier">Wallet.Emulator.Wallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Wallet.Emulator.Wallet.html#Wallet"><span class="hs-identifier">Wallet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Wallet.Emulator.Wallet.html"><span class="hs-identifier">Wallet.Emulator.Wallet</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><a href="Wallet.html"><span class="hs-identifier">Wallet</span></a></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">-- | An event with a timestamp measured in emulator time</span><span>
</span><span id="line-70"></span><span class="hs-comment">--   (currently: 'Slot')</span><span>
</span><span id="line-71"></span><span id="local-6989586621680563234"><span id="local-6989586621680563235"></span></span><span class="hs-keyword">data</span><span> </span><span id="EmulatorTimeEvent"><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorTimeEvent"><span class="hs-identifier hs-var">EmulatorTimeEvent</span></a></span></span><span> </span><span id="local-6989586621680563628"><span class="annot"><a href="#local-6989586621680563628"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-72"></span><span>    </span><span id="EmulatorTimeEvent"><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorTimeEvent"><span class="hs-identifier hs-var">EmulatorTimeEvent</span></a></span></span><span>
</span><span id="line-73"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="_eteEmulatorTime"><span class="annot"><span class="annottext">EmulatorTimeEvent e -&gt; Slot
</span><a href="Wallet.Emulator.MultiAgent.html#_eteEmulatorTime"><span class="hs-identifier hs-var hs-var">_eteEmulatorTime</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Slot</span></span><span>
</span><span id="line-74"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_eteEvent"><span class="annot"><span class="annottext">EmulatorTimeEvent e -&gt; e
</span><a href="Wallet.Emulator.MultiAgent.html#_eteEvent"><span class="hs-identifier hs-var hs-var">_eteEvent</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680563628"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-75"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680563227"><span id="local-6989586621680563229"><span class="annot"><span class="annottext">EmulatorTimeEvent e -&gt; EmulatorTimeEvent e -&gt; Bool
(EmulatorTimeEvent e -&gt; EmulatorTimeEvent e -&gt; Bool)
-&gt; (EmulatorTimeEvent e -&gt; EmulatorTimeEvent e -&gt; Bool)
-&gt; Eq (EmulatorTimeEvent e)
forall e.
Eq e =&gt;
EmulatorTimeEvent e -&gt; EmulatorTimeEvent e -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: EmulatorTimeEvent e -&gt; EmulatorTimeEvent e -&gt; Bool
$c/= :: forall e.
Eq e =&gt;
EmulatorTimeEvent e -&gt; EmulatorTimeEvent e -&gt; Bool
== :: EmulatorTimeEvent e -&gt; EmulatorTimeEvent e -&gt; Bool
$c== :: forall e.
Eq e =&gt;
EmulatorTimeEvent e -&gt; EmulatorTimeEvent e -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680563220"><span id="local-6989586621680563222"><span id="local-6989586621680563224"><span class="annot"><span class="annottext">Int -&gt; EmulatorTimeEvent e -&gt; ShowS
[EmulatorTimeEvent e] -&gt; ShowS
EmulatorTimeEvent e -&gt; String
(Int -&gt; EmulatorTimeEvent e -&gt; ShowS)
-&gt; (EmulatorTimeEvent e -&gt; String)
-&gt; ([EmulatorTimeEvent e] -&gt; ShowS)
-&gt; Show (EmulatorTimeEvent e)
forall e. Show e =&gt; Int -&gt; EmulatorTimeEvent e -&gt; ShowS
forall e. Show e =&gt; [EmulatorTimeEvent e] -&gt; ShowS
forall e. Show e =&gt; EmulatorTimeEvent e -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [EmulatorTimeEvent e] -&gt; ShowS
$cshowList :: forall e. Show e =&gt; [EmulatorTimeEvent e] -&gt; ShowS
show :: EmulatorTimeEvent e -&gt; String
$cshow :: forall e. Show e =&gt; EmulatorTimeEvent e -&gt; String
showsPrec :: Int -&gt; EmulatorTimeEvent e -&gt; ShowS
$cshowsPrec :: forall e. Show e =&gt; Int -&gt; EmulatorTimeEvent e -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. EmulatorTimeEvent e -&gt; Rep (EmulatorTimeEvent e) x)
-&gt; (forall x. Rep (EmulatorTimeEvent e) x -&gt; EmulatorTimeEvent e)
-&gt; Generic (EmulatorTimeEvent e)
forall x. Rep (EmulatorTimeEvent e) x -&gt; EmulatorTimeEvent e
forall x. EmulatorTimeEvent e -&gt; Rep (EmulatorTimeEvent e) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall e x. Rep (EmulatorTimeEvent e) x -&gt; EmulatorTimeEvent e
forall e x. EmulatorTimeEvent e -&gt; Rep (EmulatorTimeEvent e) x
$cto :: forall e x. Rep (EmulatorTimeEvent e) x -&gt; EmulatorTimeEvent e
$cfrom :: forall e x. EmulatorTimeEvent e -&gt; Rep (EmulatorTimeEvent e) x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680563212"><span id="local-6989586621680563214"><span class="annot"><span class="annottext">a -&gt; EmulatorTimeEvent b -&gt; EmulatorTimeEvent a
(a -&gt; b) -&gt; EmulatorTimeEvent a -&gt; EmulatorTimeEvent b
(forall a b.
 (a -&gt; b) -&gt; EmulatorTimeEvent a -&gt; EmulatorTimeEvent b)
-&gt; (forall a b. a -&gt; EmulatorTimeEvent b -&gt; EmulatorTimeEvent a)
-&gt; Functor EmulatorTimeEvent
forall a b. a -&gt; EmulatorTimeEvent b -&gt; EmulatorTimeEvent a
forall a b. (a -&gt; b) -&gt; EmulatorTimeEvent a -&gt; EmulatorTimeEvent b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; EmulatorTimeEvent b -&gt; EmulatorTimeEvent a
$c&lt;$ :: forall a b. a -&gt; EmulatorTimeEvent b -&gt; EmulatorTimeEvent a
fmap :: (a -&gt; b) -&gt; EmulatorTimeEvent a -&gt; EmulatorTimeEvent b
$cfmap :: forall a b. (a -&gt; b) -&gt; EmulatorTimeEvent a -&gt; EmulatorTimeEvent b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680563177"><span id="local-6989586621680563179"><span id="local-6989586621680563181"><span id="local-6989586621680563183"><span id="local-6989586621680563185"><span id="local-6989586621680563187"><span id="local-6989586621680563189"><span id="local-6989586621680563191"><span id="local-6989586621680563193"><span id="local-6989586621680563195"><span id="local-6989586621680563197"><span id="local-6989586621680563199"><span id="local-6989586621680563201"><span id="local-6989586621680563203"><span id="local-6989586621680563205"><span id="local-6989586621680563207"><span id="local-6989586621680563209"><span class="annot"><span class="annottext">EmulatorTimeEvent a -&gt; Bool
(a -&gt; m) -&gt; EmulatorTimeEvent a -&gt; m
(a -&gt; b -&gt; b) -&gt; b -&gt; EmulatorTimeEvent a -&gt; b
(forall m. Monoid m =&gt; EmulatorTimeEvent m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; EmulatorTimeEvent a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; EmulatorTimeEvent a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; EmulatorTimeEvent a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; EmulatorTimeEvent a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; EmulatorTimeEvent a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; EmulatorTimeEvent a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; EmulatorTimeEvent a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; EmulatorTimeEvent a -&gt; a)
-&gt; (forall a. EmulatorTimeEvent a -&gt; [a])
-&gt; (forall a. EmulatorTimeEvent a -&gt; Bool)
-&gt; (forall a. EmulatorTimeEvent a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; EmulatorTimeEvent a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; EmulatorTimeEvent a -&gt; a)
-&gt; (forall a. Ord a =&gt; EmulatorTimeEvent a -&gt; a)
-&gt; (forall a. Num a =&gt; EmulatorTimeEvent a -&gt; a)
-&gt; (forall a. Num a =&gt; EmulatorTimeEvent a -&gt; a)
-&gt; Foldable EmulatorTimeEvent
forall a. Eq a =&gt; a -&gt; EmulatorTimeEvent a -&gt; Bool
forall a. Num a =&gt; EmulatorTimeEvent a -&gt; a
forall a. Ord a =&gt; EmulatorTimeEvent a -&gt; a
forall m. Monoid m =&gt; EmulatorTimeEvent m -&gt; m
forall a. EmulatorTimeEvent a -&gt; Bool
forall a. EmulatorTimeEvent a -&gt; Int
forall a. EmulatorTimeEvent a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; EmulatorTimeEvent a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; EmulatorTimeEvent a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; EmulatorTimeEvent a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; EmulatorTimeEvent a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
product :: EmulatorTimeEvent a -&gt; a
$cproduct :: forall a. Num a =&gt; EmulatorTimeEvent a -&gt; a
sum :: EmulatorTimeEvent a -&gt; a
$csum :: forall a. Num a =&gt; EmulatorTimeEvent a -&gt; a
minimum :: EmulatorTimeEvent a -&gt; a
$cminimum :: forall a. Ord a =&gt; EmulatorTimeEvent a -&gt; a
maximum :: EmulatorTimeEvent a -&gt; a
$cmaximum :: forall a. Ord a =&gt; EmulatorTimeEvent a -&gt; a
elem :: a -&gt; EmulatorTimeEvent a -&gt; Bool
$celem :: forall a. Eq a =&gt; a -&gt; EmulatorTimeEvent a -&gt; Bool
length :: EmulatorTimeEvent a -&gt; Int
$clength :: forall a. EmulatorTimeEvent a -&gt; Int
null :: EmulatorTimeEvent a -&gt; Bool
$cnull :: forall a. EmulatorTimeEvent a -&gt; Bool
toList :: EmulatorTimeEvent a -&gt; [a]
$ctoList :: forall a. EmulatorTimeEvent a -&gt; [a]
foldl1 :: (a -&gt; a -&gt; a) -&gt; EmulatorTimeEvent a -&gt; a
$cfoldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; EmulatorTimeEvent a -&gt; a
foldr1 :: (a -&gt; a -&gt; a) -&gt; EmulatorTimeEvent a -&gt; a
$cfoldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; EmulatorTimeEvent a -&gt; a
foldl' :: (b -&gt; a -&gt; b) -&gt; b -&gt; EmulatorTimeEvent a -&gt; b
$cfoldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; EmulatorTimeEvent a -&gt; b
foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; EmulatorTimeEvent a -&gt; b
$cfoldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; EmulatorTimeEvent a -&gt; b
foldr' :: (a -&gt; b -&gt; b) -&gt; b -&gt; EmulatorTimeEvent a -&gt; b
$cfoldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; EmulatorTimeEvent a -&gt; b
foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; EmulatorTimeEvent a -&gt; b
$cfoldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; EmulatorTimeEvent a -&gt; b
foldMap' :: (a -&gt; m) -&gt; EmulatorTimeEvent a -&gt; m
$cfoldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; EmulatorTimeEvent a -&gt; m
foldMap :: (a -&gt; m) -&gt; EmulatorTimeEvent a -&gt; m
$cfoldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; EmulatorTimeEvent a -&gt; m
fold :: EmulatorTimeEvent m -&gt; m
$cfold :: forall m. Monoid m =&gt; EmulatorTimeEvent m -&gt; m
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680563166"><span id="local-6989586621680563168"><span id="local-6989586621680563170"><span id="local-6989586621680563172"><span class="annot"><span class="annottext">Functor EmulatorTimeEvent
Foldable EmulatorTimeEvent
Functor EmulatorTimeEvent
-&gt; Foldable EmulatorTimeEvent
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; EmulatorTimeEvent a -&gt; f (EmulatorTimeEvent b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    EmulatorTimeEvent (f a) -&gt; f (EmulatorTimeEvent a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; EmulatorTimeEvent a -&gt; m (EmulatorTimeEvent b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    EmulatorTimeEvent (m a) -&gt; m (EmulatorTimeEvent a))
-&gt; Traversable EmulatorTimeEvent
(a -&gt; f b) -&gt; EmulatorTimeEvent a -&gt; f (EmulatorTimeEvent b)
forall (t :: * -&gt; *).
Functor t
-&gt; Foldable t
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a.
Monad m =&gt;
EmulatorTimeEvent (m a) -&gt; m (EmulatorTimeEvent a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
EmulatorTimeEvent (f a) -&gt; f (EmulatorTimeEvent a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; EmulatorTimeEvent a -&gt; m (EmulatorTimeEvent b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; EmulatorTimeEvent a -&gt; f (EmulatorTimeEvent b)
sequence :: EmulatorTimeEvent (m a) -&gt; m (EmulatorTimeEvent a)
$csequence :: forall (m :: * -&gt; *) a.
Monad m =&gt;
EmulatorTimeEvent (m a) -&gt; m (EmulatorTimeEvent a)
mapM :: (a -&gt; m b) -&gt; EmulatorTimeEvent a -&gt; m (EmulatorTimeEvent b)
$cmapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; EmulatorTimeEvent a -&gt; m (EmulatorTimeEvent b)
sequenceA :: EmulatorTimeEvent (f a) -&gt; f (EmulatorTimeEvent a)
$csequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
EmulatorTimeEvent (f a) -&gt; f (EmulatorTimeEvent a)
traverse :: (a -&gt; f b) -&gt; EmulatorTimeEvent a -&gt; f (EmulatorTimeEvent b)
$ctraverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; EmulatorTimeEvent a -&gt; f (EmulatorTimeEvent b)
$cp2Traversable :: Foldable EmulatorTimeEvent
$cp1Traversable :: Functor EmulatorTimeEvent
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></a></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680563157"><span id="local-6989586621680563159"><span id="local-6989586621680563161"><span id="local-6989586621680563163"><span class="annot"><span class="annottext">[EmulatorTimeEvent e] -&gt; Encoding
[EmulatorTimeEvent e] -&gt; Value
EmulatorTimeEvent e -&gt; Encoding
EmulatorTimeEvent e -&gt; Value
(EmulatorTimeEvent e -&gt; Value)
-&gt; (EmulatorTimeEvent e -&gt; Encoding)
-&gt; ([EmulatorTimeEvent e] -&gt; Value)
-&gt; ([EmulatorTimeEvent e] -&gt; Encoding)
-&gt; ToJSON (EmulatorTimeEvent e)
forall e. ToJSON e =&gt; [EmulatorTimeEvent e] -&gt; Encoding
forall e. ToJSON e =&gt; [EmulatorTimeEvent e] -&gt; Value
forall e. ToJSON e =&gt; EmulatorTimeEvent e -&gt; Encoding
forall e. ToJSON e =&gt; EmulatorTimeEvent e -&gt; Value
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [EmulatorTimeEvent e] -&gt; Encoding
$ctoEncodingList :: forall e. ToJSON e =&gt; [EmulatorTimeEvent e] -&gt; Encoding
toJSONList :: [EmulatorTimeEvent e] -&gt; Value
$ctoJSONList :: forall e. ToJSON e =&gt; [EmulatorTimeEvent e] -&gt; Value
toEncoding :: EmulatorTimeEvent e -&gt; Encoding
$ctoEncoding :: forall e. ToJSON e =&gt; EmulatorTimeEvent e -&gt; Encoding
toJSON :: EmulatorTimeEvent e -&gt; Value
$ctoJSON :: forall e. ToJSON e =&gt; EmulatorTimeEvent e -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680563152"><span id="local-6989586621680563154"><span class="annot"><span class="annottext">Value -&gt; Parser [EmulatorTimeEvent e]
Value -&gt; Parser (EmulatorTimeEvent e)
(Value -&gt; Parser (EmulatorTimeEvent e))
-&gt; (Value -&gt; Parser [EmulatorTimeEvent e])
-&gt; FromJSON (EmulatorTimeEvent e)
forall e. FromJSON e =&gt; Value -&gt; Parser [EmulatorTimeEvent e]
forall e. FromJSON e =&gt; Value -&gt; Parser (EmulatorTimeEvent e)
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [EmulatorTimeEvent e]
$cparseJSONList :: forall e. FromJSON e =&gt; Value -&gt; Parser [EmulatorTimeEvent e]
parseJSON :: Value -&gt; Parser (EmulatorTimeEvent e)
$cparseJSON :: forall e. FromJSON e =&gt; Value -&gt; Parser (EmulatorTimeEvent e)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span id="eteEvent"><span id="eteEmulatorTime"><span id="local-6989586621680563150"><span id="local-6989586621680563628"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">EmulatorTimeEvent</span></span></span></span></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span id="local-6989586621680563147"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680563144"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621680563147"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorTimeEvent"><span class="hs-identifier hs-type">EmulatorTimeEvent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680563147"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-82"></span><span>    </span><span id="local-6989586621680563142"><span class="annot"><span class="annottext">pretty :: EmulatorTimeEvent e -&gt; Doc ann
</span><a href="#local-6989586621680563142"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorTimeEvent"><span class="hs-identifier hs-type">EmulatorTimeEvent</span></a></span><span class="hs-special">{</span><span id="local-6989586621680563141"><span class="annot"><span class="annottext">Slot
_eteEmulatorTime :: Slot
_eteEmulatorTime :: forall e. EmulatorTimeEvent e -&gt; Slot
</span><a href="#local-6989586621680563141"><span class="hs-identifier hs-var hs-var">_eteEmulatorTime</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680563140"><span class="annot"><span class="annottext">e
_eteEvent :: e
_eteEvent :: forall e. EmulatorTimeEvent e -&gt; e
</span><a href="#local-6989586621680563140"><span class="hs-identifier hs-var hs-var">_eteEvent</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-83"></span><span>        </span><span class="annot"><span class="annottext">Slot -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680563141"><span class="hs-identifier hs-var">_eteEmulatorTime</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">colon</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">e -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680563140"><span class="hs-identifier hs-var">_eteEvent</span></a></span></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span id="local-6989586621680563139"><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#emulatorTimeEvent"><span class="hs-identifier hs-type">emulatorTimeEvent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Slot</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prism'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorTimeEvent"><span class="hs-identifier hs-type">EmulatorTimeEvent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680563139"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680563139"><span class="hs-identifier hs-type">e</span></a></span></span><span>
</span><span id="line-86"></span><span id="emulatorTimeEvent"><span class="annot"><span class="annottext">emulatorTimeEvent :: Slot -&gt; Prism' (EmulatorTimeEvent e) e
</span><a href="Wallet.Emulator.MultiAgent.html#emulatorTimeEvent"><span class="hs-identifier hs-var hs-var">emulatorTimeEvent</span></a></span></span><span> </span><span id="local-6989586621680563137"><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680563137"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(e -&gt; EmulatorTimeEvent e)
-&gt; (EmulatorTimeEvent e -&gt; Maybe e)
-&gt; Prism' (EmulatorTimeEvent e) e
forall b s a. (b -&gt; s) -&gt; (s -&gt; Maybe a) -&gt; Prism s s a b
</span><span class="hs-identifier hs-var">prism'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Slot -&gt; e -&gt; EmulatorTimeEvent e
forall e. Slot -&gt; e -&gt; EmulatorTimeEvent e
</span><a href="Wallet.Emulator.MultiAgent.html#EmulatorTimeEvent"><span class="hs-identifier hs-var">EmulatorTimeEvent</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680563137"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorTimeEvent"><span class="hs-identifier hs-type">EmulatorTimeEvent</span></a></span><span> </span><span id="local-6989586621680563136"><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680563136"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621680563135"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680563135"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680563136"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Slot -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680563137"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e -&gt; Maybe e
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680563135"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">EmulatorTimeEvent e
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe e
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-comment">-- | Events produced by the blockchain emulator.</span><span>
</span><span id="line-89"></span><span id="local-6989586621680563133"><span id="local-6989586621680563134"></span></span><span class="hs-keyword">data</span><span> </span><span id="EmulatorEvent%27"><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorEvent%27"><span class="hs-identifier hs-var">EmulatorEvent'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-90"></span><span>    </span><span id="ChainEvent"><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#ChainEvent"><span class="hs-identifier hs-var">ChainEvent</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Chain.ChainEvent</span></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="ClientEvent"><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#ClientEvent"><span class="hs-identifier hs-var">ClientEvent</span></a></span></span><span> </span><span class="annot"><a href="Wallet.Emulator.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="annot"><a href="Wallet.Emulator.NodeClient.html#NodeClientEvent"><span class="hs-identifier hs-type">NC.NodeClientEvent</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="WalletEvent"><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#WalletEvent"><span class="hs-identifier hs-var">WalletEvent</span></a></span></span><span> </span><span class="annot"><a href="Wallet.Emulator.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="annot"><a href="Wallet.Emulator.Wallet.html#WalletEvent"><span class="hs-identifier hs-type">Wallet.WalletEvent</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="ChainIndexEvent"><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#ChainIndexEvent"><span class="hs-identifier hs-var">ChainIndexEvent</span></a></span></span><span> </span><span class="annot"><a href="Wallet.Emulator.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChainIndex.ChainIndexLog</span></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="SchedulerEvent"><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#SchedulerEvent"><span class="hs-identifier hs-var">SchedulerEvent</span></a></span></span><span> </span><span class="annot"><a href="Plutus.Trace.Scheduler.html#SchedulerLog"><span class="hs-identifier hs-type">Scheduler.SchedulerLog</span></a></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="InstanceEvent"><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#InstanceEvent"><span class="hs-identifier hs-var">InstanceEvent</span></a></span></span><span> </span><span class="annot"><a href="Plutus.Trace.Emulator.Types.html#ContractInstanceLog"><span class="hs-identifier hs-type">ContractInstanceLog</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="UserThreadEvent"><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#UserThreadEvent"><span class="hs-identifier hs-var">UserThreadEvent</span></a></span></span><span> </span><span class="annot"><a href="Plutus.Trace.Emulator.Types.html#UserThreadMsg"><span class="hs-identifier hs-type">UserThreadMsg</span></a></span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680563122"><span id="local-6989586621680563124"><span class="annot"><span class="annottext">EmulatorEvent' -&gt; EmulatorEvent' -&gt; Bool
(EmulatorEvent' -&gt; EmulatorEvent' -&gt; Bool)
-&gt; (EmulatorEvent' -&gt; EmulatorEvent' -&gt; Bool) -&gt; Eq EmulatorEvent'
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: EmulatorEvent' -&gt; EmulatorEvent' -&gt; Bool
$c/= :: EmulatorEvent' -&gt; EmulatorEvent' -&gt; Bool
== :: EmulatorEvent' -&gt; EmulatorEvent' -&gt; Bool
$c== :: EmulatorEvent' -&gt; EmulatorEvent' -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680563116"><span id="local-6989586621680563118"><span id="local-6989586621680563120"><span class="annot"><span class="annottext">Int -&gt; EmulatorEvent' -&gt; ShowS
[EmulatorEvent'] -&gt; ShowS
EmulatorEvent' -&gt; String
(Int -&gt; EmulatorEvent' -&gt; ShowS)
-&gt; (EmulatorEvent' -&gt; String)
-&gt; ([EmulatorEvent'] -&gt; ShowS)
-&gt; Show EmulatorEvent'
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [EmulatorEvent'] -&gt; ShowS
$cshowList :: [EmulatorEvent'] -&gt; ShowS
show :: EmulatorEvent' -&gt; String
$cshow :: EmulatorEvent' -&gt; String
showsPrec :: Int -&gt; EmulatorEvent' -&gt; ShowS
$cshowsPrec :: Int -&gt; EmulatorEvent' -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. EmulatorEvent' -&gt; Rep EmulatorEvent' x)
-&gt; (forall x. Rep EmulatorEvent' x -&gt; EmulatorEvent')
-&gt; Generic EmulatorEvent'
forall x. Rep EmulatorEvent' x -&gt; EmulatorEvent'
forall x. EmulatorEvent' -&gt; Rep EmulatorEvent' x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep EmulatorEvent' x -&gt; EmulatorEvent'
$cfrom :: forall x. EmulatorEvent' -&gt; Rep EmulatorEvent' x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680563106"><span id="local-6989586621680563108"><span id="local-6989586621680563110"><span id="local-6989586621680563112"><span class="annot"><span class="annottext">[EmulatorEvent'] -&gt; Encoding
[EmulatorEvent'] -&gt; Value
EmulatorEvent' -&gt; Encoding
EmulatorEvent' -&gt; Value
(EmulatorEvent' -&gt; Value)
-&gt; (EmulatorEvent' -&gt; Encoding)
-&gt; ([EmulatorEvent'] -&gt; Value)
-&gt; ([EmulatorEvent'] -&gt; Encoding)
-&gt; ToJSON EmulatorEvent'
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [EmulatorEvent'] -&gt; Encoding
$ctoEncodingList :: [EmulatorEvent'] -&gt; Encoding
toJSONList :: [EmulatorEvent'] -&gt; Value
$ctoJSONList :: [EmulatorEvent'] -&gt; Value
toEncoding :: EmulatorEvent' -&gt; Encoding
$ctoEncoding :: EmulatorEvent' -&gt; Encoding
toJSON :: EmulatorEvent' -&gt; Value
$ctoJSON :: EmulatorEvent' -&gt; Value
</span><a href="#local-6989586621680563106"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></a></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680563102"><span id="local-6989586621680563104"><span class="annot"><span class="annottext">Value -&gt; Parser [EmulatorEvent']
Value -&gt; Parser EmulatorEvent'
(Value -&gt; Parser EmulatorEvent')
-&gt; (Value -&gt; Parser [EmulatorEvent']) -&gt; FromJSON EmulatorEvent'
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [EmulatorEvent']
$cparseJSONList :: Value -&gt; Parser [EmulatorEvent']
parseJSON :: Value -&gt; Parser EmulatorEvent'
$cparseJSON :: Value -&gt; Parser EmulatorEvent'
</span><a href="#local-6989586621680563102"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680563099"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorEvent%27"><span class="hs-identifier hs-type">EmulatorEvent'</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-101"></span><span>    </span><span id="local-6989586621680563098"><span class="annot"><span class="annottext">pretty :: EmulatorEvent' -&gt; Doc ann
</span><a href="#local-6989586621680563098"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-102"></span><span>        </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#ClientEvent"><span class="hs-identifier hs-type">ClientEvent</span></a></span><span> </span><span id="local-6989586621680563097"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563097"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621680563096"><span class="annot"><span class="annottext">NodeClientEvent
</span><a href="#local-6989586621680563096"><span class="hs-identifier hs-var">e</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563097"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">colon</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">NodeClientEvent -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">NodeClientEvent
</span><a href="#local-6989586621680563096"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-103"></span><span>        </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#ChainEvent"><span class="hs-identifier hs-type">ChainEvent</span></a></span><span> </span><span id="local-6989586621680563095"><span class="annot"><span class="annottext">ChainEvent
</span><a href="#local-6989586621680563095"><span class="hs-identifier hs-var">e</span></a></span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ChainEvent -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">ChainEvent
</span><a href="#local-6989586621680563095"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-104"></span><span>        </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#WalletEvent"><span class="hs-identifier hs-type">WalletEvent</span></a></span><span> </span><span id="local-6989586621680563094"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563094"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621680563093"><span class="annot"><span class="annottext">WalletEvent
</span><a href="#local-6989586621680563093"><span class="hs-identifier hs-var">e</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563094"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">colon</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">WalletEvent -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">WalletEvent
</span><a href="#local-6989586621680563093"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-105"></span><span>        </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#ChainIndexEvent"><span class="hs-identifier hs-type">ChainIndexEvent</span></a></span><span> </span><span id="local-6989586621680563092"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563092"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621680563091"><span class="annot"><span class="annottext">ChainIndexLog
</span><a href="#local-6989586621680563091"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563092"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">colon</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">ChainIndexLog -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">ChainIndexLog
</span><a href="#local-6989586621680563091"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-106"></span><span>        </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#SchedulerEvent"><span class="hs-identifier hs-type">SchedulerEvent</span></a></span><span> </span><span id="local-6989586621680563090"><span class="annot"><span class="annottext">SchedulerLog
</span><a href="#local-6989586621680563090"><span class="hs-identifier hs-var">e</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SchedulerLog -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">SchedulerLog
</span><a href="#local-6989586621680563090"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-107"></span><span>        </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#InstanceEvent"><span class="hs-identifier hs-type">InstanceEvent</span></a></span><span> </span><span id="local-6989586621680563089"><span class="annot"><span class="annottext">ContractInstanceLog
</span><a href="#local-6989586621680563089"><span class="hs-identifier hs-var">e</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ContractInstanceLog -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">ContractInstanceLog
</span><a href="#local-6989586621680563089"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-108"></span><span>        </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#UserThreadEvent"><span class="hs-identifier hs-type">UserThreadEvent</span></a></span><span> </span><span id="local-6989586621680563088"><span class="annot"><span class="annottext">UserThreadMsg
</span><a href="#local-6989586621680563088"><span class="hs-identifier hs-var">e</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UserThreadMsg -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">UserThreadMsg
</span><a href="#local-6989586621680563088"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-keyword">type</span><span> </span><span id="EmulatorEvent"><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorEvent"><span class="hs-identifier hs-var">EmulatorEvent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorTimeEvent"><span class="hs-identifier hs-type">EmulatorTimeEvent</span></a></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorEvent%27"><span class="hs-identifier hs-type">EmulatorEvent'</span></a></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#chainEvent"><span class="hs-identifier hs-type">chainEvent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prism'</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorEvent%27"><span class="hs-identifier hs-type">EmulatorEvent'</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Chain.ChainEvent</span></span><span>
</span><span id="line-113"></span><span id="chainEvent"><span class="annot"><span class="annottext">chainEvent :: p ChainEvent (f ChainEvent) -&gt; p EmulatorEvent' (f EmulatorEvent')
</span><a href="Wallet.Emulator.MultiAgent.html#chainEvent"><span class="hs-identifier hs-var hs-var">chainEvent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ChainEvent -&gt; EmulatorEvent')
-&gt; (EmulatorEvent' -&gt; Maybe ChainEvent)
-&gt; Prism EmulatorEvent' EmulatorEvent' ChainEvent ChainEvent
forall b s a. (b -&gt; s) -&gt; (s -&gt; Maybe a) -&gt; Prism s s a b
</span><span class="hs-identifier hs-var">prism'</span></span><span> </span><span class="annot"><span class="annottext">ChainEvent -&gt; EmulatorEvent'
</span><a href="Wallet.Emulator.MultiAgent.html#ChainEvent"><span class="hs-identifier hs-var">ChainEvent</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#ChainEvent"><span class="hs-identifier hs-type">ChainEvent</span></a></span><span> </span><span id="local-6989586621680563086"><span class="annot"><span class="annottext">ChainEvent
</span><a href="#local-6989586621680563086"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ChainEvent -&gt; Maybe ChainEvent
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ChainEvent
</span><a href="#local-6989586621680563086"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">EmulatorEvent'
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ChainEvent
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#walletClientEvent"><span class="hs-identifier hs-type">walletClientEvent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Wallet.Emulator.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prism'</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorEvent%27"><span class="hs-identifier hs-type">EmulatorEvent'</span></a></span><span> </span><span class="annot"><a href="Wallet.Emulator.NodeClient.html#NodeClientEvent"><span class="hs-identifier hs-type">NC.NodeClientEvent</span></a></span><span>
</span><span id="line-116"></span><span id="walletClientEvent"><span class="annot"><span class="annottext">walletClientEvent :: Wallet -&gt; Prism' EmulatorEvent' NodeClientEvent
</span><a href="Wallet.Emulator.MultiAgent.html#walletClientEvent"><span class="hs-identifier hs-var hs-var">walletClientEvent</span></a></span></span><span> </span><span id="local-6989586621680563084"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563084"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NodeClientEvent -&gt; EmulatorEvent')
-&gt; (EmulatorEvent' -&gt; Maybe NodeClientEvent)
-&gt; Prism' EmulatorEvent' NodeClientEvent
forall b s a. (b -&gt; s) -&gt; (s -&gt; Maybe a) -&gt; Prism s s a b
</span><span class="hs-identifier hs-var">prism'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; NodeClientEvent -&gt; EmulatorEvent'
</span><a href="Wallet.Emulator.MultiAgent.html#ClientEvent"><span class="hs-identifier hs-var">ClientEvent</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563084"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#ClientEvent"><span class="hs-identifier hs-type">ClientEvent</span></a></span><span> </span><span id="local-6989586621680563083"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563083"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span id="local-6989586621680563082"><span class="annot"><span class="annottext">NodeClientEvent
</span><a href="#local-6989586621680563082"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563084"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Wallet -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563083"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NodeClientEvent -&gt; Maybe NodeClientEvent
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">NodeClientEvent
</span><a href="#local-6989586621680563082"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">EmulatorEvent'
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe NodeClientEvent
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#walletEvent"><span class="hs-identifier hs-type">walletEvent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Wallet.Emulator.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prism'</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorEvent%27"><span class="hs-identifier hs-type">EmulatorEvent'</span></a></span><span> </span><span class="annot"><a href="Wallet.Emulator.Wallet.html#WalletEvent"><span class="hs-identifier hs-type">Wallet.WalletEvent</span></a></span><span>
</span><span id="line-119"></span><span id="walletEvent"><span class="annot"><span class="annottext">walletEvent :: Wallet -&gt; Prism' EmulatorEvent' WalletEvent
</span><a href="Wallet.Emulator.MultiAgent.html#walletEvent"><span class="hs-identifier hs-var hs-var">walletEvent</span></a></span></span><span> </span><span id="local-6989586621680563080"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563080"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WalletEvent -&gt; EmulatorEvent')
-&gt; (EmulatorEvent' -&gt; Maybe WalletEvent)
-&gt; Prism' EmulatorEvent' WalletEvent
forall b s a. (b -&gt; s) -&gt; (s -&gt; Maybe a) -&gt; Prism s s a b
</span><span class="hs-identifier hs-var">prism'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; WalletEvent -&gt; EmulatorEvent'
</span><a href="Wallet.Emulator.MultiAgent.html#WalletEvent"><span class="hs-identifier hs-var">WalletEvent</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563080"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#WalletEvent"><span class="hs-identifier hs-type">WalletEvent</span></a></span><span> </span><span id="local-6989586621680563079"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563079"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span id="local-6989586621680563078"><span class="annot"><span class="annottext">WalletEvent
</span><a href="#local-6989586621680563078"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563080"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Wallet -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563079"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WalletEvent -&gt; Maybe WalletEvent
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">WalletEvent
</span><a href="#local-6989586621680563078"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">EmulatorEvent'
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe WalletEvent
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#walletEvent%27"><span class="hs-identifier hs-type">walletEvent'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prism'</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorEvent%27"><span class="hs-identifier hs-type">EmulatorEvent'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Wallet.Emulator.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Wallet.Emulator.Wallet.html#WalletEvent"><span class="hs-identifier hs-type">Wallet.WalletEvent</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span id="walletEvent%27"><span class="annot"><span class="annottext">walletEvent' :: p (Wallet, WalletEvent) (f (Wallet, WalletEvent))
-&gt; p EmulatorEvent' (f EmulatorEvent')
</span><a href="Wallet.Emulator.MultiAgent.html#walletEvent%27"><span class="hs-identifier hs-var hs-var">walletEvent'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Wallet, WalletEvent) -&gt; EmulatorEvent')
-&gt; (EmulatorEvent' -&gt; Maybe (Wallet, WalletEvent))
-&gt; Prism
     EmulatorEvent'
     EmulatorEvent'
     (Wallet, WalletEvent)
     (Wallet, WalletEvent)
forall b s a. (b -&gt; s) -&gt; (s -&gt; Maybe a) -&gt; Prism s s a b
</span><span class="hs-identifier hs-var">prism'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Wallet -&gt; WalletEvent -&gt; EmulatorEvent')
-&gt; (Wallet, WalletEvent) -&gt; EmulatorEvent'
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; WalletEvent -&gt; EmulatorEvent'
</span><a href="Wallet.Emulator.MultiAgent.html#WalletEvent"><span class="hs-identifier hs-var">WalletEvent</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#WalletEvent"><span class="hs-identifier hs-type">WalletEvent</span></a></span><span> </span><span id="local-6989586621680563075"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563075"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621680563074"><span class="annot"><span class="annottext">WalletEvent
</span><a href="#local-6989586621680563074"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Wallet, WalletEvent) -&gt; Maybe (Wallet, WalletEvent)
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563075"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WalletEvent
</span><a href="#local-6989586621680563074"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">EmulatorEvent'
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Wallet, WalletEvent)
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#chainIndexEvent"><span class="hs-identifier hs-type">chainIndexEvent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Wallet.Emulator.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prism'</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorEvent%27"><span class="hs-identifier hs-type">EmulatorEvent'</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChainIndex.ChainIndexLog</span></span><span>
</span><span id="line-125"></span><span id="chainIndexEvent"><span class="annot"><span class="annottext">chainIndexEvent :: Wallet -&gt; Prism' EmulatorEvent' ChainIndexLog
</span><a href="Wallet.Emulator.MultiAgent.html#chainIndexEvent"><span class="hs-identifier hs-var hs-var">chainIndexEvent</span></a></span></span><span> </span><span id="local-6989586621680563072"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563072"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ChainIndexLog -&gt; EmulatorEvent')
-&gt; (EmulatorEvent' -&gt; Maybe ChainIndexLog)
-&gt; Prism' EmulatorEvent' ChainIndexLog
forall b s a. (b -&gt; s) -&gt; (s -&gt; Maybe a) -&gt; Prism s s a b
</span><span class="hs-identifier hs-var">prism'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; ChainIndexLog -&gt; EmulatorEvent'
</span><a href="Wallet.Emulator.MultiAgent.html#ChainIndexEvent"><span class="hs-identifier hs-var">ChainIndexEvent</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563072"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#ChainIndexEvent"><span class="hs-identifier hs-type">ChainIndexEvent</span></a></span><span> </span><span id="local-6989586621680563071"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563071"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span id="local-6989586621680563070"><span class="annot"><span class="annottext">ChainIndexLog
</span><a href="#local-6989586621680563070"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563072"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Wallet -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563071"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ChainIndexLog -&gt; Maybe ChainIndexLog
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexLog
</span><a href="#local-6989586621680563070"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">EmulatorEvent'
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ChainIndexLog
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#schedulerEvent"><span class="hs-identifier hs-type">schedulerEvent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prism'</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorEvent%27"><span class="hs-identifier hs-type">EmulatorEvent'</span></a></span><span> </span><span class="annot"><a href="Plutus.Trace.Scheduler.html#SchedulerLog"><span class="hs-identifier hs-type">Scheduler.SchedulerLog</span></a></span><span>
</span><span id="line-128"></span><span id="schedulerEvent"><span class="annot"><span class="annottext">schedulerEvent :: p SchedulerLog (f SchedulerLog)
-&gt; p EmulatorEvent' (f EmulatorEvent')
</span><a href="Wallet.Emulator.MultiAgent.html#schedulerEvent"><span class="hs-identifier hs-var hs-var">schedulerEvent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SchedulerLog -&gt; EmulatorEvent')
-&gt; (EmulatorEvent' -&gt; Maybe SchedulerLog)
-&gt; Prism EmulatorEvent' EmulatorEvent' SchedulerLog SchedulerLog
forall b s a. (b -&gt; s) -&gt; (s -&gt; Maybe a) -&gt; Prism s s a b
</span><span class="hs-identifier hs-var">prism'</span></span><span> </span><span class="annot"><span class="annottext">SchedulerLog -&gt; EmulatorEvent'
</span><a href="Wallet.Emulator.MultiAgent.html#SchedulerEvent"><span class="hs-identifier hs-var">SchedulerEvent</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#SchedulerEvent"><span class="hs-identifier hs-type">SchedulerEvent</span></a></span><span> </span><span id="local-6989586621680563068"><span class="annot"><span class="annottext">SchedulerLog
</span><a href="#local-6989586621680563068"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SchedulerLog -&gt; Maybe SchedulerLog
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">SchedulerLog
</span><a href="#local-6989586621680563068"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">EmulatorEvent'
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe SchedulerLog
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#instanceEvent"><span class="hs-identifier hs-type">instanceEvent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prism'</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorEvent%27"><span class="hs-identifier hs-type">EmulatorEvent'</span></a></span><span> </span><span class="annot"><a href="Plutus.Trace.Emulator.Types.html#ContractInstanceLog"><span class="hs-identifier hs-type">ContractInstanceLog</span></a></span><span>
</span><span id="line-131"></span><span id="instanceEvent"><span class="annot"><span class="annottext">instanceEvent :: p ContractInstanceLog (f ContractInstanceLog)
-&gt; p EmulatorEvent' (f EmulatorEvent')
</span><a href="Wallet.Emulator.MultiAgent.html#instanceEvent"><span class="hs-identifier hs-var hs-var">instanceEvent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ContractInstanceLog -&gt; EmulatorEvent')
-&gt; (EmulatorEvent' -&gt; Maybe ContractInstanceLog)
-&gt; Prism
     EmulatorEvent'
     EmulatorEvent'
     ContractInstanceLog
     ContractInstanceLog
forall b s a. (b -&gt; s) -&gt; (s -&gt; Maybe a) -&gt; Prism s s a b
</span><span class="hs-identifier hs-var">prism'</span></span><span> </span><span class="annot"><span class="annottext">ContractInstanceLog -&gt; EmulatorEvent'
</span><a href="Wallet.Emulator.MultiAgent.html#InstanceEvent"><span class="hs-identifier hs-var">InstanceEvent</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#InstanceEvent"><span class="hs-identifier hs-type">InstanceEvent</span></a></span><span> </span><span id="local-6989586621680563066"><span class="annot"><span class="annottext">ContractInstanceLog
</span><a href="#local-6989586621680563066"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ContractInstanceLog -&gt; Maybe ContractInstanceLog
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceLog
</span><a href="#local-6989586621680563066"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">EmulatorEvent'
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ContractInstanceLog
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#userThreadEvent"><span class="hs-identifier hs-type">userThreadEvent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prism'</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorEvent%27"><span class="hs-identifier hs-type">EmulatorEvent'</span></a></span><span> </span><span class="annot"><a href="Plutus.Trace.Emulator.Types.html#UserThreadMsg"><span class="hs-identifier hs-type">UserThreadMsg</span></a></span><span>
</span><span id="line-134"></span><span id="userThreadEvent"><span class="annot"><span class="annottext">userThreadEvent :: p UserThreadMsg (f UserThreadMsg)
-&gt; p EmulatorEvent' (f EmulatorEvent')
</span><a href="Wallet.Emulator.MultiAgent.html#userThreadEvent"><span class="hs-identifier hs-var hs-var">userThreadEvent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(UserThreadMsg -&gt; EmulatorEvent')
-&gt; (EmulatorEvent' -&gt; Maybe UserThreadMsg)
-&gt; Prism EmulatorEvent' EmulatorEvent' UserThreadMsg UserThreadMsg
forall b s a. (b -&gt; s) -&gt; (s -&gt; Maybe a) -&gt; Prism s s a b
</span><span class="hs-identifier hs-var">prism'</span></span><span> </span><span class="annot"><span class="annottext">UserThreadMsg -&gt; EmulatorEvent'
</span><a href="Wallet.Emulator.MultiAgent.html#UserThreadEvent"><span class="hs-identifier hs-var">UserThreadEvent</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#UserThreadEvent"><span class="hs-identifier hs-type">UserThreadEvent</span></a></span><span> </span><span id="local-6989586621680563064"><span class="annot"><span class="annottext">UserThreadMsg
</span><a href="#local-6989586621680563064"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UserThreadMsg -&gt; Maybe UserThreadMsg
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">UserThreadMsg
</span><a href="#local-6989586621680563064"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">EmulatorEvent'
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe UserThreadMsg
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-keyword">type</span><span> </span><span id="EmulatedWalletControlEffects"><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatedWalletControlEffects"><span class="hs-identifier hs-var">EmulatedWalletControlEffects</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-137"></span><span>        </span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Wallet.Emulator.NodeClient.html#NodeClientControlEffect"><span class="hs-identifier hs-type">NC.NodeClientControlEffect</span></a></span><span>
</span><span id="line-138"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChainIndex.ChainIndexControlEffect</span></span><span>
</span><span id="line-139"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Wallet.Emulator.Wallet.html#SigningProcessControlEffect"><span class="hs-identifier hs-type">Wallet.SigningProcessControlEffect</span></a></span><span>
</span><span id="line-140"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LogObserve</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogMessage</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LogMsg</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-142"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">{- Note [Control effects]

Plutus contracts interact with the outside world through a number of different
effects. These effects are captured in 'EmulatedWalletEffects'. They are
supposed to be a realistic representation of the capabilities that contracts
will have in the real world, when the system is released.

In the tests we often want to simulate events that happened &quot;outside of the
contract&quot;. For example: A new block is added to the chain, or a user takes the
transaction and emails it to another person to sign, before sending it to the
node. These kinds of events cannot be expressed in 'EmulatedWalletEffects',
because it would make the emulated wallet effects unrealistic - Plutus
contracts in the real world will not have the power to decide when a new block
gets added to the chain, or to control who adds their signature to a
transaction.

But in the emulated world of our unit tests we, the contract authors, would very
much like to have this power. That is why there is a second list of emulator
effects: 'EmulatedWalletControlEffects' are the of effects that only make sense
in the emulator, but not in the real world. With 'EmulatedWalletControlEffects'
we can control the blockchain and the lines of communication between the
emulated components.

By being clear about which of our (ie. the contract authors) actions
require the full power of 'EmulatedWalletControlEffects', we can be more
confident that our contracts will run in the real world, and not just in the
test environment. That is why there are two similar but different constructors
for 'MultiAgentEffect': 'WalletAction' is used for things that we will be able
to do in the real world, and 'WalletControlAction' is for everything else.

-}</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-comment">-- | The type of actions in the emulator.</span><span>
</span><span id="line-177"></span><span class="hs-keyword">data</span><span> </span><span id="MultiAgentEffect"><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#MultiAgentEffect"><span class="hs-identifier hs-var">MultiAgentEffect</span></a></span></span><span> </span><span id="local-6989586621680563063"><span class="annot"><a href="#local-6989586621680563063"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-comment">-- | A direct action performed by a wallet. Usually represents a &quot;user action&quot;, as it is</span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-comment">-- triggered externally.</span><span>
</span><span id="line-180"></span><span>    </span><span id="local-6989586621680563574"><span id="WalletAction"><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#WalletAction"><span class="hs-identifier hs-var">WalletAction</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Wallet.Emulator.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="Plutus.Trace.Emulator.Types.html#EmulatedWalletEffects"><span class="hs-identifier hs-type">EmulatedWalletEffects</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680563574"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#MultiAgentEffect"><span class="hs-identifier hs-type">MultiAgentEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680563574"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-keyword">data</span><span> </span><span id="MultiAgentControlEffect"><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#MultiAgentControlEffect"><span class="hs-identifier hs-var">MultiAgentControlEffect</span></a></span></span><span> </span><span id="local-6989586621680563061"><span class="annot"><a href="#local-6989586621680563061"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-comment">-- | An action affecting the emulated parts of a wallet (only available in emulator - see note [Control effects].)</span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621680563534"><span id="WalletControlAction"><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#WalletControlAction"><span class="hs-identifier hs-var">WalletControlAction</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Wallet.Emulator.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatedWalletControlEffects"><span class="hs-identifier hs-type">EmulatedWalletControlEffects</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680563534"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#MultiAgentControlEffect"><span class="hs-identifier hs-type">MultiAgentControlEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680563534"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="hs-comment">-- | Run an action in the context of a wallet (ie. agent)</span><span>
</span><span id="line-187"></span><span id="local-6989586621680563539"><span id="local-6989586621680563540"><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#walletAction"><span class="hs-identifier hs-type">walletAction</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#MultiAgentEffect"><span class="hs-identifier hs-type">MultiAgentEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680563540"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Wallet.Emulator.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="Plutus.Trace.Emulator.Types.html#EmulatedWalletEffects"><span class="hs-identifier hs-type">EmulatedWalletEffects</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680563539"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680563540"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680563539"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-192"></span><span id="walletAction"><span class="annot"><span class="annottext">walletAction :: Wallet -&gt; Eff EmulatedWalletEffects r -&gt; Eff effs r
</span><a href="Wallet.Emulator.MultiAgent.html#walletAction"><span class="hs-identifier hs-var hs-var">walletAction</span></a></span></span><span> </span><span id="local-6989586621680563058"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563058"><span class="hs-identifier hs-var">wallet</span></a></span></span><span> </span><span id="local-6989586621680563057"><span class="annot"><span class="annottext">Eff EmulatedWalletEffects r
</span><a href="#local-6989586621680563057"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MultiAgentEffect r -&gt; Eff effs r
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]) a.
Member eff effs =&gt;
eff a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">send</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; Eff EmulatedWalletEffects r -&gt; MultiAgentEffect r
forall r.
Wallet -&gt; Eff EmulatedWalletEffects r -&gt; MultiAgentEffect r
</span><a href="Wallet.Emulator.MultiAgent.html#WalletAction"><span class="hs-identifier hs-var">WalletAction</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563058"><span class="hs-identifier hs-var">wallet</span></a></span><span> </span><span class="annot"><span class="annottext">Eff EmulatedWalletEffects r
</span><a href="#local-6989586621680563057"><span class="hs-identifier hs-var">act</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#handleMultiAgentEffects"><span class="hs-identifier hs-type">handleMultiAgentEffects</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680563055"><span class="annot"><a href="#local-6989586621680563055"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-196"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#MultiAgentEffect"><span class="hs-identifier hs-type">MultiAgentEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680563055"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Wallet.Emulator.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Trace.Emulator.Types.html#EmulatedWalletEffects%27"><span class="hs-identifier hs-type">EmulatedWalletEffects'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680563055"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680563055"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-200"></span><span id="handleMultiAgentEffects"><span class="annot"><span class="annottext">handleMultiAgentEffects :: Wallet -&gt; Eff (EmulatedWalletEffects' effs) ~&gt; Eff effs
</span><a href="Wallet.Emulator.MultiAgent.html#handleMultiAgentEffects"><span class="hs-identifier hs-var hs-var">handleMultiAgentEffects</span></a></span></span><span> </span><span id="local-6989586621680563054"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563054"><span class="hs-identifier hs-var">wallet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-201"></span><span>    </span><span class="annot"><span class="annottext">(LogMsg Text ~&gt; Eff effs) -&gt; Eff (LogMsg Text : effs) ~&gt; Eff effs
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; LogMsg Text ~&gt; Eff effs
forall (f :: * -&gt; *) (effs :: [* -&gt; *]).
(Member f EmulatedWalletEffects, Member MultiAgentEffect effs) =&gt;
Wallet -&gt; f ~&gt; Eff effs
</span><a href="Wallet.Emulator.MultiAgent.html#raiseWallet"><span class="hs-identifier hs-var">raiseWallet</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogMsg</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563054"><span class="hs-identifier hs-var">wallet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>        </span><span class="annot"><span class="annottext">(Eff (LogMsg Text : effs) x -&gt; Eff effs x)
-&gt; (Eff (EmulatedWalletEffects' effs) x
    -&gt; Eff (LogMsg Text : effs) x)
-&gt; Eff (EmulatedWalletEffects' effs) x
-&gt; Eff effs x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg TxBalanceMsg ~&gt; Eff (LogMsg Text : effs))
-&gt; Eff (LogMsg TxBalanceMsg : LogMsg Text : effs)
   ~&gt; Eff (LogMsg Text : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; LogMsg TxBalanceMsg ~&gt; Eff (LogMsg Text : effs)
forall (f :: * -&gt; *) (effs :: [* -&gt; *]).
(Member f EmulatedWalletEffects, Member MultiAgentEffect effs) =&gt;
Wallet -&gt; f ~&gt; Eff effs
</span><a href="Wallet.Emulator.MultiAgent.html#raiseWallet"><span class="hs-identifier hs-var">raiseWallet</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogMsg</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxBalanceMsg</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563054"><span class="hs-identifier hs-var">wallet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>        </span><span class="annot"><span class="annottext">(Eff (LogMsg TxBalanceMsg : LogMsg Text : effs) x
 -&gt; Eff (LogMsg Text : effs) x)
-&gt; (Eff (EmulatedWalletEffects' effs) x
    -&gt; Eff (LogMsg TxBalanceMsg : LogMsg Text : effs) x)
-&gt; Eff (EmulatedWalletEffects' effs) x
-&gt; Eff (LogMsg Text : effs) x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg RequestHandlerLogMsg
 ~&gt; Eff (LogMsg TxBalanceMsg : LogMsg Text : effs))
-&gt; Eff
     (LogMsg RequestHandlerLogMsg
        : LogMsg TxBalanceMsg : LogMsg Text : effs)
   ~&gt; Eff (LogMsg TxBalanceMsg : LogMsg Text : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet
-&gt; LogMsg RequestHandlerLogMsg
   ~&gt; Eff (LogMsg TxBalanceMsg : LogMsg Text : effs)
forall (f :: * -&gt; *) (effs :: [* -&gt; *]).
(Member f EmulatedWalletEffects, Member MultiAgentEffect effs) =&gt;
Wallet -&gt; f ~&gt; Eff effs
</span><a href="Wallet.Emulator.MultiAgent.html#raiseWallet"><span class="hs-identifier hs-var">raiseWallet</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogMsg</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.LogMessages.html#RequestHandlerLogMsg"><span class="hs-identifier hs-type">RequestHandlerLogMsg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563054"><span class="hs-identifier hs-var">wallet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>        </span><span class="annot"><span class="annottext">(Eff
   (LogMsg RequestHandlerLogMsg
      : LogMsg TxBalanceMsg : LogMsg Text : effs)
   x
 -&gt; Eff (LogMsg TxBalanceMsg : LogMsg Text : effs) x)
-&gt; (Eff (EmulatedWalletEffects' effs) x
    -&gt; Eff
         (LogMsg RequestHandlerLogMsg
            : LogMsg TxBalanceMsg : LogMsg Text : effs)
         x)
-&gt; Eff (EmulatedWalletEffects' effs) x
-&gt; Eff (LogMsg TxBalanceMsg : LogMsg Text : effs) x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LogObserve (LogMessage Text)
 ~&gt; Eff
      (LogMsg RequestHandlerLogMsg
         : LogMsg TxBalanceMsg : LogMsg Text : effs))
-&gt; Eff
     (LogObserve (LogMessage Text)
        : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
        : effs)
   ~&gt; Eff
        (LogMsg RequestHandlerLogMsg
           : LogMsg TxBalanceMsg : LogMsg Text : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet
-&gt; LogObserve (LogMessage Text)
   ~&gt; Eff
        (LogMsg RequestHandlerLogMsg
           : LogMsg TxBalanceMsg : LogMsg Text : effs)
forall (f :: * -&gt; *) (effs :: [* -&gt; *]).
(Member f EmulatedWalletEffects, Member MultiAgentEffect effs) =&gt;
Wallet -&gt; f ~&gt; Eff effs
</span><a href="Wallet.Emulator.MultiAgent.html#raiseWallet"><span class="hs-identifier hs-var">raiseWallet</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogObserve</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogMessage</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563054"><span class="hs-identifier hs-var">wallet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>        </span><span class="annot"><span class="annottext">(Eff
   (LogObserve (LogMessage Text)
      : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
      : effs)
   x
 -&gt; Eff
      (LogMsg RequestHandlerLogMsg
         : LogMsg TxBalanceMsg : LogMsg Text : effs)
      x)
-&gt; (Eff (EmulatedWalletEffects' effs) x
    -&gt; Eff
         (LogObserve (LogMessage Text)
            : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
            : effs)
         x)
-&gt; Eff (EmulatedWalletEffects' effs) x
-&gt; Eff
     (LogMsg RequestHandlerLogMsg
        : LogMsg TxBalanceMsg : LogMsg Text : effs)
     x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexQueryEffect
 ~&gt; Eff
      (LogObserve (LogMessage Text)
         : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
         : effs))
-&gt; Eff
     (ChainIndexQueryEffect
        : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
        : LogMsg TxBalanceMsg : LogMsg Text : effs)
   ~&gt; Eff
        (LogObserve (LogMessage Text)
           : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
           : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet
-&gt; ChainIndexQueryEffect
   ~&gt; Eff
        (LogObserve (LogMessage Text)
           : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
           : effs)
forall (f :: * -&gt; *) (effs :: [* -&gt; *]).
(Member f EmulatedWalletEffects, Member MultiAgentEffect effs) =&gt;
Wallet -&gt; f ~&gt; Eff effs
</span><a href="Wallet.Emulator.MultiAgent.html#raiseWallet"><span class="hs-identifier hs-var">raiseWallet</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">ChainIndex.ChainIndexQueryEffect</span></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563054"><span class="hs-identifier hs-var">wallet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>        </span><span class="annot"><span class="annottext">(Eff
   (ChainIndexQueryEffect
      : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
      : LogMsg TxBalanceMsg : LogMsg Text : effs)
   x
 -&gt; Eff
      (LogObserve (LogMessage Text)
         : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
         : effs)
      x)
-&gt; (Eff (EmulatedWalletEffects' effs) x
    -&gt; Eff
         (ChainIndexQueryEffect
            : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
            : LogMsg TxBalanceMsg : LogMsg Text : effs)
         x)
-&gt; Eff (EmulatedWalletEffects' effs) x
-&gt; Eff
     (LogObserve (LogMessage Text)
        : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
        : effs)
     x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(NodeClientEffect
 ~&gt; Eff
      (ChainIndexQueryEffect
         : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
         : LogMsg TxBalanceMsg : LogMsg Text : effs))
-&gt; Eff
     (NodeClientEffect
        : ChainIndexQueryEffect : LogObserve (LogMessage Text)
        : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
        : effs)
   ~&gt; Eff
        (ChainIndexQueryEffect
           : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
           : LogMsg TxBalanceMsg : LogMsg Text : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet
-&gt; NodeClientEffect
   ~&gt; Eff
        (ChainIndexQueryEffect
           : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
           : LogMsg TxBalanceMsg : LogMsg Text : effs)
forall (f :: * -&gt; *) (effs :: [* -&gt; *]).
(Member f EmulatedWalletEffects, Member MultiAgentEffect effs) =&gt;
Wallet -&gt; f ~&gt; Eff effs
</span><a href="Wallet.Emulator.MultiAgent.html#raiseWallet"><span class="hs-identifier hs-var">raiseWallet</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Wallet.Effects.html#NodeClientEffect"><span class="hs-identifier hs-type">WAPI.NodeClientEffect</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563054"><span class="hs-identifier hs-var">wallet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>        </span><span class="annot"><span class="annottext">(Eff
   (NodeClientEffect
      : ChainIndexQueryEffect : LogObserve (LogMessage Text)
      : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
      : effs)
   x
 -&gt; Eff
      (ChainIndexQueryEffect
         : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
         : LogMsg TxBalanceMsg : LogMsg Text : effs)
      x)
-&gt; (Eff (EmulatedWalletEffects' effs) x
    -&gt; Eff
         (NodeClientEffect
            : ChainIndexQueryEffect : LogObserve (LogMessage Text)
            : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
            : effs)
         x)
-&gt; Eff (EmulatedWalletEffects' effs) x
-&gt; Eff
     (ChainIndexQueryEffect
        : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
        : LogMsg TxBalanceMsg : LogMsg Text : effs)
     x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Error WalletAPIError
 ~&gt; Eff
      (NodeClientEffect
         : ChainIndexQueryEffect : LogObserve (LogMessage Text)
         : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
         : effs))
-&gt; Eff
     (Error WalletAPIError
        : NodeClientEffect : ChainIndexQueryEffect
        : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
        : LogMsg TxBalanceMsg : LogMsg Text : effs)
   ~&gt; Eff
        (NodeClientEffect
           : ChainIndexQueryEffect : LogObserve (LogMessage Text)
           : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
           : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet
-&gt; Error WalletAPIError
   ~&gt; Eff
        (NodeClientEffect
           : ChainIndexQueryEffect : LogObserve (LogMessage Text)
           : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
           : effs)
forall (f :: * -&gt; *) (effs :: [* -&gt; *]).
(Member f EmulatedWalletEffects, Member MultiAgentEffect effs) =&gt;
Wallet -&gt; f ~&gt; Eff effs
</span><a href="Wallet.Emulator.MultiAgent.html#raiseWallet"><span class="hs-identifier hs-var">raiseWallet</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.Error.html#WalletAPIError"><span class="hs-identifier hs-type">WAPI.WalletAPIError</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563054"><span class="hs-identifier hs-var">wallet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>        </span><span class="annot"><span class="annottext">(Eff
   (Error WalletAPIError
      : NodeClientEffect : ChainIndexQueryEffect
      : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
      : LogMsg TxBalanceMsg : LogMsg Text : effs)
   x
 -&gt; Eff
      (NodeClientEffect
         : ChainIndexQueryEffect : LogObserve (LogMessage Text)
         : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
         : effs)
      x)
-&gt; (Eff (EmulatedWalletEffects' effs) x
    -&gt; Eff
         (Error WalletAPIError
            : NodeClientEffect : ChainIndexQueryEffect
            : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
            : LogMsg TxBalanceMsg : LogMsg Text : effs)
         x)
-&gt; Eff (EmulatedWalletEffects' effs) x
-&gt; Eff
     (NodeClientEffect
        : ChainIndexQueryEffect : LogObserve (LogMessage Text)
        : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
        : effs)
     x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(WalletEffect
 ~&gt; Eff
      (Error WalletAPIError
         : NodeClientEffect : ChainIndexQueryEffect
         : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
         : LogMsg TxBalanceMsg : LogMsg Text : effs))
-&gt; Eff (EmulatedWalletEffects' effs)
   ~&gt; Eff
        (Error WalletAPIError
           : NodeClientEffect : ChainIndexQueryEffect
           : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
           : LogMsg TxBalanceMsg : LogMsg Text : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet
-&gt; WalletEffect
   ~&gt; Eff
        (Error WalletAPIError
           : NodeClientEffect : ChainIndexQueryEffect
           : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
           : LogMsg TxBalanceMsg : LogMsg Text : effs)
forall (f :: * -&gt; *) (effs :: [* -&gt; *]).
(Member f EmulatedWalletEffects, Member MultiAgentEffect effs) =&gt;
Wallet -&gt; f ~&gt; Eff effs
</span><a href="Wallet.Emulator.MultiAgent.html#raiseWallet"><span class="hs-identifier hs-var">raiseWallet</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Wallet.Effects.html#WalletEffect"><span class="hs-identifier hs-type">WAPI.WalletEffect</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563054"><span class="hs-identifier hs-var">wallet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#raiseWallet"><span class="hs-identifier hs-type">raiseWallet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680563564"><span class="annot"><a href="#local-6989586621680563564"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621680563563"><span class="annot"><a href="#local-6989586621680563563"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="annot"><a href="#local-6989586621680563564"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="Plutus.Trace.Emulator.Types.html#EmulatedWalletEffects"><span class="hs-identifier hs-type">EmulatedWalletEffects</span></a></span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#MultiAgentEffect"><span class="hs-identifier hs-type">MultiAgentEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680563563"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Wallet.Emulator.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680563564"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-216"></span><span>    </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680563563"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-217"></span><span id="raiseWallet"><span class="annot"><span class="annottext">raiseWallet :: Wallet -&gt; f ~&gt; Eff effs
</span><a href="Wallet.Emulator.MultiAgent.html#raiseWallet"><span class="hs-identifier hs-var hs-var">raiseWallet</span></a></span></span><span> </span><span id="local-6989586621680563051"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563051"><span class="hs-identifier hs-var">wllt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Eff EmulatedWalletEffects x -&gt; Eff effs x
forall (effs :: [* -&gt; *]) r.
Member MultiAgentEffect effs =&gt;
Wallet -&gt; Eff EmulatedWalletEffects r -&gt; Eff effs r
</span><a href="Wallet.Emulator.MultiAgent.html#walletAction"><span class="hs-identifier hs-var">walletAction</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563051"><span class="hs-identifier hs-var">wllt</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff EmulatedWalletEffects x -&gt; Eff effs x)
-&gt; (f x -&gt; Eff EmulatedWalletEffects x) -&gt; f x -&gt; Eff effs x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">f x -&gt; Eff EmulatedWalletEffects x
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]) a.
Member eff effs =&gt;
eff a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">send</span></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-comment">-- | Run a control action in the context of a wallet</span><span>
</span><span id="line-220"></span><span id="local-6989586621680563049"><span id="local-6989586621680563050"><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#walletControlAction"><span class="hs-identifier hs-type">walletControlAction</span></a></span><span>
</span><span id="line-221"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Member</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#MultiAgentControlEffect"><span class="hs-identifier hs-type">MultiAgentControlEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680563050"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Wallet.Emulator.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span>
</span><span id="line-223"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatedWalletControlEffects"><span class="hs-identifier hs-type">EmulatedWalletControlEffects</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680563049"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680563050"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680563049"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-225"></span><span id="walletControlAction"><span class="annot"><span class="annottext">walletControlAction :: Wallet -&gt; Eff EmulatedWalletControlEffects r -&gt; Eff effs r
</span><a href="Wallet.Emulator.MultiAgent.html#walletControlAction"><span class="hs-identifier hs-var hs-var">walletControlAction</span></a></span></span><span> </span><span id="local-6989586621680563047"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563047"><span class="hs-identifier hs-var">wallet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MultiAgentControlEffect r -&gt; Eff effs r
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]) a.
Member eff effs =&gt;
eff a -&gt; Eff effs a
</span><span class="hs-identifier hs-var">send</span></span><span> </span><span class="annot"><span class="annottext">(MultiAgentControlEffect r -&gt; Eff effs r)
-&gt; (Eff EmulatedWalletControlEffects r
    -&gt; MultiAgentControlEffect r)
-&gt; Eff EmulatedWalletControlEffects r
-&gt; Eff effs r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
-&gt; Eff EmulatedWalletControlEffects r -&gt; MultiAgentControlEffect r
forall r.
Wallet
-&gt; Eff EmulatedWalletControlEffects r -&gt; MultiAgentControlEffect r
</span><a href="Wallet.Emulator.MultiAgent.html#WalletControlAction"><span class="hs-identifier hs-var">WalletControlAction</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563047"><span class="hs-identifier hs-var">wallet</span></a></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="hs-comment">-- | The state of the emulator itself.</span><span>
</span><span id="line-228"></span><span class="hs-keyword">data</span><span> </span><span id="EmulatorState"><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorState"><span class="hs-identifier hs-var">EmulatorState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="EmulatorState"><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorState"><span class="hs-identifier hs-var">EmulatorState</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-229"></span><span>    </span><span id="_chainState"><span class="annot"><span class="annottext">EmulatorState -&gt; ChainState
</span><a href="Wallet.Emulator.MultiAgent.html#_chainState"><span class="hs-identifier hs-var hs-var">_chainState</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Chain.ChainState</span></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ^ Mockchain</span><span>
</span><span id="line-230"></span><span>    </span><span id="_walletStates"><span class="annot"><span class="annottext">EmulatorState -&gt; Map Wallet WalletState
</span><a href="Wallet.Emulator.MultiAgent.html#_walletStates"><span class="hs-identifier hs-var hs-var">_walletStates</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="annot"><a href="Wallet.Emulator.Wallet.html#WalletState"><span class="hs-identifier hs-type">Wallet.WalletState</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ^ The state of each agent.</span><span>
</span><span id="line-231"></span><span>    </span><span id="_emulatorLog"><span class="annot"><span class="annottext">EmulatorState -&gt; [LogMessage EmulatorEvent]
</span><a href="Wallet.Emulator.MultiAgent.html#_emulatorLog"><span class="hs-identifier hs-var hs-var">_emulatorLog</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">LogMessage</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorEvent"><span class="hs-identifier hs-type">EmulatorEvent</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ The emulator log messages, with the newest last.</span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680563037"><span id="local-6989586621680563039"><span id="local-6989586621680563041"><span class="annot"><span class="annottext">Int -&gt; EmulatorState -&gt; ShowS
[EmulatorState] -&gt; ShowS
EmulatorState -&gt; String
(Int -&gt; EmulatorState -&gt; ShowS)
-&gt; (EmulatorState -&gt; String)
-&gt; ([EmulatorState] -&gt; ShowS)
-&gt; Show EmulatorState
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [EmulatorState] -&gt; ShowS
$cshowList :: [EmulatorState] -&gt; ShowS
show :: EmulatorState -&gt; String
$cshow :: EmulatorState -&gt; String
showsPrec :: Int -&gt; EmulatorState -&gt; ShowS
$cshowsPrec :: Int -&gt; EmulatorState -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span id="walletStates"><span id="emulatorLog"><span id="chainState"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">EmulatorState</span></span></span></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#walletState"><span class="hs-identifier hs-type">walletState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Wallet.Emulator.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorState"><span class="hs-identifier hs-type">EmulatorState</span></a></span><span> </span><span class="annot"><a href="Wallet.Emulator.Wallet.html#WalletState"><span class="hs-identifier hs-type">Wallet.WalletState</span></a></span><span>
</span><span id="line-237"></span><span id="walletState"><span class="annot"><span class="annottext">walletState :: Wallet -&gt; Lens' EmulatorState WalletState
</span><a href="Wallet.Emulator.MultiAgent.html#walletState"><span class="hs-identifier hs-var hs-var">walletState</span></a></span></span><span> </span><span id="local-6989586621680563032"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563032"><span class="hs-identifier hs-var">wallet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Map Wallet WalletState -&gt; f (Map Wallet WalletState))
-&gt; EmulatorState -&gt; f EmulatorState
Lens' EmulatorState (Map Wallet WalletState)
</span><a href="Wallet.Emulator.MultiAgent.html#walletStates"><span class="hs-identifier hs-var">walletStates</span></a></span><span> </span><span class="annot"><span class="annottext">((Map Wallet WalletState -&gt; f (Map Wallet WalletState))
 -&gt; EmulatorState -&gt; f EmulatorState)
-&gt; ((WalletState -&gt; f WalletState)
    -&gt; Map Wallet WalletState -&gt; f (Map Wallet WalletState))
-&gt; (WalletState -&gt; f WalletState)
-&gt; EmulatorState
-&gt; f EmulatorState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Index (Map Wallet WalletState)
-&gt; Lens'
     (Map Wallet WalletState) (Maybe (IxValue (Map Wallet WalletState)))
forall m. At m =&gt; Index m -&gt; Lens' m (Maybe (IxValue m))
</span><span class="hs-identifier hs-var">at</span></span><span> </span><span class="annot"><span class="annottext">Index (Map Wallet WalletState)
Wallet
</span><a href="#local-6989586621680563032"><span class="hs-identifier hs-var">wallet</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe WalletState -&gt; f (Maybe WalletState))
 -&gt; Map Wallet WalletState -&gt; f (Map Wallet WalletState))
-&gt; ((WalletState -&gt; f WalletState)
    -&gt; Maybe WalletState -&gt; f (Maybe WalletState))
-&gt; (WalletState -&gt; f WalletState)
-&gt; Map Wallet WalletState
-&gt; f (Map Wallet WalletState)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">WalletState
-&gt; (WalletState -&gt; Bool) -&gt; Iso' (Maybe WalletState) WalletState
forall a. a -&gt; (a -&gt; Bool) -&gt; Iso' (Maybe a) a
</span><span class="hs-identifier hs-var">anon</span></span><span> </span><span class="annot"><span class="annottext">WalletState
</span><a href="#local-6989586621680563031"><span class="hs-identifier hs-var">emptyState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; WalletState -&gt; Bool
forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-238"></span><span>    </span><span id="local-6989586621680563031"><span class="annot"><span class="annottext">emptyState :: WalletState
</span><a href="#local-6989586621680563031"><span class="hs-identifier hs-var hs-var">emptyState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WalletState -&gt; Maybe WalletState -&gt; WalletState
forall a. a -&gt; Maybe a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; WalletState
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; WalletState) -&gt; String -&gt; WalletState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;walletState: not a known wallet: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563032"><span class="hs-identifier hs-var">wallet</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; Maybe WalletState
</span><a href="Wallet.Emulator.Wallet.html#emptyWalletState"><span class="hs-identifier hs-var">Wallet.emptyWalletState</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563032"><span class="hs-identifier hs-var">wallet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-comment">-- | Get the blockchain as a list of blocks, starting with the oldest (genesis)</span><span>
</span><span id="line-241"></span><span class="hs-comment">--   block.</span><span>
</span><span id="line-242"></span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#chainOldestFirst"><span class="hs-identifier hs-type">chainOldestFirst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorState"><span class="hs-identifier hs-type">EmulatorState</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Blockchain</span></span><span>
</span><span id="line-243"></span><span id="chainOldestFirst"><span class="annot"><span class="annottext">chainOldestFirst :: (Blockchain -&gt; f Blockchain) -&gt; EmulatorState -&gt; f EmulatorState
</span><a href="Wallet.Emulator.MultiAgent.html#chainOldestFirst"><span class="hs-identifier hs-var hs-var">chainOldestFirst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ChainState -&gt; f ChainState) -&gt; EmulatorState -&gt; f EmulatorState
Lens' EmulatorState ChainState
</span><a href="Wallet.Emulator.MultiAgent.html#chainState"><span class="hs-identifier hs-var">chainState</span></a></span><span> </span><span class="annot"><span class="annottext">((ChainState -&gt; f ChainState) -&gt; EmulatorState -&gt; f EmulatorState)
-&gt; ((Blockchain -&gt; f Blockchain) -&gt; ChainState -&gt; f ChainState)
-&gt; (Blockchain -&gt; f Blockchain)
-&gt; EmulatorState
-&gt; f EmulatorState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Blockchain -&gt; f Blockchain) -&gt; ChainState -&gt; f ChainState
Lens' ChainState Blockchain
</span><span class="hs-identifier hs-var">Chain.chainNewestFirst</span></span><span> </span><span class="annot"><span class="annottext">((Blockchain -&gt; f Blockchain) -&gt; ChainState -&gt; f ChainState)
-&gt; ((Blockchain -&gt; f Blockchain) -&gt; Blockchain -&gt; f Blockchain)
-&gt; (Blockchain -&gt; f Blockchain)
-&gt; ChainState
-&gt; f ChainState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Blockchain -&gt; f Blockchain) -&gt; Blockchain -&gt; f Blockchain
forall a. Reversing a =&gt; Iso' a a
</span><span class="hs-identifier hs-var">reversed</span></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#chainUtxo"><span class="hs-identifier hs-type">chainUtxo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Getter</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorState"><span class="hs-identifier hs-type">EmulatorState</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">AM.AddressMap</span></span><span>
</span><span id="line-246"></span><span id="chainUtxo"><span class="annot"><span class="annottext">chainUtxo :: (AddressMap -&gt; f AddressMap) -&gt; EmulatorState -&gt; f EmulatorState
</span><a href="Wallet.Emulator.MultiAgent.html#chainUtxo"><span class="hs-identifier hs-var hs-var">chainUtxo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ChainState -&gt; f ChainState) -&gt; EmulatorState -&gt; f EmulatorState
Lens' EmulatorState ChainState
</span><a href="Wallet.Emulator.MultiAgent.html#chainState"><span class="hs-identifier hs-var">chainState</span></a></span><span> </span><span class="annot"><span class="annottext">((ChainState -&gt; f ChainState) -&gt; EmulatorState -&gt; f EmulatorState)
-&gt; ((AddressMap -&gt; f AddressMap) -&gt; ChainState -&gt; f ChainState)
-&gt; (AddressMap -&gt; f AddressMap)
-&gt; EmulatorState
-&gt; f EmulatorState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Blockchain -&gt; f Blockchain) -&gt; ChainState -&gt; f ChainState
Lens' ChainState Blockchain
</span><span class="hs-identifier hs-var">Chain.chainNewestFirst</span></span><span> </span><span class="annot"><span class="annottext">((Blockchain -&gt; f Blockchain) -&gt; ChainState -&gt; f ChainState)
-&gt; ((AddressMap -&gt; f AddressMap) -&gt; Blockchain -&gt; f Blockchain)
-&gt; (AddressMap -&gt; f AddressMap)
-&gt; ChainState
-&gt; f ChainState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Blockchain -&gt; AddressMap)
-&gt; (AddressMap -&gt; f AddressMap) -&gt; Blockchain -&gt; f Blockchain
forall (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s a.
(Profunctor p, Contravariant f) =&gt;
(s -&gt; a) -&gt; Optic' p f s a
</span><span class="hs-identifier hs-var">to</span></span><span> </span><span class="annot"><span class="annottext">Blockchain -&gt; AddressMap
</span><span class="hs-identifier hs-var">AM.fromChain</span></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-comment">-- | Get a map with the total value of each wallet's &quot;own funds&quot;.</span><span>
</span><span id="line-249"></span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#fundsDistribution"><span class="hs-identifier hs-type">fundsDistribution</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorState"><span class="hs-identifier hs-type">EmulatorState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Value</span></span><span>
</span><span id="line-250"></span><span id="fundsDistribution"><span class="annot"><span class="annottext">fundsDistribution :: EmulatorState -&gt; Map Wallet Value
</span><a href="Wallet.Emulator.MultiAgent.html#fundsDistribution"><span class="hs-identifier hs-var hs-var">fundsDistribution</span></a></span></span><span> </span><span id="local-6989586621680563021"><span class="annot"><span class="annottext">EmulatorState
</span><a href="#local-6989586621680563021"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680563020"><span class="annot"><span class="annottext">fullState :: AddressMap
</span><a href="#local-6989586621680563020"><span class="hs-identifier hs-var hs-var">fullState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Getting AddressMap EmulatorState AddressMap
-&gt; EmulatorState -&gt; AddressMap
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting AddressMap EmulatorState AddressMap
Getter EmulatorState AddressMap
</span><a href="Wallet.Emulator.MultiAgent.html#chainUtxo"><span class="hs-identifier hs-var">chainUtxo</span></a></span><span> </span><span class="annot"><span class="annottext">EmulatorState
</span><a href="#local-6989586621680563021"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-252"></span><span>        </span><span id="local-6989586621680563019"><span class="annot"><span class="annottext">wallets :: [Wallet]
</span><a href="#local-6989586621680563019"><span class="hs-identifier hs-var hs-var">wallets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EmulatorState
</span><a href="#local-6989586621680563021"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">EmulatorState
-&gt; Getting (Endo [Wallet]) EmulatorState Wallet -&gt; [Wallet]
forall s a. s -&gt; Getting (Endo [a]) s a -&gt; [a]
</span><span class="hs-operator hs-var">^..</span></span><span> </span><span class="annot"><span class="annottext">(Map Wallet WalletState
 -&gt; Const (Endo [Wallet]) (Map Wallet WalletState))
-&gt; EmulatorState -&gt; Const (Endo [Wallet]) EmulatorState
Lens' EmulatorState (Map Wallet WalletState)
</span><a href="Wallet.Emulator.MultiAgent.html#walletStates"><span class="hs-identifier hs-var">walletStates</span></a></span><span> </span><span class="annot"><span class="annottext">((Map Wallet WalletState
  -&gt; Const (Endo [Wallet]) (Map Wallet WalletState))
 -&gt; EmulatorState -&gt; Const (Endo [Wallet]) EmulatorState)
-&gt; ((Wallet -&gt; Const (Endo [Wallet]) Wallet)
    -&gt; Map Wallet WalletState
    -&gt; Const (Endo [Wallet]) (Map Wallet WalletState))
-&gt; Getting (Endo [Wallet]) EmulatorState Wallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Wallet WalletState -&gt; [Wallet])
-&gt; Optic'
     (-&gt;) (Const (Endo [Wallet])) (Map Wallet WalletState) [Wallet]
forall (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s a.
(Profunctor p, Contravariant f) =&gt;
(s -&gt; a) -&gt; Optic' p f s a
</span><span class="hs-identifier hs-var">to</span></span><span> </span><span class="annot"><span class="annottext">Map Wallet WalletState -&gt; [Wallet]
forall k a. Map k a -&gt; [k]
</span><span class="hs-identifier hs-var">Map.keys</span></span><span> </span><span class="annot"><span class="annottext">Optic'
  (-&gt;) (Const (Endo [Wallet])) (Map Wallet WalletState) [Wallet]
-&gt; ((Wallet -&gt; Const (Endo [Wallet]) Wallet)
    -&gt; [Wallet] -&gt; Const (Endo [Wallet]) [Wallet])
-&gt; (Wallet -&gt; Const (Endo [Wallet]) Wallet)
-&gt; Map Wallet WalletState
-&gt; Const (Endo [Wallet]) (Map Wallet WalletState)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Wallet -&gt; Const (Endo [Wallet]) Wallet)
-&gt; [Wallet] -&gt; Const (Endo [Wallet]) [Wallet]
forall (f :: * -&gt; *) a. Foldable f =&gt; IndexedFold Int (f a) a
</span><span class="hs-identifier hs-var">folded</span></span><span>
</span><span id="line-253"></span><span>        </span><span id="local-6989586621680563017"><span class="annot"><span class="annottext">walletFunds :: [(Wallet, Value)]
</span><a href="#local-6989586621680563017"><span class="hs-identifier hs-var hs-var">walletFunds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Wallet -&gt; (Wallet, Value)) -&gt; [Wallet] -&gt; [(Wallet, Value)])
-&gt; [Wallet] -&gt; (Wallet -&gt; (Wallet, Value)) -&gt; [(Wallet, Value)]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">(Wallet -&gt; (Wallet, Value)) -&gt; [Wallet] -&gt; [(Wallet, Value)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">[Wallet]
</span><a href="#local-6989586621680563019"><span class="hs-identifier hs-var">wallets</span></a></span><span> </span><span class="annot"><span class="annottext">((Wallet -&gt; (Wallet, Value)) -&gt; [(Wallet, Value)])
-&gt; (Wallet -&gt; (Wallet, Value)) -&gt; [(Wallet, Value)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680563015"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563015"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-254"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563015"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">((CardanoTx, TxOut) -&gt; Value)
-&gt; Map TxIn (CardanoTx, TxOut) -&gt; Value
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOut -&gt; Value
</span><span class="hs-identifier hs-var">txOutValue</span></span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; Value)
-&gt; ((CardanoTx, TxOut) -&gt; TxOut) -&gt; (CardanoTx, TxOut) -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(CardanoTx, TxOut) -&gt; TxOut
forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Map TxIn (CardanoTx, TxOut) -&gt; Value)
-&gt; Map TxIn (CardanoTx, TxOut) -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map TxIn (CardanoTx, TxOut))
  AddressMap
  (Map TxIn (CardanoTx, TxOut))
-&gt; AddressMap -&gt; Map TxIn (CardanoTx, TxOut)
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardanoAddress -&gt; Lens' AddressMap (Map TxIn (CardanoTx, TxOut))
</span><span class="hs-identifier hs-var">AM.fundsAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; CardanoAddress
</span><a href="Wallet.Emulator.Wallet.html#mockWalletAddress"><span class="hs-identifier hs-var">Wallet.mockWalletAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680563015"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AddressMap
</span><a href="#local-6989586621680563020"><span class="hs-identifier hs-var">fullState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[(Wallet, Value)] -&gt; Map Wallet Value
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">[(Wallet, Value)]
</span><a href="#local-6989586621680563017"><span class="hs-identifier hs-var">walletFunds</span></a></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-comment">-- | Get the emulator log.</span><span>
</span><span id="line-258"></span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#emLog"><span class="hs-identifier hs-type">emLog</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorState"><span class="hs-identifier hs-type">EmulatorState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">LogMessage</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorEvent"><span class="hs-identifier hs-type">EmulatorEvent</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-259"></span><span id="emLog"><span class="annot"><span class="annottext">emLog :: EmulatorState -&gt; [LogMessage EmulatorEvent]
</span><a href="Wallet.Emulator.MultiAgent.html#emLog"><span class="hs-identifier hs-var hs-var">emLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Getting
  [LogMessage EmulatorEvent] EmulatorState [LogMessage EmulatorEvent]
-&gt; EmulatorState -&gt; [LogMessage EmulatorEvent]
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting
  [LogMessage EmulatorEvent] EmulatorState [LogMessage EmulatorEvent]
Lens' EmulatorState [LogMessage EmulatorEvent]
</span><a href="Wallet.Emulator.MultiAgent.html#emulatorLog"><span class="hs-identifier hs-var">emulatorLog</span></a></span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#emptyEmulatorState"><span class="hs-identifier hs-type">emptyEmulatorState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorState"><span class="hs-identifier hs-type">EmulatorState</span></a></span><span>
</span><span id="line-262"></span><span id="emptyEmulatorState"><span class="annot"><span class="annottext">emptyEmulatorState :: EmulatorState
</span><a href="Wallet.Emulator.MultiAgent.html#emptyEmulatorState"><span class="hs-identifier hs-var hs-var">emptyEmulatorState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EmulatorState :: ChainState
-&gt; Map Wallet WalletState
-&gt; [LogMessage EmulatorEvent]
-&gt; EmulatorState
</span><a href="Wallet.Emulator.MultiAgent.html#EmulatorState"><span class="hs-identifier hs-type">EmulatorState</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-263"></span><span>    </span><span class="annot"><span class="annottext">_chainState :: ChainState
</span><a href="Wallet.Emulator.MultiAgent.html#_chainState"><span class="hs-identifier hs-var">_chainState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChainState
</span><span class="hs-identifier hs-var">Chain.emptyChainState</span></span><span class="hs-special">,</span><span>
</span><span id="line-264"></span><span>    </span><span class="annot"><span class="annottext">_walletStates :: Map Wallet WalletState
</span><a href="Wallet.Emulator.MultiAgent.html#_walletStates"><span class="hs-identifier hs-var">_walletStates</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Wallet WalletState
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-265"></span><span>    </span><span class="annot"><span class="annottext">_emulatorLog :: [LogMessage EmulatorEvent]
</span><a href="Wallet.Emulator.MultiAgent.html#_emulatorLog"><span class="hs-identifier hs-var">_emulatorLog</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LogMessage EmulatorEvent]
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-266"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="hs-comment">-- | Initialise the emulator state with a blockchain.</span><span>
</span><span id="line-269"></span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#emulatorState"><span class="hs-identifier hs-type">emulatorState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Blockchain</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorState"><span class="hs-identifier hs-type">EmulatorState</span></a></span><span>
</span><span id="line-270"></span><span id="emulatorState"><span class="annot"><span class="annottext">emulatorState :: Blockchain -&gt; EmulatorState
</span><a href="Wallet.Emulator.MultiAgent.html#emulatorState"><span class="hs-identifier hs-var hs-var">emulatorState</span></a></span></span><span> </span><span id="local-6989586621680563006"><span class="annot"><span class="annottext">Blockchain
</span><a href="#local-6989586621680563006"><span class="hs-identifier hs-var">bc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EmulatorState
</span><a href="Wallet.Emulator.MultiAgent.html#emptyEmulatorState"><span class="hs-identifier hs-var">emptyEmulatorState</span></a></span><span>
</span><span id="line-271"></span><span>    </span><span class="annot"><span class="annottext">EmulatorState -&gt; (EmulatorState -&gt; EmulatorState) -&gt; EmulatorState
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainState -&gt; Identity ChainState)
-&gt; EmulatorState -&gt; Identity EmulatorState
Lens' EmulatorState ChainState
</span><a href="Wallet.Emulator.MultiAgent.html#chainState"><span class="hs-identifier hs-var">chainState</span></a></span><span> </span><span class="annot"><span class="annottext">((ChainState -&gt; Identity ChainState)
 -&gt; EmulatorState -&gt; Identity EmulatorState)
-&gt; ChainState -&gt; EmulatorState -&gt; EmulatorState
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Blockchain -&gt; ChainState
</span><span class="hs-identifier hs-var">Chain.fromBlockchain</span></span><span> </span><span class="annot"><span class="annottext">Blockchain
</span><a href="#local-6989586621680563006"><span class="hs-identifier hs-var">bc</span></a></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-comment">-- | Initialise the emulator state with a pool of pending transactions.</span><span>
</span><span id="line-274"></span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#emulatorStatePool"><span class="hs-identifier hs-type">emulatorStatePool</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Chain.TxPool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorState"><span class="hs-identifier hs-type">EmulatorState</span></a></span><span>
</span><span id="line-275"></span><span id="emulatorStatePool"><span class="annot"><span class="annottext">emulatorStatePool :: TxPool -&gt; EmulatorState
</span><a href="Wallet.Emulator.MultiAgent.html#emulatorStatePool"><span class="hs-identifier hs-var hs-var">emulatorStatePool</span></a></span></span><span> </span><span id="local-6989586621680563003"><span class="annot"><span class="annottext">TxPool
</span><a href="#local-6989586621680563003"><span class="hs-identifier hs-var">tp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EmulatorState
</span><a href="Wallet.Emulator.MultiAgent.html#emptyEmulatorState"><span class="hs-identifier hs-var">emptyEmulatorState</span></a></span><span>
</span><span id="line-276"></span><span>    </span><span class="annot"><span class="annottext">EmulatorState -&gt; (EmulatorState -&gt; EmulatorState) -&gt; EmulatorState
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainState -&gt; Identity ChainState)
-&gt; EmulatorState -&gt; Identity EmulatorState
Lens' EmulatorState ChainState
</span><a href="Wallet.Emulator.MultiAgent.html#chainState"><span class="hs-identifier hs-var">chainState</span></a></span><span> </span><span class="annot"><span class="annottext">((ChainState -&gt; Identity ChainState)
 -&gt; EmulatorState -&gt; Identity EmulatorState)
-&gt; ((TxPool -&gt; Identity TxPool)
    -&gt; ChainState -&gt; Identity ChainState)
-&gt; (TxPool -&gt; Identity TxPool)
-&gt; EmulatorState
-&gt; Identity EmulatorState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(TxPool -&gt; Identity TxPool) -&gt; ChainState -&gt; Identity ChainState
Lens' ChainState TxPool
</span><span class="hs-identifier hs-var">Chain.txPool</span></span><span> </span><span class="annot"><span class="annottext">((TxPool -&gt; Identity TxPool)
 -&gt; EmulatorState -&gt; Identity EmulatorState)
-&gt; TxPool -&gt; EmulatorState -&gt; EmulatorState
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">TxPool
</span><a href="#local-6989586621680563003"><span class="hs-identifier hs-var">tp</span></a></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="hs-comment">{- Note [Creating wallets with multiple outputs]

Every transaction needs a collateral input, which is a wallet output that gets spent
when the transaction fails to validate on chain (phase 2 validation). This output is required
to be an Ada-only output. To make sure we always have an Ada-only output available during emulation,
we create 10 Ada-only outputs per wallet here.
-}</span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-comment">-- | Initialise the emulator state with a single pending transaction that</span><span>
</span><span id="line-287"></span><span class="hs-comment">--   creates the initial distribution of funds to public key addresses.</span><span>
</span><span id="line-288"></span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#emulatorStateInitialDist"><span class="hs-identifier hs-type">emulatorStateInitialDist</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Params</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PaymentPubKeyHash</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToCardanoError</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorState"><span class="hs-identifier hs-type">EmulatorState</span></a></span><span>
</span><span id="line-289"></span><span id="emulatorStateInitialDist"><span class="annot"><span class="annottext">emulatorStateInitialDist :: Params
-&gt; Map PaymentPubKeyHash Value
-&gt; Either ToCardanoError EmulatorState
</span><a href="Wallet.Emulator.MultiAgent.html#emulatorStateInitialDist"><span class="hs-identifier hs-var hs-var">emulatorStateInitialDist</span></a></span></span><span> </span><span id="local-6989586621680563000"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680563000"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621680562999"><span class="annot"><span class="annottext">Map PaymentPubKeyHash Value
</span><a href="#local-6989586621680562999"><span class="hs-identifier hs-var">mp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-290"></span><span>    </span><span id="local-6989586621680562998"><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621680562998"><span class="hs-identifier hs-var">minAdaEmptyTxOut</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Either ToCardanoError Lovelace
</span><a href="#local-6989586621680562997"><span class="hs-identifier hs-var">mMinAdaTxOut</span></a></span><span>
</span><span id="line-291"></span><span>    </span><span id="local-6989586621680562996"><span class="annot"><span class="annottext">[[TxOut]]
</span><a href="#local-6989586621680562996"><span class="hs-identifier hs-var">outs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((PaymentPubKeyHash, Value) -&gt; Either ToCardanoError [TxOut])
-&gt; [(PaymentPubKeyHash, Value)] -&gt; Either ToCardanoError [[TxOut]]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lovelace
-&gt; (PaymentPubKeyHash, Value) -&gt; Either ToCardanoError [TxOut]
</span><a href="#local-6989586621680562994"><span class="hs-identifier hs-var">mkOutputs</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621680562998"><span class="hs-identifier hs-var">minAdaEmptyTxOut</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map PaymentPubKeyHash Value -&gt; [(PaymentPubKeyHash, Value)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">Map PaymentPubKeyHash Value
</span><a href="#local-6989586621680562999"><span class="hs-identifier hs-var">mp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>    </span><span id="local-6989586621680562992"><span class="annot"><span class="annottext">(TxValidityLowerBound BabbageEra, TxValidityUpperBound BabbageEra)
</span><a href="#local-6989586621680562992"><span class="hs-identifier hs-var">validityRange</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SlotRange
-&gt; Either
     ToCardanoError
     (TxValidityLowerBound BabbageEra, TxValidityUpperBound BabbageEra)
</span><span class="hs-identifier hs-var">C.toCardanoValidityRange</span></span><span> </span><span class="annot"><span class="annottext">SlotRange
</span><a href="Wallet.API.html#defaultSlotRange"><span class="hs-identifier hs-var">WAPI.defaultSlotRange</span></a></span><span>
</span><span id="line-293"></span><span>    </span><span id="local-6989586621680562990"><span class="annot"><span class="annottext">ScriptWitness WitCtxMint BabbageEra
</span><a href="#local-6989586621680562990"><span class="hs-identifier hs-var">mintWitness</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ToCardanoError
 -&gt; Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra))
-&gt; (ScriptWitness WitCtxMint BabbageEra
    -&gt; Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra))
-&gt; Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra)
-&gt; Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra)
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
-&gt; Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String
 -&gt; Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra))
-&gt; (ToCardanoError -&gt; String)
-&gt; ToCardanoError
-&gt; Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ToCardanoError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ScriptWitness WitCtxMint BabbageEra
-&gt; Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra)
 -&gt; Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra))
-&gt; Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra)
-&gt; Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptLanguageInEra PlutusScriptV2 BabbageEra
-&gt; PlutusScriptVersion PlutusScriptV2
-&gt; PlutusScriptOrReferenceInput PlutusScriptV2
-&gt; ScriptDatum WitCtxMint
-&gt; ScriptRedeemer
-&gt; ExecutionUnits
-&gt; ScriptWitness WitCtxMint BabbageEra
forall lang era witctx.
ScriptLanguageInEra lang era
-&gt; PlutusScriptVersion lang
-&gt; PlutusScriptOrReferenceInput lang
-&gt; ScriptDatum witctx
-&gt; ScriptRedeemer
-&gt; ExecutionUnits
-&gt; ScriptWitness witctx era
</span><span class="hs-identifier hs-var">C.PlutusScriptWitness</span></span><span> </span><span class="annot"><span class="annottext">ScriptLanguageInEra PlutusScriptV2 BabbageEra
</span><span class="hs-identifier hs-var">C.PlutusScriptV2InBabbage</span></span><span> </span><span class="annot"><span class="annottext">PlutusScriptVersion PlutusScriptV2
</span><span class="hs-identifier hs-var">C.PlutusScriptV2</span></span><span>
</span><span id="line-294"></span><span>                           </span><span class="annot"><span class="annottext">(PlutusScriptOrReferenceInput PlutusScriptV2
 -&gt; ScriptDatum WitCtxMint
 -&gt; ScriptRedeemer
 -&gt; ExecutionUnits
 -&gt; ScriptWitness WitCtxMint BabbageEra)
-&gt; Either
     ToCardanoError (PlutusScriptOrReferenceInput PlutusScriptV2)
-&gt; Either
     ToCardanoError
     (ScriptDatum WitCtxMint
      -&gt; ScriptRedeemer
      -&gt; ExecutionUnits
      -&gt; ScriptWitness WitCtxMint BabbageEra)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlutusScript PlutusScriptV2
-&gt; PlutusScriptOrReferenceInput PlutusScriptV2
forall lang. PlutusScript lang -&gt; PlutusScriptOrReferenceInput lang
</span><span class="hs-identifier hs-var">C.PScript</span></span><span> </span><span class="annot"><span class="annottext">(PlutusScript PlutusScriptV2
 -&gt; PlutusScriptOrReferenceInput PlutusScriptV2)
-&gt; Either ToCardanoError (PlutusScript PlutusScriptV2)
-&gt; Either
     ToCardanoError (PlutusScriptOrReferenceInput PlutusScriptV2)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">AsType (PlutusScript PlutusScriptV2)
-&gt; Script -&gt; Either ToCardanoError (PlutusScript PlutusScriptV2)
forall plutusScript.
SerialiseAsRawBytes plutusScript =&gt;
AsType plutusScript -&gt; Script -&gt; Either ToCardanoError plutusScript
</span><span class="hs-identifier hs-var">C.toCardanoPlutusScript</span></span><span>
</span><span id="line-295"></span><span>                                                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AsType PlutusScriptV2 -&gt; AsType (PlutusScript PlutusScriptV2)
forall lang. AsType lang -&gt; AsType (PlutusScript lang)
</span><span class="hs-identifier hs-var">C.AsPlutusScript</span></span><span> </span><span class="annot"><span class="annottext">AsType PlutusScriptV2
</span><span class="hs-identifier hs-var">C.AsPlutusScriptV2</span></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>                                                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MintingPolicy -&gt; Script
</span><span class="hs-identifier hs-var hs-var">getMintingPolicy</span></span><span> </span><span class="annot"><span class="annottext">MintingPolicy
</span><span class="hs-identifier hs-var">alwaysSucceedPolicy</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>                           </span><span class="annot"><span class="annottext">Either
  ToCardanoError
  (ScriptDatum WitCtxMint
   -&gt; ScriptRedeemer
   -&gt; ExecutionUnits
   -&gt; ScriptWitness WitCtxMint BabbageEra)
-&gt; Either ToCardanoError (ScriptDatum WitCtxMint)
-&gt; Either
     ToCardanoError
     (ScriptRedeemer
      -&gt; ExecutionUnits -&gt; ScriptWitness WitCtxMint BabbageEra)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptDatum WitCtxMint
-&gt; Either ToCardanoError (ScriptDatum WitCtxMint)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptDatum WitCtxMint
</span><span class="hs-identifier hs-var">C.NoScriptDatumForMint</span></span><span>
</span><span id="line-298"></span><span>                           </span><span class="annot"><span class="annottext">Either
  ToCardanoError
  (ScriptRedeemer
   -&gt; ExecutionUnits -&gt; ScriptWitness WitCtxMint BabbageEra)
-&gt; Either ToCardanoError ScriptRedeemer
-&gt; Either
     ToCardanoError
     (ExecutionUnits -&gt; ScriptWitness WitCtxMint BabbageEra)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptRedeemer -&gt; Either ToCardanoError ScriptRedeemer
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Data -&gt; ScriptRedeemer
</span><span class="hs-identifier hs-var">C.fromPlutusData</span></span><span> </span><span class="annot"><span class="annottext">(Data -&gt; ScriptRedeemer) -&gt; Data -&gt; ScriptRedeemer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Redeemer -&gt; Data
forall a. ToData a =&gt; a -&gt; Data
</span><span class="hs-identifier hs-var">toData</span></span><span> </span><span class="annot"><span class="annottext">Redeemer
</span><span class="hs-identifier hs-var">Script.unitRedeemer</span></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>                           </span><span class="annot"><span class="annottext">Either
  ToCardanoError
  (ExecutionUnits -&gt; ScriptWitness WitCtxMint BabbageEra)
-&gt; Either ToCardanoError ExecutionUnits
-&gt; Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutionUnits -&gt; Either ToCardanoError ExecutionUnits
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutionUnits
</span><span class="hs-identifier hs-var">C.zeroExecutionUnits</span></span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-301"></span><span>        </span><span id="local-6989586621680562978"><span class="annot"><span class="annottext">txBodyContent :: TxBodyContent BuildTx BabbageEra
</span><a href="#local-6989586621680562978"><span class="hs-identifier hs-var hs-var">txBodyContent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxBodyContent BuildTx BabbageEra
</span><span class="hs-identifier hs-var">emptyTxBodyContent</span></span><span>
</span><span id="line-302"></span><span>           </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">txIns :: TxIns BuildTx BabbageEra
</span><span class="hs-identifier hs-var">C.txIns</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn
</span><span class="hs-identifier hs-var">Index.genesisTxIn</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Witness WitCtxTxIn BabbageEra
-&gt; BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra)
forall a. a -&gt; BuildTxWith BuildTx a
</span><span class="hs-identifier hs-var">C.BuildTxWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyWitnessInCtx WitCtxTxIn -&gt; Witness WitCtxTxIn BabbageEra
forall witctx era. KeyWitnessInCtx witctx -&gt; Witness witctx era
</span><span class="hs-identifier hs-var">C.KeyWitness</span></span><span> </span><span class="annot"><span class="annottext">KeyWitnessInCtx WitCtxTxIn
</span><span class="hs-identifier hs-var">C.KeyWitnessForSpending</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-303"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txInsCollateral :: TxInsCollateral BabbageEra
</span><span class="hs-identifier hs-var">C.txInsCollateral</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CollateralSupportedInEra BabbageEra
-&gt; [TxIn] -&gt; TxInsCollateral BabbageEra
forall era.
CollateralSupportedInEra era -&gt; [TxIn] -&gt; TxInsCollateral era
</span><span class="hs-identifier hs-var">C.TxInsCollateral</span></span><span> </span><span class="annot"><span class="annottext">CollateralSupportedInEra BabbageEra
</span><span class="hs-identifier hs-var">C.CollateralInBabbageEra</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TxIn
</span><span class="hs-identifier hs-var">Index.genesisTxIn</span></span><span class="hs-special">]</span><span>
</span><span id="line-304"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txMintValue :: TxMintValue BuildTx BabbageEra
</span><span class="hs-identifier hs-var">C.txMintValue</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MultiAssetSupportedInEra BabbageEra
-&gt; Value
-&gt; BuildTxWith
     BuildTx (Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
-&gt; TxMintValue BuildTx BabbageEra
forall era build.
MultiAssetSupportedInEra era
-&gt; Value
-&gt; BuildTxWith build (Map PolicyId (ScriptWitness WitCtxMint era))
-&gt; TxMintValue build era
</span><span class="hs-identifier hs-var">C.TxMintValue</span></span><span> </span><span class="annot"><span class="annottext">MultiAssetSupportedInEra BabbageEra
</span><span class="hs-identifier hs-var">C.MultiAssetInBabbageEra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map PaymentPubKeyHash Value -&gt; Value
forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">(Map PaymentPubKeyHash Value -&gt; Value)
-&gt; Map PaymentPubKeyHash Value -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Value)
-&gt; Map PaymentPubKeyHash Value -&gt; Map PaymentPubKeyHash Value
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value
</span><span class="hs-identifier hs-var">CardanoAPI.noAdaValue</span></span><span> </span><span class="annot"><span class="annottext">Map PaymentPubKeyHash Value
</span><a href="#local-6989586621680562999"><span class="hs-identifier hs-var">mp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>                              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map PolicyId (ScriptWitness WitCtxMint BabbageEra)
-&gt; BuildTxWith
     BuildTx (Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
forall a. a -&gt; BuildTxWith BuildTx a
</span><span class="hs-identifier hs-var">C.BuildTxWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PolicyId
-&gt; ScriptWitness WitCtxMint BabbageEra
-&gt; Map PolicyId (ScriptWitness WitCtxMint BabbageEra)
forall k a. k -&gt; a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.singleton</span></span><span> </span><span class="annot"><span class="annottext">PolicyId
</span><span class="hs-identifier hs-var">alwaysSucceedPolicyId</span></span><span> </span><span class="annot"><span class="annottext">ScriptWitness WitCtxMint BabbageEra
</span><a href="#local-6989586621680562990"><span class="hs-identifier hs-var">mintWitness</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txOuts :: [TxOut CtxTx BabbageEra]
</span><span class="hs-identifier hs-var">C.txOuts</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; TxOut CtxTx BabbageEra
</span><span class="hs-identifier hs-var hs-var">Tx.getTxOut</span></span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; TxOut CtxTx BabbageEra)
-&gt; [TxOut] -&gt; [TxOut CtxTx BabbageEra]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[[TxOut]] -&gt; [TxOut]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">[[TxOut]]
</span><a href="#local-6989586621680562996"><span class="hs-identifier hs-var">outs</span></a></span><span>
</span><span id="line-307"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txValidityRange :: (TxValidityLowerBound BabbageEra, TxValidityUpperBound BabbageEra)
</span><span class="hs-identifier hs-var">C.txValidityRange</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TxValidityLowerBound BabbageEra, TxValidityUpperBound BabbageEra)
</span><a href="#local-6989586621680562992"><span class="hs-identifier hs-var">validityRange</span></a></span><span>
</span><span id="line-308"></span><span>           </span><span class="hs-special">}</span><span>
</span><span id="line-309"></span><span>    </span><span id="local-6989586621680562960"><span class="annot"><span class="annottext">TxBody BabbageEra
</span><a href="#local-6989586621680562960"><span class="hs-identifier hs-var">txBody</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TxBodyError -&gt; Either ToCardanoError (TxBody BabbageEra))
-&gt; (TxBody BabbageEra -&gt; Either ToCardanoError (TxBody BabbageEra))
-&gt; Either TxBodyError (TxBody BabbageEra)
-&gt; Either ToCardanoError (TxBody BabbageEra)
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Either ToCardanoError (TxBody BabbageEra)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either ToCardanoError (TxBody BabbageEra))
-&gt; (TxBodyError -&gt; String)
-&gt; TxBodyError
-&gt; Either ToCardanoError (TxBody BabbageEra)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;emulatorStateInitialDist: Can't create TxBody: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; (TxBodyError -&gt; String) -&gt; TxBodyError -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxBody BabbageEra -&gt; Either ToCardanoError (TxBody BabbageEra)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Either TxBodyError (TxBody BabbageEra)
 -&gt; Either ToCardanoError (TxBody BabbageEra))
-&gt; Either TxBodyError (TxBody BabbageEra)
-&gt; Either ToCardanoError (TxBody BabbageEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyContent BuildTx BabbageEra
-&gt; Either TxBodyError (TxBody BabbageEra)
forall era.
IsCardanoEra era =&gt;
TxBodyContent BuildTx era -&gt; Either TxBodyError (TxBody era)
</span><span class="hs-identifier hs-var">C.makeTransactionBody</span></span><span> </span><span class="annot"><span class="annottext">TxBodyContent BuildTx BabbageEra
</span><a href="#local-6989586621680562978"><span class="hs-identifier hs-var">txBodyContent</span></a></span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680562958"><span class="annot"><span class="annottext">cTx :: CardanoTx
</span><a href="#local-6989586621680562958"><span class="hs-identifier hs-var hs-var">cTx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CardanoTx -&gt; CardanoTx
</span><span class="hs-identifier hs-var">signAll</span></span><span> </span><span class="annot"><span class="annottext">(CardanoTx -&gt; CardanoTx) -&gt; CardanoTx -&gt; CardanoTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Tx BabbageEra -&gt; CardanoTx
</span><span class="hs-identifier hs-var">CardanoEmulatorEraTx</span></span><span> </span><span class="annot"><span class="annottext">(Tx BabbageEra -&gt; CardanoTx) -&gt; Tx BabbageEra -&gt; CardanoTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody BabbageEra -&gt; [KeyWitness BabbageEra] -&gt; Tx BabbageEra
forall era. TxBody era -&gt; [KeyWitness era] -&gt; Tx era
</span><span class="hs-identifier hs-var">C.Tx</span></span><span> </span><span class="annot"><span class="annottext">TxBody BabbageEra
</span><a href="#local-6989586621680562960"><span class="hs-identifier hs-var">txBody</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><span class="annottext">EmulatorState -&gt; Either ToCardanoError EmulatorState
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(EmulatorState -&gt; Either ToCardanoError EmulatorState)
-&gt; EmulatorState -&gt; Either ToCardanoError EmulatorState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxPool -&gt; EmulatorState
</span><a href="Wallet.Emulator.MultiAgent.html#emulatorStatePool"><span class="hs-identifier hs-var">emulatorStatePool</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621680562958"><span class="hs-identifier hs-var">cTx</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-312"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-313"></span><span>        </span><span class="hs-comment">-- we start with an empty TxOut and we adjust it to be sure that the contained Adas fit the size</span><span>
</span><span id="line-314"></span><span>        </span><span class="hs-comment">-- of the TxOut</span><span>
</span><span id="line-315"></span><span>        </span><span id="local-6989586621680562997"><span class="annot"><span class="annottext">mMinAdaTxOut :: Either ToCardanoError Lovelace
</span><a href="#local-6989586621680562997"><span class="hs-identifier hs-var hs-var">mMinAdaTxOut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-316"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680562956"><span class="annot"><span class="annottext">k :: PaymentPubKeyHash
</span><a href="#local-6989586621680562956"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PaymentPubKeyHash, Value) -&gt; PaymentPubKeyHash
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((PaymentPubKeyHash, Value) -&gt; PaymentPubKeyHash)
-&gt; (PaymentPubKeyHash, Value) -&gt; PaymentPubKeyHash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(PaymentPubKeyHash, Value)] -&gt; (PaymentPubKeyHash, Value)
forall a. [a] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="annot"><span class="annottext">([(PaymentPubKeyHash, Value)] -&gt; (PaymentPubKeyHash, Value))
-&gt; [(PaymentPubKeyHash, Value)] -&gt; (PaymentPubKeyHash, Value)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Map PaymentPubKeyHash Value -&gt; [(PaymentPubKeyHash, Value)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">Map PaymentPubKeyHash Value
</span><a href="#local-6989586621680562999"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-317"></span><span>          </span><span id="local-6989586621680562954"><span class="annot"><span class="annottext">TxOut
</span><a href="#local-6989586621680562954"><span class="hs-identifier hs-var">emptyTxOut</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PaymentPubKeyHash -&gt; Value -&gt; Either ToCardanoError TxOut
</span><a href="#local-6989586621680562953"><span class="hs-identifier hs-var">mkOutput</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentPubKeyHash
</span><a href="#local-6989586621680562956"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Value
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-318"></span><span>          </span><span class="annot"><span class="annottext">Lovelace -&gt; Either ToCardanoError Lovelace
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Lovelace -&gt; Either ToCardanoError Lovelace)
-&gt; Lovelace -&gt; Either ToCardanoError Lovelace
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PParams (BabbageEra StandardCrypto) -&gt; TxOut -&gt; Lovelace
</span><span class="hs-identifier hs-var">minAdaTxOut</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params -&gt; PParams (BabbageEra StandardCrypto)
</span><span class="hs-identifier hs-var hs-var">emulatorPParams</span></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680563000"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxOut
</span><a href="#local-6989586621680562954"><span class="hs-identifier hs-var">emptyTxOut</span></a></span><span>
</span><span id="line-319"></span><span>        </span><span class="hs-comment">-- See [Creating wallets with multiple outputs]</span><span>
</span><span id="line-320"></span><span>        </span><span id="local-6989586621680562994"><span class="annot"><span class="annottext">mkOutputs :: Lovelace
-&gt; (PaymentPubKeyHash, Value) -&gt; Either ToCardanoError [TxOut]
</span><a href="#local-6989586621680562994"><span class="hs-identifier hs-var hs-var">mkOutputs</span></a></span></span><span> </span><span id="local-6989586621680562951"><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621680562951"><span class="hs-identifier hs-var">minAda</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680562950"><span class="annot"><span class="annottext">PaymentPubKeyHash
</span><a href="#local-6989586621680562950"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680562949"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680562949"><span class="hs-identifier hs-var">vl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Either ToCardanoError TxOut)
-&gt; [Value] -&gt; Either ToCardanoError [TxOut]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PaymentPubKeyHash -&gt; Value -&gt; Either ToCardanoError TxOut
</span><a href="#local-6989586621680562953"><span class="hs-identifier hs-var">mkOutput</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentPubKeyHash
</span><a href="#local-6989586621680562950"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Lovelace -&gt; [Value]
</span><a href="#local-6989586621680562948"><span class="hs-identifier hs-var">splitInto10</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680562949"><span class="hs-identifier hs-var">vl</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621680562951"><span class="hs-identifier hs-var">minAda</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>        </span><span id="local-6989586621680562948"><span class="annot"><span class="annottext">splitInto10 :: Value -&gt; Lovelace -&gt; [Value]
</span><a href="#local-6989586621680562948"><span class="hs-identifier hs-var hs-var">splitInto10</span></a></span></span><span> </span><span id="local-6989586621680562947"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680562947"><span class="hs-identifier hs-var">vl</span></a></span></span><span> </span><span id="local-6989586621680562946"><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621680562946"><span class="hs-identifier hs-var">minAda</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621680562945"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Lovelace -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><span class="hs-number">1</span></span><span>
</span><span id="line-322"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680562947"><span class="hs-identifier hs-var">vl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-323"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Value -&gt; [Value]
forall a. Int -&gt; a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lovelace -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621680562945"><span class="hs-identifier hs-var">count</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lovelace -&gt; Value
</span><span class="hs-identifier hs-var">lovelaceToValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621680562942"><span class="hs-identifier hs-var">ada</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Lovelace -&gt; Lovelace
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621680562945"><span class="hs-identifier hs-var">count</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; [Value] -&gt; [Value]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621680562940"><span class="hs-identifier hs-var">remainder</span></a></span><span>
</span><span id="line-324"></span><span>            </span><span class="hs-keyword">where</span><span>
</span><span id="line-325"></span><span>                </span><span id="local-6989586621680562942"><span class="annot"><span class="annottext">ada :: Lovelace
</span><a href="#local-6989586621680562942"><span class="hs-identifier hs-var hs-var">ada</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Maybe Lovelace
</span><span class="hs-identifier hs-var">C.valueToLovelace</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680562947"><span class="hs-identifier hs-var">vl</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-326"></span><span>                    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680562938"><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621680562938"><span class="hs-identifier hs-var">lovelace</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621680562938"><span class="hs-identifier hs-var">lovelace</span></a></span><span>
</span><span id="line-327"></span><span>                    </span><span class="annot"><span class="annottext">Maybe Lovelace
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Lovelace
</span><span class="hs-identifier hs-var">C.selectLovelace</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680562947"><span class="hs-identifier hs-var">vl</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Lovelace -&gt; Lovelace
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621680562946"><span class="hs-identifier hs-var">minAda</span></a></span><span>
</span><span id="line-328"></span><span>                </span><span class="hs-comment">-- Make sure we don't make the outputs too small</span><span>
</span><span id="line-329"></span><span>                </span><span id="local-6989586621680562945"><span class="annot"><span class="annottext">count :: Lovelace
</span><a href="#local-6989586621680562945"><span class="hs-identifier hs-var hs-var">count</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Lovelace -&gt; Lovelace
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">min</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">(Lovelace -&gt; Lovelace) -&gt; Lovelace -&gt; Lovelace
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621680562942"><span class="hs-identifier hs-var">ada</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Lovelace -&gt; Lovelace
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621680562946"><span class="hs-identifier hs-var">minAda</span></a></span><span>
</span><span id="line-330"></span><span>                </span><span id="local-6989586621680562940"><span class="annot"><span class="annottext">remainder :: [Value]
</span><a href="#local-6989586621680562940"><span class="hs-identifier hs-var hs-var">remainder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680562947"><span class="hs-identifier hs-var">vl</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; Value
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Value
</span><span class="hs-identifier hs-var">lovelaceToValue</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621680562942"><span class="hs-identifier hs-var">ada</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Maybe Lovelace -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">isNothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Maybe Lovelace
</span><span class="hs-identifier hs-var">C.valueToLovelace</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680562947"><span class="hs-identifier hs-var">vl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-331"></span><span>        </span><span id="local-6989586621680562953"><span class="annot"><span class="annottext">mkOutput :: PaymentPubKeyHash -&gt; Value -&gt; Either ToCardanoError TxOut
</span><a href="#local-6989586621680562953"><span class="hs-identifier hs-var hs-var">mkOutput</span></a></span></span><span> </span><span id="local-6989586621680562935"><span class="annot"><span class="annottext">PaymentPubKeyHash
</span><a href="#local-6989586621680562935"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621680562934"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680562934"><span class="hs-identifier hs-var">vl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-332"></span><span>            </span><span id="local-6989586621680562933"><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680562933"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NetworkId -&gt; Address -&gt; Either ToCardanoError CardanoAddress
</span><span class="hs-identifier hs-var">CardanoAPI.toCardanoAddressInEra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params -&gt; NetworkId
</span><span class="hs-identifier hs-var hs-var">pNetworkId</span></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680563000"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PaymentPubKeyHash -&gt; Maybe StakingCredential -&gt; Address
</span><span class="hs-identifier hs-var">pubKeyHashAddress</span></span><span> </span><span class="annot"><span class="annottext">PaymentPubKeyHash
</span><a href="#local-6989586621680562935"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe StakingCredential
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>            </span><span class="annot"><span class="annottext">TxOut -&gt; Either ToCardanoError TxOut
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; Either ToCardanoError TxOut)
-&gt; TxOut -&gt; Either ToCardanoError TxOut
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut CtxTx BabbageEra -&gt; TxOut
</span><span class="hs-identifier hs-var">TxOut</span></span><span> </span><span class="annot"><span class="annottext">(TxOut CtxTx BabbageEra -&gt; TxOut)
-&gt; TxOut CtxTx BabbageEra -&gt; TxOut
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress
-&gt; TxOutValue BabbageEra
-&gt; TxOutDatum CtxTx BabbageEra
-&gt; ReferenceScript BabbageEra
-&gt; TxOut CtxTx BabbageEra
forall ctx era.
AddressInEra era
-&gt; TxOutValue era
-&gt; TxOutDatum ctx era
-&gt; ReferenceScript era
-&gt; TxOut ctx era
</span><span class="hs-identifier hs-var">C.TxOut</span></span><span> </span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680562933"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; TxOutValue BabbageEra
</span><span class="hs-identifier hs-var">CardanoAPI.toCardanoTxOutValue</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680562934"><span class="hs-identifier hs-var">vl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxOutDatum CtxTx BabbageEra
forall ctx era. TxOutDatum ctx era
</span><span class="hs-identifier hs-var">C.TxOutDatumNone</span></span><span> </span><span class="annot"><span class="annottext">ReferenceScript BabbageEra
forall era. ReferenceScript era
</span><span class="hs-identifier hs-var">C.ReferenceScriptNone</span></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="hs-keyword">type</span><span> </span><span id="MultiAgentEffs"><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#MultiAgentEffs"><span class="hs-identifier hs-var">MultiAgentEffs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-336"></span><span>    </span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorState"><span class="hs-identifier hs-type">EmulatorState</span></a></span><span>
</span><span id="line-337"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LogMsg</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorEvent%27"><span class="hs-identifier hs-type">EmulatorEvent'</span></a></span><span>
</span><span id="line-338"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.Error.html#WalletAPIError"><span class="hs-identifier hs-type">WAPI.WalletAPIError</span></a></span><span>
</span><span id="line-339"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChainIndex.ChainIndexError</span></span><span>
</span><span id="line-340"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Chain.ChainEffect</span></span><span>
</span><span id="line-341"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Chain.ChainControlEffect</span></span><span>
</span><span id="line-342"></span><span>     </span><span class="hs-special">]</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#handleMultiAgentControl"><span class="hs-identifier hs-type">handleMultiAgentControl</span></a></span><span>
</span><span id="line-345"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680562924"><span class="annot"><a href="#local-6989586621680562924"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Members</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#MultiAgentEffs"><span class="hs-identifier hs-type">MultiAgentEffs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680562924"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-346"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#MultiAgentControlEffect"><span class="hs-identifier hs-type">MultiAgentControlEffect</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621680562924"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680562924"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-347"></span><span id="handleMultiAgentControl"><span class="annot"><span class="annottext">handleMultiAgentControl :: Eff (MultiAgentControlEffect : effs) ~&gt; Eff effs
</span><a href="Wallet.Emulator.MultiAgent.html#handleMultiAgentControl"><span class="hs-identifier hs-var hs-var">handleMultiAgentControl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MultiAgentControlEffect ~&gt; Eff effs)
-&gt; Eff (MultiAgentControlEffect : effs) ~&gt; Eff effs
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="annot"><span class="annottext">((MultiAgentControlEffect ~&gt; Eff effs)
 -&gt; Eff (MultiAgentControlEffect : effs) ~&gt; Eff effs)
-&gt; (MultiAgentControlEffect ~&gt; Eff effs)
-&gt; Eff (MultiAgentControlEffect : effs) ~&gt; Eff effs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-348"></span><span>    </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#WalletControlAction"><span class="hs-identifier hs-type">WalletControlAction</span></a></span><span> </span><span id="local-6989586621680562923"><span class="annot"><a href="#local-6989586621680562923"><span class="hs-identifier hs-var">wallet</span></a></span></span><span> </span><span id="local-6989586621680562922"><span class="annot"><a href="#local-6989586621680562922"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-349"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-350"></span><span>            </span><span class="annot"><a href="#local-6989586621680562921"><span class="hs-identifier hs-type">p1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AReview</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorEvent%27"><span class="hs-identifier hs-type">EmulatorEvent'</span></a></span><span> </span><span class="annot"><a href="Wallet.Emulator.Wallet.html#WalletEvent"><span class="hs-identifier hs-type">Wallet.WalletEvent</span></a></span><span>
</span><span id="line-351"></span><span>            </span><span id="local-6989586621680562921"><span class="annot"><span class="annottext">p1 :: AReview EmulatorEvent' WalletEvent
</span><a href="#local-6989586621680562921"><span class="hs-identifier hs-var hs-var">p1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Prism' EmulatorEvent' WalletEvent
</span><a href="Wallet.Emulator.MultiAgent.html#walletEvent"><span class="hs-identifier hs-var">walletEvent</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680562923"><span class="hs-identifier hs-var">wallet</span></a></span><span>
</span><span id="line-352"></span><span>            </span><span class="annot"><a href="#local-6989586621680562920"><span class="hs-identifier hs-type">p2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AReview</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorEvent%27"><span class="hs-identifier hs-type">EmulatorEvent'</span></a></span><span> </span><span class="annot"><a href="Wallet.Emulator.NodeClient.html#NodeClientEvent"><span class="hs-identifier hs-type">NC.NodeClientEvent</span></a></span><span>
</span><span id="line-353"></span><span>            </span><span id="local-6989586621680562920"><span class="annot"><span class="annottext">p2 :: AReview EmulatorEvent' NodeClientEvent
</span><a href="#local-6989586621680562920"><span class="hs-identifier hs-var hs-var">p2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Prism' EmulatorEvent' NodeClientEvent
</span><a href="Wallet.Emulator.MultiAgent.html#walletClientEvent"><span class="hs-identifier hs-var">walletClientEvent</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680562923"><span class="hs-identifier hs-var">wallet</span></a></span><span>
</span><span id="line-354"></span><span>            </span><span class="annot"><a href="#local-6989586621680562919"><span class="hs-identifier hs-type">p3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AReview</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorEvent%27"><span class="hs-identifier hs-type">EmulatorEvent'</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChainIndex.ChainIndexLog</span></span><span>
</span><span id="line-355"></span><span>            </span><span id="local-6989586621680562919"><span class="annot"><span class="annottext">p3 :: AReview EmulatorEvent' ChainIndexLog
</span><a href="#local-6989586621680562919"><span class="hs-identifier hs-var hs-var">p3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Prism' EmulatorEvent' ChainIndexLog
</span><a href="Wallet.Emulator.MultiAgent.html#chainIndexEvent"><span class="hs-identifier hs-var">chainIndexEvent</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680562923"><span class="hs-identifier hs-var">wallet</span></a></span><span>
</span><span id="line-356"></span><span>            </span><span class="annot"><a href="#local-6989586621680562918"><span class="hs-identifier hs-type">p4</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AReview</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorEvent%27"><span class="hs-identifier hs-type">EmulatorEvent'</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-357"></span><span>            </span><span id="local-6989586621680562918"><span class="annot"><span class="annottext">p4 :: AReview EmulatorEvent' Text
</span><a href="#local-6989586621680562918"><span class="hs-identifier hs-var hs-var">p4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Wallet -&gt; Prism' EmulatorEvent' WalletEvent
</span><a href="Wallet.Emulator.MultiAgent.html#walletEvent"><span class="hs-identifier hs-var">walletEvent</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680562923"><span class="hs-identifier hs-var">wallet</span></a></span><span> </span><span class="annot"><span class="annottext">AReview EmulatorEvent' WalletEvent
-&gt; (Tagged Text (Identity Text)
    -&gt; Tagged WalletEvent (Identity WalletEvent))
-&gt; AReview EmulatorEvent' Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Tagged Text (Identity Text)
-&gt; Tagged WalletEvent (Identity WalletEvent)
Prism' WalletEvent Text
</span><a href="Wallet.Emulator.Wallet.html#_GenericLog"><span class="hs-identifier hs-var">Wallet._GenericLog</span></a></span><span>
</span><span id="line-358"></span><span>        </span><span class="annot"><span class="annottext">Eff EmulatedWalletControlEffects x
</span><a href="#local-6989586621680562922"><span class="hs-identifier hs-var">act</span></a></span><span>
</span><span id="line-359"></span><span>            </span><span class="annot"><span class="annottext">Eff EmulatedWalletControlEffects x
-&gt; (Eff EmulatedWalletControlEffects x
    -&gt; Eff
         (NodeClientControlEffect
            : ChainIndexControlEffect : SigningProcessControlEffect
            : LogObserve (LogMessage Text) : LogMsg Text : State WalletState
            : LogMsg WalletEvent : State NodeClientState
            : LogMsg NodeClientEvent : State ChainIndexEmulatorState
            : LogMsg ChainIndexLog : State (Maybe SigningProcess)
            : Writer [LogMessage EmulatorEvent] : effs)
         x)
-&gt; Eff
     (NodeClientControlEffect
        : ChainIndexControlEffect : SigningProcessControlEffect
        : LogObserve (LogMessage Text) : LogMsg Text : State WalletState
        : LogMsg WalletEvent : State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
     x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Eff EmulatedWalletControlEffects x
-&gt; Eff
     (NodeClientControlEffect
        : ChainIndexControlEffect : SigningProcessControlEffect
        : LogObserve (LogMessage Text) : LogMsg Text : State WalletState
        : LogMsg WalletEvent : State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
     x
forall (effs :: [* -&gt; *]) (as :: [* -&gt; *]).
CanWeakenEnd as effs =&gt;
Eff as ~&gt; Eff effs
</span><span class="hs-identifier hs-var">raiseEnd</span></span><span>
</span><span id="line-360"></span><span>            </span><span class="annot"><span class="annottext">Eff
  (NodeClientControlEffect
     : ChainIndexControlEffect : SigningProcessControlEffect
     : LogObserve (LogMessage Text) : LogMsg Text : State WalletState
     : LogMsg WalletEvent : State NodeClientState
     : LogMsg NodeClientEvent : State ChainIndexEmulatorState
     : LogMsg ChainIndexLog : State (Maybe SigningProcess)
     : Writer [LogMessage EmulatorEvent] : effs)
  x
-&gt; (Eff
      (NodeClientControlEffect
         : ChainIndexControlEffect : SigningProcessControlEffect
         : LogObserve (LogMessage Text) : LogMsg Text : State WalletState
         : LogMsg WalletEvent : State NodeClientState
         : LogMsg NodeClientEvent : State ChainIndexEmulatorState
         : LogMsg ChainIndexLog : State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs)
      x
    -&gt; Eff
         (ChainIndexControlEffect
            : SigningProcessControlEffect : LogObserve (LogMessage Text)
            : LogMsg Text : State WalletState : LogMsg WalletEvent
            : State NodeClientState : LogMsg NodeClientEvent
            : State ChainIndexEmulatorState : LogMsg ChainIndexLog
            : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
            : effs)
         x)
-&gt; Eff
     (ChainIndexControlEffect
        : SigningProcessControlEffect : LogObserve (LogMessage Text)
        : LogMsg Text : State WalletState : LogMsg WalletEvent
        : State NodeClientState : LogMsg NodeClientEvent
        : State ChainIndexEmulatorState : LogMsg ChainIndexLog
        : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
        : effs)
     x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  (NodeClientControlEffect
     : ChainIndexControlEffect : SigningProcessControlEffect
     : LogObserve (LogMessage Text) : LogMsg Text : State WalletState
     : LogMsg WalletEvent : State NodeClientState
     : LogMsg NodeClientEvent : State ChainIndexEmulatorState
     : LogMsg ChainIndexLog : State (Maybe SigningProcess)
     : Writer [LogMessage EmulatorEvent] : effs)
  x
-&gt; Eff
     (ChainIndexControlEffect
        : SigningProcessControlEffect : LogObserve (LogMessage Text)
        : LogMsg Text : State WalletState : LogMsg WalletEvent
        : State NodeClientState : LogMsg NodeClientEvent
        : State ChainIndexEmulatorState : LogMsg ChainIndexLog
        : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
        : effs)
     x
forall (effs :: [* -&gt; *]).
Members NodeClientEffs effs =&gt;
Eff (NodeClientControlEffect : effs) ~&gt; Eff effs
</span><a href="Wallet.Emulator.NodeClient.html#handleNodeControl"><span class="hs-identifier hs-var">NC.handleNodeControl</span></a></span><span>
</span><span id="line-361"></span><span>            </span><span class="annot"><span class="annottext">Eff
  (ChainIndexControlEffect
     : SigningProcessControlEffect : LogObserve (LogMessage Text)
     : LogMsg Text : State WalletState : LogMsg WalletEvent
     : State NodeClientState : LogMsg NodeClientEvent
     : State ChainIndexEmulatorState : LogMsg ChainIndexLog
     : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
     : effs)
  x
-&gt; (Eff
      (ChainIndexControlEffect
         : SigningProcessControlEffect : LogObserve (LogMessage Text)
         : LogMsg Text : State WalletState : LogMsg WalletEvent
         : State NodeClientState : LogMsg NodeClientEvent
         : State ChainIndexEmulatorState : LogMsg ChainIndexLog
         : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
         : effs)
      x
    -&gt; Eff
         (SigningProcessControlEffect
            : LogObserve (LogMessage Text) : LogMsg Text : State WalletState
            : LogMsg WalletEvent : State NodeClientState
            : LogMsg NodeClientEvent : State ChainIndexEmulatorState
            : LogMsg ChainIndexLog : State (Maybe SigningProcess)
            : Writer [LogMessage EmulatorEvent] : effs)
         x)
-&gt; Eff
     (SigningProcessControlEffect
        : LogObserve (LogMessage Text) : LogMsg Text : State WalletState
        : LogMsg WalletEvent : State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
     x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexControlEffect
 ~&gt; Eff
      (SigningProcessControlEffect
         : LogObserve (LogMessage Text) : LogMsg Text : State WalletState
         : LogMsg WalletEvent : State NodeClientState
         : LogMsg NodeClientEvent : State ChainIndexEmulatorState
         : LogMsg ChainIndexLog : State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs))
-&gt; Eff
     (ChainIndexControlEffect
        : SigningProcessControlEffect : LogObserve (LogMessage Text)
        : LogMsg Text : State WalletState : LogMsg WalletEvent
        : State NodeClientState : LogMsg NodeClientEvent
        : State ChainIndexEmulatorState : LogMsg ChainIndexLog
        : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
        : effs)
   ~&gt; Eff
        (SigningProcessControlEffect
           : LogObserve (LogMessage Text) : LogMsg Text : State WalletState
           : LogMsg WalletEvent : State NodeClientState
           : LogMsg NodeClientEvent : State ChainIndexEmulatorState
           : LogMsg ChainIndexLog : State (Maybe SigningProcess)
           : Writer [LogMessage EmulatorEvent] : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (State ChainIndexEmulatorState) effs,
 Member (Error ChainIndexError) effs,
 Member (LogMsg ChainIndexLog) effs) =&gt;
ChainIndexControlEffect ~&gt; Eff effs
ChainIndexControlEffect
~&gt; Eff
     (SigningProcessControlEffect
        : LogObserve (LogMessage Text) : LogMsg Text : State WalletState
        : LogMsg WalletEvent : State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
</span><span class="hs-identifier hs-var">ChainIndex.handleControl</span></span><span>
</span><span id="line-362"></span><span>            </span><span class="annot"><span class="annottext">Eff
  (SigningProcessControlEffect
     : LogObserve (LogMessage Text) : LogMsg Text : State WalletState
     : LogMsg WalletEvent : State NodeClientState
     : LogMsg NodeClientEvent : State ChainIndexEmulatorState
     : LogMsg ChainIndexLog : State (Maybe SigningProcess)
     : Writer [LogMessage EmulatorEvent] : effs)
  x
-&gt; (Eff
      (SigningProcessControlEffect
         : LogObserve (LogMessage Text) : LogMsg Text : State WalletState
         : LogMsg WalletEvent : State NodeClientState
         : LogMsg NodeClientEvent : State ChainIndexEmulatorState
         : LogMsg ChainIndexLog : State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs)
      x
    -&gt; Eff
         (LogObserve (LogMessage Text)
            : LogMsg Text : State WalletState : LogMsg WalletEvent
            : State NodeClientState : LogMsg NodeClientEvent
            : State ChainIndexEmulatorState : LogMsg ChainIndexLog
            : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
            : effs)
         x)
-&gt; Eff
     (LogObserve (LogMessage Text)
        : LogMsg Text : State WalletState : LogMsg WalletEvent
        : State NodeClientState : LogMsg NodeClientEvent
        : State ChainIndexEmulatorState : LogMsg ChainIndexLog
        : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
        : effs)
     x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  (SigningProcessControlEffect
     : LogObserve (LogMessage Text) : LogMsg Text : State WalletState
     : LogMsg WalletEvent : State NodeClientState
     : LogMsg NodeClientEvent : State ChainIndexEmulatorState
     : LogMsg ChainIndexLog : State (Maybe SigningProcess)
     : Writer [LogMessage EmulatorEvent] : effs)
  x
-&gt; Eff
     (LogObserve (LogMessage Text)
        : LogMsg Text : State WalletState : LogMsg WalletEvent
        : State NodeClientState : LogMsg NodeClientEvent
        : State ChainIndexEmulatorState : LogMsg ChainIndexLog
        : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
        : effs)
     x
forall (effs :: [* -&gt; *]).
Members SigningProcessEffs effs =&gt;
Eff (SigningProcessControlEffect : effs) ~&gt; Eff effs
</span><a href="Wallet.Emulator.Wallet.html#handleSigningProcessControl"><span class="hs-identifier hs-var">Wallet.handleSigningProcessControl</span></a></span><span>
</span><span id="line-363"></span><span>            </span><span class="annot"><span class="annottext">Eff
  (LogObserve (LogMessage Text)
     : LogMsg Text : State WalletState : LogMsg WalletEvent
     : State NodeClientState : LogMsg NodeClientEvent
     : State ChainIndexEmulatorState : LogMsg ChainIndexLog
     : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
     : effs)
  x
-&gt; (Eff
      (LogObserve (LogMessage Text)
         : LogMsg Text : State WalletState : LogMsg WalletEvent
         : State NodeClientState : LogMsg NodeClientEvent
         : State ChainIndexEmulatorState : LogMsg ChainIndexLog
         : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
         : effs)
      x
    -&gt; Eff
         (LogMsg Text
            : State WalletState : LogMsg WalletEvent : State NodeClientState
            : LogMsg NodeClientEvent : State ChainIndexEmulatorState
            : LogMsg ChainIndexLog : State (Maybe SigningProcess)
            : Writer [LogMessage EmulatorEvent] : effs)
         x)
-&gt; Eff
     (LogMsg Text
        : State WalletState : LogMsg WalletEvent : State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
     x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  (LogObserve (LogMessage Text)
     : LogMsg Text : State WalletState : LogMsg WalletEvent
     : State NodeClientState : LogMsg NodeClientEvent
     : State ChainIndexEmulatorState : LogMsg ChainIndexLog
     : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
     : effs)
  x
-&gt; Eff
     (LogMsg Text
        : State WalletState : LogMsg WalletEvent : State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
     x
forall (effs :: [* -&gt; *]).
Member (LogMsg Text) effs =&gt;
Eff (LogObserve (LogMessage Text) : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">handleObserveLog</span></span><span>
</span><span id="line-364"></span><span>            </span><span class="annot"><span class="annottext">Eff
  (LogMsg Text
     : State WalletState : LogMsg WalletEvent : State NodeClientState
     : LogMsg NodeClientEvent : State ChainIndexEmulatorState
     : LogMsg ChainIndexLog : State (Maybe SigningProcess)
     : Writer [LogMessage EmulatorEvent] : effs)
  x
-&gt; (Eff
      (LogMsg Text
         : State WalletState : LogMsg WalletEvent : State NodeClientState
         : LogMsg NodeClientEvent : State ChainIndexEmulatorState
         : LogMsg ChainIndexLog : State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs)
      x
    -&gt; Eff
         (State WalletState
            : LogMsg WalletEvent : State NodeClientState
            : LogMsg NodeClientEvent : State ChainIndexEmulatorState
            : LogMsg ChainIndexLog : State (Maybe SigningProcess)
            : Writer [LogMessage EmulatorEvent] : effs)
         x)
-&gt; Eff
     (State WalletState
        : LogMsg WalletEvent : State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
     x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg Text
 ~&gt; Eff
      (State WalletState
         : LogMsg WalletEvent : State NodeClientState
         : LogMsg NodeClientEvent : State ChainIndexEmulatorState
         : LogMsg ChainIndexLog : State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs))
-&gt; Eff
     (LogMsg Text
        : State WalletState : LogMsg WalletEvent : State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
   ~&gt; Eff
        (State WalletState
           : LogMsg WalletEvent : State NodeClientState
           : LogMsg NodeClientEvent : State ChainIndexEmulatorState
           : LogMsg ChainIndexLog : State (Maybe SigningProcess)
           : Writer [LogMessage EmulatorEvent] : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Text -&gt; EmulatorEvent')
-&gt; LogMsg Text
   ~&gt; Eff
        (State WalletState
           : LogMsg WalletEvent : State NodeClientState
           : LogMsg NodeClientEvent : State ChainIndexEmulatorState
           : LogMsg ChainIndexLog : State (Maybe SigningProcess)
           : Writer [LogMessage EmulatorEvent] : effs)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><span class="hs-identifier hs-var">mapLog</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AReview EmulatorEvent' Text -&gt; Text -&gt; EmulatorEvent'
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview EmulatorEvent' Text
</span><a href="#local-6989586621680562918"><span class="hs-identifier hs-var">p4</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>            </span><span class="annot"><span class="annottext">Eff
  (State WalletState
     : LogMsg WalletEvent : State NodeClientState
     : LogMsg NodeClientEvent : State ChainIndexEmulatorState
     : LogMsg ChainIndexLog : State (Maybe SigningProcess)
     : Writer [LogMessage EmulatorEvent] : effs)
  x
-&gt; (Eff
      (State WalletState
         : LogMsg WalletEvent : State NodeClientState
         : LogMsg NodeClientEvent : State ChainIndexEmulatorState
         : LogMsg ChainIndexLog : State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs)
      x
    -&gt; Eff
         (LogMsg WalletEvent
            : State NodeClientState : LogMsg NodeClientEvent
            : State ChainIndexEmulatorState : LogMsg ChainIndexLog
            : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
            : effs)
         x)
-&gt; Eff
     (LogMsg WalletEvent
        : State NodeClientState : LogMsg NodeClientEvent
        : State ChainIndexEmulatorState : LogMsg ChainIndexLog
        : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
        : effs)
     x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(State WalletState
 ~&gt; Eff
      (LogMsg WalletEvent
         : State NodeClientState : LogMsg NodeClientEvent
         : State ChainIndexEmulatorState : LogMsg ChainIndexLog
         : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
         : effs))
-&gt; Eff
     (State WalletState
        : LogMsg WalletEvent : State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
   ~&gt; Eff
        (LogMsg WalletEvent
           : State NodeClientState : LogMsg NodeClientEvent
           : State ChainIndexEmulatorState : LogMsg ChainIndexLog
           : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
           : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lens' EmulatorState WalletState
-&gt; State WalletState
   ~&gt; Eff
        (LogMsg WalletEvent
           : State NodeClientState : LogMsg NodeClientEvent
           : State ChainIndexEmulatorState : LogMsg ChainIndexLog
           : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
           : effs)
forall s2 (effs :: [* -&gt; *]) s1.
Member (State s2) effs =&gt;
Lens' s2 s1 -&gt; State s1 ~&gt; Eff effs
</span><span class="hs-identifier hs-var">handleZoomedState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; Lens' EmulatorState WalletState
</span><a href="Wallet.Emulator.MultiAgent.html#walletState"><span class="hs-identifier hs-var">walletState</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680562923"><span class="hs-identifier hs-var">wallet</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>            </span><span class="annot"><span class="annottext">Eff
  (LogMsg WalletEvent
     : State NodeClientState : LogMsg NodeClientEvent
     : State ChainIndexEmulatorState : LogMsg ChainIndexLog
     : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
     : effs)
  x
-&gt; (Eff
      (LogMsg WalletEvent
         : State NodeClientState : LogMsg NodeClientEvent
         : State ChainIndexEmulatorState : LogMsg ChainIndexLog
         : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
         : effs)
      x
    -&gt; Eff
         (State NodeClientState
            : LogMsg NodeClientEvent : State ChainIndexEmulatorState
            : LogMsg ChainIndexLog : State (Maybe SigningProcess)
            : Writer [LogMessage EmulatorEvent] : effs)
         x)
-&gt; Eff
     (State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
     x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg WalletEvent
 ~&gt; Eff
      (State NodeClientState
         : LogMsg NodeClientEvent : State ChainIndexEmulatorState
         : LogMsg ChainIndexLog : State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs))
-&gt; Eff
     (LogMsg WalletEvent
        : State NodeClientState : LogMsg NodeClientEvent
        : State ChainIndexEmulatorState : LogMsg ChainIndexLog
        : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
        : effs)
   ~&gt; Eff
        (State NodeClientState
           : LogMsg NodeClientEvent : State ChainIndexEmulatorState
           : LogMsg ChainIndexLog : State (Maybe SigningProcess)
           : Writer [LogMessage EmulatorEvent] : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WalletEvent -&gt; EmulatorEvent')
-&gt; LogMsg WalletEvent
   ~&gt; Eff
        (State NodeClientState
           : LogMsg NodeClientEvent : State ChainIndexEmulatorState
           : LogMsg ChainIndexLog : State (Maybe SigningProcess)
           : Writer [LogMessage EmulatorEvent] : effs)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><span class="hs-identifier hs-var">mapLog</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AReview EmulatorEvent' WalletEvent -&gt; WalletEvent -&gt; EmulatorEvent'
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview EmulatorEvent' WalletEvent
</span><a href="#local-6989586621680562921"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>            </span><span class="annot"><span class="annottext">Eff
  (State NodeClientState
     : LogMsg NodeClientEvent : State ChainIndexEmulatorState
     : LogMsg ChainIndexLog : State (Maybe SigningProcess)
     : Writer [LogMessage EmulatorEvent] : effs)
  x
-&gt; (Eff
      (State NodeClientState
         : LogMsg NodeClientEvent : State ChainIndexEmulatorState
         : LogMsg ChainIndexLog : State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs)
      x
    -&gt; Eff
         (LogMsg NodeClientEvent
            : State ChainIndexEmulatorState : LogMsg ChainIndexLog
            : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
            : effs)
         x)
-&gt; Eff
     (LogMsg NodeClientEvent
        : State ChainIndexEmulatorState : LogMsg ChainIndexLog
        : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
        : effs)
     x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(State NodeClientState
 ~&gt; Eff
      (LogMsg NodeClientEvent
         : State ChainIndexEmulatorState : LogMsg ChainIndexLog
         : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
         : effs))
-&gt; Eff
     (State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
   ~&gt; Eff
        (LogMsg NodeClientEvent
           : State ChainIndexEmulatorState : LogMsg ChainIndexLog
           : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
           : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lens' EmulatorState NodeClientState
-&gt; State NodeClientState
   ~&gt; Eff
        (LogMsg NodeClientEvent
           : State ChainIndexEmulatorState : LogMsg ChainIndexLog
           : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
           : effs)
forall s2 (effs :: [* -&gt; *]) s1.
Member (State s2) effs =&gt;
Lens' s2 s1 -&gt; State s1 ~&gt; Eff effs
</span><span class="hs-identifier hs-var">handleZoomedState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; Lens' EmulatorState WalletState
</span><a href="Wallet.Emulator.MultiAgent.html#walletState"><span class="hs-identifier hs-var">walletState</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680562923"><span class="hs-identifier hs-var">wallet</span></a></span><span> </span><span class="annot"><span class="annottext">((WalletState -&gt; f WalletState)
 -&gt; EmulatorState -&gt; f EmulatorState)
-&gt; ((NodeClientState -&gt; f NodeClientState)
    -&gt; WalletState -&gt; f WalletState)
-&gt; (NodeClientState -&gt; f NodeClientState)
-&gt; EmulatorState
-&gt; f EmulatorState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(NodeClientState -&gt; f NodeClientState)
-&gt; WalletState -&gt; f WalletState
Lens' WalletState NodeClientState
</span><a href="Wallet.Emulator.Wallet.html#nodeClient"><span class="hs-identifier hs-var">Wallet.nodeClient</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>            </span><span class="annot"><span class="annottext">Eff
  (LogMsg NodeClientEvent
     : State ChainIndexEmulatorState : LogMsg ChainIndexLog
     : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
     : effs)
  x
-&gt; (Eff
      (LogMsg NodeClientEvent
         : State ChainIndexEmulatorState : LogMsg ChainIndexLog
         : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
         : effs)
      x
    -&gt; Eff
         (State ChainIndexEmulatorState
            : LogMsg ChainIndexLog : State (Maybe SigningProcess)
            : Writer [LogMessage EmulatorEvent] : effs)
         x)
-&gt; Eff
     (State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
     x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg NodeClientEvent
 ~&gt; Eff
      (State ChainIndexEmulatorState
         : LogMsg ChainIndexLog : State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs))
-&gt; Eff
     (LogMsg NodeClientEvent
        : State ChainIndexEmulatorState : LogMsg ChainIndexLog
        : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
        : effs)
   ~&gt; Eff
        (State ChainIndexEmulatorState
           : LogMsg ChainIndexLog : State (Maybe SigningProcess)
           : Writer [LogMessage EmulatorEvent] : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NodeClientEvent -&gt; EmulatorEvent')
-&gt; LogMsg NodeClientEvent
   ~&gt; Eff
        (State ChainIndexEmulatorState
           : LogMsg ChainIndexLog : State (Maybe SigningProcess)
           : Writer [LogMessage EmulatorEvent] : effs)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><span class="hs-identifier hs-var">mapLog</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AReview EmulatorEvent' NodeClientEvent
-&gt; NodeClientEvent -&gt; EmulatorEvent'
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview EmulatorEvent' NodeClientEvent
</span><a href="#local-6989586621680562920"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>            </span><span class="annot"><span class="annottext">Eff
  (State ChainIndexEmulatorState
     : LogMsg ChainIndexLog : State (Maybe SigningProcess)
     : Writer [LogMessage EmulatorEvent] : effs)
  x
-&gt; (Eff
      (State ChainIndexEmulatorState
         : LogMsg ChainIndexLog : State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs)
      x
    -&gt; Eff
         (LogMsg ChainIndexLog
            : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
            : effs)
         x)
-&gt; Eff
     (LogMsg ChainIndexLog
        : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
        : effs)
     x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(State ChainIndexEmulatorState
 ~&gt; Eff
      (LogMsg ChainIndexLog
         : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
         : effs))
-&gt; Eff
     (State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
   ~&gt; Eff
        (LogMsg ChainIndexLog
           : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
           : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lens' EmulatorState ChainIndexEmulatorState
-&gt; State ChainIndexEmulatorState
   ~&gt; Eff
        (LogMsg ChainIndexLog
           : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
           : effs)
forall s2 (effs :: [* -&gt; *]) s1.
Member (State s2) effs =&gt;
Lens' s2 s1 -&gt; State s1 ~&gt; Eff effs
</span><span class="hs-identifier hs-var">handleZoomedState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; Lens' EmulatorState WalletState
</span><a href="Wallet.Emulator.MultiAgent.html#walletState"><span class="hs-identifier hs-var">walletState</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680562923"><span class="hs-identifier hs-var">wallet</span></a></span><span> </span><span class="annot"><span class="annottext">((WalletState -&gt; f WalletState)
 -&gt; EmulatorState -&gt; f EmulatorState)
-&gt; ((ChainIndexEmulatorState -&gt; f ChainIndexEmulatorState)
    -&gt; WalletState -&gt; f WalletState)
-&gt; (ChainIndexEmulatorState -&gt; f ChainIndexEmulatorState)
-&gt; EmulatorState
-&gt; f EmulatorState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexEmulatorState -&gt; f ChainIndexEmulatorState)
-&gt; WalletState -&gt; f WalletState
Lens' WalletState ChainIndexEmulatorState
</span><a href="Wallet.Emulator.Wallet.html#chainIndexEmulatorState"><span class="hs-identifier hs-var">Wallet.chainIndexEmulatorState</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>            </span><span class="annot"><span class="annottext">Eff
  (LogMsg ChainIndexLog
     : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
     : effs)
  x
-&gt; (Eff
      (LogMsg ChainIndexLog
         : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
         : effs)
      x
    -&gt; Eff
         (State (Maybe SigningProcess)
            : Writer [LogMessage EmulatorEvent] : effs)
         x)
-&gt; Eff
     (State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
     x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg ChainIndexLog
 ~&gt; Eff
      (State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs))
-&gt; Eff
     (LogMsg ChainIndexLog
        : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
        : effs)
   ~&gt; Eff
        (State (Maybe SigningProcess)
           : Writer [LogMessage EmulatorEvent] : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ChainIndexLog -&gt; EmulatorEvent')
-&gt; LogMsg ChainIndexLog
   ~&gt; Eff
        (State (Maybe SigningProcess)
           : Writer [LogMessage EmulatorEvent] : effs)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><span class="hs-identifier hs-var">mapLog</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AReview EmulatorEvent' ChainIndexLog
-&gt; ChainIndexLog -&gt; EmulatorEvent'
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview EmulatorEvent' ChainIndexLog
</span><a href="#local-6989586621680562919"><span class="hs-identifier hs-var">p3</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>            </span><span class="annot"><span class="annottext">Eff
  (State (Maybe SigningProcess)
     : Writer [LogMessage EmulatorEvent] : effs)
  x
-&gt; (Eff
      (State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs)
      x
    -&gt; Eff (Writer [LogMessage EmulatorEvent] : effs) x)
-&gt; Eff (Writer [LogMessage EmulatorEvent] : effs) x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(State (Maybe SigningProcess)
 ~&gt; Eff (Writer [LogMessage EmulatorEvent] : effs))
-&gt; Eff
     (State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
   ~&gt; Eff (Writer [LogMessage EmulatorEvent] : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lens' EmulatorState (Maybe SigningProcess)
-&gt; State (Maybe SigningProcess)
   ~&gt; Eff (Writer [LogMessage EmulatorEvent] : effs)
forall s2 (effs :: [* -&gt; *]) s1.
Member (State s2) effs =&gt;
Lens' s2 s1 -&gt; State s1 ~&gt; Eff effs
</span><span class="hs-identifier hs-var">handleZoomedState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; Lens' EmulatorState WalletState
</span><a href="Wallet.Emulator.MultiAgent.html#walletState"><span class="hs-identifier hs-var">walletState</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680562923"><span class="hs-identifier hs-var">wallet</span></a></span><span> </span><span class="annot"><span class="annottext">((WalletState -&gt; f WalletState)
 -&gt; EmulatorState -&gt; f EmulatorState)
-&gt; ((Maybe SigningProcess -&gt; f (Maybe SigningProcess))
    -&gt; WalletState -&gt; f WalletState)
-&gt; (Maybe SigningProcess -&gt; f (Maybe SigningProcess))
-&gt; EmulatorState
-&gt; f EmulatorState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe SigningProcess -&gt; f (Maybe SigningProcess))
-&gt; WalletState -&gt; f WalletState
Lens' WalletState (Maybe SigningProcess)
</span><a href="Wallet.Emulator.Wallet.html#signingProcess"><span class="hs-identifier hs-var">Wallet.signingProcess</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>            </span><span class="annot"><span class="annottext">Eff (Writer [LogMessage EmulatorEvent] : effs) x
-&gt; (Eff (Writer [LogMessage EmulatorEvent] : effs) x -&gt; Eff effs x)
-&gt; Eff effs x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(Writer [LogMessage EmulatorEvent] ~&gt; Eff effs)
-&gt; Eff (Writer [LogMessage EmulatorEvent] : effs) ~&gt; Eff effs
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Setter' EmulatorState [LogMessage EmulatorEvent]
-&gt; Writer [LogMessage EmulatorEvent] ~&gt; Eff effs
forall s1 s2 (effs :: [* -&gt; *]).
(Monoid s1, Member (State s2) effs) =&gt;
Setter' s2 s1 -&gt; Writer s1 ~&gt; Eff effs
</span><span class="hs-identifier hs-var">writeIntoState</span></span><span> </span><span class="annot"><span class="annottext">Lens' EmulatorState [LogMessage EmulatorEvent]
Setter' EmulatorState [LogMessage EmulatorEvent]
</span><a href="Wallet.Emulator.MultiAgent.html#emulatorLog"><span class="hs-identifier hs-var">emulatorLog</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#handleMultiAgent"><span class="hs-identifier hs-type">handleMultiAgent</span></a></span><span>
</span><span id="line-375"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680562910"><span class="annot"><a href="#local-6989586621680562910"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Members</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#MultiAgentEffs"><span class="hs-identifier hs-type">MultiAgentEffs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680562910"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-376"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#MultiAgentEffect"><span class="hs-identifier hs-type">MultiAgentEffect</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621680562910"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">~&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680562910"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-377"></span><span id="handleMultiAgent"><span class="annot"><span class="annottext">handleMultiAgent :: Eff (MultiAgentEffect : effs) ~&gt; Eff effs
</span><a href="Wallet.Emulator.MultiAgent.html#handleMultiAgent"><span class="hs-identifier hs-var hs-var">handleMultiAgent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MultiAgentEffect ~&gt; Eff effs)
-&gt; Eff (MultiAgentEffect : effs) ~&gt; Eff effs
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="annot"><span class="annottext">((MultiAgentEffect ~&gt; Eff effs)
 -&gt; Eff (MultiAgentEffect : effs) ~&gt; Eff effs)
-&gt; (MultiAgentEffect ~&gt; Eff effs)
-&gt; Eff (MultiAgentEffect : effs) ~&gt; Eff effs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-378"></span><span>    </span><span class="hs-comment">-- TODO: catch, log, and rethrow wallet errors?</span><span>
</span><span id="line-379"></span><span>    </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#WalletAction"><span class="hs-identifier hs-type">WalletAction</span></a></span><span> </span><span id="local-6989586621680562909"><span class="annot"><a href="#local-6989586621680562909"><span class="hs-identifier hs-var">wallet</span></a></span></span><span> </span><span id="local-6989586621680562908"><span class="annot"><a href="#local-6989586621680562908"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-380"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-381"></span><span>            </span><span class="annot"><a href="#local-6989586621680562907"><span class="hs-identifier hs-type">p1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AReview</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorEvent%27"><span class="hs-identifier hs-type">EmulatorEvent'</span></a></span><span> </span><span class="annot"><a href="Wallet.Emulator.Wallet.html#WalletEvent"><span class="hs-identifier hs-type">Wallet.WalletEvent</span></a></span><span>
</span><span id="line-382"></span><span>            </span><span id="local-6989586621680562907"><span class="annot"><span class="annottext">p1 :: AReview EmulatorEvent' WalletEvent
</span><a href="#local-6989586621680562907"><span class="hs-identifier hs-var hs-var">p1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Prism' EmulatorEvent' WalletEvent
</span><a href="Wallet.Emulator.MultiAgent.html#walletEvent"><span class="hs-identifier hs-var">walletEvent</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680562909"><span class="hs-identifier hs-var">wallet</span></a></span><span>
</span><span id="line-383"></span><span>            </span><span class="annot"><a href="#local-6989586621680562906"><span class="hs-identifier hs-type">p2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AReview</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorEvent%27"><span class="hs-identifier hs-type">EmulatorEvent'</span></a></span><span> </span><span class="annot"><a href="Wallet.Emulator.NodeClient.html#NodeClientEvent"><span class="hs-identifier hs-type">NC.NodeClientEvent</span></a></span><span>
</span><span id="line-384"></span><span>            </span><span id="local-6989586621680562906"><span class="annot"><span class="annottext">p2 :: AReview EmulatorEvent' NodeClientEvent
</span><a href="#local-6989586621680562906"><span class="hs-identifier hs-var hs-var">p2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Prism' EmulatorEvent' NodeClientEvent
</span><a href="Wallet.Emulator.MultiAgent.html#walletClientEvent"><span class="hs-identifier hs-var">walletClientEvent</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680562909"><span class="hs-identifier hs-var">wallet</span></a></span><span>
</span><span id="line-385"></span><span>            </span><span class="annot"><a href="#local-6989586621680562905"><span class="hs-identifier hs-type">p3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AReview</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorEvent%27"><span class="hs-identifier hs-type">EmulatorEvent'</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChainIndex.ChainIndexLog</span></span><span>
</span><span id="line-386"></span><span>            </span><span id="local-6989586621680562905"><span class="annot"><span class="annottext">p3 :: AReview EmulatorEvent' ChainIndexLog
</span><a href="#local-6989586621680562905"><span class="hs-identifier hs-var hs-var">p3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Prism' EmulatorEvent' ChainIndexLog
</span><a href="Wallet.Emulator.MultiAgent.html#chainIndexEvent"><span class="hs-identifier hs-var">chainIndexEvent</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680562909"><span class="hs-identifier hs-var">wallet</span></a></span><span>
</span><span id="line-387"></span><span>            </span><span class="annot"><a href="#local-6989586621680562904"><span class="hs-identifier hs-type">p4</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AReview</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorEvent%27"><span class="hs-identifier hs-type">EmulatorEvent'</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-388"></span><span>            </span><span id="local-6989586621680562904"><span class="annot"><span class="annottext">p4 :: AReview EmulatorEvent' Text
</span><a href="#local-6989586621680562904"><span class="hs-identifier hs-var hs-var">p4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Prism' EmulatorEvent' WalletEvent
</span><a href="Wallet.Emulator.MultiAgent.html#walletEvent"><span class="hs-identifier hs-var">walletEvent</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680562909"><span class="hs-identifier hs-var">wallet</span></a></span><span> </span><span class="annot"><span class="annottext">AReview EmulatorEvent' WalletEvent
-&gt; (Tagged Text (Identity Text)
    -&gt; Tagged WalletEvent (Identity WalletEvent))
-&gt; AReview EmulatorEvent' Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Tagged Text (Identity Text)
-&gt; Tagged WalletEvent (Identity WalletEvent)
Prism' WalletEvent Text
</span><a href="Wallet.Emulator.Wallet.html#_GenericLog"><span class="hs-identifier hs-var">Wallet._GenericLog</span></a></span><span>
</span><span id="line-389"></span><span>            </span><span class="annot"><a href="#local-6989586621680562903"><span class="hs-identifier hs-type">p5</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AReview</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorEvent%27"><span class="hs-identifier hs-type">EmulatorEvent'</span></a></span><span> </span><span class="annot"><a href="Wallet.Emulator.LogMessages.html#RequestHandlerLogMsg"><span class="hs-identifier hs-type">RequestHandlerLogMsg</span></a></span><span>
</span><span id="line-390"></span><span>            </span><span id="local-6989586621680562903"><span class="annot"><span class="annottext">p5 :: AReview EmulatorEvent' RequestHandlerLogMsg
</span><a href="#local-6989586621680562903"><span class="hs-identifier hs-var hs-var">p5</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Prism' EmulatorEvent' WalletEvent
</span><a href="Wallet.Emulator.MultiAgent.html#walletEvent"><span class="hs-identifier hs-var">walletEvent</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680562909"><span class="hs-identifier hs-var">wallet</span></a></span><span> </span><span class="annot"><span class="annottext">AReview EmulatorEvent' WalletEvent
-&gt; (Tagged RequestHandlerLogMsg (Identity RequestHandlerLogMsg)
    -&gt; Tagged WalletEvent (Identity WalletEvent))
-&gt; AReview EmulatorEvent' RequestHandlerLogMsg
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Tagged RequestHandlerLogMsg (Identity RequestHandlerLogMsg)
-&gt; Tagged WalletEvent (Identity WalletEvent)
Prism' WalletEvent RequestHandlerLogMsg
</span><a href="Wallet.Emulator.Wallet.html#_RequestHandlerLog"><span class="hs-identifier hs-var">Wallet._RequestHandlerLog</span></a></span><span>
</span><span id="line-391"></span><span>            </span><span class="annot"><a href="#local-6989586621680562901"><span class="hs-identifier hs-type">p6</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AReview</span></span><span> </span><span class="annot"><a href="Wallet.Emulator.MultiAgent.html#EmulatorEvent%27"><span class="hs-identifier hs-type">EmulatorEvent'</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxBalanceMsg</span></span><span>
</span><span id="line-392"></span><span>            </span><span id="local-6989586621680562901"><span class="annot"><span class="annottext">p6 :: AReview EmulatorEvent' TxBalanceMsg
</span><a href="#local-6989586621680562901"><span class="hs-identifier hs-var hs-var">p6</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Prism' EmulatorEvent' WalletEvent
</span><a href="Wallet.Emulator.MultiAgent.html#walletEvent"><span class="hs-identifier hs-var">walletEvent</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680562909"><span class="hs-identifier hs-var">wallet</span></a></span><span> </span><span class="annot"><span class="annottext">AReview EmulatorEvent' WalletEvent
-&gt; (Tagged TxBalanceMsg (Identity TxBalanceMsg)
    -&gt; Tagged WalletEvent (Identity WalletEvent))
-&gt; AReview EmulatorEvent' TxBalanceMsg
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Tagged TxBalanceMsg (Identity TxBalanceMsg)
-&gt; Tagged WalletEvent (Identity WalletEvent)
Prism' WalletEvent TxBalanceMsg
</span><a href="Wallet.Emulator.Wallet.html#_TxBalanceLog"><span class="hs-identifier hs-var">Wallet._TxBalanceLog</span></a></span><span>
</span><span id="line-393"></span><span>        </span><span class="annot"><span class="annottext">Eff EmulatedWalletEffects x
</span><a href="#local-6989586621680562908"><span class="hs-identifier hs-var">act</span></a></span><span>
</span><span id="line-394"></span><span>            </span><span class="annot"><span class="annottext">Eff EmulatedWalletEffects x
-&gt; (Eff EmulatedWalletEffects x
    -&gt; Eff
         (WalletEffect
            : Error WalletAPIError : NodeClientEffect : ChainIndexQueryEffect
            : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
            : LogMsg TxBalanceMsg : LogMsg Text : State WalletState
            : LogMsg WalletEvent : State NodeClientState
            : LogMsg NodeClientEvent : State ChainIndexEmulatorState
            : LogMsg ChainIndexLog : State (Maybe SigningProcess)
            : Writer [LogMessage EmulatorEvent] : effs)
         x)
-&gt; Eff
     (WalletEffect
        : Error WalletAPIError : NodeClientEffect : ChainIndexQueryEffect
        : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
        : LogMsg TxBalanceMsg : LogMsg Text : State WalletState
        : LogMsg WalletEvent : State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
     x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Eff EmulatedWalletEffects x
-&gt; Eff
     (WalletEffect
        : Error WalletAPIError : NodeClientEffect : ChainIndexQueryEffect
        : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
        : LogMsg TxBalanceMsg : LogMsg Text : State WalletState
        : LogMsg WalletEvent : State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
     x
forall (effs :: [* -&gt; *]) (as :: [* -&gt; *]).
CanWeakenEnd as effs =&gt;
Eff as ~&gt; Eff effs
</span><span class="hs-identifier hs-var">raiseEnd</span></span><span>
</span><span id="line-395"></span><span>            </span><span class="annot"><span class="annottext">Eff
  (WalletEffect
     : Error WalletAPIError : NodeClientEffect : ChainIndexQueryEffect
     : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
     : LogMsg TxBalanceMsg : LogMsg Text : State WalletState
     : LogMsg WalletEvent : State NodeClientState
     : LogMsg NodeClientEvent : State ChainIndexEmulatorState
     : LogMsg ChainIndexLog : State (Maybe SigningProcess)
     : Writer [LogMessage EmulatorEvent] : effs)
  x
-&gt; (Eff
      (WalletEffect
         : Error WalletAPIError : NodeClientEffect : ChainIndexQueryEffect
         : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
         : LogMsg TxBalanceMsg : LogMsg Text : State WalletState
         : LogMsg WalletEvent : State NodeClientState
         : LogMsg NodeClientEvent : State ChainIndexEmulatorState
         : LogMsg ChainIndexLog : State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs)
      x
    -&gt; Eff
         (Error WalletAPIError
            : NodeClientEffect : ChainIndexQueryEffect
            : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
            : LogMsg TxBalanceMsg : LogMsg Text : State WalletState
            : LogMsg WalletEvent : State NodeClientState
            : LogMsg NodeClientEvent : State ChainIndexEmulatorState
            : LogMsg ChainIndexLog : State (Maybe SigningProcess)
            : Writer [LogMessage EmulatorEvent] : effs)
         x)
-&gt; Eff
     (Error WalletAPIError
        : NodeClientEffect : ChainIndexQueryEffect
        : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
        : LogMsg TxBalanceMsg : LogMsg Text : State WalletState
        : LogMsg WalletEvent : State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
     x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(WalletEffect
 ~&gt; Eff
      (Error WalletAPIError
         : NodeClientEffect : ChainIndexQueryEffect
         : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
         : LogMsg TxBalanceMsg : LogMsg Text : State WalletState
         : LogMsg WalletEvent : State NodeClientState
         : LogMsg NodeClientEvent : State ChainIndexEmulatorState
         : LogMsg ChainIndexLog : State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs))
-&gt; Eff
     (WalletEffect
        : Error WalletAPIError : NodeClientEffect : ChainIndexQueryEffect
        : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
        : LogMsg TxBalanceMsg : LogMsg Text : State WalletState
        : LogMsg WalletEvent : State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
   ~&gt; Eff
        (Error WalletAPIError
           : NodeClientEffect : ChainIndexQueryEffect
           : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
           : LogMsg TxBalanceMsg : LogMsg Text : State WalletState
           : LogMsg WalletEvent : State NodeClientState
           : LogMsg NodeClientEvent : State ChainIndexEmulatorState
           : LogMsg ChainIndexLog : State (Maybe SigningProcess)
           : Writer [LogMessage EmulatorEvent] : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (Error WalletAPIError) effs, Member NodeClientEffect effs,
 Member ChainIndexQueryEffect effs, Member (State WalletState) effs,
 Member (LogMsg TxBalanceMsg) effs) =&gt;
WalletEffect ~&gt; Eff effs
WalletEffect
~&gt; Eff
     (Error WalletAPIError
        : NodeClientEffect : ChainIndexQueryEffect
        : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
        : LogMsg TxBalanceMsg : LogMsg Text : State WalletState
        : LogMsg WalletEvent : State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
</span><a href="Wallet.Emulator.Wallet.html#handleWallet"><span class="hs-identifier hs-var">Wallet.handleWallet</span></a></span><span>
</span><span id="line-396"></span><span>            </span><span class="annot"><span class="annottext">Eff
  (Error WalletAPIError
     : NodeClientEffect : ChainIndexQueryEffect
     : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
     : LogMsg TxBalanceMsg : LogMsg Text : State WalletState
     : LogMsg WalletEvent : State NodeClientState
     : LogMsg NodeClientEvent : State ChainIndexEmulatorState
     : LogMsg ChainIndexLog : State (Maybe SigningProcess)
     : Writer [LogMessage EmulatorEvent] : effs)
  x
-&gt; (Eff
      (Error WalletAPIError
         : NodeClientEffect : ChainIndexQueryEffect
         : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
         : LogMsg TxBalanceMsg : LogMsg Text : State WalletState
         : LogMsg WalletEvent : State NodeClientState
         : LogMsg NodeClientEvent : State ChainIndexEmulatorState
         : LogMsg ChainIndexLog : State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs)
      x
    -&gt; Eff
         (NodeClientEffect
            : ChainIndexQueryEffect : LogObserve (LogMessage Text)
            : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
            : State WalletState : LogMsg WalletEvent : State NodeClientState
            : LogMsg NodeClientEvent : State ChainIndexEmulatorState
            : LogMsg ChainIndexLog : State (Maybe SigningProcess)
            : Writer [LogMessage EmulatorEvent] : effs)
         x)
-&gt; Eff
     (NodeClientEffect
        : ChainIndexQueryEffect : LogObserve (LogMessage Text)
        : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
        : State WalletState : LogMsg WalletEvent : State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
     x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  (Error WalletAPIError
     : NodeClientEffect : ChainIndexQueryEffect
     : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
     : LogMsg TxBalanceMsg : LogMsg Text : State WalletState
     : LogMsg WalletEvent : State NodeClientState
     : LogMsg NodeClientEvent : State ChainIndexEmulatorState
     : LogMsg ChainIndexLog : State (Maybe SigningProcess)
     : Writer [LogMessage EmulatorEvent] : effs)
  x
-&gt; Eff
     (NodeClientEffect
        : ChainIndexQueryEffect : LogObserve (LogMessage Text)
        : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
        : State WalletState : LogMsg WalletEvent : State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
     x
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
Member eff effs =&gt;
Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">subsume</span></span><span>
</span><span id="line-397"></span><span>            </span><span class="annot"><span class="annottext">Eff
  (NodeClientEffect
     : ChainIndexQueryEffect : LogObserve (LogMessage Text)
     : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
     : State WalletState : LogMsg WalletEvent : State NodeClientState
     : LogMsg NodeClientEvent : State ChainIndexEmulatorState
     : LogMsg ChainIndexLog : State (Maybe SigningProcess)
     : Writer [LogMessage EmulatorEvent] : effs)
  x
-&gt; (Eff
      (NodeClientEffect
         : ChainIndexQueryEffect : LogObserve (LogMessage Text)
         : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
         : State WalletState : LogMsg WalletEvent : State NodeClientState
         : LogMsg NodeClientEvent : State ChainIndexEmulatorState
         : LogMsg ChainIndexLog : State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs)
      x
    -&gt; Eff
         (ChainIndexQueryEffect
            : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
            : LogMsg TxBalanceMsg : LogMsg Text : State WalletState
            : LogMsg WalletEvent : State NodeClientState
            : LogMsg NodeClientEvent : State ChainIndexEmulatorState
            : LogMsg ChainIndexLog : State (Maybe SigningProcess)
            : Writer [LogMessage EmulatorEvent] : effs)
         x)
-&gt; Eff
     (ChainIndexQueryEffect
        : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
        : LogMsg TxBalanceMsg : LogMsg Text : State WalletState
        : LogMsg WalletEvent : State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
     x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  (NodeClientEffect
     : ChainIndexQueryEffect : LogObserve (LogMessage Text)
     : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
     : State WalletState : LogMsg WalletEvent : State NodeClientState
     : LogMsg NodeClientEvent : State ChainIndexEmulatorState
     : LogMsg ChainIndexLog : State (Maybe SigningProcess)
     : Writer [LogMessage EmulatorEvent] : effs)
  x
-&gt; Eff
     (ChainIndexQueryEffect
        : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
        : LogMsg TxBalanceMsg : LogMsg Text : State WalletState
        : LogMsg WalletEvent : State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
     x
forall (effs :: [* -&gt; *]).
Members NodeClientEffs effs =&gt;
Eff (NodeClientEffect : effs) ~&gt; Eff effs
</span><a href="Wallet.Emulator.NodeClient.html#handleNodeClient"><span class="hs-identifier hs-var">NC.handleNodeClient</span></a></span><span>
</span><span id="line-398"></span><span>            </span><span class="annot"><span class="annottext">Eff
  (ChainIndexQueryEffect
     : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
     : LogMsg TxBalanceMsg : LogMsg Text : State WalletState
     : LogMsg WalletEvent : State NodeClientState
     : LogMsg NodeClientEvent : State ChainIndexEmulatorState
     : LogMsg ChainIndexLog : State (Maybe SigningProcess)
     : Writer [LogMessage EmulatorEvent] : effs)
  x
-&gt; (Eff
      (ChainIndexQueryEffect
         : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
         : LogMsg TxBalanceMsg : LogMsg Text : State WalletState
         : LogMsg WalletEvent : State NodeClientState
         : LogMsg NodeClientEvent : State ChainIndexEmulatorState
         : LogMsg ChainIndexLog : State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs)
      x
    -&gt; Eff
         (LogObserve (LogMessage Text)
            : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
            : State WalletState : LogMsg WalletEvent : State NodeClientState
            : LogMsg NodeClientEvent : State ChainIndexEmulatorState
            : LogMsg ChainIndexLog : State (Maybe SigningProcess)
            : Writer [LogMessage EmulatorEvent] : effs)
         x)
-&gt; Eff
     (LogObserve (LogMessage Text)
        : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
        : State WalletState : LogMsg WalletEvent : State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
     x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexQueryEffect
 ~&gt; Eff
      (LogObserve (LogMessage Text)
         : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
         : State WalletState : LogMsg WalletEvent : State NodeClientState
         : LogMsg NodeClientEvent : State ChainIndexEmulatorState
         : LogMsg ChainIndexLog : State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs))
-&gt; Eff
     (ChainIndexQueryEffect
        : LogObserve (LogMessage Text) : LogMsg RequestHandlerLogMsg
        : LogMsg TxBalanceMsg : LogMsg Text : State WalletState
        : LogMsg WalletEvent : State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
   ~&gt; Eff
        (LogObserve (LogMessage Text)
           : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
           : State WalletState : LogMsg WalletEvent : State NodeClientState
           : LogMsg NodeClientEvent : State ChainIndexEmulatorState
           : LogMsg ChainIndexLog : State (Maybe SigningProcess)
           : Writer [LogMessage EmulatorEvent] : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (State ChainIndexEmulatorState) effs,
 Member (Error ChainIndexError) effs,
 Member (LogMsg ChainIndexLog) effs) =&gt;
ChainIndexQueryEffect ~&gt; Eff effs
ChainIndexQueryEffect
~&gt; Eff
     (LogObserve (LogMessage Text)
        : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
        : State WalletState : LogMsg WalletEvent : State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
</span><span class="hs-identifier hs-var">ChainIndex.handleQuery</span></span><span>
</span><span id="line-399"></span><span>            </span><span class="annot"><span class="annottext">Eff
  (LogObserve (LogMessage Text)
     : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
     : State WalletState : LogMsg WalletEvent : State NodeClientState
     : LogMsg NodeClientEvent : State ChainIndexEmulatorState
     : LogMsg ChainIndexLog : State (Maybe SigningProcess)
     : Writer [LogMessage EmulatorEvent] : effs)
  x
-&gt; (Eff
      (LogObserve (LogMessage Text)
         : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
         : State WalletState : LogMsg WalletEvent : State NodeClientState
         : LogMsg NodeClientEvent : State ChainIndexEmulatorState
         : LogMsg ChainIndexLog : State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs)
      x
    -&gt; Eff
         (LogMsg RequestHandlerLogMsg
            : LogMsg TxBalanceMsg : LogMsg Text : State WalletState
            : LogMsg WalletEvent : State NodeClientState
            : LogMsg NodeClientEvent : State ChainIndexEmulatorState
            : LogMsg ChainIndexLog : State (Maybe SigningProcess)
            : Writer [LogMessage EmulatorEvent] : effs)
         x)
-&gt; Eff
     (LogMsg RequestHandlerLogMsg
        : LogMsg TxBalanceMsg : LogMsg Text : State WalletState
        : LogMsg WalletEvent : State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
     x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  (LogObserve (LogMessage Text)
     : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg : LogMsg Text
     : State WalletState : LogMsg WalletEvent : State NodeClientState
     : LogMsg NodeClientEvent : State ChainIndexEmulatorState
     : LogMsg ChainIndexLog : State (Maybe SigningProcess)
     : Writer [LogMessage EmulatorEvent] : effs)
  x
-&gt; Eff
     (LogMsg RequestHandlerLogMsg
        : LogMsg TxBalanceMsg : LogMsg Text : State WalletState
        : LogMsg WalletEvent : State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
     x
forall (effs :: [* -&gt; *]).
Member (LogMsg Text) effs =&gt;
Eff (LogObserve (LogMessage Text) : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">handleObserveLog</span></span><span>
</span><span id="line-400"></span><span>            </span><span class="annot"><span class="annottext">Eff
  (LogMsg RequestHandlerLogMsg
     : LogMsg TxBalanceMsg : LogMsg Text : State WalletState
     : LogMsg WalletEvent : State NodeClientState
     : LogMsg NodeClientEvent : State ChainIndexEmulatorState
     : LogMsg ChainIndexLog : State (Maybe SigningProcess)
     : Writer [LogMessage EmulatorEvent] : effs)
  x
-&gt; (Eff
      (LogMsg RequestHandlerLogMsg
         : LogMsg TxBalanceMsg : LogMsg Text : State WalletState
         : LogMsg WalletEvent : State NodeClientState
         : LogMsg NodeClientEvent : State ChainIndexEmulatorState
         : LogMsg ChainIndexLog : State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs)
      x
    -&gt; Eff
         (LogMsg TxBalanceMsg
            : LogMsg Text : State WalletState : LogMsg WalletEvent
            : State NodeClientState : LogMsg NodeClientEvent
            : State ChainIndexEmulatorState : LogMsg ChainIndexLog
            : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
            : effs)
         x)
-&gt; Eff
     (LogMsg TxBalanceMsg
        : LogMsg Text : State WalletState : LogMsg WalletEvent
        : State NodeClientState : LogMsg NodeClientEvent
        : State ChainIndexEmulatorState : LogMsg ChainIndexLog
        : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
        : effs)
     x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg RequestHandlerLogMsg
 ~&gt; Eff
      (LogMsg TxBalanceMsg
         : LogMsg Text : State WalletState : LogMsg WalletEvent
         : State NodeClientState : LogMsg NodeClientEvent
         : State ChainIndexEmulatorState : LogMsg ChainIndexLog
         : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
         : effs))
-&gt; Eff
     (LogMsg RequestHandlerLogMsg
        : LogMsg TxBalanceMsg : LogMsg Text : State WalletState
        : LogMsg WalletEvent : State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
   ~&gt; Eff
        (LogMsg TxBalanceMsg
           : LogMsg Text : State WalletState : LogMsg WalletEvent
           : State NodeClientState : LogMsg NodeClientEvent
           : State ChainIndexEmulatorState : LogMsg ChainIndexLog
           : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
           : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(RequestHandlerLogMsg -&gt; EmulatorEvent')
-&gt; LogMsg RequestHandlerLogMsg
   ~&gt; Eff
        (LogMsg TxBalanceMsg
           : LogMsg Text : State WalletState : LogMsg WalletEvent
           : State NodeClientState : LogMsg NodeClientEvent
           : State ChainIndexEmulatorState : LogMsg ChainIndexLog
           : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
           : effs)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><span class="hs-identifier hs-var">mapLog</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AReview EmulatorEvent' RequestHandlerLogMsg
-&gt; RequestHandlerLogMsg -&gt; EmulatorEvent'
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview EmulatorEvent' RequestHandlerLogMsg
</span><a href="#local-6989586621680562903"><span class="hs-identifier hs-var">p5</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>            </span><span class="annot"><span class="annottext">Eff
  (LogMsg TxBalanceMsg
     : LogMsg Text : State WalletState : LogMsg WalletEvent
     : State NodeClientState : LogMsg NodeClientEvent
     : State ChainIndexEmulatorState : LogMsg ChainIndexLog
     : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
     : effs)
  x
-&gt; (Eff
      (LogMsg TxBalanceMsg
         : LogMsg Text : State WalletState : LogMsg WalletEvent
         : State NodeClientState : LogMsg NodeClientEvent
         : State ChainIndexEmulatorState : LogMsg ChainIndexLog
         : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
         : effs)
      x
    -&gt; Eff
         (LogMsg Text
            : State WalletState : LogMsg WalletEvent : State NodeClientState
            : LogMsg NodeClientEvent : State ChainIndexEmulatorState
            : LogMsg ChainIndexLog : State (Maybe SigningProcess)
            : Writer [LogMessage EmulatorEvent] : effs)
         x)
-&gt; Eff
     (LogMsg Text
        : State WalletState : LogMsg WalletEvent : State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
     x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg TxBalanceMsg
 ~&gt; Eff
      (LogMsg Text
         : State WalletState : LogMsg WalletEvent : State NodeClientState
         : LogMsg NodeClientEvent : State ChainIndexEmulatorState
         : LogMsg ChainIndexLog : State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs))
-&gt; Eff
     (LogMsg TxBalanceMsg
        : LogMsg Text : State WalletState : LogMsg WalletEvent
        : State NodeClientState : LogMsg NodeClientEvent
        : State ChainIndexEmulatorState : LogMsg ChainIndexLog
        : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
        : effs)
   ~&gt; Eff
        (LogMsg Text
           : State WalletState : LogMsg WalletEvent : State NodeClientState
           : LogMsg NodeClientEvent : State ChainIndexEmulatorState
           : LogMsg ChainIndexLog : State (Maybe SigningProcess)
           : Writer [LogMessage EmulatorEvent] : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxBalanceMsg -&gt; EmulatorEvent')
-&gt; LogMsg TxBalanceMsg
   ~&gt; Eff
        (LogMsg Text
           : State WalletState : LogMsg WalletEvent : State NodeClientState
           : LogMsg NodeClientEvent : State ChainIndexEmulatorState
           : LogMsg ChainIndexLog : State (Maybe SigningProcess)
           : Writer [LogMessage EmulatorEvent] : effs)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><span class="hs-identifier hs-var">mapLog</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AReview EmulatorEvent' TxBalanceMsg
-&gt; TxBalanceMsg -&gt; EmulatorEvent'
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview EmulatorEvent' TxBalanceMsg
</span><a href="#local-6989586621680562901"><span class="hs-identifier hs-var">p6</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span>            </span><span class="annot"><span class="annottext">Eff
  (LogMsg Text
     : State WalletState : LogMsg WalletEvent : State NodeClientState
     : LogMsg NodeClientEvent : State ChainIndexEmulatorState
     : LogMsg ChainIndexLog : State (Maybe SigningProcess)
     : Writer [LogMessage EmulatorEvent] : effs)
  x
-&gt; (Eff
      (LogMsg Text
         : State WalletState : LogMsg WalletEvent : State NodeClientState
         : LogMsg NodeClientEvent : State ChainIndexEmulatorState
         : LogMsg ChainIndexLog : State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs)
      x
    -&gt; Eff
         (State WalletState
            : LogMsg WalletEvent : State NodeClientState
            : LogMsg NodeClientEvent : State ChainIndexEmulatorState
            : LogMsg ChainIndexLog : State (Maybe SigningProcess)
            : Writer [LogMessage EmulatorEvent] : effs)
         x)
-&gt; Eff
     (State WalletState
        : LogMsg WalletEvent : State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
     x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg Text
 ~&gt; Eff
      (State WalletState
         : LogMsg WalletEvent : State NodeClientState
         : LogMsg NodeClientEvent : State ChainIndexEmulatorState
         : LogMsg ChainIndexLog : State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs))
-&gt; Eff
     (LogMsg Text
        : State WalletState : LogMsg WalletEvent : State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
   ~&gt; Eff
        (State WalletState
           : LogMsg WalletEvent : State NodeClientState
           : LogMsg NodeClientEvent : State ChainIndexEmulatorState
           : LogMsg ChainIndexLog : State (Maybe SigningProcess)
           : Writer [LogMessage EmulatorEvent] : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Text -&gt; EmulatorEvent')
-&gt; LogMsg Text
   ~&gt; Eff
        (State WalletState
           : LogMsg WalletEvent : State NodeClientState
           : LogMsg NodeClientEvent : State ChainIndexEmulatorState
           : LogMsg ChainIndexLog : State (Maybe SigningProcess)
           : Writer [LogMessage EmulatorEvent] : effs)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><span class="hs-identifier hs-var">mapLog</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AReview EmulatorEvent' Text -&gt; Text -&gt; EmulatorEvent'
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview EmulatorEvent' Text
</span><a href="#local-6989586621680562904"><span class="hs-identifier hs-var">p4</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>            </span><span class="annot"><span class="annottext">Eff
  (State WalletState
     : LogMsg WalletEvent : State NodeClientState
     : LogMsg NodeClientEvent : State ChainIndexEmulatorState
     : LogMsg ChainIndexLog : State (Maybe SigningProcess)
     : Writer [LogMessage EmulatorEvent] : effs)
  x
-&gt; (Eff
      (State WalletState
         : LogMsg WalletEvent : State NodeClientState
         : LogMsg NodeClientEvent : State ChainIndexEmulatorState
         : LogMsg ChainIndexLog : State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs)
      x
    -&gt; Eff
         (LogMsg WalletEvent
            : State NodeClientState : LogMsg NodeClientEvent
            : State ChainIndexEmulatorState : LogMsg ChainIndexLog
            : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
            : effs)
         x)
-&gt; Eff
     (LogMsg WalletEvent
        : State NodeClientState : LogMsg NodeClientEvent
        : State ChainIndexEmulatorState : LogMsg ChainIndexLog
        : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
        : effs)
     x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(State WalletState
 ~&gt; Eff
      (LogMsg WalletEvent
         : State NodeClientState : LogMsg NodeClientEvent
         : State ChainIndexEmulatorState : LogMsg ChainIndexLog
         : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
         : effs))
-&gt; Eff
     (State WalletState
        : LogMsg WalletEvent : State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
   ~&gt; Eff
        (LogMsg WalletEvent
           : State NodeClientState : LogMsg NodeClientEvent
           : State ChainIndexEmulatorState : LogMsg ChainIndexLog
           : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
           : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lens' EmulatorState WalletState
-&gt; State WalletState
   ~&gt; Eff
        (LogMsg WalletEvent
           : State NodeClientState : LogMsg NodeClientEvent
           : State ChainIndexEmulatorState : LogMsg ChainIndexLog
           : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
           : effs)
forall s2 (effs :: [* -&gt; *]) s1.
Member (State s2) effs =&gt;
Lens' s2 s1 -&gt; State s1 ~&gt; Eff effs
</span><span class="hs-identifier hs-var">handleZoomedState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; Lens' EmulatorState WalletState
</span><a href="Wallet.Emulator.MultiAgent.html#walletState"><span class="hs-identifier hs-var">walletState</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680562909"><span class="hs-identifier hs-var">wallet</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>            </span><span class="annot"><span class="annottext">Eff
  (LogMsg WalletEvent
     : State NodeClientState : LogMsg NodeClientEvent
     : State ChainIndexEmulatorState : LogMsg ChainIndexLog
     : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
     : effs)
  x
-&gt; (Eff
      (LogMsg WalletEvent
         : State NodeClientState : LogMsg NodeClientEvent
         : State ChainIndexEmulatorState : LogMsg ChainIndexLog
         : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
         : effs)
      x
    -&gt; Eff
         (State NodeClientState
            : LogMsg NodeClientEvent : State ChainIndexEmulatorState
            : LogMsg ChainIndexLog : State (Maybe SigningProcess)
            : Writer [LogMessage EmulatorEvent] : effs)
         x)
-&gt; Eff
     (State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
     x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg WalletEvent
 ~&gt; Eff
      (State NodeClientState
         : LogMsg NodeClientEvent : State ChainIndexEmulatorState
         : LogMsg ChainIndexLog : State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs))
-&gt; Eff
     (LogMsg WalletEvent
        : State NodeClientState : LogMsg NodeClientEvent
        : State ChainIndexEmulatorState : LogMsg ChainIndexLog
        : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
        : effs)
   ~&gt; Eff
        (State NodeClientState
           : LogMsg NodeClientEvent : State ChainIndexEmulatorState
           : LogMsg ChainIndexLog : State (Maybe SigningProcess)
           : Writer [LogMessage EmulatorEvent] : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WalletEvent -&gt; EmulatorEvent')
-&gt; LogMsg WalletEvent
   ~&gt; Eff
        (State NodeClientState
           : LogMsg NodeClientEvent : State ChainIndexEmulatorState
           : LogMsg ChainIndexLog : State (Maybe SigningProcess)
           : Writer [LogMessage EmulatorEvent] : effs)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><span class="hs-identifier hs-var">mapLog</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AReview EmulatorEvent' WalletEvent -&gt; WalletEvent -&gt; EmulatorEvent'
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview EmulatorEvent' WalletEvent
</span><a href="#local-6989586621680562907"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>            </span><span class="annot"><span class="annottext">Eff
  (State NodeClientState
     : LogMsg NodeClientEvent : State ChainIndexEmulatorState
     : LogMsg ChainIndexLog : State (Maybe SigningProcess)
     : Writer [LogMessage EmulatorEvent] : effs)
  x
-&gt; (Eff
      (State NodeClientState
         : LogMsg NodeClientEvent : State ChainIndexEmulatorState
         : LogMsg ChainIndexLog : State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs)
      x
    -&gt; Eff
         (LogMsg NodeClientEvent
            : State ChainIndexEmulatorState : LogMsg ChainIndexLog
            : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
            : effs)
         x)
-&gt; Eff
     (LogMsg NodeClientEvent
        : State ChainIndexEmulatorState : LogMsg ChainIndexLog
        : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
        : effs)
     x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(State NodeClientState
 ~&gt; Eff
      (LogMsg NodeClientEvent
         : State ChainIndexEmulatorState : LogMsg ChainIndexLog
         : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
         : effs))
-&gt; Eff
     (State NodeClientState
        : LogMsg NodeClientEvent : State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
   ~&gt; Eff
        (LogMsg NodeClientEvent
           : State ChainIndexEmulatorState : LogMsg ChainIndexLog
           : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
           : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lens' EmulatorState NodeClientState
-&gt; State NodeClientState
   ~&gt; Eff
        (LogMsg NodeClientEvent
           : State ChainIndexEmulatorState : LogMsg ChainIndexLog
           : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
           : effs)
forall s2 (effs :: [* -&gt; *]) s1.
Member (State s2) effs =&gt;
Lens' s2 s1 -&gt; State s1 ~&gt; Eff effs
</span><span class="hs-identifier hs-var">handleZoomedState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; Lens' EmulatorState WalletState
</span><a href="Wallet.Emulator.MultiAgent.html#walletState"><span class="hs-identifier hs-var">walletState</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680562909"><span class="hs-identifier hs-var">wallet</span></a></span><span> </span><span class="annot"><span class="annottext">((WalletState -&gt; f WalletState)
 -&gt; EmulatorState -&gt; f EmulatorState)
-&gt; ((NodeClientState -&gt; f NodeClientState)
    -&gt; WalletState -&gt; f WalletState)
-&gt; (NodeClientState -&gt; f NodeClientState)
-&gt; EmulatorState
-&gt; f EmulatorState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(NodeClientState -&gt; f NodeClientState)
-&gt; WalletState -&gt; f WalletState
Lens' WalletState NodeClientState
</span><a href="Wallet.Emulator.Wallet.html#nodeClient"><span class="hs-identifier hs-var">Wallet.nodeClient</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>            </span><span class="annot"><span class="annottext">Eff
  (LogMsg NodeClientEvent
     : State ChainIndexEmulatorState : LogMsg ChainIndexLog
     : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
     : effs)
  x
-&gt; (Eff
      (LogMsg NodeClientEvent
         : State ChainIndexEmulatorState : LogMsg ChainIndexLog
         : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
         : effs)
      x
    -&gt; Eff
         (State ChainIndexEmulatorState
            : LogMsg ChainIndexLog : State (Maybe SigningProcess)
            : Writer [LogMessage EmulatorEvent] : effs)
         x)
-&gt; Eff
     (State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
     x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg NodeClientEvent
 ~&gt; Eff
      (State ChainIndexEmulatorState
         : LogMsg ChainIndexLog : State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs))
-&gt; Eff
     (LogMsg NodeClientEvent
        : State ChainIndexEmulatorState : LogMsg ChainIndexLog
        : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
        : effs)
   ~&gt; Eff
        (State ChainIndexEmulatorState
           : LogMsg ChainIndexLog : State (Maybe SigningProcess)
           : Writer [LogMessage EmulatorEvent] : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NodeClientEvent -&gt; EmulatorEvent')
-&gt; LogMsg NodeClientEvent
   ~&gt; Eff
        (State ChainIndexEmulatorState
           : LogMsg ChainIndexLog : State (Maybe SigningProcess)
           : Writer [LogMessage EmulatorEvent] : effs)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><span class="hs-identifier hs-var">mapLog</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AReview EmulatorEvent' NodeClientEvent
-&gt; NodeClientEvent -&gt; EmulatorEvent'
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview EmulatorEvent' NodeClientEvent
</span><a href="#local-6989586621680562906"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>            </span><span class="annot"><span class="annottext">Eff
  (State ChainIndexEmulatorState
     : LogMsg ChainIndexLog : State (Maybe SigningProcess)
     : Writer [LogMessage EmulatorEvent] : effs)
  x
-&gt; (Eff
      (State ChainIndexEmulatorState
         : LogMsg ChainIndexLog : State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs)
      x
    -&gt; Eff
         (LogMsg ChainIndexLog
            : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
            : effs)
         x)
-&gt; Eff
     (LogMsg ChainIndexLog
        : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
        : effs)
     x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(State ChainIndexEmulatorState
 ~&gt; Eff
      (LogMsg ChainIndexLog
         : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
         : effs))
-&gt; Eff
     (State ChainIndexEmulatorState
        : LogMsg ChainIndexLog : State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
   ~&gt; Eff
        (LogMsg ChainIndexLog
           : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
           : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lens' EmulatorState ChainIndexEmulatorState
-&gt; State ChainIndexEmulatorState
   ~&gt; Eff
        (LogMsg ChainIndexLog
           : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
           : effs)
forall s2 (effs :: [* -&gt; *]) s1.
Member (State s2) effs =&gt;
Lens' s2 s1 -&gt; State s1 ~&gt; Eff effs
</span><span class="hs-identifier hs-var">handleZoomedState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; Lens' EmulatorState WalletState
</span><a href="Wallet.Emulator.MultiAgent.html#walletState"><span class="hs-identifier hs-var">walletState</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680562909"><span class="hs-identifier hs-var">wallet</span></a></span><span> </span><span class="annot"><span class="annottext">((WalletState -&gt; f WalletState)
 -&gt; EmulatorState -&gt; f EmulatorState)
-&gt; ((ChainIndexEmulatorState -&gt; f ChainIndexEmulatorState)
    -&gt; WalletState -&gt; f WalletState)
-&gt; (ChainIndexEmulatorState -&gt; f ChainIndexEmulatorState)
-&gt; EmulatorState
-&gt; f EmulatorState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexEmulatorState -&gt; f ChainIndexEmulatorState)
-&gt; WalletState -&gt; f WalletState
Lens' WalletState ChainIndexEmulatorState
</span><a href="Wallet.Emulator.Wallet.html#chainIndexEmulatorState"><span class="hs-identifier hs-var">Wallet.chainIndexEmulatorState</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>            </span><span class="annot"><span class="annottext">Eff
  (LogMsg ChainIndexLog
     : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
     : effs)
  x
-&gt; (Eff
      (LogMsg ChainIndexLog
         : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
         : effs)
      x
    -&gt; Eff
         (State (Maybe SigningProcess)
            : Writer [LogMessage EmulatorEvent] : effs)
         x)
-&gt; Eff
     (State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
     x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg ChainIndexLog
 ~&gt; Eff
      (State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs))
-&gt; Eff
     (LogMsg ChainIndexLog
        : State (Maybe SigningProcess) : Writer [LogMessage EmulatorEvent]
        : effs)
   ~&gt; Eff
        (State (Maybe SigningProcess)
           : Writer [LogMessage EmulatorEvent] : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ChainIndexLog -&gt; EmulatorEvent')
-&gt; LogMsg ChainIndexLog
   ~&gt; Eff
        (State (Maybe SigningProcess)
           : Writer [LogMessage EmulatorEvent] : effs)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><span class="hs-identifier hs-var">mapLog</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AReview EmulatorEvent' ChainIndexLog
-&gt; ChainIndexLog -&gt; EmulatorEvent'
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><span class="hs-identifier hs-var">review</span></span><span> </span><span class="annot"><span class="annottext">AReview EmulatorEvent' ChainIndexLog
</span><a href="#local-6989586621680562905"><span class="hs-identifier hs-var">p3</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>            </span><span class="annot"><span class="annottext">Eff
  (State (Maybe SigningProcess)
     : Writer [LogMessage EmulatorEvent] : effs)
  x
-&gt; (Eff
      (State (Maybe SigningProcess)
         : Writer [LogMessage EmulatorEvent] : effs)
      x
    -&gt; Eff (Writer [LogMessage EmulatorEvent] : effs) x)
-&gt; Eff (Writer [LogMessage EmulatorEvent] : effs) x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(State (Maybe SigningProcess)
 ~&gt; Eff (Writer [LogMessage EmulatorEvent] : effs))
-&gt; Eff
     (State (Maybe SigningProcess)
        : Writer [LogMessage EmulatorEvent] : effs)
   ~&gt; Eff (Writer [LogMessage EmulatorEvent] : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lens' EmulatorState (Maybe SigningProcess)
-&gt; State (Maybe SigningProcess)
   ~&gt; Eff (Writer [LogMessage EmulatorEvent] : effs)
forall s2 (effs :: [* -&gt; *]) s1.
Member (State s2) effs =&gt;
Lens' s2 s1 -&gt; State s1 ~&gt; Eff effs
</span><span class="hs-identifier hs-var">handleZoomedState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; Lens' EmulatorState WalletState
</span><a href="Wallet.Emulator.MultiAgent.html#walletState"><span class="hs-identifier hs-var">walletState</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680562909"><span class="hs-identifier hs-var">wallet</span></a></span><span> </span><span class="annot"><span class="annottext">((WalletState -&gt; f WalletState)
 -&gt; EmulatorState -&gt; f EmulatorState)
-&gt; ((Maybe SigningProcess -&gt; f (Maybe SigningProcess))
    -&gt; WalletState -&gt; f WalletState)
-&gt; (Maybe SigningProcess -&gt; f (Maybe SigningProcess))
-&gt; EmulatorState
-&gt; f EmulatorState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe SigningProcess -&gt; f (Maybe SigningProcess))
-&gt; WalletState -&gt; f WalletState
Lens' WalletState (Maybe SigningProcess)
</span><a href="Wallet.Emulator.Wallet.html#signingProcess"><span class="hs-identifier hs-var">Wallet.signingProcess</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>            </span><span class="annot"><span class="annottext">Eff (Writer [LogMessage EmulatorEvent] : effs) x
-&gt; (Eff (Writer [LogMessage EmulatorEvent] : effs) x -&gt; Eff effs x)
-&gt; Eff effs x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(Writer [LogMessage EmulatorEvent] ~&gt; Eff effs)
-&gt; Eff (Writer [LogMessage EmulatorEvent] : effs) ~&gt; Eff effs
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><span class="hs-identifier hs-var">interpret</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Setter' EmulatorState [LogMessage EmulatorEvent]
-&gt; Writer [LogMessage EmulatorEvent] ~&gt; Eff effs
forall s1 s2 (effs :: [* -&gt; *]).
(Monoid s1, Member (State s2) effs) =&gt;
Setter' s2 s1 -&gt; Writer s1 ~&gt; Eff effs
</span><span class="hs-identifier hs-var">writeIntoState</span></span><span> </span><span class="annot"><span class="annottext">Lens' EmulatorState [LogMessage EmulatorEvent]
Setter' EmulatorState [LogMessage EmulatorEvent]
</span><a href="Wallet.Emulator.MultiAgent.html#emulatorLog"><span class="hs-identifier hs-var">emulatorLog</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-411"></span></pre></body></html>